\documentclass[12pt]{article}
\input{../../_assets/preambulo.tex}

\author{Arturo Olivares Martos}
\date{\today}
%\title{Entrega Métodos Numéricos II}

\begin{document}
    %\maketitle
    {\color{blue}
    \fancyhead[R]{\color{blue}\helv \nouppercase{\color{blue}Arturo Olivares Martos}}
    \fancyhead[L]{\color{blue}\helv \nouppercase{\color{blue}Entrega Métodos Numéricos II}}

    % Poner Línea del Encabezado en Azul
    \renewcommand{\headrulewidth}{1pt}
    \renewcommand{\headrule}{\hbox to\headwidth{%
    \color{blue}\leaders\hrule height \headrulewidth\hfill}}
    
    \begin{ejercicio}
        Se pretende aproximar mediante integración de Romberg la integral:
        \begin{equation*}
            \int_1^3 \frac{1}{x} \, dx.
        \end{equation*}
        Calcula para ello \( R(2, 2) \).\\

        Definimos la siguiente función auxiliar:
        \Func{f}{[1,3]}{\bb{R}}{x}{\nicefrac{1}{x}}

        Calculamos en primer lugar \( R(i, 0) \).
        \begin{align*}
            R(0, 0) &= T_1 = (3-1)\cdot \dfrac{f(3)-f(1)}{2}
            = \dfrac{4}{3}\\
            R(1, 0) &= T_2 = \dfrac{3-1}{2\cdot 2}\left(f(1)+2\cdot f\left(1+\dfrac{3-1}{2}\right)+f(3)\right)
            = \dfrac{7}{6}\\
            R(2, 0) &= T_{4} = \dfrac{3-1}{4\cdot 2}\left(f(1)+2\left[f\left(1+\dfrac{3-1}{4}\right)+f\left(1+2\cdot \dfrac{3-1}{4}\right)+f\left(1+3\cdot \dfrac{3-1}{4}\right)\right]+f(3)\right)
            \\&= \dfrac{67}{60}
        \end{align*}

        Una vez obtenidos esos valores, calculamos \( R(i, j) \) para \( i,j=1,2 \), con $ j < i $:
        \begin{align*}
            R(1, 1) &= \dfrac{4R(1,0)-R(0,0)}{3} = \dfrac{10}{9}\\
            R(2, 1) &= \dfrac{4R(2,0)-R(1,0)}{3} = \dfrac{11}{10}\\
            R(2, 2) &= \dfrac{4^2R(2,1)-R(1,1)}{15} = \dfrac{742}{675}\approx 1.09925925
        \end{align*}
    \end{ejercicio}

    \begin{ejercicio}
        Dada la regla de integración numérica
        \begin{equation*}
            \int_a^b f(x) \, dx = L_n(f, h) + c_1 h + c_2 h^2 + c_3 h^3 + \ldots
        \end{equation*}
        ¿Cómo se haría un procedimiento similar a la integración de Romberg con esta fórmula?


        Tomando $\nicefrac{h}{2}$, llegamos a que:
        \begin{align*}
            \int_a^b f(x) \, dx &= L_n\left(f,\nicefrac{h}{2}\right) + c_1 \cdot \frac{h}{2} + c_2 \cdot \left(\frac{h}{2}\right)^2 + c_3 \cdot \left(\frac{h}{2}\right)^3 + \ldots\\
        \end{align*}

        Buscamos ahora eliminar el término del error de orden $h$. Multiplicando por $2$ esta expresión y restándole la original, obtenemos:
        \begin{align*}
            \int_a^b f(x) \, dx &= 2L_n\left(f,\nicefrac{h}{2}\right) - L_n(f, h) + c_1 \cdot \left(\frac{h}{2}-\frac{h}{2}\right) + c_2 \cdot \left(2\left(\frac{h}{2}\right)^2 - h^2\right) + c_3 \cdot \left(2\left(\frac{h}{2}\right)^3 - h^3\right) + \ldots\\
            &= 2L_n\left(f,\nicefrac{h}{2}\right) - L_n(f, h) - c_2 \cdot \left(\frac{h^2}{2}\right) - c_3 \cdot \left(\frac{3h^3}{4}\right) + \ldots\\
        \end{align*}

        Hemos conseguido eliminar el término de orden $h$, pero nos quedan los términos de orden $h^2$ y $h^3$. De forma similar a la integración de Romberg, podemos definir los siguientes términos:
        \begin{align*}
            L(i,0) &= L_n(f, \nicefrac{h}{2^i}),\qquad i=0,1,\ldots\\
            L(i,j) &= \dfrac{2^jL(i,j-1)-L(i-1,j-1)}{2^j-1}, \quad i,j\in \{0,1,\ldots\}, \quad j\leq i\\
        \end{align*}

        De esta forma, podemos aproximar la integral de la siguiente forma:
        \begin{align*}
            \int_a^b f(x) \, dx &\approx L(N,N)
        \end{align*}
        donde $N$ es el número de pasos que hemos dado.
    \end{ejercicio}
    }
\end{document}
