\chapter{Sucesiones monótonas, parciales y de Cauchy}\label{chp:Tema6}

%########################################################################################################
% Sucesiones monótonas.
%########################################################################################################

\section{Sucesiones monótonas}
\begin{definicion}
    Se dice que una sucesión de números reales $\{x_n\}$ es \textbf{creciente} (respectivamente \textbf{decreciente}) si $x_n \leq x_{n+1}, ~\forall n \in \mathbb{N}$ (respectivamente $x_n \geq~x_{n+1},\\\forall n \in~\mathbb{N}$).
\end{definicion}

\begin{definicion}
    Se dice que una sucesión de números reales $\{x_n\}$ es \textbf{estrictamente creciente} (respectivamente \textbf{estrictamente decreciente}) si $x_n < x_{n+1}, ~\forall n \in \mathbb{N}$ (respectivamente $x_n > x_{n+1}, ~\forall n \in \mathbb{N}$).
\end{definicion}

\begin{definicion}
    Se dice que una sucesión de números reales es \textbf{monótona} cuando es creciente o decreciente. Si el crecimiento o decrecimiento es estricto, diremos que es \textbf{estrictamente monótona}.
\end{definicion}

Toda sucesión estrictamente monótona es monótona, pero el recíproco no es cierto. Las sucesiones constantes también son monótonas, pues cumplen con la definición de sucesión creciente (también la de decreciente). Es fácil ver que el que una sucesión sea monótona no implica que sea convergente en general. Vamos a ver la relación entre convergencia, acotación y monotonía
en el siguiente teorema:
\begin{teo}
    Toda sucesión de números reales $\{x_n\}$ creciente y mayorada es convergente con $\lim \{x_n\}=\sup \{x_n ~:~ n \in \mathbb{N}\}$.
\end{teo}
\begin{proof}
    Sea $\alpha = \sup \{x_n ~:~ n \in \mathbb{N}\}$.
    \begin{equation*}
        \forall \varepsilon > 0 ~\exists m \in \mathbb{N} ~:~ \alpha - \varepsilon < x_m
    \end{equation*}
    Si $n \in \mathbb{N}$, $n \geq m$, entonces:
    \begin{equation*}
        \alpha - \varepsilon < x_m \leq x_n \implies \alpha - \varepsilon < x_n \leq \alpha < \alpha + \varepsilon
    \end{equation*}
    Por lo que $\lim \{x_n\} = \alpha$, como queríamos. 
\end{proof}

Análogamente, es fácil probar que toda sucesión de números reales decreciente y minorada es convergente con
con $\lim \{x_n\}=\inf \{x_n ~:~ n \in \mathbb{N}\}$.
\begin{coro}\label{coro:6.1.5}
    Toda sucesión de números reales monótona y acotada es convergente.
\end{coro}


%########################################################################################################
% Sucesiones parciales.
%########################################################################################################

\section{Sucesiones parciales}
\begin{definicion}
    Se dice que una aplicación $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ es \textbf{estrictamente creciente} si
    \begin{equation*}
        \sigma(n) < \sigma(n+1), ~ \forall n \in \mathbb{N}.
    \end{equation*}
\end{definicion}

Es inmediato comprobar que $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ es estrictamente si y sólo si
\begin{equation*}
    n,m \in \mathbb{N}, ~ n < m \implies \sigma(n) < \sigma(m)
\end{equation*}

\begin{definicion}
    Dadas dos sucesiones de números reales $\{x_n\}$ e $\{y_n\}$, diremos que $\{y_n\}$ es una \textbf{sucesión parcial} de $\{x_n\}$ si existe $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ estrictamente creciente tal que
    \begin{equation*}
        \{y_n\} = \{x_{\sigma(n)}\}, ~\forall n \in \mathbb{N}
    \end{equation*}
\end{definicion}

Por ejemplo, la sucesión $\{1\}$ (constantemente igual a $1$) es una parcial de $\{(-1)^n\}$ (Tómese $\sigma(n)=2n$). En general, las sucesiones parciales de $\{x_n\}$ son de la forma $\{x_{\sigma(n)}\}$, con $\sigma$ una aplicación de $\mathbb{N}$ en $\mathbb{N}$ estrictamente creciente.\\

Las siguientes afirmaciones son de comprobación inmediata:
\begin{itemize}
    \item Toda sucesión es una parcial de sí misma.
    \item Si $\{y_n\}$ es una parcial de $\{x_n\}$ y $\{z_n\}$ es una parcial de $\{y_n\}$, entonces $\{z_n\}$ es una parcial de $\{x_n\}$ (Piénsese que la composición de aplicaciones de $\mathbb{N}$ en $\mathbb{N}$ estrictamente crecientes es a su vez estrictamente creciente).
\end{itemize}

\begin{lema}
    Sea $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ una aplicación estrictamente creciente. Entonces, se tiene que $\sigma(n) \geq n$, $\forall n \in \mathbb{N}$.
\end{lema}
\begin{proof}
    Hacemos inducción sobre $n$. Obviamente $\sigma(1) \geq 1$. Supuesto que $\sigma(n) \geq n$ para un cierto $n$ natural, tenemos que
    \begin{equation*}
        \sigma(n+1) > \sigma(n) \geq n \implies \sigma(n+1) \geq n+1
    \end{equation*}
    donde se ha usado el Corolario \ref{coro.2.1.8}, lo que demuestra el lema.
\end{proof}

\begin{prop}
    Cualquier sucesión parcial de una sucesión de números reales convergente es convergente y tiene el mismo límite\footnote{Este resultado nos asegura que si una sucesión converge, cualquier parcial suya también lo hará y con el mismo límite. En general, que una sucesión admita una parcial convergente no implica que la sucesión sea convergente, pero la sucesión $\{z_n\} = \{x_{n+p}\}$, con $p \in \mathbb{N}$, es una sucesión parcial ``muy especial'', pues su convergencia equivale a la de la sucesión (Como ya se vio en el ejercicio \ref{ej:5.4.4}).}.
\end{prop}
\begin{proof}
    Sea $\{x_n\} \longrightarrow x$ y sea $\{y_n\}$ una sucesión parcial de la anterior. Sea $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ una aplicación estrictamente creciente tal que
    \begin{equation*}
        \{x_{\sigma(n)}\} = \{y_n\}, ~ \forall n \in \mathbb{N}
    \end{equation*}
    Dado $\varepsilon > 0$, por ser $\{x_n\} \longrightarrow x$ tenemos
    \begin{equation*}
        \exists m \in \mathbb{N}  ~:~ n \in \mathbb{N}, ~n \geq m \implies |x_n - x| < \varepsilon.
    \end{equation*}
    Por el lema anterior, si $n \geq m$, entonces $\sigma(n) \geq n \geq m$ y por tanto
    \begin{equation*}
        |y_n - x| = |x_{\sigma(n)} - x| < \varepsilon
    \end{equation*}
    por lo que $\{y_n\} \longrightarrow x$, como queríamos probar.
\end{proof}

\begin{lema}[Lema del Sol naciente]\label{lema:6.2.5}
    Toda sucesión de números reales admite una parcial monótona.
\end{lema}
\begin{proof}
    Sea $\{x_n\}$ una sucesión de números reales cualquiera. Consideramos el conjunto
    \begin{equation*}
        A = \{n \in \mathbb{N} ~:~ x_n \geq x_{n+h}, ~ \forall h \in \mathbb{N}\}.
    \end{equation*}
    
    Supongamos que el conjunto $A$ es infinito. Entonces, aplicando el Lema \ref{lema:2.4.2}, obtenemos una aplicación $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ estrictamente creciente tal que $\sigma(\mathbb{N}) = A$. Dado un natural $n$ arbitrario, se tiene que
    \begin{equation*}
        x_{\sigma(n)} \geq x_{\sigma(n)+h}, ~\forall h \in \mathbb{N}
    \end{equation*}
    y en particular, tomando $h = \sigma(n+1)- \sigma(n)$ se tiene que
    \begin{equation*}
        x_{\sigma(n)} \geq x_{\sigma(n+1)}, ~\forall n \in \mathbb{N}
    \end{equation*}
    por lo que $\{x_{\sigma(n)}\}$ es una sucesión parcial decreciente.\\
    
    Si $A$ fuera finito, sea $m$ un natural tal que $A \subseteq S(m)$. Dado $p$ natural, con $p > m$, definimos
    \begin{equation*}
        g(p) = \min \{n \in \mathbb{N} ~:~ n > p, ~x_p < x_n\}.
    \end{equation*}
    Notemos que el conjunto de la derecha es no vacío por ser $p \notin A$, luego por el principio de buena ordenación tiene mínimo.
    Claramente $g(p) > p > m$, por lo que $g$ es una aplicación del conjunto $\mathbb{N}-S(m)$ en sí mismo. Definimos ahora
    $\sigma ~:~ \mathbb{N} \longrightarrow \mathbb{N}$ por inducción de la siguiente forma:
    \begin{equation*}
        \sigma(1) = m+1, ~ \sigma(n+1)=g(\sigma(n)), ~ \forall n \in \mathbb{N}.
    \end{equation*}
    Evidentemente $\sigma(n+1) > \sigma(n)$ para todo $n$ natural, luego $\sigma$ es una aplicación de $\mathbb{N}$ en $\mathbb{N}$ estrictamente creciente, por lo que $\{x_{\sigma(n)}\}$ es una sucesión parcial de $\{x_n\}$. Además, por ser $x_{g(p)} > x_p$ para todo $p \in \mathbb{N}-S(m)$, tenemos que
    \begin{equation*}
        x_{\sigma(n+1)} = x_{g(\sigma(n))} > x_{\sigma(n)}
    \end{equation*}
    por lo que $\{x_{\sigma(n)}\}$ es creciente.
\end{proof}

Como consecuencia directa del lema anterior, obtenemos una importante propiedad de las sucesiones de números reales acotadas.
\begin{teo}[de Bolzano-Weierstrass]
    Toda sucesión de números reales acotada admite una parcial convergente.
\end{teo}
\begin{proof}
    Sea $\{x_n\}$ una sucesión de números reales acotada. Aplicando el lema anterior,
    obtenemos una sucesión parcial monótona $\{x_{\sigma(n)}\}$. Dado que $\{x_{\sigma(n)}\}$ también
    está acotada ($\{x_{\sigma(n)} ~:~ n \in \mathbb{N}\} \subseteq \{x_n ~:~ n \in \mathbb{N}\}$)
    por el corolario \ref{coro:6.1.5}, se tiene que $\{x_{\sigma(n)}\}$ es convergente.
\end{proof}

%########################################################################################################
% Sucesiones de Cauchy.
%########################################################################################################

\section{Sucesiones de Cauchy}
Hasta ahora, salvo en el caso de sucesiones monótonas y acotadas, para determinar si una sucesión era o no
convergente debíamos conocer de antemano su posible límite. Dedicamos este apartado para obtener una caracterización de las sucesiones convergentes sin presuponer el conocimiento de un posible límite.

Intuitivamente, si una sucesión de números reales es convergente, sus términos suficientemente avanzados son tan cercanos como se quiera. Formalizamos esta idea a continuación.
\begin{definicion}
    Se dice que una sucesión de números reales $\{x_n\}$ es una \textbf{sucesión de Cauchy} si verifica:
    \begin{equation*}
        \forall \varepsilon > 0, ~ \exists m \in \mathbb{N} ~:~ p,q \in \mathbb{N}, ~ p,q \geq m \implies |x_p - x_q| < \varepsilon
    \end{equation*}
\end{definicion}

\begin{teo}[de Complitud de $\mathbb{R}$]
    Una sucesión de números reales $\{x_n\}$ es convergente si y sólo si es de Cauchy.
\end{teo}
\begin{proof}
    Supongamos que $\{x_n\} \longrightarrow x$. Dado $\varepsilon > 0$ tenemos
    \begin{equation*}
        \exists m \in \mathbb{N} ~:~ n \in \mathbb{N}, ~ n \geq m \implies |x_n - x| < \frac{\varepsilon}{2}.
    \end{equation*}
    Así, dados $p,q \in \mathbb{N}$, con $p,q \geq m$ tenemos
    \begin{equation*}
        |x_p - x_q| \leq |x_p - x| + |x - x_q| < \varepsilon
    \end{equation*}
    por lo que $\{x_n\}$ es de Cauchy.\\
    
    Recíprocamente, supongamos que $\{x_n\}$ es de Cauchy. Entonces
    \begin{equation*}
        \exists m \in \mathbb{N} ~:~ p,q \in \mathbb{N}, ~ p,q \geq m \implies |x_p - x_q| < 1.
    \end{equation*}
    Tomando $K = x_m$ y haciendo $q = m$ se tiene
    \begin{equation*}
        p \geq m \implies K-1 < x_p < K+1
    \end{equation*}
    luego $\{x_n ~:~ n \geq m\}$ es un conjunto acotado, por lo que la sucesión $\{x_n\}$ está acotada. Por el Teorema de Bolzano-Weierstrass, $\{x_n\}$ admite una sucesión parcial convergente $\{x_{\sigma(n)}\}$.
    Sea $x = \lim \{x_{\sigma(n)}\}$. Dado $\varepsilon > 0$, tenemos que
    \begin{gather*}
        \exists m_1 \in \mathbb{N} ~:~ n \in \mathbb{N}, ~ n \geq m_1 \implies |x_{\sigma(n)}-x| < \frac{\varepsilon}{2}\\
        \exists m_2 \in \mathbb{N} ~:~ p,q \in \mathbb{N}, ~ p,q \geq m_2 \implies |x_p - x_q| < \frac{\varepsilon}{2}
    \end{gather*}
    Sea $m = \max \{m_1, m_2\}$. Si $n \geq m$, entonces
    \begin{gather*}
        \sigma(n) \geq n \geq m_1 \implies |x_{\sigma(n)} - x| < \frac{\varepsilon}{2}\\
        n, \sigma(n) \geq m_2 \implies |x_n - x_{\sigma(n)}| < \frac{\varepsilon}{2}
    \end{gather*}
    con lo que finalmente
    \begin{equation*}
        |x_n - x| \leq |x_n - x_{\sigma(n)}| + |x_{\sigma(n)} - x| < \varepsilon
    \end{equation*}
    por lo que $\{x_n\} \longrightarrow x$, como queríamos.
\end{proof}


%########################################################################################################
% Límites superior e inferior de una sucesión.
%########################################################################################################

\section{Límites superior e inferior de una sucesión}

Si $\{x_n\}$ es una sucesión de números reales acotada, entonces $\exists A,B \in \mathbb{R}$ tales que
\begin{equation*}
    A \leq x_n \leq B, ~ \forall n \in \mathbb{N}.
\end{equation*}

Definimos las sucesiones $\{\alpha_n\}$ y $\{\beta_n\}$ como sigue:
\begin{gather*}
    \alpha_n = \inf \{x_k ~:~ k \geq n\} \\
    \beta_n = \sup \{x_k ~:~ k \geq n\}
\end{gather*}
Es fácil ver que
\begin{equation*}
    A \leq \alpha_n \leq \beta_n \leq B, ~\forall n \in \mathbb{N},
\end{equation*}
que $\{\alpha_n\}$ es creciente y que $\{\beta_n\}$ es decreciente, luego ambas sucesiones son convergentes verificando que $\lim \{\alpha_n\} \leq \lim \{\beta_n\}$.
\begin{definicion}
    Sea $\{x_n\}$ es una sucesión de números reales acotada. Definimos el \textbf{límite superior} de la sucesión $\{x_n\}$, notaremos $\limsup \{x_n\}$, como sigue:
    \begin{equation*}
        \limsup \{x_n\} := \lim \{\beta_n\}
    \end{equation*}
    
    Análogamente, definimos el \textbf{límite inferior}  de la sucesión $\{x_n\}$, notaremos $\liminf \{x_n\}$, como sigue:
    \begin{equation*}
        \liminf \{x_n\} := \lim \{\alpha_n\}
    \end{equation*}
\end{definicion}

\begin{prop}
    Si $\{x_n\}$ es una sucesión de números reales acotada y $L \in \mathbb{R}$, entonces:
    \begin{equation*}
        \{x_n\} \longrightarrow L \Longleftrightarrow \liminf \{x_n\} = \limsup \{x_n\} = L
    \end{equation*}
\end{prop}
\begin{proof} Procedemos mediante doble implicación:
\begin{description}
    \item [$\Longleftarrow$)]
        Como $\alpha_n \leq x_n \leq \beta_n$, $\forall n \in \mathbb{N}$
        y $\liminf \{x_n\} = \limsup \{x_n\} = L$, aplicando el Lema \ref{lema:5.3.5}, tenemos que $ \{x_n\} \longrightarrow L$.
        
    \item [$\Longrightarrow$)]
        Dado $\varepsilon > 0$, existe $m \in \mathbb{N}$ tal que si $n \in \mathbb{N}$, $n \geq m$
        se tiene que
        \begin{equation*}
            L - \frac{\varepsilon}{2} < x_n < L + \frac{\varepsilon}{2}
        \end{equation*}
        Es claro que
        \begin{equation*}
            \{x_k ~:~ k \geq n\} \subseteq \left] L - \frac{\varepsilon}{2}, L + \frac{\varepsilon}{2} \right[
        \end{equation*}
        y usando que
        \begin{equation*}
            \alpha_n = \inf \{x_k ~:~ k \geq n\}
            \qquad \land \qquad
            \beta_n = \sup \{x_k ~:~ k \geq n\}
        \end{equation*}
        entonces
        \begin{equation*}
            \alpha_n \geq L - \frac{\varepsilon}{2} > L - \varepsilon 
            \qquad \land \qquad
            \beta_n \leq L + \frac{\varepsilon}{2} < L + \varepsilon 
        \end{equation*}
        de donde deducimos que
        \begin{equation*}
            \forall \varepsilon > 0, ~\exists m \in \mathbb{N} ~:~ n \geq m \Longrightarrow L-\varepsilon < \alpha_n \leq \beta_n < L+\varepsilon,
        \end{equation*}
        por lo que $\liminf \{x_n\} = \limsup \{x_n\} = L$.
\end{description}
\end{proof}

%########################################################################################################
% Ejercicios de Sucesiones monótonas, parciales y de Cauchy.
%########################################################################################################

\section{Ejercicios}

\begin{ejercicio}\label{ej:6.5.1}
    Dar un ejemplo de una sucesión de números reales positivos que sea convergente a 0, pero no sea monótona.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.2}
    Dar un ejemplo de una sucesión no acotada que admita una parcial convergente.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.3}
    Sea $x \in \mathbb{R}$, $x \neq 1$. Probar que
    \begin{equation*}
        1+x+x^2+x^3+\dots+x^n=\frac{1-x^{n+1}}{1-x}, ~\forall n \in \mathbb{N}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.4}
    Sea $0 < x < 1$. Probar que $\{x^n\} \longrightarrow 0$.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.5}
    Sea $-1 < x < 1$. Probar que $\{x^n\} \longrightarrow 0$ y que
    \begin{equation*}
        \{1+x+x^2+x^3+\dots+x^n\} \longrightarrow \frac{1}{1-x}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.6}
    Sea $x > 1$. Probar que $\{x^n\}$ no está acotada.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.7}
    Sea $a > 0$. Definimos la sucesión $\{x_n\}$ como sigue:
    \begin{equation*}
        x_1 = a, ~ x_{n+1} = \frac{x_n}{1+x_n}, ~\forall n \in \mathbb{N}
    \end{equation*}
    Probar que $\{x_n\} \longrightarrow 0$.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.8}
    Probar que la sucesión $x_1 = 1$; $x_{n+1}=\sqrt{3 x_n}$ es convergente y calcular su límite.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.9}
    Estudiar la convergencia de la sucesión
    \begin{equation*}
        x_1 = 2; ~ x_{n+1}=\frac{x_n^2+5}{6}, ~ \forall n \in \mathbb{N}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.10}
    Considera la sucesión
    \begin{equation*}
        x_1=1; ~ x_{n+1}=\sqrt{1+2 x_n} - 1, ~ \forall n \in \mathbb{N}
    \end{equation*}
    Calcular $\lim \{x_n\}$ y $\lim \left\{\frac{x_n}{x_{n+1}}\right\}$.
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.11}
    Sea $a > 1$ fijo. Estudiar la convergencia de la sucesión
    \begin{equation*}
        x_1=a, ~ x_{n+1}=\sqrt{\frac{x_n^2+a}{2}}, ~ \forall n \in \mathbb{N}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.12}
    Estudiar la convergencia de la sucesión
    \begin{equation*}
        x_1 = 1, ~ x_{n+1} = \frac{x_n}{1+ 2 x_n}, ~ \forall n \in \mathbb{N}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:6.5.13}
    Sea $\{x_n\}$ una sucesión de números reales acotada y sean $M,P \in~\mathbb{R}$ tal que $\limsup \{x_n\} < M$ y que $\liminf \{x_n\} > P$.

    Probar que
    \begin{gather*}
        \exists m_1 \in \mathbb{N} ~:~ n \in m_1 \Longrightarrow x_n < M\\
        \exists m_2 \in \mathbb{N} ~:~ n \in m_2 \Longrightarrow x_n > P
    \end{gather*}
\end{ejercicio}