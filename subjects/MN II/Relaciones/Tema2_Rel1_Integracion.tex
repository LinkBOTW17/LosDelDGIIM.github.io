\subsection{Relación 1. Integración Numérica}
\setcounter{ejercicio}{8}

\begin{ejercicio}\label{ej:2.1.9}
    Se considera la siguiente fórmula de integración numérica:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \alpha_0 f(-1) + \alpha_1 f(0) + \alpha_2 f(1).
    \end{equation*}
    \begin{enumerate}
        \item Halle de tres formas distintas los valores $\alpha_i \in \mathbb{R}$, $i = 0, 1, 2$ para que dicha fórmula sea de tipo interpolatorio en $\bb{P}_2$.
        
        \begin{enumerate}
            \item \ul{Integración de los polinomios fundamentales de Lagrange:}
            \begin{align*}
                \alpha_0 &= \int_{-1}^{1} \ell_0(x) dx = \int_{-1}^{1} \frac{(x - 0)(x - 1)}{(-1 - 0)(-1 - 1)} dx = \int_{-1}^{1} \frac{x^2 - x}{2} dx = \dfrac{1}{2} \left[ \frac{x^3}{3} - \frac{x^2}{2} \right]_{-1}^{1} =\\&= \dfrac{1}{2} \left( \frac{1}{3} - \frac{1}{2} + \frac{1}{3} + \frac{1}{2} \right) = \dfrac{1}{3},\\
                \alpha_1 &= \int_{-1}^{1} \ell_1(x) dx = \int_{-1}^{1} \frac{(x + 1)(x - 1)}{(0 + 1)(0 - 1)} dx = \int_{-1}^{1} -x^2 + 1 dx = 2\cdot \int_{0}^{1} 1-x^2 dx =\\&= 2\cdot \left[ x - \frac{x^3}{3} \right]_{0}^{1} = 2\cdot \left( 1 - \frac{1}{3} \right) = \dfrac{4}{3},\\
                \alpha_2 &= \int_{-1}^{1} \ell_2(x) dx = \int_{-1}^{1} \frac{(x + 1)(x - 0)}{(1 + 1)(1 - 0)} dx = \int_{-1}^{1} \frac{x^2 + x}{2} dx = \dfrac{1}{2} \left[ \frac{x^3}{3} + \frac{x^2}{2} \right]_{-1}^{1} =\\&= \dfrac{1}{2} \left( \frac{1}{3} + \frac{1}{2} + \frac{1}{3} - \frac{1}{2} \right) = \dfrac{1}{3}.
            \end{align*}

            \item \ul{Imponiendo exactitud en $\bb{P}_2$:}
            \begin{align*}
                2 = \int_{-1}^{1} 1 dx &= \alpha_0 + \alpha_1 + \alpha_2,\\
                0 = \int_{-1}^{1} x dx &= -\alpha_0 + \alpha_2,\\
                \nicefrac{2}{3} = \int_{-1}^{1} x^2 dx &= \alpha_0 + \alpha_2
            \end{align*}

            Sustituyendo la tercera ecuación en la primera:
            \begin{align*}
                2 &= \alpha_1 + \frac{2}{3}\Longrightarrow \alpha_1 = 2 - \frac{2}{3} = \frac{4}{3}
            \end{align*}

            Sumando la segunda y la tercera, obtenemos:
            \begin{equation*}
                \alpha_2 = \frac{1}{3} = \alpha_0.
            \end{equation*}


            \item \ul{Integrando el polinomio de interpolación de Newton:}
            
            La tabla de diferencias divididas asociada a los nodos $-1$, $0$ y $1$ es:
            \begin{equation*}
                \begin{array}{c|cccc}
                    x_i & f[x_i] \\
                    \\
                    -1 & \mathbf{f(-1)} \\
                    && \mathbf{f(0)-f(-1)} \\
                    0 & f(0) & & \mathbf{\nicefrac{1}{2}(f(1)-2f(0)+f(-1))}\\
                    && f(1)-f(0)\\
                    1 & f(1)
                \end{array}
            \end{equation*}
            Por tanto, el polinomio de interpolación es:
            \begin{align*}
                p(x) &= f(-1) + \left(f(0)-f(-1)\right)(x+1) + \frac{1}{2}\left(f(1)-2f(0)+f(-1)\right)x(x+1)
                =\\&= f(-1)\left(1-1-x+\dfrac{x(x+1)}{2}\right) + f(0)\left(1+x-x(x+1)\right) + f(1)\left(\dfrac{x(x+1)}{2}\right)\\
                &= f(-1)\left(\dfrac{x(x-1)}{2}\right) + f(0)\left(1-x^2\right) + f(1)\left(\dfrac{x(x+1)}{2}\right).
            \end{align*}

            Empleando las integrales de los polinomios fundamentales de Lagrange ya vistos, tenemos:
            \begin{align*}
                \int_{-1}^{1} p(x) dx &= f(-1)\int_{-1}^{1} \dfrac{x(x-1)}{2} dx + f(0)\int_{-1}^{1} (1-x^2) dx + f(1)\int_{-1}^{1} \dfrac{x(x+1)}{2} dx =\\
                &= \dfrac{1}{3}\cdot f(-1) + \dfrac{4}{3}\cdot f(0) + \dfrac{1}{3}\cdot f(1).
            \end{align*}
        \end{enumerate}

        En cualquiera de los casos, obtenemos que:
        \begin{equation*}
            \alpha_0 = \alpha_2 = \frac{1}{3},\quad \alpha_1 = \frac{4}{3}.
        \end{equation*}

        La fórmula de integración numérica obtenida es:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx \frac{1}{3} f(-1) + \frac{4}{3} f(0) + \frac{1}{3} f(1).
        \end{equation*}
        \item Halle el grado de exactitud de la fórmula obtenida en el apartado anterior.
        
        Por construcción, sabemos que la fórmula es exacta en $\bb{P}_2$. Veamos si es exacta en $x^3$ y $x^4$:
        \begin{align*}
            \int_{-1}^{1} x^3 dx &= 0= -\frac{1}{3}+\frac{1}{3}\\
            \int_{-1}^{1} x^4 dx &= \frac{2}{5} \neq \frac{1}{3} + \frac{1}{3} = \frac{2}{3}.
        \end{align*}

        Por tanto, la fórmula es exacta en $\bb{P}_3$ y no es exacta en $\bb{P}_4$, por lo que su grado de exactitud es 3.
        \item Proporcione una fórmula de la forma propuesta que no sea de tipo interpolatorio en $\bb{P}_2$. Justifique la respuesta.
        
        Para ello, basta encontrar valores de $\alpha_0$, $\alpha_1$ y $\alpha_2$ de forma que la fórmula no sea exacta en $\bb{P}_2$. Suponiendo por ejemplo $\alpha_0 = \alpha_1 = \alpha_2 = 1$, tenemos:
        \begin{align*}
            \int_{-1}^{1} f(x) dx &\approx f(-1) + f(0) + f(1),\\
            \int_{-1}^{1} x^2 dx &= \frac{2}{3} \neq 1 + 1 + 1 = 3.
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.10}
    Para evaluar el funcional lineal $\displaystyle L(f) = f(\nicefrac{1}{2}) + \int_{0}^{1} f(x) dx$ con $f \in C^1[0, 1]$ se propone la siguiente fórmula de aproximación lineal:
    \begin{equation*}
        L(f) \approx \frac{1}{8} (13f(0) + 5f'(0) + 3f(1)).
    \end{equation*}
    \begin{enumerate}
        \item ¿La fórmula es exacta para $f(x) = x^3$? ¿Por qué? ¿Cuál es el grado de exactitud de la fórmula? ¿Por qué?
        
        \begin{align*}
            L(x^3) &= \frac{1}{2^3} + \dfrac{1}{4} = \frac{1}{8} + \frac{1}{4} = \frac{3}{8} = \frac{1}{8} (13\cdot 0 + 5\cdot 0 + 3\cdot 1).
        \end{align*}

        Por tanto, la fórmula es exacta para $f(x) = x^3$. Para ver el grado de exactitud, veamos en primer lugar si es exacta en $\{1,x,x^2\}$:
        \begin{align*}
            L(1) &= 1 + 1 = 2 = \frac{1}{8} (13\cdot 1 + 5\cdot 0 + 3\cdot 1) = \frac{16}{8},\\
            L(x) &= \frac{1}{2} + \frac{1}{2} = 1 = \frac{1}{8} (13\cdot 0 + 5\cdot 1 + 3\cdot 1) = \frac{8}{8},\\
            L(x^2) &= \frac{1}{2^2} + \dfrac{1}{3} = \frac{1}{4} + \frac{1}{3} = \frac{7}{12} \neq \frac{1}{8} (13\cdot 0 + 5\cdot 0 + 3\cdot 1) = \frac{3}{8}
        \end{align*}

        Como es exacta en $\{1,x\}$ pero no lo es en $\{1,x,x^2\}$, el grado de exactitud de la fórmula es 1.
        \item ¿La fórmula es de tipo interpolatorio en $\bb{P}_2$? ¿Por qué? Si no lo es, deduzca los coeficientes de la fórmula para que sí lo sea.\\
        
        No, no lo es porque no es exacta en $x^2$. Para que sea de tipo interpolatorio en $\bb{P}_2$, debe ser exacta en $\{1,x,x^2\}$, por lo que debemos imponer:
        \begin{align*}
            L(1) &= 2 = \alpha_0 + \alpha_2\\
            L(x) &= 1 = \alpha_1 + \alpha_2\\
            L(x^2) &= \frac{7}{12} = \alpha_2
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{align*}
            \alpha_2 &= \nicefrac{7}{12},\\
            \alpha_1 &= 1 - \nicefrac{7}{12} = \nicefrac{5}{12},\\
            \alpha_0 &= 2 - \nicefrac{7}{12} = \nicefrac{17}{12}.
        \end{align*}

        Por tanto, la fórmula de tipo interpolatorio en $\bb{P}_2$ es:
        \begin{equation*}
            L(f) \approx \dfrac{1}{12}\left(17f(0) + 5f'(0) + 7f(1)\right).
        \end{equation*}
        
        \item Deduzca el error de la fórmula obtenida en el apartado anterior suponiendo $f \in C^3[0, 1]$.
        
        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[0,0,1,x]\Pi(x)\qquad \text{con } \Pi(x) = \prod_{i=0}^{2} (x - x_i) = (x - 0)(x - 0)(x - 1) = x^2(x - 1).
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= L(E) = f[0,0,1,\nicefrac{1}{2}]\cdot \dfrac{1}{2^2}\left(\frac{1}{2}-1\right) + \int_{0}^{1} f[0,0,1,x]\cdot x^2(x - 1) dx
        \end{align*}

        Puesto que $x^2(x - 1)$ no cambia de signo en $[0, 1]$, podemos aplicar el Teorema del Valor Medio Generalizado para integrales para deducir que $\exists \zeta \in [0, 1]$ tal que:
        \begin{align*}
            R(f) &= -\dfrac{f[0,0,1,\nicefrac{1}{2}]}{8} + f[0,0,1,\zeta]\cdot \int_{0}^{1} x^2(x - 1) dx
            =\\&= -\dfrac{f[0,0,1,\nicefrac{1}{2}]}{8} + f[0,0,1,\zeta]\cdot \left( \dfrac{1}{4} - \dfrac{1}{3} \right)
            =\\&= -\dfrac{f[0,0,1,\nicefrac{1}{2}]}{8} - \dfrac{f[0,0,1,\zeta]}{12}.
        \end{align*}

        Por las propiedades de las diferencias divididas, $\exists \xi_1, \xi_2 \in [0, 1]$ tales que:
        \begin{align*}
            R(f) &= -\dfrac{1}{8}\cdot \dfrac{f'''(\xi_1)}{3!} - \dfrac{1}{12}\cdot \dfrac{f'''(\xi_2)}{3!}
            = -\dfrac{f'''(\xi_1)}{48} - \dfrac{f'''(\xi_2)}{72}
            = -\dfrac{1}{144}\left(3f'''(\xi_1) + 2f'''(\xi_2)\right).
        \end{align*}

        Por tanto, tenemos que $\exists \xi\in [0, 1]$ tal que:
        \begin{equation*}
            R(f) = -\dfrac{5}{144}\cdot f'''(\xi).
        \end{equation*}
        \item ¿Qué fórmula se obtiene si deseamos que sea de tipo interpolatorio en el espacio $V = \langle 1, \sen(\pi x), \cos(\pi x)\rangle$?
        
        Imponemos que la fórmula sea exacta en $\{1, \sen(\pi x), \cos(\pi x)\}$:
        \begin{align*}
            L(1) &= 2 = \alpha_0 + \alpha_2,\\
            L(\sen(\pi x)) &= 1 + \frac{2}{\pi} = \pi\alpha_1\\
            L(\cos(\pi x)) &= 0 = \alpha_0 - \alpha_2.
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{align*}
            \alpha_0 &= 1,\\
            \alpha_1 &= \frac{\pi + 2}{\pi^{2}},\\
            \alpha_2 &= 1.
        \end{align*}

        Por tanto, la fórmula de tipo interpolatorio en $V$ es:
        \begin{equation*}
            L(f) \approx f(0) + \frac{\pi + 2}{\pi^{2}} f'\left(0\right) + f(1).
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.11}~
    \begin{enumerate}
        \item Use el método interpolatorio para obtener la fórmula del rectángulo izquierda y deduzca la expresión del error de esta fórmula cuando $f \in C^1[a, b]$. ¿Cuál es el grado de exactitud de dicha fórmula? Justifique la respuesta.
        
        En este caso, el polinomio de interpolación de $f$ en el nodo $a$ es:
        \begin{equation*}
            p(x) = f(a)
        \end{equation*}

        Por tanto, la fórmula del rectángulo izquierda es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx \approx \int_{a}^{b} p(x) dx = \int_{a}^{b} f(a) dx = f(a)(b - a).
        \end{equation*}

        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[a,x]\Pi(x)\qquad \text{con } \Pi(x) = x - a.
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= \int_{a}^{b} E(x) dx = \int_{a}^{b} f[a,x](x - a) dx
        \end{align*}

        Puesto que $x - a$ no cambia de signo en $[a, b]$, podemos aplicar el Teorema del Valor Medio Generalizado para integrales para deducir que $\exists \xi_1 \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= f[a,\xi_1]\cdot \int_{a}^{b} (x - a) dx
            = f[a,\xi_1]\cdot \left[ \frac{x^2}{2} - ax \right]_{a}^{b}
            = f[a,\xi_1]\cdot \left( \frac{b^2}{2} - ab - \frac{a^2}{2} + a^2 \right)
            =\\&= f[a,\xi_1]\cdot \left( \frac{b^2 + a^2 - 2ab}{2} \right)
            = f[a,\xi_1]\cdot \left( \frac{(b - a)^2}{2} \right).
        \end{align*}

        Por las propiedades de las diferencias divididas, $\exists \xi \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= f'(\xi)\cdot \frac{(b - a)^2}{2}
        \end{align*}

        Por tanto, el grado de exactitud de la fórmula es 0.
        \item Utilice el método interpolatorio para obtener la fórmula del punto medio y deduzca la expresión del error de esta fórmula cuando $f \in C^2[a, b]$.
        
        En este caso, el polinomio de interpolación de $f$ en el nodo $m=\nicefrac{a + b}{2}$ es:
        \begin{equation*}
            p(x) = f(m)
        \end{equation*}

        Por tanto, la fórmula del punto medio es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx \approx \int_{a}^{b} p(x) dx = \int_{a}^{b} f(m) dx = f(m)(b - a).
        \end{equation*}

        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[m,x]\Pi(x)\qquad \text{con } \Pi(x) = x - m.
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= \int_{a}^{b} E(x) dx = \int_{a}^{b} f[m,x](x - m) dx
        \end{align*}

        Como $x - m$ cambia de signo en $[a, b]$, no podemos aplicar el Teorema del Valor Medio Generalizado para integrales. Por las propiedades de las diferencias divididas, tenemos que:
        \begin{equation*}
            f[m,m,x] = \dfrac{f[m,x] - f[m,m]}{x - m}
            \Longrightarrow f[m,x] = f[m,m,x] (x - m) + f[m,m]
        \end{equation*}

        Por tanto, podemos aplicar el Teorema del Valor Medio Generalizado para integrales, por lo que $\exists \xi_1 \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= \int_{a}^{b} f[m,m,x] (x - m)^2 dx + f[m,m]\int_{a}^{b} (x - m) dx
            =\\&= \int_{a}^{b} f[m,m,x] (x - m)^2 dx + f'(m)\cdot 0
            =\\&= f[m,m,\xi_1] \cdot \int_{a}^{b} (x - m)^2 dx
            = f[m,m,\xi_1] \cdot \left[ \frac{(x - m)^3}{3} \right]_{a}^{b}
            =\\&= f[m,m,\xi_1] \cdot \left( \frac{(b - m)^3}{3} - \frac{(a - m)^3}{3} \right)
            = f[m,m,\xi_1] \cdot \left( \frac{(b - a)^3}{24} - \frac{(a-b)^3}{24} \right)
            =\\&= f[m,m,\xi_1] \cdot \left( \frac{(b - a)^3}{12} \right).
        \end{align*}

        Por las propiedades de las diferencias divididas, $\exists \xi \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= f''(\xi)\cdot \frac{(b - a)^3}{24}.
        \end{align*}

        Por tanto, el grado de exactitud de la fórmula es 1. Como vemos, en este caso tiene un grado de exactitud mayor que el que le corresponde por construcción.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.12}
    Obtenga la fórmula del trapecio calculando directamente sus coeficientes mediante la base de Lagrange del problema de interpolación unisolvente asociado a dicha fórmula. Halle la expresión del error de cuadratura de esta fórmula cuando $f \in C^2[a, b]$ y deduzca cuál es su grado de exactitud.\\

    La fórmula del trapecio consiste en usar como nodos los extremos del intervalo de integración, $a$ y $b$. Por tanto, calculamos ambos coeficientes integrando los polinomios fundamentales de Lagrange asociados a dichos nodos:
    \begin{align*}
        \alpha_0 &= \int_{a}^{b} \ell_0(x) dx = \int_{a}^{b} \frac{x - b}{a - b} dx = \frac{1}{a - b} \left[\dfrac{(x-b)^2}{2}\right]_{a}^{b} = \frac{1}{a - b} \left(0 - \dfrac{(a-b)^2}{2}\right) = -\frac{(a-b)}{2} = \frac{b-a}{2},\\
        \alpha_1 &= \int_{a}^{b} \ell_1(x) dx = \int_{a}^{b} \frac{x - a}{b - a} dx = \frac{1}{b - a} \left[\dfrac{(x-a)^2}{2}\right]_{a}^{b} = \frac{1}{b - a} \left(\dfrac{(b-a)^2}{2} - 0\right) = \frac{(b-a)}{2}.
    \end{align*}

    Por tanto, la fórmula del trapecio es:
    \begin{equation*}
        \int_{a}^{b} f(x) dx \approx \frac{b-a}{2} f(a) + \frac{b-a}{2} f(b) = \frac{b-a}{2} (f(a) + f(b)).
    \end{equation*}

    El error de interpolación cometido es:
    \begin{equation*}
        E(x) = f[a,b,x]\Pi(x)\qquad \text{con } \Pi(x) = (x - a)(x - b).
    \end{equation*}

    Por tanto, tenemos que:
    \begin{align*}
        R(f) &= \int_{a}^{b} E(x) dx = \int_{a}^{b} f[a,b,x](x - a)(x - b) dx
    \end{align*}
    Puesto que $(x - a)(x - b)$ no cambia de signo en $[a, b]$, podemos aplicar el Teorema del Valor Medio Generalizado para integrales para deducir que $\exists \xi_1 \in [a, b]$ tal que:
    \begin{align*}
        R(f) &= f[a,b,\xi_1]\cdot \int_{a}^{b} (x - a)(x - b) dx
        = f[a,b,\xi_1]\cdot \int_{a}^{b} \left( x^2 - (a + b)x + ab \right) dx
        =\\&= f[a,b,\xi_1]\cdot \left[ \frac{x^3}{3} - \frac{(a + b)x^2}{2} + abx \right]_{a}^{b}
        =\\&= f[a,b,\xi_1]\cdot \left( \frac{b^3 - a^3}{3} - \frac{(a + b)(b^2 - a^2)}{2} + ab(b - a) \right)
        =\\&= f[a,b,\xi_1]\cdot \left( \dfrac{2b^3-2a^3-3ab^2+3a^3-3b^3+3a^2b+6ab^2-6a^2b}{6} \right)
        =\\&= f[a,b,\xi_1]\cdot \left( \dfrac{-b^3 +3ab^2 - 3a^2b + a^3}{6} \right)
        = - f[a,b,\xi_1]\cdot \dfrac{(b - a)^3}{6}
    \end{align*}

    Por las propiedades de las diferencias divididas, $\exists \xi \in [a, b]$ tal que:
    \begin{align*}
        R(f) &= -\dfrac{f''(\xi)}{12} \cdot (b - a)^3.
    \end{align*}

    Por tanto, el grado de exactitud de la fórmula del trapecio es 1.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.13}
    Halle la fórmula de Newton-Cotes abierta con dos nodos.\\

    Lo resolveremos en el intervalo $[-1, 1]$, y luego generalizaremos el resultado al intervalo $[a, b]$, para poder así simplificar las cuentas. Sea $h=\nicefrac{2}{3}$, por lo que los nodos serán $x_0 = \nicefrac{-1}{3}$ y $x_1 = \nicefrac{1}{3}$. La fórmula de Newton-Cotes abierta con dos nodos es:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1).
    \end{equation*}
    Para calcular los coeficientes $\alpha_0$ y $\alpha_1$, imponemos que la fórmula sea exacta en $\bb{P}_1$, por lo que debe ser exacta en $1$ y $x$:
    \begin{align*}
        \int_{-1}^{1} 1 dx &= 2 = \alpha_0 + \alpha_1,\\
        \int_{-1}^{1} x dx &= 0 = -\frac{1}{3}\alpha_0 + \frac{1}{3}\alpha_1.
    \end{align*}
    Sustituyendo la primera ecuación en la segunda, tenemos:
    \begin{align*}
        0 &= -\frac{1}{3}\alpha_0 + \frac{1}{3}(2 - \alpha_0) = \frac{2}{3} - \frac{2}{3}\alpha_0
        \Longrightarrow \alpha_0 = \alpha_1 = 1.
    \end{align*}

    Por tanto, la fórmula de Newton-Cotes abierta con dos nodos en el intervalo $[-1, 1]$ es:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx f\left(-\frac{1}{3}\right) + f\left(\frac{1}{3}\right).
    \end{equation*}

    Ahora, generalicemos el resultado al intervalo $[a, b]$. Buscamos un cambio de variable que nos permita transformar el intervalo $[-1,1]$ en el intervalo $[a,b]$. Sea $x=a+(b-a)\frac{1+t}{2}$, donde $t\in[-1,1]$. Entonces, tenemos que:
    \begin{align*}
        \int_{a}^{b} f(x) dx &= \int_{-1}^{1} f\left(a+(b-a)\frac{1+t}{2}\right)\cdot \frac{b-a}{2} dt
        =\\&= \frac{b-a}{2} \int_{-1}^{1} f\left(a+(b-a)\frac{1+t}{2}\right) dt
        \approx\\&\approx \frac{b-a}{2} \left( f\left(a+(b-a)\frac{1+(\nicefrac{-1}{3})}{2}\right) + f\left(a+(b-a)\frac{1+\nicefrac{1}{3}}{2}\right) \right)
        =\\&= \frac{b-a}{2} \left( f\left(a+\frac{b-a}{3}\right) + f\left(a+2\cdot \frac{b-a}{3}\right) \right)
    \end{align*}

    Definiendo $h = \frac{b-a}{3}$, tenemos que la fórmula de Newton-Cotes abierta con dos nodos en el intervalo $[a, b]$ es:
    \begin{equation*}
        \int_{a}^{b} f(x) dx \approx \frac{b-a}{2} \left( f\left(a+h\right) + f\left(a+2h\right) \right).
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.14}
    Aproxime el valor de $\displaystyle \ln 2 = \int_{1}^{2} \frac{1}{x} dx$ usando cada una de las siguientes fórmulas, y calcule una cota del valor absoluto del error que se comete en cada una de las aproximaciones obtenidas:
    \begin{enumerate}
        \item La fórmula del punto medio,
        
        Definimos la siguiente aplicación:
        \Func{f}{[1,2]}{\bb{R}}{x}{\frac{1}{x}}

        La aproximación del valor de la integral es:
        \begin{align*}
            \ln 2 = \int_{1}^{2} f(x) dx &\approx f\left(\frac{1 + 2}{2}\right) \cdot (2 - 1) = f\left(\frac{3}{2}\right) = \frac{2}{3} = 0.666666\ldots
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= \dfrac{f''(\xi)}{24}
        \end{align*}

        Calculamos la segunda derivada de $f$:
        \begin{align*}
            f'(x) &= -\frac{1}{x^2},\\
            f''(x) &= \frac{2}{x^3}.
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| \dfrac{f''(\xi)}{24} \right| = \left| \dfrac{1}{12\xi^3} \right| \leq \dfrac{1}{12} = 0.083333\ldots
        \end{align*}


        \item La fórmula del trapecio,
        
        La aproximación del valor de la integral es:
        \begin{align*}
            \ln 2 = \int_{1}^{2} f(x) dx &\approx \frac{1}{2} (f(1) + f(2)) = \frac{1}{2} \left(\frac{1}{1} + \frac{1}{2}\right) = \frac{3}{4} = 0.75.
        \end{align*}
        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= -\dfrac{f''(\xi)}{12} \cdot (2 - 1)^2 = -\dfrac{f''(\xi)}{12}.
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left|\dfrac{f''(\xi)}{12} \right| = \left|\dfrac{1}{6\xi^2} \right| \leq \dfrac{1}{6} = 0.166666\ldots
        \end{align*}
        \item La fórmula de Simpson.
        
        La aproximación del valor de la integral es:
        \begin{align*}
            \ln 2 &= \int_{1}^{2} f(x) dx \approx \frac{1}{6} (f(1) + 4f(1.5) + f(2)) = \frac{1}{6} \left(\frac{1}{1} + 4\cdot \frac{2}{3} + \frac{1}{2}\right) =\\&= \frac{1}{6} \left(1 + \frac{8}{3} + \frac{1}{2}\right) = \frac{25}{36} = 0.694444\ldots
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= -\dfrac{f^{(iv)}(\xi)}{2880}
        \end{align*}

        Calculamos la cuarta derivada de $f$:
        \begin{align*}
            f'''(x) &= -\frac{6}{x^4},\\
            f^{(iv)}(x) &= \frac{24}{x^5}.
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| -\dfrac{f^{(iv)}(\xi)}{2880} \right| = \left| -\dfrac{1}{120\xi^5} \right| \leq \dfrac{1}{120} = 0.008333\ldots
        \end{align*}

    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.15}
    Halle la expresión del error de la fórmula del trapecio compuesta cuando $f \in C^2[a, b]$.\\

    El error cometido al aplicar la fórmula simple del trapecio en el intervalo $[a, b]$ es:
    \begin{equation*}
        R(f) = -\dfrac{(b-a)^3}{12} f''(\xi)\qquad \xi \in [a, b].
    \end{equation*}

    Si consideramos una partición uniforme del intervalo $[a, b]$ en $n$ subintervalos de longitud $h = \nicefrac{b-a}{n}$, el error cometido al aplicar la fórmula del trapecio compuesta es la suma de los errores cometidos en cada uno de los subintervalos:
    \begin{align*}
        R(f) &= \sum_{i=1}^{n} R_i(f) = \sum_{i=1}^{n} -\dfrac{h^3}{12} f''(\xi_i) = -\dfrac{h^3}{12} \sum_{i=1}^{n} f''(\xi_i)
        = -\dfrac{h^3}{12}\cdot n\cdot f''(\xi)\qquad \xi \in [a, b],
    \end{align*}
    donde $\xi$ es un punto del intervalo $[a, b]$. Puesto que $n = \frac{b-a}{h}$, podemos escribir el error de la fórmula del trapecio compuesta como:
    \begin{equation*}
        R(f) = -\dfrac{h^2(b-a)}{12} f''(\xi)\qquad \xi \in [a, b].
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.16}
    La fórmula de integración numérica de tipo interpolatorio en $\bb{P}_3$ de la forma
    \begin{equation*}
        \int_{a}^{b} f(x) dx \approx \alpha_0 f(a) + \alpha_1 f(b) + \alpha_2 f'(a) + \alpha_3 f'(b)
    \end{equation*}
    es conocida como \emph{fórmula del trapecio corregida}.
    \begin{enumerate}
        \item Halle dicha fórmula, así como la expresión de su error si $f \in C^4[a, b]$. ¿Cuál es su grado de exactitud? Razone la respuesta.
        
        Imponemos exactitud en $\{1,x,x^2,x^3\}$:
        \begin{align*}
            \int_{a}^{b} 1 dx &= b - a = \alpha_0 + \alpha_1,\\
            \int_{a}^{b} x dx &= \frac{b^2 - a^2}{2} = \alpha_0\cdot a + \alpha_1\cdot b + \alpha_2 + \alpha_3,\\
            \int_{a}^{b} x^2 dx &= \frac{b^3 - a^3}{3} = \alpha_0\cdot a^2 + \alpha_1\cdot b^2 + \alpha_2\cdot 2a + \alpha_3\cdot 2b,\\
            \int_{a}^{b} x^3 dx &= \frac{b^4 - a^4}{4} = \alpha_0\cdot a^3 + \alpha_1\cdot b^3 + \alpha_2\cdot 3a^2 + \alpha_3\cdot 3b^2.
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{align*}
            \alpha_0 &= \frac{b - a}{2},\\
            \alpha_1 &= \frac{b - a}{2},\\
            \alpha_2 &= \frac{(b - a)^2}{12},\\
            \alpha_3 &= -\frac{(b - a)^2}{12}.
        \end{align*}

        Por tanto, la fórmula del trapecio corregida es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx \approx \frac{b - a}{2}\left( f(a) + f(b) \right) + \frac{(b - a)^2}{12}\left( f'(a) - f'(b) \right).
        \end{equation*}

        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[a,a,b,b,x]\Pi(x)\qquad \text{con } \Pi(x) = (x - a)^2(x - b)^2.
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= \int_{a}^{b} E(x) dx = \int_{a}^{b} f[a,a,b,b,x](x - a)^2(x - b)^2 dx
        \end{align*}

        Puesto que $(x - a)^2(x - b)^2$ no cambia de signo en $[a, b]$, podemos aplicar el Teorema del Valor Medio Generalizado para integrales para deducir que $\exists \xi_1 \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= f[a,a,b,b,\xi_1]\cdot \int_{a}^{b} (x - a)^2(x - b)^2 dx
            = f[a,a,b,b,\xi_1]\cdot \dfrac{(b - a)^5}{30}
        \end{align*}

        Por las propiedades de las diferencias divididas, $\exists \xi \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= f^{(4)}(\xi)\cdot \dfrac{(b - a)^5}{4!\cdot 30}.
        \end{align*}
        \item Escriba la fórmula de cuadratura compuesta que se obtiene a partir de ella para una partición uniforme del intervalo de integración y halle la expresión de su error cuando $f \in C^4[a, b]$.
        
        Sea $n$ el número de subintervalos de la partición uniforme del intervalo $[a, b]$, y sea $h = \nicefrac{b-a}{n}$ la longitud de cada subintervalo. 
        Entonces, la fórmula del trapecio corregida compuesta es:
        \begin{align*}
            \int_{a}^{b} f(x) dx &\approx \sum_{i=0}^{n-1} \left( \frac{h}{2}\left( f(a + ih) + f(a + (i+1)h) \right) + \frac{h^2}{12}\left( f'(a + ih) - f'(a + (i+1)h) \right) \right)
            =\\&= \frac{h}{2}\sum_{i=0}^{n-1} (f(a + ih) + f(a + (i+1)h)) + \frac{h^2}{12}\sum_{i=0}^{n-1} (f'(a + ih) - f'(a + (i+1)h))
            =\\&= \dfrac{h}{2}\left( f(a) + f(b) + 2\sum_{i=1}^{n-1} f(a + ih) \right) + \frac{h^2}{12}\left( f'(a) - f'(b)\right)
        \end{align*}

        Respecto al error cometido, tenemos que el error de la fórmula del trapecio corregida compuesta es la suma de los errores cometidos en cada uno de los subintervalos:
        \begin{align*}
            R(f) &= \sum_{i=0}^{n-1} R_i(f) = \sum_{i=0}^{n-1} f^{(4)}(\xi_i)\cdot \dfrac{h^5}{4!\cdot 30} = \dfrac{h^5}{4!\cdot 30} \sum_{i=0}^{n-1} f^{(4)}(\xi_i)
            = \dfrac{h^5}{4!\cdot 30}\cdot n\cdot f^{(4)}(\xi)\qquad \xi \in [a, b]
        \end{align*}

        Puesto que $n = \frac{b-a}{h}$, podemos escribir el error de la fórmula del trapecio corregida compuesta como:
        \begin{equation*}
            R(f) = \dfrac{h^4(b-a)}{4!\cdot 30} f^{(4)}(\xi)\qquad \xi \in [a, b].
        \end{equation*}
        Por tanto, el grado de exactitud de la fórmula del trapecio corregida compuesta es 3, ya que es exacta en $\bb{P}_3$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.17}
    De una función $f(x)$ se conocen los valores
    \begin{center}
        \begin{tabular}{c|c|c|c|c|c}
            $x$ & $-2$ & $-1$ & $0$ & $1$ & $2$ \\
            \hline
            $f(x)$ & $2$ & $1$ & $0.5$ & $0.75$ & $1.5$
        \end{tabular}
    \end{center}
    Se pide:
    \begin{enumerate}
        \item Calcule un valor aproximado de $\int_{-2}^{2} f(x) dx$ usando las siguientes fórmulas.
        \begin{enumerate}
            \item Fórmula del punto medio compuesta,
            
            En este caso, los nodos de interpolación que vamos a considerar son los puntos medios de los intervalos, por lo que hemos de considerar los intervalos $[-2, 0]$, $[0, 2]$. La aproximación dada es:
            \begin{align*}
                \int_{-2}^{2} f(x) dx &\approx 2\cdot \left(f(-1) + f(1)\right) = 3.5
            \end{align*}
            \item Fórmula del trapecio compuesta,
            
            En este caso, los nodos de interpolación que vamos a considerar son los extremos de los intervalos, por lo que hemos de considerar los intervalos $[-2, -1]$, $[-1, 0]$, $[0, 1]$, $[1, 2]$. La aproximación dada es:
            \begin{align*}
                \int_{-2}^{2} f(x) dx &\approx \dfrac{1}{2}\left(f(-2) + f(2)\right) + \left(f(-1) + f(0) + f(1)\right) = 4
            \end{align*}
            \item Fórmula de Simpson compuesta.
            
            En este caso, los nodos de interpolación que vamos a considerar son los extremos de los intervalos y los puntos medios de los mismos, por lo que hemos de considerar los intervalos $[-2, 0]$, $[0, 2]$. La aproximación dada es:
            \begin{align*}
                \int_{-2}^{2} f(x) dx &\approx \dfrac{2}{6}\left(f(-2) + 4f(-1) + f(0)\right) + \dfrac{2}{6}\left(f(0) + 4f(1) + f(2)\right) = 3.833333\ldots
            \end{align*}
        \end{enumerate}
        \item Interprete geométricamente cada una de las fórmulas anteriores para aproximar $\int_{-2}^{2} f(x) dx$ y haga un dibujo que ilustre la respuesta.
        
        En el primer caso, en la fórmula del punto medio compuesta, se considera el área de los rectángulos formados por los puntos medios de los intervalos. En el segundo caso, en la fórmula del trapecio compuesta, se considera el área de la poligonal formada por los puntos de la función, uniendo los extremos de los intervalos. En el tercer caso, en la fórmula de Simpson compuesta, se considera el área bajo la parábola que pasa por los tres puntos que se consideran en cada intervalo. Las representaciones gráficas de cada una de estas aproximaciones se muestran en la Figura \ref{fig:ej2.1.17}.
        \begin{figure}
            \centering
            \begin{subfigure}[b]{0.3\textwidth}
                \centering
                \begin{tikzpicture}[scale=0.6]
                    \begin{axis}[
                        axis lines = middle,
                        xlabel = $x$,
                        ylabel = $f(x)$,
                        xtick = {-2, -1, 0, 1, 2},
                        ytick = {0, 0.5, 1, 1.5, 2},
                        xmin = -2.5, xmax = 2.5,
                        ymin = -0.5, ymax = 2.5,
                        grid = both,
                        legend pos = north west
                    ]
                    \addplot[mark=*, only marks] coordinates {(-2,2) (-1,1) (0,0.5) (1,0.75) (2,1.5)};

                    % Fórmula del punto medio compuesta
                    \addplot[domain=-2:0, samples=2, fill=blue!20, opacity=0.5] {1} \closedcycle;
                    \addplot[domain=0:2, samples=2, fill=blue!20, opacity=0.5] {0.75} \closedcycle;
                    \end{axis}
                \end{tikzpicture}
                \caption{Pto. medio compuesta}
                \label{fig:ej2.1.17a}                
            \end{subfigure}
            \begin{subfigure}[b]{0.3\textwidth}
                \centering
                \begin{tikzpicture}[scale=0.6]
                    \begin{axis}[
                        axis lines = middle,
                        xlabel = $x$,
                        ylabel = $f(x)$,
                        xtick = {-2, -1, 0, 1, 2},
                        ytick = {0, 0.5, 1, 1.5, 2},
                        xmin = -2.5, xmax = 2.5,
                        ymin = -0.5, ymax = 2.5,
                        grid = both,
                        legend pos = north west
                    ]
                    \addplot[mark=*, only marks] coordinates {(-2,2) (-1,1) (0,0.5) (1,0.75) (2,1.5)};

                    % Fórmula del trapecio compuesta
                    \addplot[fill=red!20, draw=red, opacity=0.5] coordinates {
                        (-2,0) (-2,2) (-1,1) (0,0.5) (1,0.75) (2,1.5) (2,0)
                    } -- cycle;
                    \end{axis}
                \end{tikzpicture}
                \caption{Trapecio compuesta}
                \label{fig:ej2.1.17b}
            \end{subfigure}
            \begin{subfigure}[b]{0.3\textwidth}
                \centering
                \begin{tikzpicture}[scale=0.6]
                    \begin{axis}[
                        axis lines = middle,
                        xlabel = $x$,
                        ylabel = $f(x)$,
                        xtick = {-2, -1, 0, 1, 2},
                        ytick = {0, 0.5, 1, 1.5, 2},
                        xmin = -2.5, xmax = 2.5,
                        ymin = -0.5, ymax = 2.5,
                        grid = both,
                        legend pos = north west
                    ]
                    \addplot[mark=*, only marks] coordinates {(-2,2) (-1,1) (0,0.5) (1,0.75) (2,1.5)};

                    % Fórmula de Simpson compuesta
                    \addplot[domain=-2:0, samples=100, fill=green!20, opacity=0.5] {0.25*x^2 - 0.25*x + 0.5} \closedcycle;
                    \addplot[domain=0:2, samples=100, fill=green!20, opacity=0.5] {0.25*x^2 + 0.5} \closedcycle;
                    \end{axis}
                \end{tikzpicture}
                \caption{Simpson compuesta}
                \label{fig:ej2.1.17c}
            \end{subfigure}
            \caption{Aproximaciones de $\int_{-2}^{2} f(x) dx$}
            \label{fig:ej2.1.17}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.18}
    Calcule valores aproximados para $\ln 2 = \int_{1}^{2} \nicefrac{1}{x}\ dx$ usando las siguientes fórmulas y calcule una cota del valor absoluto del error que se comete en cada una de las aproximaciones obtenidas. Compare además los resultados obtenidos con los del problema \ref{ej:2.1.14}.
    \begin{enumerate}
        \item La fórmula del punto medio compuesta con 4 subintervalos,
        
        Los 4 subintervalos de la partición uniforme del intervalo $[1, 2]$ son $[1, 1.25]$, $[1.25, 1.5]$, $[1.5, 1.75]$, $[1.75, 2]$. La aproximación dada es:
        \begin{align*}
            \ln 2 = \int_{1}^{2} \frac{1}{x} dx &\approx 0.25\cdot \left(\frac{1}{1.125} + \frac{1}{1.375} + \frac{1}{1.625} + \frac{1}{1.875}\right) = 0.6912198\ldots
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= \dfrac{f''(\xi)}{24} \cdot \dfrac{1}{4^2}
        \end{align*}

        Calculamos la segunda derivada de $f$:
        \begin{align*}
            f'(x) = -\frac{1}{x^2},\qquad
            f''(x) = \frac{2}{x^3}.
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| \dfrac{f''(\xi)}{24} \cdot \dfrac{1}{16} \right| = \left| \dfrac{1}{12\xi^3} \cdot \dfrac{1}{16} \right| \leq \dfrac{1}{192} = 0.0052083\ldots
        \end{align*}
        \item La fórmula del trapecio compuesta con 4 subintervalos,
        
        Los 4 subintervalos de la partición uniforme del intervalo $[1, 2]$ son $[1, 1.25]$, $[1.25, 1.5]$, $[1.5, 1.75]$, $[1.75, 2]$. La aproximación dada es:
        \begin{align*}
            \ln 2 = \int_{1}^{2} \frac{1}{x} dx &\approx \dfrac{0.25}{2}\cdot \left(\frac{1}{1} + \frac{1}{2}\right) + 0.25\cdot \left(\frac{1}{1.25} + \frac{1}{1.5} + \frac{1}{1.75}\right) = 0.6970238\ldots
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= -\dfrac{f''(\xi)}{12} \cdot \left(\dfrac{1}{4}\right)^2
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| -\dfrac{f''(\xi)}{12} \cdot \dfrac{1}{16} \right| = \left| -\dfrac{1}{6\xi^2} \cdot \dfrac{1}{16} \right| \leq \dfrac{1}{96} = 0.0104166\ldots
        \end{align*}
        \item La fórmula de Simpson compuesta con 2 subintervalos.
        
        Los 2 subintervalos de la partición uniforme del intervalo $[1, 2]$ son $[1, 1.5]$, $[1.5, 2]$. La aproximación dada es:
        \begin{align*}
            \ln 2 = \int_{1}^{2} \frac{1}{x} dx &\approx \dfrac{0.5}{6}\cdot \left(\frac{1}{1} + 4\cdot \frac{1}{1.25} + 2\cdot \frac{1}{1.5} + 4\cdot \frac{1}{1.75} + \frac{1}{2}\right) = 0.693253968\ldots
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi \in [1, 2]$ tal que:
        \begin{align*}
            R(f) &= -\dfrac{f^{(iv)}(\xi)}{2880} \cdot \left(\dfrac{1}{2}\right)^4
        \end{align*}
        Calculamos la cuarta derivada de $f$:
        \begin{align*}
            f'''(x) &= -\frac{6}{x^4},\\
            f^{(iv)}(x) &= \frac{24}{x^5}.
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| -\dfrac{f^{(iv)}(\xi)}{2880} \cdot \dfrac{1}{16} \right| = \left| -\dfrac{1}{120\xi^5} \cdot \dfrac{1}{16} \right| \leq \dfrac{1}{1920} = 0.000520833\ldots
        \end{align*}
    \end{enumerate}    
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.19}
    Se quiere calcular $\int_{0}^{1} e^{-x^2} dx$ usando la fórmula del punto medio compuesta. ¿Cuántos subintervalos deberá tener la partición uniforme a considerar para que el valor absoluto del error que se cometa al aproximar dicha integral sea menor que $5\cdot 10^{-7}$?\\

    Definimos la siguiente función:
    \Func{f}{[0, 1]}{\bb{R}}{x}{e^{-x^2}}.

    El error cometido al aplicar la fórmula del punto medio compuesta en el intervalo $[0, 1]$ es:  
    \begin{equation*}
        R(f) = \dfrac{f''(\xi)}{24} \cdot h^2
        = \dfrac{f''(\xi)}{24} \cdot \left(\dfrac{1}{n}\right)^2
        \qquad \xi \in [0, 1],
    \end{equation*}
    donde $h = \nicefrac{1}{n}$ es la longitud de cada subintervalo de la partición uniforme del intervalo $[0, 1]$, y $n$ es el número de subintervalos de dicha partición.

    Calculamos la segunda derivada de $f$:
    \begin{align*}
        f'(x) &= -2xe^{-x^2},\\
        f''(x) &= -2e^{-x^2} + 4x^2e^{-x^2} = e^{-x^2}(4x^2 - 2).
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        |R(f)| &= \left| \dfrac{f''(\xi)}{24} \cdot \left(\dfrac{1}{n}\right)^2 \right| = \left| \dfrac{e^{-\xi^2}(4\xi^2 - 2)}{24} \cdot \left(\dfrac{1}{n}\right)^2 \right|\leq \dfrac{2}{24} \cdot \dfrac{1}{n^2} = \dfrac{1}{12n^2}\leq 5\cdot 10^{-7}\iff \\&\iff
        n^2 \geq \dfrac{1}{12\cdot 5\cdot 10^{-7}} = \dfrac{5\cdot 10^5}{3}
        \iff n \geq \sqrt{\dfrac{5\cdot 10^5}{3}} \approx 408.248.
    \end{align*}

    Por tanto, el número de subintervalos de la partición uniforme del intervalo $[0, 1]$ deberá ser al menos $n = 409$ para que el valor absoluto del error cometido al aproximar la integral sea menor que $5\cdot 10^{-7}$.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.20}
    Se quiere hallar un valor aproximado de $\int_{1}^{2} \ln^2(x) dx$.
    \begin{enumerate}
        \item ¿Cuántos subintervalos deberá tener la partición uniforme para que el valor absoluto del error que se cometa al aproximar dicha integral usando la fórmula del trapecio compuesta sea menor que $10^{-3}$?
        
        Definimos la siguiente función:
        \Func{f}{[1, 2]}{\bb{R}}{x}{\ln^2(x)}

        Calculamos las derivadas de $f$:
        \begin{align*}
            f'(x) &= 2\ln(x)\cdot \frac{1}{x} = \frac{2\ln(x)}{x},\\
            f''(x) &= \frac{2-2\ln(x)}{x^2} = \frac{2(1 - \ln(x))}{x^2},\\
            f^{iii)}(x) &= \dfrac{-2\cdot \nicefrac{1}{x}\cdot x^2 - 4x(1 - \ln(x))}{x^4} = \dfrac{-2 - 4(1 - \ln(x))}{x^3}
            = \dfrac{4\ln(x) - 6}{x^3},\\
            f^{(iv)}(x) &= \dfrac{4\cdot \nicefrac{1}{x}\cdot x^3 - 3x^2(4\ln(x) - 6)}{x^6} = \dfrac{4 - 3(4\ln(x) - 6)}{x^4}
            = \dfrac{-12\ln(x) + 22}{x^4}.
        \end{align*}

        El error cometido al aplicar la fórmula del trapecio compuesta en el intervalo $[1, 2]$ es:
        \begin{equation*}
            R(f) = -\dfrac{f''(\xi)}{12} \cdot h^2
            = -\dfrac{f''(\xi)}{12} \cdot \left(\dfrac{1}{n}\right)^2
        \end{equation*}
        donde $h = \nicefrac{1}{n}$ es la longitud de cada subintervalo de la partición uniforme del intervalo $[1, 2]$, y $n$ es el número de subintervalos de dicha partición.
        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| -\dfrac{f''(\xi)}{12n^2} \right| = \left| -\dfrac{2(1 - \ln(\xi))}{12\xi^2n^2} \right| \leq \dfrac{2}{12n^2} = \dfrac{1}{6n^2}\leq 10^{-3}\iff \\&\iff n^2 \geq \dfrac{1}{6\cdot 10^{-3}} = \dfrac{1000}{6} \iff n \geq \sqrt{\dfrac{1000}{6}} \approx 12.9099
        \end{align*}

        Por tanto, el número de subintervalos de la partición uniforme del intervalo $[1, 2]$ deberá ser al menos $n = 13$ para que el valor absoluto del error cometido al aproximar la integral sea menor que $10^{-3}$.

        \item ¿Cuántos subintervalos deberá tener la partición uniforme para que el valor absoluto del error que se cometa al aproximar dicha integral utilizando la fórmula de Simpson compuesta sea menor que $10^{-3}$?
        
        El error cometido al aplicar la fórmula de Simpson compuesta en el intervalo $[1, 2]$ es:
        \begin{equation*}
            R(f) = -\dfrac{f^{(iv)}(\xi)}{2880} \cdot h^4
            = -\dfrac{f^{(iv)}(\xi)}{2880n^4}
            = -\dfrac{-12\ln(\xi) + 22}{2880\xi^4n^4}
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            |R(f)| &= \left| -\dfrac{-12\ln(\xi) + 22}{2880\xi^4n^4} \right| \leq \dfrac{22}{2880n^4}\leq 10^{-3}\iff \\&\iff n^4 \geq \dfrac{22}{2880\cdot 10^{-3}} = \dfrac{22000}{2880} \iff n \geq \sqrt[4]{\dfrac{22000}{2880}} \approx 1.662484
        \end{align*}

        Por tanto, el número de subintervalos de la partición uniforme del intervalo $[1, 2]$ deberá ser al menos $n = 2$ para que el valor absoluto del error cometido al aproximar la integral sea menor que $10^{-3}$.
        \item ¿Cuál de las fórmulas compuestas de los apartados anteriores será preferible utilizar para aproximar la integral dada? Justifique la respuesta.
        
        En el primer caso, se necesitan al menos $n = 13$ subintervalos para que el error sea menor que $10^{-3}$, que son por tanto $14$ evaluaciones de la función $f$. En el segundo caso, se necesitan al menos $n = 2$ subintervalos para que el error sea menor que $10^{-3}$, que son por tanto $5$ evaluaciones de la función $f$. Por tanto, es preferible utilizar la fórmula de Simpson compuesta, ya que requiere menos evaluaciones de la función para alcanzar el mismo grado de precisión.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.21}
    Se consideran las fórmulas simples del rectángulo, del punto medio, del trapecio y de Simpson. ¿Alguna de ellas es una fórmula de cuadratura gaussiana? Justifique la respuesta.\\

    Una fórmula con $n+1$ nodos distintos es de tipo gaussiano si su grado de exactitud es $2n+1$. Expresamos la siguiente tabla, en la que queda reflejado este hecho:
    \begin{center}
        \begin{tabular}{c|c|c|c|c}
            & Rectángulo & Punto medio & Trapecio & Simpson \\
            \hline
            Nodos ($n+1$) & 1 & 1 & 2 & 3 \\
            Grado por construcción ($n$) & 0 & 0 & 1 & 2 \\
            Grado real & 0 & 1 & 1 & 3 \\
            Grado máximo $(2n+1)$ & 1 & 1 & 3 & 5 \\
            ¿Es gaussiana? & No & Sí & No & No
        \end{tabular}
    \end{center}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.22}~
    \begin{enumerate}
        \item La fórmula numérica $f''(a) \approx \frac{3f(-2h) - 5f(0) + 2f(3h)}{15h^2}$:
        \begin{enumerate}
            \item ¿Es de tipo interpolatorio clásico?
            
            Para ello, ha de ser exacta en $\bb{P}_2$, es decir, ha de ser exacta en $\{1,x,x^2\}$.
            \begin{itemize}
                \item Para $f(x) = 1$:
                \begin{align*}
                    f''(a) = 0 = \dfrac{3-5+2}{15h^2} = \dfrac{0}{15h^2} = 0.
                \end{align*}

                \item Para $f(x) = x$:
                \begin{align*}
                    f''(a) = 0 = \dfrac{3(-2h) - 5(0) + 2(3h)}{15h^2} = \dfrac{0}{15h^2} = 0.
                \end{align*}

                \item Para $f(x) = x^2$:
                \begin{align*}
                    f''(a) = 2 = \dfrac{3(-2h)^2 - 5(0) + 2(3h)^2}{15h^2} = \dfrac{12h^2 + 18h^2}{15h^2} = \dfrac{30h^2}{15h^2} = 2.
                \end{align*}
            \end{itemize}

            Por tanto, la fórmula es exacta en $\bb{P}_2$, y por tanto es de tipo interpolatorio clásico.
            \item ¿Cuál es su grado de exactitud?
            
            Veamos ahora si es exacta en $\bb{P}_3$, es decir, si es exacta en $\{1,x,x^2,x^3\}$. Para $f(x) = x^3$ tenemos:
            \begin{align*}
                f''(a) = 6a = \dfrac{3(-2h)^3 - 5(0) + 2(3h)^3}{15h^2} = \dfrac{-24h^3 + 54h^3}{15h^2} = \dfrac{30h^3}{15h^2} = 2h
            \end{align*}

            Por tanto, la fórmula no es exacta en $\bb{P}_3$ si y solo si $a=\nicefrac{h}{3}$. Veamos si es exacta en $x^4$:
            \begin{align*}
                f''(a) = 12a^2 = \dfrac{3(-2h)^4 - 5(0) + 2(3h)^4}{15h^2} = \dfrac{48h^4 + 162h^4}{15h^2} = \dfrac{210h^4}{15h^2} = 14h^2
            \end{align*}
            Como la condición $12a^2=14h^2$ es incompatible con $a=\nicefrac{h}{3}$, la fórmula no es exacta en $\bb{P}_4$.
        \end{enumerate}
        \item ¿Existe alguna fórmula de derivación numérica, basada en $n + 1$ nodos distintos, de la forma $f''(a) \approx \alpha_0 f(x_0) + \alpha_1 f(x_1) + \cdots + \alpha_n f(x_n)$ que sea de tipo interpolatorio en $\bb{P}_n$ y tenga grado de exactitud $n + 3$? Justifique la respuesta.
        
        No, hemos visto que no puede ser exacta en $n+1+2$.
        \item Justifique que la fórmula de integración numérica $$\int_{0}^{2} f(x) dx = \frac{2}{3} (3f(0) + 3f'(0) + 2f''(0)) + R(f)$$ es de tipo interpolatorio en $\bb{P}_2$ y para $f \in C^3[0, 2]$ su error se puede escribir como $R(f) = \frac{2}{3} f'''(\xi)$ con $\xi \in \left]0,2\right[$.
        
        Para que la fórmula sea de tipo interpolatorio en $\bb{P}_2$, ha de ser exacta en $\{1,x,x^2\}$.
        \begin{itemize}
            \item Para $f(x) = 1$:
            \begin{align*}
                \int_{0}^{2} 1 dx = 2 = \dfrac{2}{3}\cdot 3
            \end{align*}
            \item Para $f(x) = x$:
            \begin{align*}
                \int_{0}^{2} x dx = 2 = \dfrac{2}{3}\left(0+3+0\right) = \dfrac{2}{3}\cdot 3
            \end{align*}
            \item Para $f(x) = x^2$:
            \begin{align*}
                \int_{0}^{2} x^2 dx = \dfrac{8}{3} = \dfrac{2}{3}\left(0+0+4\right) = \dfrac{2}{3}\cdot 4
            \end{align*}
        \end{itemize}
        Por tanto, la fórmula es exacta en $\bb{P}_2$, y por tanto es de tipo interpolatorio.

        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[0,0,0,x]x^3
        \end{equation*}

        Por tanto, el error de la fórmula de integración numérica es:
        \begin{align*}
            R(f) &= \int_{0}^{2} E(x) dx = \int_{0}^{2} f[0,0,0,x]x^3 dx
        \end{align*}
        Como $x^3$ no cambia de signo en $[0,2]$, podemos aplicar el Teorema del Valor Medio Integral Generalizado, que nos dice que existe un $\xi_1 \in [0, 2]$ tal que:
        \begin{align*}
            \int_{0}^{2} E(x)\ dx = f[0,0,0,\xi_1]\int_{0}^{2} x^3 dx = f[0,0,0,\xi_1]\cdot \dfrac{16}{4} = 4f[0,0,0,\xi_1].
        \end{align*}

        Por las propiedades de las diferencias divididas, sabemos que $\exists \xi\in [0, 2]$ tal que:
        \begin{equation*}
            R(f) = 4f[0,0,0,\xi_1] = 4\cdot \dfrac{f'''(\xi)}{6} = \dfrac{2}{3}f'''(\xi).
        \end{equation*}

    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.23}~
    \begin{enumerate}
        \item Calcule la fórmula de Gauss-Legendre con 2 nodos y halle la expresión de su error cuando $f \in C^4[-1, 1]$.
        
        Buscamos encontrar $x_1,x_2\in [-1, 1]$ y $\alpha_0, \alpha_1$ tales que la fórmula siguiente sea exacta en $2\cdot 1+1 = 3$:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1).
        \end{equation*}

        Para ello, definimos el siguiente polinomio:
        \begin{equation*}
            \Pi(x) = (x-x_0)(x-x_1) = x^2 - (x_0+x_1)x + x_0x_1
        \end{equation*}

        Como $\Pi(x)\in \bb{P}_2$, entonces $\exists b,c\in \bb{R}$ tales que:
        \begin{equation*}
            \Pi(x) = x^2+bx+c
        \end{equation*}

        Como buscamos que sea exacta en $1+2$, hemos de imponer exactitud en $\{\Pi(x), x\Pi(x)\}$. Tenemos que:
        \begin{align*}
            \int_{-1}^{1} \Pi(x) dx &= \int_{-1}^{1} (x^2 + bx + c) dx = 2\cdot \dfrac{1}{3} + b\cdot 0 + c\cdot 2 = \dfrac{2}{3} + 2c,\\
            \int_{-1}^{1} x\Pi(x) dx &= \int_{-1}^{1} (x^3 + bx^2 + cx) dx = 0 + b\cdot 2\cdot \dfrac{1}{3} + c\cdot 0 = \dfrac{2b}{3}.
        \end{align*}
        
        Por tanto, e imponiendo que la fórmula sea exacta en $\Pi(x)$ y $x\Pi(x)$, tenemos el siguiente sistema:
        \begin{align*}
            \dfrac{2}{3} + 2c &= 0,\\
            \dfrac{2b}{3} &= 0.
        \end{align*}

        Por tanto, tenemos que $b = 0$ y $c = \nicefrac{-1}{3}$. Por tanto:
        \begin{equation*}
            \Pi(x) = x^2 - \dfrac{1}{3}.
        \end{equation*}

        Por tanto, las raíces de $\Pi(x)$, que son los nodos de la fórmula, son:
        \begin{align*}
            x_0 &= -\sqrt{\dfrac{1}{3}} = -\frac{\sqrt{3}}{3},\\
            x_1 &= \sqrt{\dfrac{1}{3}} = \frac{\sqrt{3}}{3}.
        \end{align*}

        Por tanto, la fórmula de Gauss-Legendre con 2 nodos es:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx \alpha_0 f\left(-\frac{\sqrt{3}}{3}\right) + \alpha_1 f\left(\frac{\sqrt{3}}{3}\right).
        \end{equation*}

        Para hallar los coeficientes $\alpha_0$ y $\alpha_1$, hemos de imponer que la fórmula sea exacta en $\{1,x,x^2\}$.
        \begin{itemize}
            \item Para $f(x) = 1$:
            \begin{align*}
                \int_{-1}^{1} 1 dx &= 2 = \alpha_0 + \alpha_1.
            \end{align*}
            \item Para $f(x) = x$:
            \begin{align*}
                \int_{-1}^{1} x dx &= 0 = -\frac{\sqrt{3}}{3}\alpha_0 + \frac{\sqrt{3}}{3}\alpha_1
                = \frac{\sqrt{3}}{3}(\alpha_1 - \alpha_0).
            \end{align*}
        \end{itemize}

        Por tanto, concluimos que $\alpha_0 = \alpha_1 = 1$. Por tanto, la fórmula de Gauss-Legendre con 2 nodos es:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx f\left(-\frac{\sqrt{3}}{3}\right) + f\left(\frac{\sqrt{3}}{3}\right).
        \end{equation*}


        Respecto al error cometido, tenemos que $\exists \xi \in [-1, 1]$ tal que:
        \begin{align*}
            R(f) &= \dfrac{1}{4!}f^{(4)}(\xi) \cdot \int_{-1}^{1} \Pi^2(x) dx
        \end{align*}

        Calculamos la integral:
        \begin{align*}
            \int_{-1}^{1} \Pi^2(x) dx &= \int_{-1}^{1} \left(x^2 - \dfrac{1}{3}\right)^2 dx = \int_{-1}^{1} \left(x^4 - \dfrac{2}{3}x^2 + \dfrac{1}{9}\right) dx\\
            &= 2\left[\dfrac{x^5}{5} - \dfrac{2}{3}\cdot \dfrac{x^3}{3} + \dfrac{1}{9}x\right]_{0}^{1} = 2\left(\dfrac{1}{5} - \dfrac{2}{9} + \dfrac{1}{9}\right) = 2\left(\dfrac{1}{5} - \dfrac{1}{9}\right) = 2\cdot \dfrac{4}{45} = \dfrac{8}{45}
        \end{align*}

        Por tanto, el error de la fórmula de Gauss-Legendre con 2 nodos es:
        \begin{align*}
            R(f) &= \dfrac{1}{4!}f^{(4)}(\xi) \cdot \dfrac{8}{45} =\dfrac{f^{(4)}(\xi)}{135}.
        \end{align*}




        \item Usando la fórmula del apartado anterior, obtenga una fórmula para aproximar $\int_{a}^{b} f(x) dx$ con $[a, b]$ un intervalo cualquiera. ¿Cuál es la expresión del error de dicha fórmula cuando $f$ es suficientemente regular?
        
        Buscamos emplear el apartado anterior, por lo que buscamos un cambio de variable que transforme el intervalo $[-1,1]$ en el intervalo $[a,b]$. Sea este el cambio de variable:
        \begin{equation*}
            x = a + (b-a)\cdot \frac{t+1}{2}, \qquad t\in [-1,1].
        \end{equation*}

        De esta forma, tenemos que:
        \begin{equation*}
            \int_{a}^{b} f(x) dx = \int_{-1}^{1} f\left(a + (b-a)\cdot \frac{t+1}{2}\right) \cdot \frac{b-a}{2} dt
            = \frac{b-a}{2} \int_{-1}^{1} f\left(a + (b-a)\cdot \frac{t+1}{2}\right) dt.
        \end{equation*}

        Definimos por tanto la función:
        \Func{g}{[-1, 1]}{\bb{R}}{t}{f\left(a + (b-a)\cdot \frac{t+1}{2}\right)}

        Por tanto, la fórmula de Gauss-Legendre con 2 nodos para aproximar $\int_{a}^{b} f(x) dx$ es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx = \frac{b-a}{2}\int_{-1}^{1} g(t) dt
        \end{equation*}

        Aproximamos la integral anterior usando la fórmula de Gauss-Legendre con 2 nodos:
        \begin{align*}
            \int_{a}^{b} f(x) dx &\approx \frac{b-a}{2}\left(g\left(-\frac{\sqrt{3}}{3}\right) + g\left(\frac{\sqrt{3}}{3}\right)\right)
            =\\&= \frac{b-a}{2}\left(f\left(a + \dfrac{b-a}{2}\left(1 - \frac{\sqrt{3}}{3}\right)\right) + f\left(a + \dfrac{b-a}{2}\left(1 + \frac{\sqrt{3}}{3}\right)\right)\right).
        \end{align*}

        Respecto al error cometido, tenemos que $\exists \xi_1 \in [-1, 1]$ tal que:
        \begin{align*}
            R(f) &= \dfrac{b-a}{2}\cdot \dfrac{g^{(4)}(\xi)}{135} 
            = \dfrac{b-a}{2}\cdot \dfrac{f^{(4)}\left(a + (b-a)\cdot \frac{\xi+1}{2}\right)}{135}\cdot \left(\frac{b-a}{2}\right)^4
        \end{align*}

        Por tanto, $\exists \xi \in [a, b]$ tal que:
        \begin{align*}
            R(f) &= \dfrac{f^{(4)}(\xi)}{4320} \cdot (b-a)^5.
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.24}
    Calcule la fórmula de Gauss-Legendre con 3 nodos y halle la expresión de su error cuando $f \in C^6[-1, 1]$.\\


    Buscamos encontrar $x_0,x_1,x_2\in [-1, 1]$ y $\alpha_0, \alpha_1, \alpha_2$ tales que la fórmula siguiente sea exacta en $2\cdot 2+1 = 5$:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1) + \alpha_2 f(x_2).
    \end{equation*}

    Para ello, definimos el siguiente polinomio:
    \begin{equation*}
        \Pi(x) = (x-x_0)(x-x_1)(x-x_2)
    \end{equation*}

    Como $\Pi(x)\in \bb{P}_3$, entonces $\exists b,c,d\in \bb{R}$ tales que:
    \begin{equation*}
        \Pi(x) = x^3 + bx^2 + cx + d.
    \end{equation*}

    Como buscamos que sea exacta en $1+2$, hemos de imponer exactitud en $\{\Pi(x), x\Pi(x), x^2\Pi(x)\}$. Tenemos que:
    \begin{align*}
        0 = \int_{-1}^{1} \Pi(x) dx &= \int_{-1}^{1} (x^3 + bx^2 + cx + d) dx = 0 + b\cdot 2\cdot \dfrac{1}{3} + c\cdot 0 + 2d = \dfrac{2b}{3} + 2d,\\
        0 = \int_{-1}^{1} x\Pi(x) dx &= \int_{-1}^{1} (x^4 + bx^3 + cx^2 + dx) dx = 2\cdot \dfrac{1}{5} + 0 + 2\cdot c\cdot \dfrac{1}{3} + 0 = \dfrac{2}{5} + \dfrac{2c}{3},\\
        0 = \int_{-1}^{1} x^2\Pi(x) dx &= \int_{-1}^{1} (x^5 + bx^4 + cx^3 + dx^2) dx = 0 + 2\cdot b\cdot \dfrac{1}{5} + 0 + d\cdot 2\cdot \dfrac{1}{3} = \dfrac{2b}{5} + \dfrac{2d}{3}.
    \end{align*}

    Por tanto, e imponiendo que la fórmula sea exacta en $\Pi(x)$, $x\Pi(x)$ y $x^2\Pi(x)$, tenemos el siguiente sistema:
    \begin{align*}
        \left.
        \begin{array}{rcl}
            \nicefrac{2b}{3} + 2d &=& 0,\\
            \nicefrac{2}{5} + \nicefrac{2c}{3} &=& 0,\\
            \nicefrac{2b}{5} + \nicefrac{2d}{3} &=& 0.
        \end{array}
        \right\}
        \iff
        \left\{
        \begin{array}{rcl}
            c=\nicefrac{-3}{5},\\
            b=d=0
        \end{array}
        \right.
    \end{align*}

    Por tanto, tenemos que:
    \begin{equation*}
        \Pi(x) = x^3 - \dfrac{3}{5}x.
    \end{equation*}

    Por tanto, las raíces de $\Pi(x)$, que son los nodos de la fórmula, son:
    \begin{align*}
        x_0 &= -\sqrt{\dfrac{3}{5}} = -\frac{\sqrt{15}}{5},\\
        x_1 &= 0,\\
        x_2 &= \sqrt{\dfrac{3}{5}} = \frac{\sqrt{15}}{5}.
    \end{align*}

    Por tanto, la fórmula de Gauss-Legendre con 3 nodos es:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \alpha_0 f\left(-\frac{\sqrt{15}}{5}\right) + \alpha_1 f(0) + \alpha_2 f\left(\frac{\sqrt{15}}{5}\right).
    \end{equation*}

    Para hallar los coeficientes $\alpha_0$, $\alpha_1$ y $\alpha_2$, hemos de imponer que la fórmula sea exacta en $\{1,x,x^2,x^3\}$.
    \begin{itemize}
        \item Para $f(x) = 1$:
        \begin{align*}
            \int_{-1}^{1} 1 dx &= 2 = \alpha_0 + \alpha_1 + \alpha_2.
        \end{align*}
        \item Para $f(x) = x$:
        \begin{align*}
            \int_{-1}^{1} x dx &= 0 = -\frac{\sqrt{15}}{5}\alpha_0 + 0\cdot\alpha_1 + \frac{\sqrt{15}}{5}\alpha_2
            = \frac{\sqrt{15}}{5}(\alpha_2 - \alpha_0).
        \end{align*}
        \item Para $f(x) = x^2$:
        \begin{align*}
            \int_{-1}^{1} x^2 dx &= \dfrac{2}{3} = \dfrac{15}{25}(\alpha_0 + \alpha_2)
        \end{align*}
    \end{itemize}

    En primer lugar, vemos que $\alpha_0=\alpha_2$. Por tanto, tenemos que:
    \begin{align*}
        2 &= \alpha_0 + \alpha_1 + \alpha_0 = 2\alpha_0 + \alpha_1,\\
        \nicefrac{2}{3} &= \dfrac{15}{25}(2\alpha_0) = \dfrac{6\alpha_0}{5} \iff \alpha_0 = \dfrac{5}{9}.
    \end{align*}

    Por tanto, $\alpha_1 = 2 - 2\cdot \dfrac{5}{9} = \dfrac{8}{9}$. Por tanto, la fórmula de Gauss-Legendre con 3 nodos es:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \dfrac{5}{9} f\left(-\frac{\sqrt{15}}{5}\right) + \dfrac{8}{9} f(0) + \dfrac{5}{9} f\left(\frac{\sqrt{15}}{5}\right).
    \end{equation*}

    Respecto al error cometido, tenemos que $\exists \xi \in [-1, 1]$ tal que:
    \begin{align*}
        R(f) &= \dfrac{1}{6!}f^{(6)}(\xi) \cdot \int_{-1}^{1} \Pi^2(x) dx
    \end{align*}

    Calculamos la integral:
    \begin{align*}
        \int_{-1}^{1} \Pi^2(x) dx &= \int_{-1}^{1} \left(x^3 - \dfrac{3}{5}x\right)^2 dx = \int_{-1}^{1} \left(x^6 - \dfrac{6}{5}x^4 + \dfrac{9}{25}x^2\right) dx\\
        &= 2\left(\dfrac{1}{7} - \dfrac{6}{5}\cdot \dfrac{1}{5} + \dfrac{9}{25}\cdot \dfrac{1}{3}\right) = \dfrac{8}{175}.
    \end{align*}

    Por tanto, el error de la fórmula de Gauss-Legendre con 3 nodos es:
    \begin{align*}
        R(f) &= \dfrac{1}{6!}f^{(6)}(\xi) \cdot \dfrac{8}{175} = \dfrac{f^{(6)}(\xi)}{15750}.
    \end{align*}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.25}
    Calcule la fórmula gaussiana con dos nodos de la forma $$\int_{-1}^{1} |x|f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1)$$ y halle la expresión de su error cuando $f \in C^4[-1, 1]$.

    Buscamos encontrar $x_0,x_1\in [-1, 1]$ y $\alpha_0, \alpha_1$ tales que la fórmula siguiente sea exacta en $2\cdot 1+1 = 3$:
    \begin{equation*}
        \int_{-1}^{1} |x|f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1).
    \end{equation*}

    Para ello, definimos el siguiente polinomio:
    \begin{equation*}
        \Pi(x) = (x-x_0)(x-x_1) = x^2 - (x_0+x_1)x + x_0x_1
    \end{equation*}

    Como $\Pi(x)\in \bb{P}_2$, entonces $\exists b,c\in \bb{R}$ tales que:
    \begin{equation*}
        \Pi(x) = x^2+bx+c.
    \end{equation*}
    Como buscamos que sea exacta en $1+2$, hemos de imponer exactitud en $\{\Pi(x), x\Pi(x)\}$. Tenemos que:
    \begin{align*}
        0 = \int_{-1}^{1} |x|\Pi(x) dx &= \int_{-1}^{1} |x|(x^2 + bx + c) dx = 2\int_{0}^{1} x^3+cx\ dx = 2\left(\dfrac{1}{4} + \dfrac{c}{2}\right) = \dfrac{1}{2} + c,\\
        0 = \int_{-1}^{1} x|x|\Pi(x) dx &= \int_{-1}^{1} x|x|(x^2 + bx + c) dx = 2\int_{0}^{1} bx^3 \ dx = 2\cdot b\cdot \dfrac{1}{4} = \dfrac{b}{2}.
    \end{align*}

    Por tanto, e imponiendo que la fórmula sea exacta en $\Pi(x)$ y $x\Pi(x)$, tenemos el siguiente sistema:
    \begin{align*}
        \left.
        \begin{array}{rcl}
            \dfrac{1}{2} + c &=& 0,\\
            \dfrac{b}{2} &=& 0.
        \end{array}
        \right\}
        \iff
        \left\{
        \begin{array}{rcl}
            c=\nicefrac{-1}{2},\\
            b=0.
        \end{array}
        \right.
    \end{align*}

    Por tanto, tenemos que:
    \begin{equation*}
        \Pi(x) = x^2 - \dfrac{1}{2}.
    \end{equation*}

    Por tanto, las raíces de $\Pi(x)$, que son los nodos de la fórmula, son:
    \begin{align*}
        x_0 &= -\sqrt{\dfrac{1}{2}} = -\frac{\sqrt{2}}{2},\\
        x_1 &= \sqrt{\dfrac{1}{2}} = \frac{\sqrt{2}}{2}.
    \end{align*}

    Por tanto, la fórmula gaussiana con 2 nodos es:
    \begin{equation*}
        \int_{-1}^{1} |x|f(x) dx \approx \alpha_0 f\left(-\frac{\sqrt{2}}{2}\right) + \alpha_1 f\left(\frac{\sqrt{2}}{2}\right).
    \end{equation*}

    Para hallar los coeficientes $\alpha_0$ y $\alpha_1$, hemos de imponer que la fórmula sea exacta en $\{1,x,x^2\}$.
    \begin{itemize}
        \item Para $f(x) = 1$:
        \begin{align*}
            \int_{-1}^{1} |x| dx &= 2\int_{0}^{1} x dx = 2\cdot \dfrac{1}{2} = 1 = \alpha_0 + \alpha_1.
        \end{align*}
        \item Para $f(x) = x$:
        \begin{align*}
            \int_{-1}^{1} |x| x dx &= 0 = -\frac{\sqrt{2}}{2}\alpha_0 + \frac{\sqrt{2}}{2}\alpha_1
            = \frac{\sqrt{2}}{2}(\alpha_1 - \alpha_0).
        \end{align*}
    \end{itemize}

    Por tanto, concluimos que $\alpha_0 = \alpha_1 = \nicefrac{1}{2}$. Por tanto, la fórmula gaussiana con 2 nodos es:
    \begin{equation*}
        \int_{-1}^{1} |x|f(x) dx \approx \frac{1}{2}\left[f\left(-\frac{\sqrt{2}}{2}\right) + f\left(\frac{\sqrt{2}}{2}\right)\right].
    \end{equation*}

    Respecto al error cometido, tenemos que $\exists \xi \in [-1, 1]$ tal que:
    \begin{align*}
        R(f) &= \dfrac{1}{4!}f^{(4)}(\xi) \cdot \int_{-1}^{1} |x| \Pi^2(x) dx
    \end{align*}

    Calculamos la integral:
    \begin{align*}
        \int_{-1}^{1} |x| \Pi^2(x) dx &= \int_{-1}^{1} |x|\left(x^2 - \dfrac{1}{2}\right)^2 dx = 2\int_{0}^{1} x\left(x^2 - \dfrac{1}{2}\right)^2 dx\\
        &= 2\int_{0}^{1} \left(x^5 - x^3 + \dfrac{1}{4}x\right) dx = 2\left(\dfrac{1}{6} - \dfrac{1}{4} + \dfrac{1}{8}\right) = \dfrac{1}{12}.
    \end{align*}

    Por tanto, el error de la fórmula gaussiana con 2 nodos es:
    \begin{align*}
        R(f) &= \dfrac{1}{4!}f^{(4)}(\xi) \cdot \dfrac{1}{12} = \dfrac{f^{(4)}(\xi)}{288}.
    \end{align*}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.26}~
    \begin{enumerate}
        \item Determine los valores de $A$, $B$, $C$ de forma que la fórmula de cuadratura $\int_{0}^{3} f(x) dx \approx Af(0) + Bf(C)$ tenga el máximo grado de exactitud posible.
        
        Sabemos que será exacta en $\bb{P}_1$ por construcción, y que el grado de exactitud máximo será $2\cdot 1 + 1 = 3$. No podemos garantizar que podamos encontrar valores de $A$, $B$ y $C$ que hagan la fórmula exacta en $\bb{P}_3$, puesto que uno de los nodos ya ha sido fijado a $0$.

        Definimos el siguiente polinomio:
        \begin{equation*}
            \Pi(x) = (x-0)(x-C) = x^2 - Cx.
        \end{equation*}

        Como buscamos que sea exacta en $\bb{P}_2$, hemos de imponer exactitud en $\{\Pi(x)\}$. Tenemos que:
        \begin{align*}
            0 = \int_{0}^{3} \Pi(x) dx &= \int_{0}^{3} (x^2 - Cx) dx = \dfrac{27}{3} - C\cdot \dfrac{9}{2} = 9 - \dfrac{9C}{2}
            = 9\left(1 - \dfrac{C}{2}\right).
        \end{align*}

        Por tanto, e imponiendo que la fórmula sea exacta en $\Pi(x)$, tenemos que $C=2$. Imponemos también que la fórmula sea exacta en $\{1,x\}$ para determinar los valores de $A$ y $B$:
        \begin{itemize}
            \item Para $f(x) = 1$:
            \begin{align*}
                \int_{0}^{3} 1 dx &= 3 = A + B.
            \end{align*}
            \item Para $f(x) = x$:
            \begin{align*}
                \int_{0}^{3} x dx &= \dfrac{9}{2} = 0\cdot A + 2B = 2B \Longrightarrow B = \dfrac{9}{4}.
            \end{align*}
        \end{itemize}

        Por tanto, $A = 3 - \dfrac{9}{4} = \dfrac{3}{4}$. Por tanto, la fórmula de cuadratura es:
        \begin{equation*}
            \int_{0}^{3} f(x) dx \approx \dfrac{3}{4}f(0) + \dfrac{9}{4}f(2).
        \end{equation*}

        Veamos ahora si es exacta en $x^3$:
        \begin{align*}
            \int_{0}^{3} x^3 dx &= \dfrac{81}{4} \neq \dfrac{3}{4}\cdot 0 + \dfrac{9}{4}\cdot 8 = 18.
        \end{align*}

        Por tanto, no es exacta en $\bb{P}_3$ y la fórmula de cuadratura tiene grado de exactitud máximo $2$.

        \item Utilizando la fórmula obtenida en el apartado anterior, obtenga una fórmula para aproximar $\int_{a}^{b} f(x) dx$ con $[a, b]$ un intervalo cualquiera.
        
        De nuevo, buscamos emplear el apartado anterior, por lo que buscamos un cambio de variable que transforme el intervalo $[0,3]$ en el intervalo $[a,b]$. Sea este el cambio de variable:
        \begin{equation*}
            x = a + (b-a)\cdot \frac{t}{3}, \qquad t\in [0,3].
        \end{equation*}

        De esta forma, tenemos que:
        \begin{align*}
            \int_{a}^{b} f(x) dx &= \int_{0}^{3} f\left(a + (b-a)\cdot \frac{t}{3}\right) \cdot \frac{b-a}{3} dt\\
            &= \frac{b-a}{3}\int_{0}^{3} f\left(a + (b-a)\cdot \frac{t}{3}\right) dt.
        \end{align*}

        Definimos por tanto la función:
        \Func{g}{[0, 3]}{\bb{R}}{t}{f\left(a + (b-a)\cdot \frac{t}{3}\right)}

        Por tanto, la fórmula de cuadratura asociada a la obtenida en el apartado anterior para aproximar $\int_{a}^{b} f(x) dx$ es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx = \frac{b-a}{3}\int_{0}^{3} g(t) dt.
        \end{equation*}

        Aproximamos la integral anterior usando la fórmula de cuadratura obtenida en el apartado anterior:
        \begin{align*}
            \int_{a}^{b} f(x) dx &\approx \frac{b-a}{3}\left(\dfrac{3}{4}g(0) + \dfrac{9}{4}g(2)\right)
            = \frac{b-a}{3}\left(\dfrac{3}{4}f(a) + \dfrac{9}{4}f\left(a + \dfrac{2(b-a)}{3}\right)\right)
            =\\&= \dfrac{b-a}{4}\left(f(a) + 3f\left(\dfrac{a + 2b}{3}\right)\right).
        \end{align*}
        \item Deduzca la fórmula de cuadratura compuesta asociada a la fórmula obtenida en el apartado anterior para una partición uniforme del intervalo de integración $[a, b]$ en $N$ subintervalos.
        
        Tenemos que:
        \begin{align*}
            \int_{a}^{b} f(x) dx &= \sum_{i=0}^{N-1}\int_{x_i}^{x_{i+1}} f(x) dx
            \approx \sum_{i=0}^{N-1}\frac{h}{4}\left(f(x_i) + 3f\left(\dfrac{x_i + 2x_{i+1}}{3}\right)\right)
            =\\&= \dfrac{h}{4}\left[\sum_{i=0}^{N-1} f(x_i) + 3\sum_{i=0}^{N-1} f\left(\dfrac{x_i + 2x_{i+1}}{3}\right)\right] 
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.27}
    Halle la fórmula de cuadratura de la forma siguiente que tiene el máximo grado de exactitud posible. ¿Cuál es ese grado de exactitud máximo? ¿Se trata de una fórmula de cuadratura gaussiana? ¿Por qué?
    $$\int_{-1}^{1} f(x) dx \approx \alpha_0 f(-1) + \alpha_1 f(x_1) + \alpha_2 f(1)$$

    Sabemos que será exacta en $\bb{P}_2$ por construcción, y que el grado de exactitud máximo será $2\cdot 2 + 1 = 5$. No podemos garantizar que podamos encontrar valores de $\alpha_0$, $\alpha_1$ y $\alpha_2$ que hagan la fórmula exacta en $\bb{P}_5$, puesto que dos de los nodos ya han sido fijados a $-1$ y $1$.\\

    Definimos el siguiente polinomio:
    \begin{equation*}
        \Pi(x) = (x+1)(x-x_1)(x-1) = (x^2-1)(x-x_1) = x^3 - x_1x^2 - x + x_1.
    \end{equation*}
    
    Como buscamos que sea exacta en $\bb{P}_3$, hemos de imponer exactitud en $\{\Pi(x)\}$. Tenemos que:
    \begin{align*}
        0 = \int_{-1}^{1} \Pi(x) dx &= \int_{-1}^{1} (x^3 - x_1x^2 - x + x_1) dx = 0 - x_1\cdot 2\cdot \dfrac{1}{3} + 0 + 2x_1 = 2x_1\left(1-\frac{1}{3}\right) = \dfrac{4x_1}{3}
    \end{align*}

    Por tanto, $x_1 = 0$. Imponemos también que la fórmula sea exacta en $\{1,x,x^2\}$ para determinar los valores de $\alpha_0$, $\alpha_1$ y $\alpha_2$:
    \begin{itemize}
        \item Para $f(x) = 1$:
        \begin{align*}
            \int_{-1}^{1} 1 dx &= 2 = \alpha_0 + \alpha_1 + \alpha_2.
        \end{align*}
        \item Para $f(x) = x$:
        \begin{align*}
            \int_{-1}^{1} x dx &= 0 = -\alpha_0 + 0\cdot\alpha_1 + \alpha_2
            = -\alpha_0 + \alpha_2.
        \end{align*}
        \item Para $f(x) = x^2$:
        \begin{align*}
            \int_{-1}^{1} x^2 dx &= \dfrac{2}{3} = \alpha_0 + 0\cdot\alpha_1 + \alpha_2
            = \alpha_0 + \alpha_2.
        \end{align*}
    \end{itemize}

    Por tanto, tenemos el siguiente sistema:
    \begin{align*}
        \left.
        \begin{array}{rcl}
            \alpha_0 + \alpha_1 + \alpha_2 &=& 2,\\
            -\alpha_0 + \alpha_2 &=& 0,\\
            \alpha_0 + \alpha_2 &=& \dfrac{2}{3}.
        \end{array}
        \right\}
        \iff
        \left\{
        \begin{array}{rcl}
            \alpha_0 = \nicefrac{1}{3},\\
            \alpha_1 = \nicefrac{4}{3},\\
            \alpha_2 = \nicefrac{1}{3}.
        \end{array}
        \right.
    \end{align*}

    Por tanto, la fórmula de cuadratura es:
    \begin{equation*}
        \int_{-1}^{1} f(x) dx \approx \dfrac{1}{3}f(-1) + \dfrac{4}{3}f(0) + \dfrac{1}{3}f(1)
        = \dfrac{1}{3}\left[f(-1) + 4f(0) + f(1)\right].
    \end{equation*}

    Sabemos por tanto que dicha fórmula de cuadratura tiene grado de exactitud máximo $5$, pero veamos si efectivamente lo alcanza. Sabemos que es exacta en $\bb{P}_2$.
    \begin{itemize}
        \item Para $f(x) = x^3$:
        \begin{align*}
            \int_{-1}^{1} x^3 dx &= 0 = \dfrac{1}{3}\left[-1+1\right]
        \end{align*}
        \item Para $f(x) = x^4$:
        \begin{align*}
            \int_{-1}^{1} x^4 dx &= \dfrac{2}{5} \neq \dfrac{1}{3}\left[1+0+1\right] = \dfrac{2}{3}.
        \end{align*}
    \end{itemize}

    Por tanto, tiene grado de exactitud $3$. No es una fórmula de cuadratura gaussiana, puesto que no alcanza su grado de exactitud máximo.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.28} Las fórmulas gaussianas de Laguerre corresponden a una integral del tipo
    \begin{equation*}
        \int_{0}^{\infty} e^{-x} f(x) dx.
    \end{equation*}
    \begin{enumerate}
        \item Obtenga la fórmula de Laguerre con dos nodos.
        
        Buscamos encontrar $x_0,x_1\in [0, \infty[$ y $\alpha_0, \alpha_1$ tales que la fórmula siguiente sea exacta en $2\cdot 1+1 = 3$:
        \begin{equation*}
            \int_{0}^{\infty} e^{-x} f(x) dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1).
        \end{equation*}

        Definimos el siguiente polinomio:
        \begin{equation*}
            \Pi(x) = (x-x_0)(x-x_1) = x^2 - (x_0+x_1)x + x_0x_1.
        \end{equation*}

        Como $\Pi(x)\in \bb{P}_2$, entonces $\exists b,c\in \bb{R}$ tales que:
        \begin{equation*}
            \Pi(x) = x^2 + bx + c.
        \end{equation*}

        Como buscamos que sea exacta en $1+2$, hemos de imponer exactitud en $\{\Pi(x), x\Pi(x)\}$. Tenemos que:
        \begin{align*}
            0 = \int_{0}^{\infty} e^{-x}\Pi(x) dx &= \int_{0}^{\infty} e^{-x}(x^2 + bx + c) dx = 2 + b + c,\\
            0 = \int_{0}^{\infty} e^{-x} x\Pi(x) dx &= \int_{0}^{\infty} e^{-x}(x^3 + bx^2 + cx) dx = 6 + 2b + c.
        \end{align*}

        Por tanto, e imponiendo que la fórmula sea exacta en $\Pi(x)$ y $x\Pi(x)$, tenemos el siguiente sistema:
        \begin{align*}
            \left.
            \begin{array}{rcl}
                2 + b + c &=& 0,\\
                6 + 2b + c &=& 0.
            \end{array}
            \right\}
            \iff
            \left\{
            \begin{array}{rcl}
                b = -4,\\
                c = 2.
            \end{array}
            \right.
        \end{align*}

        Por tanto, tenemos que:
        \begin{equation*}
            \Pi(x) = x^2 - 4x + 2.
        \end{equation*}

        Por tanto, las raíces de $\Pi(x)$, que son los nodos de la fórmula, son:
        \begin{align*}
            x_0 &= 2 - \sqrt{2},\\
            x_1 &= 2 + \sqrt{2}.
        \end{align*}

        Por tanto, la fórmula de Laguerre con 2 nodos es:
        \begin{equation*}
            \int_{0}^{\infty} e^{-x} f(x) dx \approx \alpha_0 f(2 - \sqrt{2}) + \alpha_1 f(2 + \sqrt{2}).
        \end{equation*}

        Para hallar los coeficientes $\alpha_0$ y $\alpha_1$, hemos de imponer que la fórmula sea exacta en $\{1,x\}$.
        \begin{itemize}
            \item Para $f(x) = 1$:
            \begin{align*}
                \int_{0}^{\infty} e^{-x} 1 dx &= \left[-e^{-x}\right]_{0}^{\infty} = 1 = \alpha_0 + \alpha_1.
            \end{align*}
            \item Para $f(x) = x$:
            \begin{align*}
                \int_{0}^{\infty} e^{-x} x dx &= 1 = \alpha_0(2 - \sqrt{2}) + \alpha_1(2 + \sqrt{2}).
            \end{align*}
        \end{itemize}

        Por tanto, tenemos el siguiente sistema:
        \begin{align*}
            \left.
            \begin{array}{rcl}
                \alpha_0 + \alpha_1 &=& 1,\\
                \alpha_0(2 - \sqrt{2}) + \alpha_1(2 + \sqrt{2}) &=& 1.
            \end{array}
            \right\}
            \iff
            \left\{
            \begin{array}{rcl}
                \alpha_0 = \dfrac{2+ \sqrt{2}}{4},\\
                \alpha_1 = \dfrac{2- \sqrt{2}}{4}.
            \end{array}
            \right.
        \end{align*}

        Por tanto, la fórmula de Laguerre con 2 nodos es:
        \begin{equation*}
            \int_{0}^{\infty} e^{-x} f(x) dx \approx \dfrac{2 + \sqrt{2}}{4}f(2 - \sqrt{2}) + \dfrac{2 - \sqrt{2}}{4}f(2 + \sqrt{2}).
        \end{equation*}
        \item Aplique la fórmula obtenida para aproximar $\int_{0}^{\infty} e^{-x} x^4 dx$.
        \begin{align*}
            \int_{0}^{\infty} e^{-x} x^4 dx &\approx \dfrac{2 + \sqrt{2}}{4}(2 - \sqrt{2})^4 + \dfrac{2 - \sqrt{2}}{4}(2 + \sqrt{2})^4 =  20
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.29}
    Se denominan fórmulas de integración de Lobatto a aquellas que usan como nodos los dos extremos del intervalo de integración, y eligen los restantes para alcanzar la máxima exactitud posible. Trapecio y Simpson son ejemplos de fórmulas de Lobatto, siendo la del trapecio la más sencilla.
    \begin{enumerate}
        \item Obtenga la fórmula de Lobatto del tipo $$\int_{-1}^{1} f(x) dx \approx \alpha_0 f(-1) + \alpha_1 f(x_1) + \alpha_2 f(x_2) + \alpha_3 f(1)$$
        
        Sabemos que será exacta en $\bb{P}_3$ por construcción, y que el grado de exactitud máximo será $2\cdot 3 + 1 = 7$. No podemos garantizar que podamos encontrar valores de $\alpha_0$, $\alpha_1$, $\alpha_2$ y $\alpha_3$ que hagan la fórmula exacta en $\bb{P}_7$, puesto que dos de los nodos ya han sido fijados a $-1$ y $1$.\\
        Definimos el siguiente polinomio:
        \begin{equation*}
            \Pi(x) = (x+1)(x-x_1)(x-x_2)(x-1) = (x^2-1)(x^2-(x_1+x_2)x + x_1x_2).
        \end{equation*}

        Como $(x-x_1)(x-x_2)\in \bb{P}_2$, entonces $\exists b,c\in \bb{R}$ tales que:
        \begin{equation*}
            \Pi(x) = (x^2-1)(x^2 + bx + c)
            = x^4 + bx^3 + (c-1)x^2 - bx - c.
        \end{equation*}

        Como buscamos que sea exacta en $\bb{P}_4$, hemos de imponer exactitud en $\{\Pi(x), x\Pi(x)\}$. Tenemos que:
        \begin{align*}
            0 = \int_{-1}^{1} \Pi(x) dx &= \int_{-1}^{1} (x^4 + bx^3 + (c-1)x^2 - bx - c) dx =\\&= 2\cdot \frac{1}{5} + 0 + 2(c-1)\cdot \frac{1}{3} - 0 - 2c = -\dfrac{4}{15} - \dfrac{4c}{3}
            \Longrightarrow c = -\dfrac{1}{5},\\
            0 = \int_{-1}^{1} x\Pi(x) dx &= \int_{-1}^{1} (x^5 + bx^4 + (c-1)x^3 - bx^2 - cx) dx =\\&= 0 + 2b\cdot \frac{1}{5} + 0 -2b\cdot \frac{1}{3} - 0 = \dfrac{2b}{5} - \dfrac{2b}{3} \Longrightarrow b = 0.
        \end{align*}

        Por tanto, tenemos que:
        \begin{equation*}
            \Pi(x) = x^4 - \dfrac{6}{5}x^2 + \dfrac{1}{5}.
        \end{equation*}

        Por tanto, las raíces de $\Pi(x)$, que son los nodos de la fórmula, son:
        \begin{align*}
            x_1 &= -\frac{\sqrt{5}}{5},\\
            x_2 &= \frac{\sqrt{5}}{5}.
        \end{align*}

        Por tanto, la fórmula de Lobatto con 4 nodos es:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx \alpha_0 f(-1) + \alpha_1 f\left(-\frac{\sqrt{5}}{5}\right) + \alpha_2 f\left(\frac{\sqrt{5}}{5}\right) + \alpha_3 f(1).
        \end{equation*}

        Para hallar los coeficientes $\alpha_0$, $\alpha_1$, $\alpha_2$ y $\alpha_3$, hemos de imponer que la fórmula sea exacta en $\{1,x,x^2,x^3\}$.
        \begin{itemize}
            \item Para $f(x) = 1$:
            \begin{align*}
                \int_{-1}^{1} 1 dx &= 2 = \alpha_0 + \alpha_1 + \alpha_2 + \alpha_3.
            \end{align*}
            \item Para $f(x) = x$:
            \begin{align*}
                \int_{-1}^{1} x dx &= 0 = -\alpha_0 + \alpha_1\left(-\frac{\sqrt{5}}{5}\right) + \alpha_2\left(\frac{\sqrt{5}}{5}\right) + \alpha_3
                = -\alpha_0 + \frac{\sqrt{5}}{5}(\alpha_2 - \alpha_1) + \alpha_3.
            \end{align*}
            \item Para $f(x) = x^2$:
            \begin{align*}
                \int_{-1}^{1} x^2 dx &= \dfrac{2}{3} = \alpha_0 + \alpha_1\left(-\frac{\sqrt{5}}{5}\right)^2 + \alpha_2\left(\frac{\sqrt{5}}{5}\right)^2 + \alpha_3
                = \alpha_0 + \frac{1}{5}(\alpha_1 + \alpha_2) + \alpha_3.
            \end{align*}
            \item Para $f(x) = x^3$:
            \begin{align*}
                \int_{-1}^{1} x^3 dx &= 0 = -\alpha_0 + \alpha_1\left(-\frac{\sqrt{5}}{5}\right)^3 + \alpha_2\left(\frac{\sqrt{5}}{5}\right)^3 + \alpha_3
                = -\alpha_0 + \frac{\sqrt{5}}{25}(\alpha_2 - \alpha_1) + \alpha_3.
            \end{align*}
        \end{itemize}

        Por tanto, tenemos el siguiente sistema:
        \begin{align*}
            \left.
            \begin{array}{rcl}
                \alpha_0 + \alpha_1 + \alpha_2 + \alpha_3 &=& 2,\\
                -\alpha_0 + \frac{\sqrt{5}}{5}(\alpha_2 - \alpha_1) + \alpha_3 &=& 0,\\
                \alpha_0 + \frac{1}{5}(\alpha_1 + \alpha_2) + \alpha_3 &=& \dfrac{2}{3},\\
                -\alpha_0 + \frac{\sqrt{5}}{25}(\alpha_2 - \alpha_1) + \alpha_3 &=& 0.
            \end{array}
            \right\}
            \iff
            \left\{
            \begin{array}{rcl}
                \alpha_0 = \alpha_3 = \nicefrac{1}{6},\\
                \alpha_1 = \alpha_2 = \nicefrac{5}{6}.
            \end{array}
            \right.
        \end{align*}

        Por tanto, la fórmula de Lobatto con 4 nodos es:
        \begin{equation*}
            \int_{-1}^{1} f(x) dx \approx \dfrac{1}{6}\left[f(-1) + 5f\left(-\frac{\sqrt{5}}{5}\right) + 5f\left(\frac{\sqrt{5}}{5}\right) + f(1)\right].
        \end{equation*}
        \item Obtenga la expresión del error de dicha fórmula.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio} \label{ej:2.1.30}
    Se quiere aproximar la siguiente integral, para que tenga precisión máxima:
    \begin{equation*}
        \int_0^1 xf(x) \, dx\approx \alpha_0 f(x_0) + \alpha_1 f(x_1)
    \end{equation*}
    \begin{enumerate}
        \item Determina $\alpha_0, \alpha_1$ y $x_0, x_1$ para que la fórmula anterior (con peso $\omega(x)=x$) tenga precisión máxima.
        
        Como hay $2$ nodos, el grado máximo es $2\cdot 1+1=3$.
        Definimos:
        \begin{align*}
            \Pi(x) &= (x-x_0)(x-x_1)
        \end{align*}

        Como $\Pi(x)\in \bb{P}_2$, $\exists a,b\in \bb{R}$ tal que:
        \begin{align*}
            \Pi(x) &= x^2+ax+b
        \end{align*}

        Por comodidad, debido a que lo usaremos muchas veces, tenemos que:
        \begin{align*}
            \int_0^1 x\ dx = \dfrac{1}{2}\qquad 
            \int_0^1 x^2\ dx = \dfrac{1}{3}\qquad
            \int_0^1 x^3\ dx = \dfrac{1}{4}\qquad
            \int_0^1 x^4\ dx = \dfrac{1}{5}
        \end{align*}

        Como buscamos que la fórmula sea exacta en $1+2$, hemos de imponer que lo sea en $\Pi(x)$ y $x\Pi(x)$:
        \begin{align*}
            0 &= \int_0^1 x\cdot \Pi(x)\ dx = \int_0^1 x^3 + ax^2 + bx\ dx
            = \dfrac{1}{4} + \dfrac{a}{3} + \dfrac{b}{2}\\
            0 &= \int_0^1 x^2\cdot \Pi(x)\ dx = \int_0^1 x^4 + ax^3 + bx^2\ dx
            = \dfrac{1}{5} + \dfrac{a}{4} + \dfrac{b}{3}
        \end{align*}

        Por tanto, el sistema a resolver es:
        \begin{equation*}
            \left\{
            \begin{array}{rcl}
                \nicefrac{1}{4} + \nicefrac{a}{3} + \nicefrac{b}{2} &=& 0\\
                \nicefrac{1}{5} + \nicefrac{a}{4} + \nicefrac{b}{3} &=& 0
            \end{array}
            \right\}\Longrightarrow
            \left\{
                \begin{array}{rcl}
                    a&=&\nicefrac{-6}{5}\\
                    b&=&\nicefrac{3}{10}
                \end{array}
            \right.
        \end{equation*}

        Por tanto, tenemos que:
        \begin{align*}
            \Pi(x) &= (x-x_0)(x-x_1) = x^2-\frac{6}{5}\cdot x+\frac{3}{10}
        \end{align*}

        Como $x_0,x_1$ son las raíces de $\Pi(x)$, las podemos calcular:
        \begin{align*}
            x^2-\frac{6}{5}\cdot x+\frac{3}{10} = 0
            \iff x=\dfrac{6\pm\sqrt{6}}{10}
        \end{align*}

        Por tanto, podemos tomar (la elección contaria también es posible):
        \begin{equation*}
            \left\{
                \begin{array}{rcl}
                    x_0 &=& \dfrac{6+\sqrt{6}}{10}\\
                    x_1 &=& \dfrac{6-\sqrt{6}}{10}
                \end{array}
            \right.
        \end{equation*}

        Por tanto, la fórmula de integración queda:
        \begin{align*}
            \int_0^1 xf(x) \, dx &\approx \alpha_0 f\left(\dfrac{6+\sqrt{6}}{10}\right) + \alpha_1 f\left(\dfrac{6-\sqrt{6}}{10}\right)
        \end{align*}

        De esta fórmula, la siguiente fórmula será exacta al menos en $\bb{P}_3$. Imponiendo exactitud en, por ejemplo, $\{1,x\}$, tenemos que:
        \begin{align*}
            \int_0^1 x\ dx &= \dfrac{1}{2} = \alpha_0\cdot 1 + \alpha_1\cdot 1\\
            \int_0^1 x^2\ dx &= \dfrac{1}{3} = \alpha_0\cdot x_0 + \alpha_1\cdot x_1
        \end{align*}

        De la primera ecuación, obtenemos $\alpha_0=\nicefrac{1}{2}-\alpha_1$. Sustituyendo en la segunda ecuación, tenemos que:
        \begin{align*}
            \dfrac{1}{3} = \left(\nicefrac{1}{2}-\alpha_1\right)\cdot x_0 + \alpha_1\cdot x_1
            \Longrightarrow
            \alpha_1 = \dfrac{\frac{1}{3}-\frac{x_0}{2}}{x_1-x_0}
        \end{align*}

        De los valores de $x_0$ y $x_1$, tenemos que:
        \begin{align*}
            \alpha_1 &= \dfrac{10}{6}\cdot \dfrac{2-3x_0}{\cancel{6}-\sqrt{6}-\cancel{6}-\sqrt{6}}
            = -{5}\sqrt{6}\cdot \left(2-3x_0\right)
            = \\&= -\dfrac{5\sqrt{6}}{6^2}\cdot \left(2-\dfrac{3\cdot\left(6+\sqrt{6}\right)}{10}\right)
            = -\dfrac{5\sqrt{6}}{6^2}\cdot \left(\dfrac{20-18-3\sqrt{6}}{10}\right)
            =\\&= -\dfrac{\sqrt{6}}{6^2}\cdot \left(\dfrac{2-3\sqrt{6}}{2}\right)
            = -\dfrac{\sqrt{6}}{6^2}\cdot \left(1-\dfrac{3\sqrt{6}}{2}\right)
            = \dfrac{9-\sqrt{6}}{6^2}
        \end{align*}

        Por tanto, el valor de $\alpha_0$ es:
        \begin{equation*}
            \alpha_0 = \dfrac{18}{36}-\dfrac{9-\sqrt{6}}{6^2} = \dfrac{9+\sqrt{6}}{6^2}
        \end{equation*}

        Por tanto, la fórmula de integración queda:
        \begin{align*}
            \int_0^1 xf(x) \, dx &\approx \dfrac{9+\sqrt{6}}{36}f\left(\dfrac{6+\sqrt{6}}{10}\right) + \dfrac{9-\sqrt{6}}{36}f\left(\dfrac{6-\sqrt{6}}{10}\right)
        \end{align*}

        \item Da una expresión del error.
        
        El error de viene dado por:
        \begin{align*}
            R(f) &= \dfrac{1}{4!}f^{(4)}(\xi)\cdot \int_0^1 x\Pi^2(x)\ dx\qquad \xi\in \left]\dfrac{6-\sqrt{6}}{10},\dfrac{6+\sqrt{6}}{10}\right[\subset \left]0.355,0.845\right[
        \end{align*}

        Calculemos dicha integral:
        \begin{align*}
            \int_0^1 x\Pi^2(x)\ dx
            &= \int_0^1 x\left(x^2-\frac{6}{5}x+\frac{3}{10}\right)^2\ dx
            =\\&= \int_0^1 x\left(x^4+\frac{36}{25}x^2+\frac{9}{100}-\frac{12}{5}x^3+\dfrac{3}{5}x^2-\frac{18}{25}x\right)\ dx
            =\\&= \int_0^1 \left(x^5-\frac{12}{5}x^4+\left(\frac{36}{25}+\frac{3}{5}\right)x^3-\frac{18}{25}x^2+\frac{9}{100}x\right)\ dx
            =\\&= \dfrac{1}{6}-\dfrac{12}{5}\cdot \dfrac{1}{5}+\left(\frac{36}{25}+\frac{3}{5}\right)\cdot \dfrac{1}{4}-\frac{18}{25}\cdot \dfrac{1}{3}+\frac{9}{100}\cdot \dfrac{1}{2}
            = \frac{1}{600}
        \end{align*}

        Por tanto, el error de la aproximación es:
        \begin{align*}
            R(f) &= \dfrac{1}{4!}f^{(4)}(\xi)\cdot \int_0^1 x\Pi^2(x)\ dx
            = \dfrac{1}{24}\cdot f^{(4)}(\xi)\cdot \dfrac{1}{600}
            = \dfrac{f^{(4)}(\xi)}{14400}
        \end{align*}

    \end{enumerate}
\end{ejercicio}
