\subsection{Relación 1}
\setcounter{ejercicio}{0}

En la mayoría de los ejercicios se hace referencia al problema de valores iniciales (PVI) siguiente:
\begin{equation}\label{eq:pvi}
    x' = f(t, x),\quad f : D = [a = t_0, b] \times \bb{R} \to \bb{R},\quad x(t_0) = \mu,\quad (t_0, \mu) \in D
\end{equation}
siendo $x = x(t)$ una función desconocida de $t$.

\begin{ejercicio}\label{ej:3.1.1}
    Sea $f : D \to \bb{R}$ continua y lipschitziana en su segunda variable con constante de Lipschitz $M$, y $f\in C^1(D)$. Sea $h = \frac{b-a}{N}$, con $N \in \bb{N}$. Se considera el método de Euler para resolver el PVI~\eqref{eq:pvi} con tamaño de paso $h$. Demuestre que:
    \begin{itemize}
        \item Si $M = 0$, entonces $|e_n| \leq \frac{(b-a)M^*}{2} h$ para todo $n = 0, \ldots, N$.
        \item Si $M > 0$, entonces $|e_n| \leq \dfrac{e^{(b-a)M} - 1}{M} \cdot \frac{M^*}{2} h$ para todo $n = 0, \ldots, N$,
    \end{itemize}
    donde $e_n$ es el error de truncatura global del método en el punto $t_n$, y $M^*$ es tal que $|x''(t)| \leq M^*$ para todo $t \in [a, b]$, siendo $x(t)$ la única solución de~\eqref{eq:pvi}.    
\end{ejercicio}


\begin{ejercicio}\label{ej:3.1.2}
    Demuestre que el PVI $x' = \nicefrac{-1}{2} x$, $x(0) = 2$ tiene una única solución en $[0, 1]$ y halle una cota del error de truncatura global en cada nodo del método de Euler de tamaño de paso $h$ para aproximar dicha solución.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.3}
    Demuestre que si $f : D \to \bb{R}$ es continua y lipschitziana en su segunda variable, entonces el método del punto medio para resolver el PVI~\eqref{eq:pvi} es estable, consistente con~\eqref{eq:pvi} y converge a la solución de~\eqref{eq:pvi}.\\

    Buscamos obtener el método del punto medio para resolver el PVI~\eqref{eq:pvi}. Tenemos que:
    \begin{equation*}
        x(t_{n+1})-x(t_n) = \int_{t_n}^{t_{n+1}} x'(s)\, ds = \int_{t_n}^{t_{n+1}} f(s, x(s))\, ds
    \end{equation*}

    Para aproximar la integral anterior, utilizamos el método del punto medio visto en integración numérica:
    \begin{equation*}
        \int_{t_n}^{t_{n+1}} f(s, x(s))\, ds \approx h f\left(t_n + \frac{h}{2}, x\left(t_n + \frac{h}{2}\right)\right)
    \end{equation*}

    Para obtener el valor de $x(t_n + \nicefrac{h}{2})$, lo aproximamos como sigue:
    \begin{equation*}
        x\left(t_n + \frac{h}{2}\right) \approx x(t_n) + \frac{h}{2} f(t_n, x(t_n))
    \end{equation*}

    Por tanto, el método del punto medio para resolver el PVI~\eqref{eq:pvi} queda definido por la siguiente ecuación en diferencias:
    \begin{equation*}
        x_{n+1} = x_n + h f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} f(t_n, x_n)\right)
    \end{equation*}

    Veamos que $\Phi$ es lipschitziana. Supongamos que $f$ lo es con constante $L$.
    \begin{align*}
        |\Phi(z; t, h) - \Phi(w; t, h)| &= \left| f\left(t + \frac{h}{2}, z + \frac{h}{2} f(t, z)\right) - f\left(t + \frac{h}{2}, w + \frac{h}{2} f(t, w)\right) \right|\\
        &\leq L\left|z + \frac{h}{2} f(t, z) - w - \frac{h}{2} f(t, w)\right|\\
        &\leq L\left|z - w\right| + \frac{h}{2} L \left|f(t, z) - f(t, w)\right|\\
        &\leq L\left|z - w\right| + \frac{h}{2} L^2 \left|z - w\right|\\
        &= \left(L + \frac{h}{2} L^2\right) \left|z - w\right|
    \end{align*}
    Por tanto, $\Phi$ es lipschitziana con constante de Lipschitz $L + \frac{h}{2} L^2$.
    Su polinomio característico es:
    \begin{equation*}
        p(\lm) = \lm -1
    \end{equation*}

    Para ver que es estable, es necesario ver que el módulo de las raíces del polinomio característico es menor o igual que 1, y en el caso de que sea igual a 1, que la raíz sea simple. En este caso, la única raíz es $\lm = 1$, que es simple, por lo que el método del punto medio es estable.

    Para ver que es consistente con el PVI~\eqref{eq:pvi} empleando la caracterización de la consistencia, tenemos que:
    \begin{itemize}
        \item $p(1)= 0$, que se tiene.
        \item $\Phi(x(t_n), t_n, 0)=p'(1)f(t_n, x(t_n))$:
        \begin{equation*}
            \Phi(x(t_n), t_n, 0) = f\left(t_n, x(t_n)\right) = p'(1) f(t_n, x(t_n))
        \end{equation*}
        Por tanto, se tiene también.
    \end{itemize}
    
    Por tanto, el método del punto medio es consistente con el PVI~\eqref{eq:pvi}. Como es estable y consistente, converge a la solución del PVI~\eqref{eq:pvi}.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.4}
    Razone la veracidad o falsedad de la afirmación siguiente: El método de Euler modificado (Heun) proporciona la solución exacta de la EDO dada por $x' = -2\lambda t$.\\

    La solución exacta de la EDO $x' = -2\lambda t$ es:
    \begin{equation*}
        x(t) = -\lambda t^2 + C
    \end{equation*}

    El método de Euler modificado (Heun) para resolver el PVI $x' = f(t, x)$ consiste en aplicar la fórmula de integración numérica del trapecio:
    \begin{equation*}
        x_{n+1} - x_n = \int_{t_n}^{t_{n+1}} f(s, x(s))\, ds \approx \frac{h}{2} \left( f(t_n, x_n) + f(t_{n+1}, x_{n+1}) \right)
    \end{equation*}

    Para obtener $x_{n+1}$, se aproxima por el método de Euler:
    \begin{equation*}
        x_{n+1} = x_n + h f(t_n, x_n)
    \end{equation*}

    Por tanto, el método de Euler modificado (Heun) para resolver el PVI $x' = -2\lambda t$ queda definido por la siguiente ecuación en diferencias:
    \begin{equation*}
        x_{n+1} = x_n + \frac{h}{2} \left( f(t_n, x_n) + f(t_{n+1}, x_n + h f(t_n, x_n)) \right)
    \end{equation*}

    Aplicada al PVI $x' = -2\lambda t$, la ecuación en diferencias queda:
    \begin{equation*}
        x_{n+1} = x_n + \frac{h}{2} \left( -2\lambda t_n + (-2\lambda (t_n + h)) \right)
        = x_n - \lambda h (t_n + t_ n + h)
        = x_n - \lambda h (2t_n + h)
    \end{equation*}

    Veamos si efectivamente el método de Euler modificado (Heun) proporciona la solución exacta de la EDO $x' = -2\lambda t$. Para ello, hemos de suponer que el dato inicial $x_0$ proporcionado cumple que $x_0 = x(t_0)$. Supuesto esto:
    \begin{align*}
        x_{n+1} &= x(t_{n+1}) = x(t_n + h) = -\lambda (t_n + h)^2 + C \\
        &= -\lambda (t_n^2 + 2t_n h + h^2) + C \\
        &= -\lambda t_n^2 - 2\lambda t_n h - \lambda h^2 + C \\
        &= x(t_n) - \lambda h (2t_n + h) \\
        &= x_n - \lambda h (2t_n + h)
    \end{align*}

    Por tanto, por inducción, demostramos que el método de Euler modificado (Heun) proporciona la solución exacta de la EDO $x' = -2\lambda t$ si el dato inicial $x_0$ es tal que $x_0 = x(t_0)$.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.5}
    Demuestre que si $f : D \to \bb{R}$ es continua y lipschitziana en su segunda variable, entonces el método de Runge-Kutta clásico para resolver el PVI~\eqref{eq:pvi} es estable, consistente con~\eqref{eq:pvi} y converge a la solución de~\eqref{eq:pvi}.\\

    El método de Runge-Kutta clásico para resolver el PVI~\eqref{eq:pvi} se define por la siguiente ecuación en diferencias:
    \begin{align*}
        x_{n+1} &= x_n + \frac{h}{6} \left( K_1 + 2K_2 + 2K_3 + K_4 \right)\\
        K_1 &= f(t_n, x_n) \\
        K_2 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_1\right) \\
        K_3 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_2\right) \\
        K_4 &= f(t_n + h, x_n + h K_3)
    \end{align*}

    Su polinomio característico es:
    \begin{equation*}
        p(\lm) = \lm - 1
    \end{equation*}

    Para ver que es estable, es necesario ver que el módulo de las raíces del polinomio característico es menor o igual que 1, y en el caso de que sea igual a 1, que la raíz sea simple. En este caso, la única raíz es $\lm = 1$, que es simple, por lo que el método de Runge-Kutta clásico es estable.

    Para ver que es consistente con el PVI~\eqref{eq:pvi} empleando la caracterización de la consistencia, tenemos que:
    \begin{itemize}
        \item $p(1)= 0$, que se tiene.
        \item $\Phi(x(t_n), t_n, 0)=p'(1)f(t_n, x(t_n))$:
        
        En primer lugar, hemos de ver que si $h=0$ entonces:
        \begin{equation*}
            K_1 = K_2 = K_3 = K_4 = f(t_n, x_n)
        \end{equation*}

        Por tanto:
        \begin{align*}
            \Phi(x(t_n), t_n, 0) &= \frac{1}{6} \left( K_1 + 2K_2 + 2K_3 + K_4 \right) = \dfrac{1}{6}\cdot 6 f(t_n, x_n) = p'(1) f(t_n, x_n)
        \end{align*}
        Por tanto, se tiene también.
    \end{itemize}
    
    Por tanto, el método de Runge-Kutta clásico es consistente con el PVI~\eqref{eq:pvi}. Como es estable y consistente, converge a la solución del PVI~\eqref{eq:pvi}.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.6}
    Razone la veracidad o falsedad de las siguientes afirmaciones:
    \begin{enumerate}
        \item Al aplicar el método de un paso del punto medio al problema $x'(t) = -x(t) + 1$, $x(0) = 2$ se obtiene la solución numérica $\{t_n, x_n\}_{n=0}^N$ donde $x_n = A^n + 1$ con $A = 1 - h + \frac{h^2}{2}$.
        
        El método del punto medio para resolver el PVI $x' = f(t, x)$ se define por la siguiente ecuación en diferencias:
        \begin{equation*}
            x_{n+1} = x_n + h f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} f(t_n, x_n)\right)
        \end{equation*}
        Aplicada al PVI $x' = -x + 1$, la ecuación en diferencias queda:
        \begin{align*}
            x_{n+1} &= x_n + h\left(-x_n - \frac{h}{2}(-x_n + 1)+1\right) \\
            &= x_n + h\left(-x_n + \frac{h}{2} x_n - \frac{h}{2} + 1\right)
        \end{align*}

        Demostramos ahora por inducción.
        \begin{itemize}
            \item Para $n=0$, tenemos que:
            \begin{equation*}
                x_0 = 2 = A^0 + 1
            \end{equation*}

            \item Supongamos que se cumple para $n$, y demostremos que se cumple para $n+1$:
            \begin{align*}
                x_{n+1} &= x_n + h\left(-x_n + \frac{h}{2} x_n - \frac{h}{2} + 1\right) \\
                &= A^n + 1 + h\left(-A^n - 1 + \frac{h}{2} (A^n+1) - \frac{h}{2} + 1\right) \\
                &= A^n + 1 + h\left(-A^n + \frac{h}{2} A^n\right) \\
                &= 1 + A^n + hA^n\left(-1 + \frac{h}{2}\right) \\
                &= 1 + A^n\left(1 - h + \frac{h^2}{2}\right) \\
                &= 1 + A^{n+1}
            \end{align*}

            Por tanto, se cumple para $n+1$.
        \end{itemize}

        Por tanto, por inducción, se tiene demostrado para todo $n \in \bb{N}$.
        \item El orden de un método explícito de un paso cuya ecuación en diferencias es:
        \begin{equation*}
            x_{n+1} = x_n + h \Phi(x_n; t_n, h),\qquad n = 0, \ldots, N-1
        \end{equation*}
        con $\Phi(x; t, h) = f(t, x) + \frac{h}{2} x''(t)$ es al menos 2.\\

        Tenemos que calcular:
        \begin{align*}
            R_{n+1} &= x(t_{n+1}) - x(t_n) -h \Phi(x(t_n); t_n, h)
            =\\&= x(t_{n+1}) - x(t_n) - h f(t_n, x(t_n)) - \frac{h^2}{2} x''(t_n) 
            =\\&= x(t_n + h) - x(t_n) - h x'(t_n) - \frac{h^2}{2} x''(t_n)
        \end{align*}

        El desarrollo de Taylor de $x(t_n + h)$ alrededor de $t_n$ es:
        \begin{align*}
            x(t_n + h) &= x(t_n) + h x'(t_n) + \frac{h^2}{2} x''(t_n) + O(h^3)
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            R_{n+1} &= O(h^3)
        \end{align*}

        Por tanto, el orden del método es al menos 2.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.7}
    Demuestre que el PVI $x' = t - x$, $x(0) = 1$ tiene una única solución en $[0, 1]$. ¿Se puede aproximar dicha solución mediante:
    \begin{itemize}
        \item el método de Taylor de orden 2?
        \item el método de Heun?
        \item el método del punto medio?
    \end{itemize}
    ¿Por qué? Escriba la ecuación en diferencias de cada uno de estos métodos para resolver el PVI considerado. ¿Ocurre algo reseñable?\\

    Sea $x'=f(t, x)$, con:
    \Func{f}{\bb{R}^2}{\bb{R}}{(t, x)}{t - x}

    Veamos que $f$ es continua y lipschitziana en su segunda variable. La continuidad de $f$ es inmediata, y para ver que es lipschitziana, sean $x,y\in \bb{R}$:
    \begin{align*}
        |f(t, x) - f(t, y)| &= |(t - x) - (t - y)| = |y - x|\leq 1\cdot |x-y|\qquad \forall t\in \bb{R}
    \end{align*}

    Por tanto, $f$ es lipschitziana en su segunda variable con constante de Lipschitz $M = 1$. Por tanto, el PVI tiene una única solución en $[0,1]\subset \bb{R}$. Se puede aproximar mediante los tres métodos, veámoslo:
    \begin{enumerate}
        \item El método de Taylor de orden 2 para resolver el PVI $x' = f(t, x)$ es:
        \begin{align*}
            x_{n+1} &\approx x(t_n + h) \approx x(t_n) + hx'(t_n) + \frac{h^2}{2} x''(t_n)
        \end{align*}

        Para aproximar $x'(t_n)$ y $x''(t_n)$, utilizamos que:
        \begin{align*}
            x'(t_n) &= f(t_n, x(t_n)) = t_n - x(t_n)\approx t_n - x_n \\
            x''(t_n) &= \frac{\partial f}{\partial t}(t_n, x(t_n)) + \frac{\partial f}{\partial x}(t_n, x(t_n)) x'(t_n) = 1 - 1\cdot (t_n - x(t_n)) \approx 1 - t_n + x_n
        \end{align*}

        Por tanto, la ecuación en diferencias del método de Taylor de orden 2 para resolver el PVI $x' = t - x$ es:
        \begin{align*}
            x_{n+1} &= x_n + h(t_n - x_n) + \frac{h^2}{2} (1 - t_n + x_n)
        \end{align*}

        \item El método de Heun para resolver el PVI $x' = f(t, x)$ es:
        \begin{align*}
            x_{n+1} &= x_n + \frac{h}{2} \left( f(t_n, x_n) + f(t_{n+1}, x_{n} + h f(t_n, x_n)) \right)
            =\\&= x_n + \frac{h}{2} \left( (t_n - x_n) + (t_{n+1} - (x_n + h(t_n - x_n))) \right)
            =\\&= x_n + \frac{h}{2} \left( 2t_n -x_n +h -x_n -ht_n +hx_n\right)
            =\\&= x_n + h(t_n - x_n) + \frac{h^2}{2} \left( 1 - t_n + x_n \right)
        \end{align*}

        \item El método del punto medio para resolver el PVI $x' = f(t, x)$ es:
        \begin{align*}
            x_{n+1} &= x_n + h f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} f(t_n, x_n)\right)
            =\\&= x_n + h\left(t_n + \frac{h}{2} - (x_n + \frac{h}{2} (t_n - x_n))\right)
            =\\&= x_n + h(t_n - x_n) + \frac{h^2}{2} (1 - t_n + x_n)
        \end{align*}
    \end{enumerate}

    El aspecto resañable es que los tres métodos resultan en el mismo.
    Tiene como polinomio característico:
    \begin{equation*}
        p(\lm) = \lm - 1
    \end{equation*}

    Por tanto, es estable. Veamos ahora si es consistente con el PVI~\eqref{eq:pvi} empleando la caracterización de la consistencia, tenemos que:
    \begin{itemize}
        \item $p(1)= 0$, que se tiene.
        \item $\Phi(x(t_n), t_n, 0)=p'(1)f(t_n, x(t_n))$:
        \begin{align*}
            \Phi(x(t_n), t_n, 0) &= t_n - x(t_n) = f(t_n, x(t_n)) = p'(1) f(t_n, x(t_n))
        \end{align*}
        Por tanto, se tiene también.
    \end{itemize}

    Por tanto, este método es estable y consistente, luego converge a la solución del PVI~\eqref{eq:pvi}.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.8}
    Demuestre que el PVI $x' = t^2 x$, $x(0) = 1$ tiene una única solución $x(t)$ en $[0, 1]$. Demuestre que el método de Taylor de orden 2 y el método de Runge-Kutta clásico convergen a $x(t)$ y halle las aproximaciones de cada uno de estos dos métodos para el tamaño de paso $h = 0.2$.\\

    Sea $x'=f(t, x)$, con:
    \Func{f}{\bb{R}^2}{\bb{R}}{(t, x)}{t^2 x}

    Veamos que $f$ es continua y lipschitziana en su segunda variable. La continuidad de $f$ es inmediata, y para ver que es lipschitziana, sean $x,y\in \bb{R}$:
    \begin{align*}
        |f(t, x) - f(t, y)| &= |t^2 x - t^2 y| = |t^2||x - y| \leq |x-y|\qquad \forall t\in [0, 1]
    \end{align*}
    Por tanto, $f$ es lipschitziana en su segunda variable con constante de Lipschitz $M \leq 1$. Por tanto, el PVI tiene una única solución en $[0,1]\subset \bb{R}$.

    \begin{enumerate}
        \item El método de Taylor de orden 2 para resolver el PVI $x' = f(t, x)$ es:
        \begin{align*}
            x_{n+1} &\approx x(t_n + h) \approx x(t_n) + hx'(t_n) + \frac{h^2}{2} x''(t_n)
        \end{align*}

        Para aproximar $x'(t_n)$ y $x''(t_n)$, utilizamos que:
        \begin{align*}
            x'(t_n) &= f(t_n, x(t_n)) = t_n^2 x(t_n)\approx t_n^2 x_n \\
            x''(t_n) &= \frac{\partial f}{\partial t}(t_n, x(t_n)) + \frac{\partial f}{\partial x}(t_n, x(t_n)) x'(t_n) = 2 t_n x(t_n) + t_n^2 (t_n^2 x(t_n)) = (2 t_n + t_n^4) x(t_n)
        \end{align*}

        Por tanto, la ecuación en diferencias del método de Taylor de orden 2 para resolver el PVI $x' = t^2 x$ es:
        \begin{align*}
            x_{n+1} &= x_n + h t_n^2 x_n + \frac{h^2}{2} (2 t_n + t_n^4) x_n
        \end{align*}

        Su polinomio característico es:
        \begin{equation*}
            p(\lm) = \lm - 1
        \end{equation*}

        Para ver que es estable, es necesario ver que el módulo de las raíces del polinomio característico es menor o igual que 1, y en el caso de que sea igual a 1, que la raíz sea simple. En este caso, la única raíz es $\lm = 1$, que es simple, por lo que el método de Taylor de orden 2 es estable.

        Para ver que es consistente con el PVI~\eqref{eq:pvi} empleando la caracterización de la consistencia, tenemos que:
        \begin{itemize}
            \item $p(1)= 0$, que se tiene.
            \item $\Phi(x(t_n), t_n, 0)=p'(1)f(t_n, x(t_n))$:
            \begin{align*}
                \Phi(x(t_n), t_n, 0) &= t_n^2 x(t_n) = f(t_n, x(t_n)) = p'(1) f(t_n, x(t_n))
            \end{align*}
            Por tanto, se tiene también.
        \end{itemize}

        Por tanto, el método de Taylor de orden 2 es consistente con el PVI~\eqref{eq:pvi}. Como es estable y consistente, converge a la solución del PVI~\eqref{eq:pvi}.

        Para $h = 0.2$, tenemos que:
        \begin{align*}
            x_{n+1} &= x_n + 0.2 t_n^2 x_n + 0.0002(2 t_n + t_n^4) x_n \\
        \end{align*}
        \begin{equation*}
            \begin{array}{c|c|c}
                n & t_n & x_n\\ \hline
                0 & 0 & 1 \\
                1 & 0.2 & 1\\
                2 & 0.4 & 1.00808\\
            \end{array}
        \end{equation*}

        \item El método de Runge-Kutta clásico para resolver el PVI $x' = f(t, x)$ se define por la siguiente ecuación en diferencias:
        \begin{align*}
            x_{n+1} &= x_n + \frac{h}{6} \left( K_1 + 2K_2 + 2K_3 + K_4 \right)\\
            K_1 &= f(t_n, x_n) \\
            K_2 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_1\right) \\
            K_3 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_2\right) \\
            K_4 &= f(t_n + h, x_n + h K_3)
        \end{align*}

        Este método ya se ha visto que es convergente. La primera evaluación es:
        \begin{equation*}
            \begin{array}{c|c|c|c|c|c|c}
                n & t_n & K_1 & K_2 & K_3 & K_4 & x_n\\ \hline
                0 & 0 & &&&& 1 \\
                1 & 0.2 & 0.04 & 0.01004&0.01001004&0.04008008032& 1.004006005
            \end{array}
        \end{equation*}

    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.9}
    Utilizando el método de Runge-Kutta clásico para resolver el PVI $x' = f(t)$, $x(0) = \mu$, deduzca una conocida fórmula de integración numérica e indique de qué fórmula se trata.\\

    El método de Runge-Kutta clásico para resolver el PVI $x' = f(t)$, $x(0) = \mu$ se define por la siguiente ecuación en diferencias:
    \begin{align*}
        x_{n+1} &= x_n + \frac{h}{6} \left( K_1 + 2K_2 + 2K_3 + K_4 \right)\\
        K_1 &= f(t_n, x_n) = f(t_n) \\
        K_2 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_1\right) = f\left(t_n + \frac{h}{2}\right) \\
        K_3 &= f\left(t_n + \frac{h}{2}, x_n + \frac{h}{2} K_2\right) = f\left(t_n + \frac{h}{2}\right) \\
        K_4 &= f(t_n + h, x_n + h K_3)
        = f(t_n + h)
    \end{align*}

    Tenemos que:
    \begin{align*}
        \int_{t_n}^{t_{n+1}} f(s)\, ds &= x(t_{n+1}) - x(t_n) \approx x_{n+1} - x_n 
        = \dfrac{h}{6} \left( K_1 + 2K_2 + 2K_3 + K_4 \right)
        =\\&= \dfrac{h}{6} \left( f(t_n) + 2f\left(t_n + \frac{h}{2}\right) + 2f\left(t_n + \frac{h}{2}\right) + f(t_n + h) \right)
        =\\&= \dfrac{h}{6} \left( f(t_n) + 4f\left(t_n + \frac{h}{2}\right) + f(t_n + h) \right)
    \end{align*}

    Por tanto, el método de Runge-Kutta clásico para resolver el PVI $x' = f(t)$, $x(0) = \mu$ es equivalente a la fórmula simple de Simpson.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.10}
    Para el método de Runge-Kutta de 2 evaluaciones con arreglo de Butcher:
    \begin{equation*}
        \begin{array}{c|cc}
            0 & 0 & 0 \\ 
            \alpha & \alpha & 0 \\ \hline
             & \frac{1-\alpha}{2} & \frac{1+\alpha}{2}
        \end{array}
    \end{equation*}
    \begin{enumerate}
        \item Determine el orden del método según los valores del escalar $\alpha$.
        
        El método es:
        \begin{align*}
            x_{n+1} &= x_n + h \left( \dfrac{1-\alpha}{2} K_1 + \dfrac{1+\alpha}{2} K_2 \right)\\
            K_1 &= f(t_n + 0\cdot h, x_n + h(0K_1 + 0K_2)) = f(t_n, x_n) \\
            K_2 &= f\left(t_n + \alpha h, x_n + h(\alpha K_1 + 0K_2)\right) = f\left(t_n + \alpha h, x_n + \alpha h K_1\right)
        \end{align*}
        \item Para $\alpha$ adecuado para que el método tenga orden máximo, ¿cuál es el término principal del error local de truncatura?
        \item ¿Es estable (cero-estable) el método para todo $\alpha$ si $f(t, x)$ es continua y lipschitziana respecto de $x$ sobre $D$?
        
        El polinomio característico del método es:
        \begin{equation*}
            p(\lm) = \lm - 1
        \end{equation*}

        Para ver que es estable, es necesario ver que el módulo de las raíces del polinomio característico es menor o igual que 1, y en el caso de que sea igual a 1, que la raíz sea simple. En este caso, la única raíz es $\lm = 1$, que es simple, por lo que el método de Runge-Kutta de 2 evaluaciones con arreglo de Butcher es estable.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Considere el MML definido por:
    \begin{equation*}
        x_{n+2} + a_1 x_{n+1} + a_0 x_n = h (b_0 f_n + b_1 f_{n+1})
    \end{equation*}
    \begin{enumerate}
        \item Exprese los valores de $a_0$, $b_0$, $b_1$ respecto de $a_1$ para que el método sea de orden, al menos, 2.
        
        Tenemos que:
        \begin{align*}
            x_{n+2} = - a_1 x_{n+1} - a_0 x_n + h (b_0 f_n + b_1 f_{n+1})
        \end{align*}

        Para que el método sea de orden, al menos, 2, hemos de cumplir que:
        \begin{align*}
            0 = C_0 &= 1+a_1+a_0 \\
            0 = C_1 &= 2 + 0a_0 + a_1 - b_0 - b_1 \\
            0 = C_2 &= \dfrac{2^2}{2!} + \dfrac{0^2}{2!}a_0 + \dfrac{1^2}{2!} a_1 - \dfrac{1^1}{1!} b_1
            = 4 + a_1 - 2b_1
        \end{align*}

        Por tanto:
        \begin{equation*}
            a_0 = -1 - a_1,\qquad b_1 = \dfrac{4 + a_1}{2},\qquad b_0 = 2+a_1-b_1 = \dfrac{4 +2a_1-4-a_1}{2} = \dfrac{a_1}{2}
        \end{equation*}
        \item Para la familia de métodos obtenida en el apartado anterior, ¿qué valor(es) de $a_1$ hacen el MML estable?
        
        Para estudiar la estabilidad del MML, hemos de estudiar el polinomio característico:
        \begin{align*}
            p(\lm) &= \lm^2 + a_1 \lm + a_0
            = \lm^2 + a_1 \lm - 1 - a_1
            = 0\iff\\&\iff
            \lm = \dfrac{-a_1 \pm \sqrt{a_1^2 +4+4a_1}}{2}
            = \dfrac{-a_1 \pm \sqrt{(a_1+2)^2}}{2}
            = \dfrac{-a_1 \pm (a_1+2)}{2}
            \iff\\&\iff
            \lm \in \{1,-a_1-1\}
        \end{align*}

        Tenemos que:
        \begin{align*}
            |-a_1-1|\leq 1\iff -1 \leq a_1+1\leq 1
            \iff a_1\in [-2,0]
        \end{align*}

        Si $a_1=-2$, entonces $1$ es una raíz doble, por lo que no es estable. Por tanto, el MML es estable si y solo si $a_1\in \left]-2,0\right]$.
        \item ¿Qué métodos particulares se obtienen si $a_1 = 0$ y $a_1 = -1$?
        \begin{itemize}
            \item Si $a_1 = 0$, entonces:
            \begin{equation*}
                a_0 = -1,\qquad b_0 = 0,\qquad b_1 = 2
            \end{equation*}

            Por tanto, el MML es:
            \begin{equation*}
                x_{n+2} = x_n + 2h f_{n+1}
            \end{equation*}

            En este caso, se trata del MML basado en la fórmula de cuadratura del punto medio aplicada al segmento $[t_n, t_{n+2}]$.

            \item Si $a_1 = -1$, entonces:
            \begin{equation*}
                a_0 = 0,\qquad b_0 = \nicefrac{-1}{2},\qquad b_1 = \nicefrac{3}{2}
            \end{equation*}

            Por tanto, el MML es:
            \begin{align*}
                x_{n+2} &= x_{n+1} +h\left(-\frac{1}{2}f_n + \dfrac{3}{2}f_{n+1}\right)
                =\\&= x_{n+1} +\dfrac{h}{2}\left(3f_{n+1}-f_n\right)
            \end{align*}
        \end{itemize}
        \item ¿Es estable y de orden 3 el MML para algún valor de $a_1$?
        
        Calculemos para ello $C_3$.
        \begin{align*}
            C_3 &= \dfrac{2^3}{3!}+ 0\cdot a_0 + \dfrac{1}{3!}a_1 -\dfrac{1}{2!}b_1
            = \dfrac{8}{6} + \dfrac{a_1}{6} - \dfrac{4+a_1}{4}
            =\\&= \frac{1}{3}+ \dfrac{a_1}{6} -\dfrac{a_1}{4}
            = \frac{1}{3}- \dfrac{a_1}{12}
            =0 \iff a_1=4
        \end{align*}

        No obstante, en ese caso $a_1\notin \left]-2,0\right]$, por lo que no es posible encontrar dicho valor de $a_1$ pedido.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.12}
    Determine los parámetros $\alpha$, $\beta$ para los que el método lineal de ecuación en diferencias:
    \begin{equation*}
        x_{n+2} - (1 + \alpha) x_{n+1} + \alpha x_n = h ((1 + \beta) f_{n+2} - (\alpha + \beta + \alpha \beta) f_{n+1} + \alpha \beta f_n)
    \end{equation*}
    con $n = 0, \ldots, N-2$, tenga el mayor orden posible. ¿Cuál es dicho orden? ¿Es convergente el método obtenido? ¿Por qué?\\

    Calculemos los valores de los $C_i$.
    \begin{align*}
        C_0 &= 1-(1+\alpha) + \alpha = 0\qquad \forall \alpha,\beta\\
        C_1 &= 2 +0\cdot \alpha -(1+\alpha) - \alpha\beta + (\alpha+\beta+\alpha\beta) - (1+\beta) = 0\qquad \forall \alpha,\beta\\
        C_2 &= \dfrac{2^2}{2!} - \dfrac{1}{2!}(1+\alpha)+\dfrac{1}{1!}(\alpha+\beta+\alpha\beta) - \dfrac{2^1}{1!}(1+\beta)
        = -\frac{1}{2}+\frac{\alpha}{2}-\beta+\alpha\beta=0\\
        C_3 &= \dfrac{2^3}{3!} - \dfrac{1}{3!}(1+\alpha)+\dfrac{1}{2!}(\alpha+\beta+\alpha\beta) - \dfrac{2^2}{2!}(1+\beta)
        = -\frac{5}{6}+\frac{\alpha}{3}-\dfrac{3\beta}{2}+\frac{\alpha\beta}{2}
    \end{align*}

    Por tanto, planteamos el siguiente sistema:
    \begin{equation*}
        \left.
            \begin{array}{rcl}
                \alpha-2\beta+2\alpha\beta &=& 1\\
                2\alpha-9\beta+3\alpha\beta &=& 5
            \end{array}
        \right\}
        \Longrightarrow
        \left\{
            \begin{array}{rcl}
                \alpha &=& 1\\
                \beta &=& \nicefrac{-1}{2}
            \end{array}
        \right\}
    \end{equation*}

    Por tanto, ya tenemos determinados los valores de $\alpha$ y $\beta$. Veamos si estos también cumplen que $C_4=0$:
    \begin{align*}
        C_4 &= \dfrac{2^4}{4!} - \dfrac{1}{4!}(1+\alpha)+\dfrac{1}{3!}(\alpha+\beta+\alpha\beta) - \dfrac{2^3}{3!}(1+\beta)
        =\\&= \dfrac{16}{24}-\dfrac{2}{24} + \dfrac{1}{3!}\cdot 0 - \dfrac{8}{6\cdot 2}
        = -\dfrac{1}{12}\neq 0
    \end{align*}

    Por tanto, su orden exacto es $3$. Veamos si es convergente. Su polinomio característico es:
    \begin{align*}
        p(\lm) = \lm^2-(1+\alpha)\lm + \alpha
        = \lm^2-2\lm + 1 = (\lm-1)^2
    \end{align*}

    Por tanto, y como las raíces de $p$ de módulo $1$ no son simples, el método no es estable y por tanto no podrá ser convergente.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.13}
    Construya una familia 1-paramétrica de MML implícitos de dos pasos con el mayor orden posible. ¿Cuál es dicho orden? Si $x(t)$ es suficientemente diferenciable, ¿cuál es la parte principal de error de truncatura local? ¿Qué valores del parámetro aseguran la convergencia?\\

    Un MML genérico implícito de 2 pasos es:
    \begin{align*}
        x_{n+2} = \alpha_1x_{n+1} + \alpha_0x_{n} + h\left(\beta_0f_n + \beta_1f_{n+1} + \beta_2f_{n+2}\right)
    \end{align*}

    Como tenemos $5$ parámetros y buscamos una solución uniparamétrica, necesitamos $4$ ecuaciones.
    \begin{align*}
        0 = C_0 &= 1-\alpha_0-\alpha_1\\
        0 = C_1 &= 2-\alpha_1-\beta_0-\beta_1-\beta_2\\
        0 = C_2 &= \dfrac{2^2}{2!} -\frac{\alpha_1}{2!} - \frac{0^1}{1!}\beta_0- \frac{1^1}{1!}\beta_1- \frac{2^1}{1!}\beta_2
        = 2-\frac{\alpha_1}{2}-\beta_1-2\beta_2\\
        0 = C_3 &= \dfrac{2^3}{3!} -\frac{\alpha_1}{3!} - \frac{0^2}{2!}\beta_0- \frac{1^2}{2!}\beta_1- \frac{2^2}{2!}\beta_2
        = \frac{8}{6} - \frac{\alpha_1}{6} - \frac{\beta_1}{2} - 2\beta_2
    \end{align*}

    Planteamos por tanto el siguiente sistema:
    \begin{equation*}
        \left.
            \begin{array}{rcl}
                \alpha_0+\alpha_1 &=& 1\\
                \alpha_1+\beta_0 + \beta_1 + \beta_2 &=& 2\\
                \alpha_1 + 2\beta_1 + 4\beta_2 &=& 4\\
                \alpha_1 + 3\beta_1+12\beta_2 &=& 8
            \end{array}
        \right\}
        \Longrightarrow
        \left\{
            \begin{array}{rcl}
                \alpha_0 &=&-12\beta_2+5\\
                \alpha_1 &=&12\beta_2-4\\
                \beta_0 &=&-5\beta_2+2\\
                \beta_1 &=&-8\beta_2+4
            \end{array}
        \right\}
    \end{equation*}

    Por tanto, la familia de MML implícitos de 2 pasos con el mayor orden posible es:
    \begin{align*}
        x_{n+2} &= (-12\beta_2 + 5)x_{n+1} + (12\beta_2 - 4)x_n + h\left((-5\beta_2+2)f_n + (-8\beta_2 + 4)f_{n+1} + \beta_2 f_{n+2}\right)
    \end{align*}

    Este MML es al menos de orden 3. Veamos el valor de $C_4$:
    \begin{align*}
        C_4 &= \dfrac{2^4}{4!} -\frac{\alpha_1}{4!} - \frac{1^3}{3!}\beta_1- \frac{2^3}{3!}\beta_2
        = \frac{2}{3} - \frac{12\beta_2-4}{24} - \frac{-8\beta_2+4}{6} - \frac{8}{6}\beta_2
        = \frac{1}{6} - \frac{\beta_2}{2}
    \end{align*}

    Por tanto, distinguimos según el valor de $\beta_2$:
    \begin{itemize}
        \item Si $\beta_2=\nicefrac{1}{3}$, el orden del MML es al menos $4$.
        \begin{align*}
            C_5 &= \dfrac{2^5}{5!} -\frac{\alpha_1}{5!} - \frac{1^4}{4!}\beta_1- \frac{2^4}{4!}\beta_2
            = \frac{4}{15} - \frac{12\cdot \nicefrac{1}{3}-4}{120} - \frac{-8\cdot \nicefrac{1}{3}+4}{24} - \frac{2\cdot \nicefrac{1}{3}}{3}
            = -\dfrac{1}{90}\neq 0
        \end{align*}

        Por tanto, el orden del MML es $4$. La parte principal del error de truncatura local es:
        \begin{align*}
            -\dfrac{1}{90}h^5\cdot x^{(5)}(t_n)
        \end{align*}
        \item Si $\beta_2\neq \nicefrac{1}{3}$, el orden del MML es $3$. La parte principal del error de truncatura local es:
        \begin{align*}
            \left(\frac{1}{6} - \frac{\beta_2}{2}\right)h^4\cdot x^{(4)}(t_n)
        \end{align*}
    \end{itemize}

    Veamos ahora qué valores de $\beta_2$ aseguran la convergencia del MML. Como ya tenemos garantizada la consistencia, estudiamos la estabilidad. Para ello, hemos de estudiar el polinomio característico:
    \begin{align*}
        p(\lm) &= \lm^2 - (12\beta_2 - 4)\lm - (-12\beta_2 + 5)
        = 0\iff \\&\iff
        \lm = \dfrac{(12\beta_2 - 4) \pm \sqrt{(12\beta_2 - 4)^2 + 4(-12\beta_2 + 5)}}{2}
        =\\&\hspace{2cm}= \dfrac{(12\beta_2 - 4) \pm 2\sqrt{4(3\beta_2 - 1)^2 + (-12\beta_2 + 5)}}{2}
        =\\&\hspace{2cm}= \dfrac{(12\beta_2 - 4) \pm 2\sqrt{4(9\beta_2^2 - 6\beta_2 + 1) -12\beta_2 + 5}}{2}
        =\\&\hspace{2cm}= 6\beta_2 - 2 \pm \sqrt{36\beta_2^2 -36\beta_2 +9}
        =\\&\hspace{2cm}= 6\beta_2 - 2 \pm 3\sqrt{4\beta_2^2 -4\beta_2 +1}
        =\\&\hspace{2cm}= 6\beta_2 - 2 \pm 3(2\beta_2 - 1)
    \end{align*}

    Por tanto, las raíces son:
    \begin{align*}
        \lm_1 &= 12\beta_2 - 5\\
        \lm_2 &= 1
    \end{align*}

    Estudiemos su módulo:
    \begin{align*}
        |\lm_1| \leq 1 &\iff -1 \leq 12\beta_2 - 5 \leq 1
        \iff 4 \leq 12\beta_2 \leq 6
        \iff \frac{1}{3} \leq \beta_2 \leq \frac{1}{2}
    \end{align*}

    En el caso de que $\beta_2 = \nicefrac{1}{3}$, tenemos que $\lm_1 = -1$, pero si $\beta_2 = \nicefrac{1}{2}$, entonces $\lm_1 = 1$, que es una raíz doble. Por tanto, el MML es convergente si y solo si $\beta_2\in \left[\nicefrac{1}{3},\nicefrac{1}{2}\right[$.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.14}
    Obtenga la ecuación en diferencias del método de Adams-Bashforth de tres pasos y la del método de Adams-Moulton de dos pasos. Estudie la convergencia y el orden de dichos métodos.\\

    El método de Adams-Bashforth de 3 pasos es:
    \begin{align*}
        x_{n+3} &= x_{n+2} + h\left(\beta_0 f_n + \beta_1 f_{n+1} + \beta_2 f_{n+2}\right)
    \end{align*}

    Puesto que tenemos $3$ incógnitas, hemos de imponer que $C_i=0$ para $i=0,1,2,3$:
    \begin{align*}
        C_0 &= 1 -1 = 0\qquad \forall \beta_0, \beta_1, \beta_2\\
        C_1 &= 3-2\cdot 1 - \beta_0 - \beta_1 - \beta_2 = 0\\
        C_2 &= \dfrac{3^2}{2!} - \dfrac{2^2}{2!} - \dfrac{1^1}{1!}\beta_1 - \dfrac{2^1}{1!}\beta_2 = \frac{5}{2} - \beta_1 - 2\beta_2 = 0\\
        C_3 &= \dfrac{3^3}{3!} - \dfrac{2^3}{3!} - \dfrac{1^2}{2!}\beta_1 - \dfrac{2^2}{2!}\beta_2 = \frac{19}{6} - \frac{\beta_1}{2} - 2\beta_2 = 0
    \end{align*}

    Planteamos el siguiente sistema:
    \begin{equation*}
        \left.
            \begin{array}{rcl}
                \beta_0 + \beta_1 + \beta_2 &=& 1\\
                2\beta_1 + 4\beta_2 &=& 5\\
                \beta_1 + 4\beta_2 &=& \nicefrac{19}{3}
            \end{array}
        \right\}
        \Longrightarrow
        \left\{
            \begin{array}{rcl}
                \beta_0 &=& \nicefrac{5}{12}\\
                \beta_1 &=& \nicefrac{-4}{3}\\
                \beta_2 &=& \nicefrac{23}{12}
            \end{array}
        \right\}
    \end{equation*}

    Por tanto, la ecuación en diferencias del método de Adams-Bashforth de 3 pasos es:
    \begin{align*}
        x_{n+3} &= x_{n+2} + h\left(\frac{5}{12} f_n - \frac{4}{3} f_{n+1} + \frac{23}{12} f_{n+2}\right)
    \end{align*}~\\

    El método de Adams-Moulton de 2 pasos es:
    \begin{align*}
        x_{n+2} &= x_{n+1} + h\left(\beta_0 f_n + \beta_1 f_{n+1}+ \beta_2 f_{n+2}\right)
    \end{align*}
    Puesto que tenemos $3$ incógnitas, hemos de imponer que $C_i=0$ para $i=0,1,2,3$:
    \begin{align*}
        C_0 &= 1 -1 = 0\qquad \forall \beta_0, \beta_1, \beta_2\\
        C_1 &= 2-1 - \beta_0 - \beta_1 - \beta_2 = 0\\
        C_2 &= \dfrac{2^2}{2!} - \dfrac{1^2}{2!} - \dfrac{1^1}{1!}\beta_1 - \dfrac{2^1}{1!}\beta_2 = \frac{3}{2} - \beta_1 - 2\beta_2 = 0\\
        C_3 &= \dfrac{2^3}{3!} - \dfrac{1^3}{3!} - \dfrac{1^2}{2!}\beta_1 - \dfrac{2^2}{2!}\beta_2 = \frac{7}{6} - \frac{\beta_1}{2} - 2\beta_2 = 0
    \end{align*}

    Planteamos el siguiente sistema:
    \begin{equation*}
        \left.
            \begin{array}{rcl}
                \beta_0 + \beta_1 + \beta_2 &=& 1\\
                \beta_1 + 2\beta_2 &=& \nicefrac{3}{2}\\
                \beta_1 + 4\beta_2 &=& \nicefrac{7}{3}\\
            \end{array}
        \right\}
        \Longrightarrow
        \left\{
            \begin{array}{rcl}
                \beta_0 &=& \nicefrac{-1}{12}\\
                \beta_1 &=& \nicefrac{2}{3}\\
                \beta_2 &=& \nicefrac{5}{12}
            \end{array}
        \right\}
    \end{equation*}

    Por tanto, la ecuación en diferencias del método de Adams-Moulton de 2 pasos es:
    \begin{align*}
        x_{n+2} &= x_{n+1} + h\left(-\frac{1}{12} f_n + \frac{2}{3} f_{n+1} + \frac{5}{12} f_{n+2}\right)
    \end{align*}
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.15}
    Usando integración numérica sobre el intervalo $[t_{n+1}, t_{n+3}]$, deduzca dos métodos lineales de tres pasos explícitos diferentes para resolver el PVI de ecuación $x' = f(t, x)$ y condición inicial $x(t_0) = \mu$. ¿Es alguno de ellos un método óptimo? Justifique la respuesta.
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.16}
    Dado el MML:
    \begin{equation*}
        x_{n+3} + \alpha (x_{n+2} - x_{n+1}) - x_n = h \frac{(3 + \alpha)}{2} (f_{n+1} + f_{n+2})
    \end{equation*}
    razone si es cierto que:
    \begin{enumerate}
        \item Para $\alpha = 9$, el orden es 4.
        
        Calculamos los $C_i$:
        \begin{align*}
            C_0 &= 1 -1 - \alpha+\alpha = 0\qquad \forall \alpha\\
            C_1 &= 3-\alpha+2\alpha - 2\cdot \dfrac{3+\alpha}{2} = 0\qquad \forall \alpha\\
            C_2 &= \dfrac{3^2}{2!} - \dfrac{1^2}{2!}\alpha + \dfrac{2^2}{2!}\alpha - \dfrac{3+\alpha}{2}\left(\dfrac{1^1}{1!} + \dfrac{2^1}{1!}\right)
            = \dfrac{9}{2} - \dfrac{\alpha}{2} + 2\alpha - \dfrac{3}{2}\cdot (3+\alpha) = 0\qquad \forall \alpha\\
            C_3 &= \dfrac{3^3}{3!} - \dfrac{1^3}{3!}\alpha + \dfrac{2^3}{3!}\alpha - \dfrac{3+\alpha}{2}\left(\dfrac{1^2}{2!} + \dfrac{2^2}{2!}\right)
            = \frac{9}{2} - \frac{\alpha}{6} + \frac{4\alpha}{3} - \frac{3+\alpha}{2}\cdot \dfrac{5}{2}
            =\\&=\frac{3}{4} - \frac{\alpha}{12} = 0\iff \alpha = 9\\
            C_4 &= \dfrac{3^4}{4!} - \dfrac{1^4}{4!}\alpha + \dfrac{2^4}{4!}\alpha - \dfrac{3+\alpha}{2}\left(\dfrac{1^3}{3!} + \dfrac{2^3}{3!}\right)
            = \frac{9}{8} - \frac{\alpha}{24} =0\iff \alpha = 27
        \end{align*}

        Por tanto, el orden del MML es $3$ para $\alpha = 9$.
        \item Si $-3 < \alpha < 1$, el método es cero-estable.
        
        Calculamos su polinomio característico:
        \begin{align*}
            p(\lm) &= \lm^3 + \alpha (\lm^2 - \lm) - 1
            = (\lm - 1)(\lm^2 + (\alpha + 1)\lm + 1)
        \end{align*}

        Una de sus raíces es $\lm = 1$. Veamos las otras dos raíces:
        \begin{align*}
            \dfrac{-(\alpha + 1) \pm \sqrt{(\alpha + 1)^2 - 4}}{2}
            = \dfrac{-(\alpha + 1) \pm \sqrt{\alpha^2 + 2\alpha - 3}}{2}
        \end{align*}

        Tenemos que $\alpha^2 + 2\alpha - 3\leq 0$ para todo $\alpha\in \left]-3,1\right[$, por lo que las raíces son complejas conjugadas. Estas son:
        \begin{align*}
            \lm_{1,2} &= \dfrac{-(\alpha + 1)}{2} \pm i \dfrac{\sqrt{3 - \alpha^2 - 2\alpha}}{2}
        \end{align*}

        El módulo de estas raíces es:
        \begin{align*}
            |\lm_{1,2}| &= \dfrac{(\alpha+1)^2 + 3-\alpha^2-2\alpha}{4}=1
        \end{align*}

        Por tanto, las raíces del polinomio característico son de módulo 1, y tienen multiplicidad simple, por lo que el MML es cero-estable.

        \item Si el MML dado es convergente, su orden es exactamente 2.
        
        Hemos visto que el orden del MML es al menos $2$ para cualquier valor de $\alpha$; y es exactamente $2$ para todo $\alpha\neq 9$. Veamos que, si es convergente, no se puede dar que $\alpha = 9$.

        Si el MML es convergente, entonces su polinomio característico ha de ser estable. Como hemos visto, el polinomio característico es:
        \begin{align*}
            p(\lm) &= (\lm - 1)(\lm^2 + (\alpha + 1)\lm + 1)
        \end{align*}
        Si $\alpha = 9$, entonces el polinomio característico es:
        \begin{align*}
            p(\lm) &= (\lm - 1)(\lm^2 + 10\lm + 1)
        \end{align*}
        Las raíces de este polinomio son:
        \begin{align*}
            \lm_{1,2} &= \dfrac{-10 \pm \sqrt{100 - 4}}{2} = -5 \pm 2\sqrt{6}
        \end{align*}

        Como $-5 -2\sqrt{6} < -1$, tenemos que $|\lm_2| > 1$, por lo que al menos una de sus raíces es de módulo mayor que 1, y por tanto el MML no es convergente. Por tanto, si el MML es convergente, su orden es exactamente $2$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:3.1.17}
    Para que un MML sea estable es necesario que las raíces del primer polinomio característico $p(\lm)$ sean de módulo no mayor que 1, y todas las de módulo 1 sean simples. Cualquier MML ya tiene la raíz $\lm = 1$ entre las de su primer polinomio característico. Podemos afinar algo más distinguiendo los MML que no tienen ninguna otra raíz de módulo 1, de aquellos en los que hay más de una raíz de módulo 1. Los primeros se denominan \emph{fuertemente estables} y los segundos \emph{débilmente estables}.
    \begin{enumerate}
        \item Compruebe que el método Adams-Bashforth de 4 pasos es fuertemente estable:
        \begin{equation*}
            x_{n+1} = x_n + \frac{h}{24} (-9 f_{n-3} + 37 f_{n-2} - 59 f_{n-1} + 55 f_n)
        \end{equation*}

        Notemos que esta notación no nos sirve para trabajar con el método. Este método en realidad es:
        \begin{equation*}
            x_{n+4} = x_{n+3} + \frac{h}{24} (-9 f_{n} + 37 f_{n+1} - 59 f_{n+2} + 55 f_{n+3})
        \end{equation*}

        El polinomio característico del método es:
        \begin{equation*}
            p(\lm) = \lm^4-\lm^3 = \lm^3(\lm-1)
        \end{equation*}

        Sus raíces son $\lm = 0$ (de multiplicidad $3$) y $\lm = 1$ (de multiplicidad $1$). Como el único valor de módulo $1$ es $1$ y tiene multiplicidad $1$, el MML es fuertemente estable.
        \item Compruebe que la fórmula abierta de 4 pasos es débilmente estable:
        \begin{equation*}
            x_{n+1} = x_{n-3} + \frac{4h}{3} (2 f_{n-2} - f_{n-1} + 2 f_n)
        \end{equation*}

        De nuevo, esta notación no nos sirve para trabajar con el método. Este método en realidad es:
        \begin{equation*}
            x_{n+4} = x_{n} + \frac{4h}{3} (2 f_{n+1} - f_{n+2} + 2 f_{n+3})
        \end{equation*}

        El polinomio característico del método es:
        \begin{equation*}
            p(\lm) = \lm^4 - 1 \iff \lm\in \{1,-1,i,-i\}
        \end{equation*}

        Todas sus raíces son de módulo $1$ y simples, luego el MML es débilmente estable.
        \item (Práctica) Considere el PVI $x' = -6x + 6$, $0 \leq t \leq 1$, $x(0) = 2$, que tiene como solución exacta $x(t) = 1 + e^{-6t}$. Con $h = 0.1$ y valores iniciales exactos $x_0$, $x_1$, $x_2$, $x_3$, aproxime $x(1)$ con las dos fórmulas anteriores, incluyendo los errores acumulados en cada paso para ambos métodos. Comente los resultados.
    \end{enumerate}
\end{ejercicio}
