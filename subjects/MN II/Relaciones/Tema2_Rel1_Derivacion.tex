\subsection{Relación 1. Derivación Numérica}
\setcounter{ejercicio}{0}


\begin{ejercicio}\label{ej:2.1.1}~
    \begin{enumerate}
        \item Use el método interpolatorio para obtener la fórmula de diferencia progresiva en dos nodos para aproximar $f'(a)$. ¿Cuál es el grado de exactitud de dicha fórmula? Justifique la respuesta.
        
        \item Utilice la fórmula de Taylor para hallar la fórmula mencionada en el apartado anterior y la expresión de su error cuando $f'' \in C^2[a, a + h]$.
        
        \item Use el método interpolatorio para obtener la fórmula de diferencia centrada en dos nodos para aproximar $f'(a)$. ¿Cuál es el grado de exactitud de dicha fórmula? Justifique la respuesta.
        
        \item Utilice la fórmula de Taylor para hallar la fórmula mencionada en el apartado anterior y la expresión de su error cuando $f'' \in C^3[a - h, a + h]$.
    \end{enumerate}    
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.2}
    Usando el método de los coeficientes indeterminados deduzca la fórmula de diferencia centrada en tres nodos para aproximar $f'(a)$ y compruebe que coincide con la fórmula de diferencia centrada en dos nodos.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.3}
    Obtenga la fórmula de diferencia progresiva en tres nodos para aproximar $f'(a)$ calculando directamente sus coeficientes mediante la base de Lagrange del problema de interpolación unisolvente asociado a dicha fórmula. Halle la expresión del error para esta fórmula cuando $f \in C^4[a, a + 2h]$.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.4}
    Se considera la fórmula de tipo interpolatorio en $\bb{P}_n$ siguiente:
    \[
    f''(c) \approx \alpha_0 f(x_0) + \alpha_1 f(x_1) + \cdots + \alpha_n f(x_n)
    \]
    con $x_0 < x_1 < \cdots < x_n$. Demuestre que si $f \in C^{n+3}[a, b]$ con $[a, b]$ tal que $x_0, x_1, \ldots, x_n, c \in [a, b]$, entonces
    \[
    R(f) = 2\cdot \frac{f^{(n+3)}(\xi_2)}{(n + 3)!}\Pi(c) + 2\cdot \frac{f^{(n+2)}(\xi_1)}{(n + 2)!}\Pi'(c) + \frac{f^{(n+1)}(\xi_0)}{(n + 1)!}\Pi''(c)
    \]
    siendo $\xi_0, \xi_1, \xi_2 \in \left] \min\{x_0, c\}, \max\{x_n, c\} \right[$ y $\Pi(x) = \prod\limits_{i=0}^{n}(x - x_i)$.\\

    Sabemos que el error cometido con la interpolación de $f$ en los nodos $x_0, x_1, \ldots, x_n$ mediante $p\in \bb{P}_n$ es:
    \[
    E(x) = f(x)-p(x)= f[x_0, x_1, \ldots, x_n, x]\Pi(x)
    \]

    Calculemos cada una de las derivadas de $E(x)$:
    \begin{align*}
        E'(x) &= f[x_0, x_1, \ldots, x_n, x,x]\Pi(x) + f[x_0, x_1, \ldots, x_n, x]\Pi'(x)\\
        E''(x) &= 2f[x_0, x_1, \ldots, x_n, x,x,x]\Pi(x) + 2f[x_0, x_1, \ldots, x_n, x,x]\Pi'(x) + f[x_0, x_1, \ldots, x_n, x]\Pi''(x)
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        R(f) &= L(f-p)=L(E)=E''(c)
        =\\&= 2f[x_0, x_1, \ldots, x_n, c,c,c]\Pi(c) + 2f[x_0, x_1, \ldots, x_n, c,c]\Pi'(c) + f[x_0, x_1, \ldots, x_n, c]\Pi''(c)
        =\\&= 2\cdot \frac{f^{(n+3)}(\xi_2)}{(n + 3)!}\Pi(c) + 2\cdot \frac{f^{(n+2)}(\xi_1)}{(n + 2)!}\Pi'(c) + \frac{f^{(n+1)}(\xi_0)}{(n + 1)!}\Pi''(c)
    \end{align*}
    con $\xi_0, \xi_1, \xi_2 \in \left] \min\{x_0, c\}, \max\{x_n, c\} \right[$, donde hemos empleado que los nodos están ordenados; es decir, $x_0<x_1<\cdots<x_n$.

\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.5}
    Use el método de los coeficientes indeterminados para obtener la fórmula de diferencia regresiva en tres nodos para aproximar $f''(a)$. Halle la expresión del error de truncamiento para esta fórmula cuando $f \in C^5[a - 2h, a]$.\\
    
    Sabemos que la fórmula de diferencia regresiva en tres nodos para aproximar $f''(a)$ es de la forma:
    \[
    f''(a) \approx \alpha_0 f(a - 2h) + \alpha_1 f(a - h) + \alpha_2 f(a)
    \]
    donde $\alpha_0, \alpha_1, \alpha_2$ son los coeficientes que debemos determinar. Para ello, imponemos exactitud en $\bb{P}_2$:
    \begin{align*}
        0 &= \alpha_0 + \alpha_1 + \alpha_2\\
        0 &= (a-2h)\alpha_0 + (a-h)\alpha_1 + a\alpha_2\\
        2 &= (a-2h)^2\alpha_0 + (a-h)^2\alpha_1 + a^2\alpha_2
    \end{align*}

    Equivalentemente:
    \begin{align*}
        0 &= \alpha_0 + \alpha_1 + \alpha_2\\
        0 &= a\left(\alpha_0 + \alpha_1 + \alpha_2\right) - 2h\alpha_0 - h\alpha_1\\
        2 &= a^2\left(\alpha_0 + \alpha_1 + \alpha_2\right) +4h^2\alpha_0 + h^2\alpha_1 - 4ah\alpha_0 - 2ah\alpha_1
    \end{align*}

    Equivalentemente:
    \begin{align*}
        0 &= \alpha_0 + \alpha_1 + \alpha_2\\
        0 &= h(2\alpha_0 + \alpha_1)\\
        2 &= 2h^2\alpha_0 + h^2(2\alpha_0+\alpha_1) -2ah(2\alpha_0+\alpha_1)
    \end{align*}

    Equivalentemente:
    \begin{equation*}
        \left\{
            \begin{array}{rl}
                0 &= \alpha_0 + \alpha_1 + \alpha_2\\
                0 &= 2\alpha_0 + \alpha_1\\
                1 &= h^2\alpha_0
            \end{array}
        \right\}
        \quad\Longrightarrow\quad
        \left\{
            \begin{array}{rl}
                \alpha_0 &= \nicefrac{1}{h^2}\\
                \alpha_1 &= -2\alpha_0 = \nicefrac{-2}{h^2}\\
                \alpha_2 &= -\alpha_0 - \alpha_1 = \alpha_0 = \nicefrac{1}{h^2}
            \end{array}
        \right\}
    \end{equation*}

    Por tanto, la fórmula de diferencia regresiva en tres nodos para aproximar $f''(a)$ es:
    \[
    f''(a) \approx \frac{1}{h^2}f(a - 2h) - \frac{2}{h^2}f(a - h) + \frac{1}{h^2}f(a)
    \]

    Para el error, definimos:
    \begin{align*}
        \Pi(x) &= \prod_{i=0}^{2}(x - (a - ih)) = (x - a + 2h)(x - a + h)(x - a)\\
        \Pi'(x) &= (x-a+h)(x-a) + (x-a+2h)(x-a) + (x-a+2h)(x-a+h)\\
        \Pi''(x) &= 2(x-a) + 2(x-a+h) + 2(x-a+2h)
    \end{align*}

    Por el Ejercicio~\ref{ej:2.1.4}, puesto que $f \in C^5[a - 2h, a]$, tenemos que:
    \begin{align*}
        R(f) &= 2\cdot \frac{f^{(5)}(\xi_2)}{5!}\cancelto{0}{\Pi(a)} + 2\cdot \frac{f^{(4)}(\xi_1)}{4!}\Pi'(a) + \frac{f^{(3)}(\xi_0)}{3!}\Pi''(a)
        =\\&=2\cdot 2h^2\cdot \frac{f^{(4)}(\xi_1)}{4!} + 6h\cdot \frac{f^{(3)}(\xi_0)}{3!}
        =\\&=h^2\cdot \frac{f^{(4)}(\xi_1)}{6} + h\cdot f^{(3)}(\xi_0)
    \end{align*}
    con $\xi_0, \xi_1, \xi_2 \in \left] a-2h, a \right[$.
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.6}
    Use la fórmula de Taylor para obtener, cuando $f \in C^4[a - h, a + h]$, la fórmula de diferencia centrada en tres nodos para aproximar $f''(a)$ y la expresión de su error. ¿Cuál es el orden de precisión de esta fórmula? ¿Por qué?
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.7}~
    \begin{enumerate}
        \item Halle la fórmula de tipo interpolatorio en $P_2$ de la forma
        \[
        f'(a) \approx \alpha_0 f(a - h_1) + \alpha_1 f(a) + \alpha_2 f(a + h_2)
        \]
        con $h_1, h_2 > 0$, así como la expresión de su error de truncamiento cuando $f \in C^4[a - h_1, a + h_2]$. ¿Cuál es el grado de exactitud de esta fórmula? Justifique la respuesta.
        
        \item Use la tabla de valores
        \begin{center}
            \begin{tabular}{c|c}
                $x$ & $f(x)$ \\
                \hline
                $0.7$ & $-0.1$ \\
                $1.25$ & $0.2$ \\
                $1.5$ & $0.3$ \\
                $1.75$ & $0.25$
            \end{tabular}
        \end{center}
        para dar valores aproximados de $f'(0.7)$, $f'(1.25)$, $f'(1.5)$ y $f'(1.75)$ utilizando para cada uno de ellos la fórmula de derivación numérica más adecuada. Indique la fórmula usada en cada caso y justifique su uso.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:2.1.8}
    Halle una cota del valor absoluto del error que se comete al aproximar la derivada de la función $f(x) = \cos^2 x$ en $x = 0.8$ mediante la correspondiente fórmula de derivación numérica de tipo interpolatorio que usa los valores de $f$ en los puntos $0.6$, $0.8$ y $1$.
\end{ejercicio}