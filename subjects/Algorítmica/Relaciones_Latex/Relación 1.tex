\section{La eficiencia de los algoritmos}

\begin{ejercicio}
    Demostrar las siguientes propiedades:
    \begin{enumerate}[label=\alph*)]
        \item $k\cdot f(n) \in O(f(n)), \qquad \forall k > 0$.
        
        Hemos de ver que existe una constante $c\in \bb{R}^+,~n_0\in \bb{N}$ tal que $k\cdot f(n) \leq c\cdot f(n)$ para todo $n\geq n_0$.
        En este caso, podemos tomar $c=k$ y $n_0=1$ y se tiene que $k\cdot f(n) \leq k\cdot f(n)$ para todo $n\in \bb{N}$.
        
        \item $n^r\in O(n^k)$ si $0\leq r \leq k$.
        
        Hemos de ver que existe una constante $c\in \bb{R}^+,~n_0\in \bb{N}$ tal que $n^r \leq c\cdot n^k$ para todo $n\geq n_0$.

        Como $0\leq r \leq k$, entonces $n^r \leq n^k$ para todo $n\in \bb{N}$, por lo que podemos tomar $c=1$ y $n_0=1$.

        \item $O(n^k) \subset O(n^{k+1})$.
        
        Sea $f(n)\in O(n^k)$; es decir, existe una constante $c\in \bb{R}^+,~n_0\in \bb{N}$ tal que $f(n)\leq c\cdot n^k$ para todo $n\geq n_0$.
        Hemos de ver que $f(n)\in O(n^{k+1})$; es decir, que existe una constante $c'\in \bb{R}^+,~n_0'\in \bb{N}$ tal que $f(n)\leq c'\cdot n^{k+1}$ para todo $n\geq n_0'$.

        Tomando $c'=c$ y $n_0'=n_0$, se tiene que $f(n)\leq c\cdot n^k\leq c\cdot n^{k+1}$ para todo $n\geq n_0$, por lo que $f(n)\in O(n^{k+1})$.

        \item $n^k\in O(b^n) \quad \forall b>1,k\geq 0$.
        
        Hemos de ver que existe una constante $c\in \bb{R}^+,~n_0\in \bb{N}$ tal que $n^k \leq c\cdot b^n$ para todo $n\geq n_0$.
        Tomando $c=1$, tenemos que dicho valor de $n_0$ existe, ya que:
        \begin{equation*}
            \lim_{n\to\infty} \frac{n^k}{b^n} = 0
        \end{equation*}


        \item $\log_b n \in O(n^k) \quad \forall b>1,k>0$.
        
        Hemos de ver que existe una constante $c\in \bb{R}^+,~n_0\in \bb{N}$ tal que $\log_b n \leq c\cdot n^k$ para todo $n\geq n_0$.
        Tomando $c=1$, tenemos que dicho valor de $n_0$ existe, ya que:
        \begin{equation*}
            \lim_{n\to\infty} \frac{\log_b n}{n^k} = 0
        \end{equation*}

        \item Si $f(n)\in O(g(n))$ y $h(n)\in O(g(n))$, entonces $f(n)+h(n)\in O(g(n))$.
        
        Tenemos que:
        \begin{align*}
            f(n)\in O(g(n)) &\Longrightarrow \exists c_1\in \bb{R}^+,~n_1\in \bb{N} \text{ tal que } f(n)\leq c_1\cdot g(n) \quad \forall n\geq n_1, \\
            h(n)\in O(g(n)) &\Longrightarrow \exists c_2\in \bb{R}^+,~n_2\in \bb{N} \text{ tal que } h(n)\leq c_2\cdot g(n) \quad \forall n\geq n_2.
        \end{align*}

        Tomando $c=c_1+c_2$ y $n_0=\max\{n_1,n_2\}$, se tiene que:
        \begin{equation*}
            f(n)+h(n)\leq c_1\cdot g(n) + c_2\cdot g(n) = (c_1+c_2)\cdot g(n) \quad \forall n\geq n_0,
        \end{equation*}
        
        \item Si $f(n)\in O(g(n))$, entonces $f(n)+g(n)\in O(g(n))$.
        
        Por el primer apartado, sabemos que $g(n)\in O(g(n))$.
        Por tanto, usando el apartado anterior, se tiene que $f(n)+g(n)\in O(g(n))$.

        \item \emph{Reflexividad}: $f(n)\in O(f(n))$.
        
        Se tiene de forma directa por el primer apartado tomando $k=1$.

        \item \emph{Transitividad}: Si $f(n)\in O(g(n))$ y $g(n)\in O(h(n))$, entonces $f(n)\in O(h(n))$.
        
        Tenemos que:
        \begin{align*}
            f(n)\in O(g(n)) &\Longrightarrow \exists c_1\in \bb{R}^+,~n_1\in \bb{N} \text{ tal que } f(n)\leq c_1\cdot g(n) \quad \forall n\geq n_1, \\
            g(n)\in O(h(n)) &\Longrightarrow \exists c_2\in \bb{R}^+,~n_2\in \bb{N} \text{ tal que } g(n)\leq c_2\cdot h(n) \quad \forall n\geq n_2.
        \end{align*}

        Por tanto, tomando $c=c_1\cdot c_2$ y $n_0=\max\{n_1,n_2\}$, se tiene que:
        \begin{equation*}
            f(n)\leq c_1\cdot g(n) \leq c_1\cdot c_2\cdot h(n) = c\cdot h(n) \quad \forall n\geq n_0,
        \end{equation*}

        \item \emph{Regla de la suma}: Si $T1(n)$ es $O(f(n))$ y $T2(n)$ es $O(g(n))$, entonces: $$T1(n)+T2(n)\in O(\max\{f(n),g(n)\}).$$
        
        Tenemos que:
        \begin{align*}
            T1(n)\in O(f(n)) &\Longrightarrow \exists c_1\in \bb{R}^+,~n_1\in \bb{N} \text{ tal que } T1(n)\leq c_1\cdot f(n) \quad \forall n\geq n_1, \\
            T2(n)\in O(g(n)) &\Longrightarrow \exists c_2\in \bb{R}^+,~n_2\in \bb{N} \text{ tal que } T2(n)\leq c_2\cdot g(n) \quad \forall n\geq n_2.
        \end{align*}

        Tomando $c=\max\{c_1,c_2\}$ y $n_0=\max\{n_1,n_2\}$, se tiene que:
        \begin{equation*}
            T1(n)+T2(n)\leq c_1\cdot f(n) + c_2\cdot g(n) \leq c\cdot \max\{f(n),g(n)\} \quad \forall n\geq n_0,
        \end{equation*}

        \item \emph{Regla del producto}: Si $T1(n)$ es $O(f(n))$ y $T2(n)$ es $O(g(n))$, entonces: $$T1(n)\cdot T2(n)\in O(f(n)\cdot g(n)).$$
        
        Tenemos que:
        \begin{align*}
            T1(n)\in O(f(n)) &\Longrightarrow \exists c_1\in \bb{R}^+,~n_1\in \bb{N} \text{ tal que } T1(n)\leq c_1\cdot f(n) \quad \forall n\geq n_1, \\
            T2(n)\in O(g(n)) &\Longrightarrow \exists c_2\in \bb{R}^+,~n_2\in \bb{N} \text{ tal que } T2(n)\leq c_2\cdot g(n) \quad \forall n\geq n_2.
        \end{align*}

        Tomando $c=c_1\cdot c_2$ y $n_0=\max\{n_1,n_2\}$, se tiene que:
        \begin{equation*}
            T1(n)\cdot T2(n)\leq c_1\cdot f(n) \cdot c_2\cdot g(n) = c\cdot f(n)\cdot g(n) \quad \forall n\geq n_0,
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Expresar, en notación $O(\cdot)$, el orden que tendrí un algoritmo cuyo tiempo de ejecución fuera $f_i(n)$, donde:
    \begin{enumerate}
        \item $f_1(n) = n^2$
        
        En este caso se tiene que $f_1(n)\in O(n^2)$.
        \item $f_2(n) = n^2+1000n$
        
        En este caso, por la regla de la suma, se tiene que $f_2(n)\in O(n^2)$.

        \item $f_3(n) = \begin{cases}
            n & \text{si } n \text{ es par} \\
            n^3 & \text{si } n \text{ es impar}
        \end{cases}$

        En este caso, como $n^3\geq n$ para todo $n\geq 1$, se tiene que $f_3(n)\in O(n^3)$.
        \item $f_n4(n)=\begin{cases}
            n & \text{si } n\leq 100 \\
            n^3 & \text{si } n > 100
        \end{cases}$

        En este caso, como se trata de comportamientos asintóticos, se tiene que $f_4(n)\in O(n^3)$.

        \item $f_5(n) = (n-1)^3$
        
        En este caso, por la regla de la suma, se tiene que $f_5(n)\in O(n^3)$.
        \item $f_6(n) = \sqrt{n^2-1}$.
        
        En este caso, como $\sqrt{n^2-1}\leq n$ para todo $n\geq 1$, se tiene que $f_6(n)\in O(n)$.

        \item $f_7(n) = \log(n!)$
        
        Por el Criterio de Stolz, se tiene que:
        \begin{equation*}
            \left\{\frac{\log(n!)}{n \log n}\right\}
            = \left\{\frac{\log(n+1)}{(n+1)\log(n+1)-n\log n}\right\}
            = \left\{\frac{1}{n+1-n\cdot \frac{\log(n)}{\log(n+1)}}\right\} \to \frac{1}{n+1-n}=1
        \end{equation*}

        Por tanto, tenemos que $\log(n!)\in O(n\log n)$.

        \item $f_8(n) = n!$
        
        Claramente, $f_8(n)\in O(n!)$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3}
    Usando la notación $O(\cdot)$, obtener el tiempo de ejecución de las siguientes funciones:
    \begin{enumerate}
        \item \label{ej:1.3.a} Código Fuente \ref{lst:1.3.a} (\verb|ejemplo1|).
        \begin{listing}[H]
            \begin{minted}[linenos,xleftmargin=3cm]{c++}
void ejemplo1 (int n)
{
    int i, j, k;

    for (i = 0; i < n; i++)
        for (j = 0; j < n; j++)
        {
            C[i][j] = 0;
            for (k = 0; k < n; k++)
                C[i][j] += A[j][k] * B[k][j];
        }
}
            \end{minted}
            \caption{Función del Ejercicio \ref{ej:1.3} apartado \ref{ej:1.3.a}.}
            \label{lst:1.3.a}
        \end{listing}

        En este caso, el tiempo de ejecución de la linea 10 lo podemos acotar por una constante, sea esta $c$.
        Entonces, tenemos que el tiempo de ejecución de la función \verb|ejemplo1| es:
        \begin{align*}
            T(n)&=\sum_{i=0}^{n-1} \sum_{j=0}^{n-1} \left(1+ \sum_{k=0}^{n-1} c\right)
            = \sum_{i=0}^{n-1} \sum_{j=0}^{n-1} (1+c\cdot (n-1-0+1))
            = \sum_{i=0}^{n-1} \sum_{j=0}^{n-1} (1+c\cdot n)
            =\\&= n^2\cdot (1+c\cdot n) \in O(n^3)
        \end{align*}

        Se trata del algoritmo de multiplicación de matrices, cuyo tiempo de ejecución es $O(n^3)$.

        \item \label{ej:1.3.b} Código Fuente \ref{lst:1.3.b} (\verb|ejemplo2|).
        \begin{listing}[H]
            \begin{minted}[linenos,xleftmargin=3cm]{c++}
long ejemplo2 (int n)
{
    int i, j, k;
    long total = 0;

    for (i = 0; i < n; i++)
        for (j = i+1; j <= n; j++)
            for (k = 1; k <= j; k++)
                total += k*i;

    return total;
}
            \end{minted}
            \caption{Función del Ejercicio \ref{ej:1.3} apartado \ref{ej:1.3.b}.}
            \label{lst:1.3.b}
        \end{listing}

        En este caso, el tiempo de ejecución de la linea 9 lo podemos acotar por una constante, sea esta $c$.
        Entonces, tenemos que el tiempo de ejecución de la función \verb|ejemplo2| es:
        \begin{align*}
            T(n)&= 1 + \sum_{i=0}^{n-1} \sum_{j=i+1}^{n} \sum_{k=1}^{j} c
            = 1 + \sum_{i=0}^{n-1} \sum_{j=i+1}^{n} c\cdot (j-1+1)
            = 1 + \sum_{i=0}^{n-1} \sum_{j=i+1}^{n} c\cdot j
            =\\&= 1 + \sum_{i=0}^{n-1} c\cdot \left(\frac{n(n+1)}{2} - \frac{i(i+1)}{2}\right)
            = 1 + cn\cdot \frac{n(n+1)}{2} - c\cdot \sum_{i=0}^{n-1} \frac{i(i+1)}{2} =\\
            &= 1 + cn\cdot \frac{n(n+1)}{2} - \frac{c}{2}\sum_{i=0}^{n-1} i^2 - \frac{c}{2}\sum_{i=0}^{n-1} i =\\
            &= 1 + cn\cdot \frac{n(n+1)}{2} - \frac{c}{2}\cdot \frac{(n-1)n(2(n-1)+1)}{6} - \frac{c}{2}\cdot \frac{(n-1)n}{2} \in O(n^3)
        \end{align*}

        Por tanto, el tiempo de ejecución de la función \verb|ejemplo2| es $O(n^3)$.

        \item \label{ej:1.3.c} Código Fuente \ref{lst:1.3.c} (\verb|ejemplo3|).
        \begin{listing}[H]
            \begin{minted}[linenos,xleftmargin=3cm]{c++}
void ejemplo3 (int n)
{
    int i, j, x=0, y=0;

    for (i = 1; i <= n; i++)
        if (i % 2 == 1)
        {
            for (j = i; j <= n; j++)
                x++;
            for (j = 0; j < i; j++)
                y++;
        }
}
            \end{minted}
            \caption{Función del Ejercicio \ref{ej:1.3} apartado \ref{ej:1.3.c}.}
            \label{lst:1.3.c}
        \end{listing}

        Tenemos que:
        \begin{align*}
            T(n)&= 1 + \sum_{i=1}^{n} \left(2 + \sum_{j=i}^{n} 1 + \sum_{j=0}^{i-1} 1\right)
            = 1 + \sum_{i=1}^{n} \left(2 + (n-i+1) + i\right)
            =\\&= 1 + \sum_{i=1}^{n} (n+3) = 1 + n(n+3) \in O(n^2)
        \end{align*}

        Por tanto, el tiempo de ejecución de la función \verb|ejemplo3| es $O(n^2)$.

        \item \label{ej:1.3.d} Código Fuente \ref{lst:1.3.d} (\verb|ejemplo4|).
        \begin{listing}[H]
            \begin{minted}[linenos,xleftmargin=3cm]{c++}
int ejemplo4 (int n)
{
    if (n <= 1)
        return 1;
    else
        return (ejemplo4(n - 1) + ejemplo4(n-1));
}
            \end{minted}
            \caption{Función del Ejercicio \ref{ej:1.3} apartado \ref{ej:1.3.d}.}
            \label{lst:1.3.d}
        \end{listing}

        \item \label{ej:1.3.e} Código Fuente \ref{lst:1.3.e} (\verb|ejemplo5|).
        \begin{listing}[H]
            \begin{minted}[linenos,xleftmargin=3cm]{c++}
int ejemplo5 (int n)
{
    if (n == 1)
        return n;
    else
        return (ejemplo5(n/2) + 1);
}
            \end{minted}
            \caption{Función del Ejercicio \ref{ej:1.3} apartado \ref{ej:1.3.e}.}
            \label{lst:1.3.e}
        \end{listing}
    \end{enumerate}
\end{ejercicio}


\begin{ejercicio}
    Resolver las siguientes recurrencias:
    \begin{enumerate}[label=\alph*)]
        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            2T(n-1) + 1 & \text{en otro caso}
        \end{cases}$

        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            2T(n-1) + n & \text{en otro caso}
        \end{cases}$

        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            1 & \text{si } n = 1 \\
            T(n-1) + T(n-2) & \text{en otro caso}
        \end{cases}$

        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            1 & \text{si } n = 1 \\
            3T(n-1) + 4T(n-2) & \text{en otro caso}
        \end{cases}$

        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            1 & \text{si } n = 1 \\
            5T(n-1) - 8T(n-2) +4T(n-3)& \text{en otro caso}
        \end{cases}$

        \item $T(n) = \begin{cases}
            0 & \text{si } n = 0 \\
            36 & \text{si } n = 1 \\
            5T(n-1) + 6T(n-2) + 4\cdot 3^n & \text{en otro caso}
        \end{cases}$

        \item $T(n)=2T(n-1) + 3^n$.
        \item $T(n)=2T(n-1) + n+2^n$.
        \item $T(n)=2T\left(\nicefrac{n}{2}\right) + \log n$.
        \item $T(n)=4T\left(\nicefrac{n}{2}\right) + n$.
        \item $T(n)=4T\left(\nicefrac{n}{2}\right) + n^2$.
        \item $T(n)=2T\left(\nicefrac{n}{2}\right) + n\log n$.
        \item $T(n) = \begin{cases}
            1 & \text{si } n = 2 \\
            2T\left(\sqrt{n}\right) + \log n & \text{si } n \geq 4
        \end{cases}$

        \item $T(n) = \begin{cases}
            1 & \text{si } n = 2 \\
            2T\left(\sqrt{n}\right) + \log \log n & \text{si } n \geq 4
        \end{cases}$

        \item[o)] $T(n) = \begin{cases}
            1 & \text{si } n = 1 \\
            5T\left(\nicefrac{n}{2}\right) + (n\log n)^2 & \text{si } n \geq 2
        \end{cases}$

        \item[p)] $T(n)=\sqrt{n} T\left(\sqrt{n}\right) + n,\qquad n\geq 4$.
        \item[q)] $T(n)=\begin{cases}
            6 & \text{si } n=1 \\
            nT^2\left(\nicefrac{n}{2}\right) & \text{si } n>1
        \end{cases}$.

        \item[r)] $T(n) = \begin{cases}
            1 & \text{si } n = 1 \\
            4 & \text{si } n = 2 \\
            T\left(\nicefrac{n}{2}\right) \cdot T^2\left(\nicefrac{n}{2}\right) & \text{si } n \geq 4
        \end{cases}$
    \end{enumerate}
\end{ejercicio}


\begin{ejercicio}
    El tiempo de ejecución de un Algotimo $A$ viene descrito por la recurrencia
    \begin{equation*}
        T(n)=7T\left(\nicefrac{n}{2}\right) + n^2
    \end{equation*}

    Otro algoritmo $B$ tiene un tiempo de ejecución descrito por la recurrencia
    \begin{equation*}
        T'(n)=aT'\left(\nicefrac{n}{4}\right) + n^2
    \end{equation*}

    ¿Cuál es el mayor valor de la constante $a\in \bb{R}$ que hace al algoritmo $B$ asintóticamente más eficiente que $A$?
\end{ejercicio}


\begin{ejercicio}
    Resuelva la siguiente recurrencia:
    \begin{equation*}
        T(n)=aT\left(\frac{n}{b}\right)+n^k
    \end{equation*}
    con $a,b,k\in \bb{R}$, $a\geq 1,~b\geq 2,~k\geq 0$.
\end{ejercicio}