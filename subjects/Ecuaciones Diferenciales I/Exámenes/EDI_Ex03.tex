\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}


\begin{document}

    % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{ffccA4.jpg}{Ecuaciones\\Diferenciales I\\Examen III}{Ecuaciones Diferenciales I. Examen III}{MidnightBlue}{-8}{28}{2024-2025}{Arturo Olivares Martos}

    \begin{description}
        \item[Asignatura] Ecuaciones Diferenciales I
        \item[Curso Académico] 2023-24.
        \item[Grado] Doble Grado en Ingeniería Informática y Matemáticas.
        \item[Grupo] Único.
        \item[Profesor] Rafael Ortega Ríos.
        \item[Descripción] Primer parcial.
        \item[Fecha] 31 de octubre de 2023.
        \item[Duración] 120 minutos.
    
    \end{description}
    \newpage
    

    \begin{ejercicio}
        Pruebe que la siguiente ecuación define una única función implícita $x: \bb{R} \to \bb{R}$, $t \mapsto x(t)$:
        \begin{equation*}
            e^x + x^3 + t = 0
        \end{equation*}
        Pruebe además que la función $x(t)$ es decreciente.\\

        Para que la ecuación anterior defina una única función implícita, hemos de ver que, para cada $t\in\bb{R}$, la ecuación $e^x + x^3 + t = 0$ tiene una única solución.
        Demostremos por tanto la existencia y unicidad de la solución de la ecuación anterior.
        \begin{description}
            \item[Existencia] 
            Definimos:
            \Func{f_t}{\bb{R}}{\bb{R}}{x}{e^x + x^3 + t}

            Tenemos que:
            \begin{equation*}
                \lim_{x\to-\infty} f_t(x) = -\infty, \quad \lim_{x\to+\infty} f_t(x) = +\infty
            \end{equation*}

            Como $f_t$ es continua, por el Teorema de Bolzano tenemos que existe $x_t\in\bb{R}$ tal que $f_t(x_t) = 0$. Por tanto, la ecuación $e^x + x^3 + t = 0$ tiene solución para cada $t\in\bb{R}$.

            \item[Unicidad]
            
            Como $f_t$ es derivable, tenemos que:
            \begin{equation*}
                f_t'(x) = e^x + 3x^2 > 0, \quad \forall x\in\bb{R}
            \end{equation*}

            Por tanto, $f_t$ es estrictamente creciente, por lo que es inyectiva. Por tanto, la ecuación $e^x + x^3 + t = 0$ tiene una única solución $x_t$ para cada $t\in\bb{R}$.
        \end{description}
            
        Sea entonces la función implícita la siguiente:
        \Func{x}{\bb{R}}{\bb{R}}{t}{x_t}

        Para probar que $x(t)$ es decreciente, podemos hacerlo de dos formas:
        \begin{description}
            \item[Opción 1] Sea $t_1, t_2\in\bb{R}$ tales que $t_1 < t_2$. Hemos de probar que $x(t_1) > x(t_2)$.
            
            Como $x(t_1)$ y $x(t_2)$ son las soluciones de las ecuaciones $e^x + x^3 + t_1 = 0$ y $e^x + x^3 + t_2 = 0$, respectivamente, tenemos que:
            \begin{equation*}
                e^{x(t_1)} + (x(t_1))^3 + t_1 = 0, \quad e^{x(t_2)} + (x(t_2))^3 + t_2 = 0
            \end{equation*}

            Restando ambas ecuaciones, obtenemos:
            \begin{equation*}
                e^{x(t_1)} + (x(t_1))^3 - e^{x(t_2)} - (x(t_2))^3 + t_1 - t_2 = 0
            \end{equation*}

            Como $t_1-t_2 < 0$, tenemos que:
            \begin{equation*}
                e^{x(t_1)} + (x(t_1))^3 - e^{x(t_2)} - (x(t_2))^3 > 0 \Longrightarrow
                e^{x(t_1)} + (x(t_1))^3 > e^{x(t_2)} + (x(t_2))^3
            \end{equation*}

            Definimos ahora la siguiente función:
            \Func{g}{\bb{R}}{\bb{R}}{x}{e^x + x^3}

            Como $g$ es suma de una función estrictamente creciente y otra función creciente, tenemos que $g$ es estrictamente creciente. Por tanto, usando $g$, tenemos que:
            \begin{equation*}
                g(x(t_1)) > g(x(t_2))
            \end{equation*}

            Como $g$ es estrictamente creciente, esto solo será posible si $x(t_1) > x(t_2)$, por lo que hemos probado que $x(t)$ es decreciente.

            \item[Opción 2] Aplicar el Teorema de la Función Implícita. Para ello, definimos:
            \Func{F}{\bb{R}^2}{\bb{R}}{(t,x)}{e^x + x^3 + t}

            Calculamos las derivadas parciales:
            \begin{equation*}
                \dfrac{\partial F}{\partial x}(t,x) = e^x + 3x^2, \quad \dfrac{\partial F}{\partial t}(t,x) = 1, \quad \forall (t,x)\in\bb{R}^2
            \end{equation*}

            Por tanto, $F\in C^1(\bb{R}^2)$. Además, tenemos $\dfrac{\partial F}{\partial x} (t, x) > 0$ para todo $(t, x)\in\bb{R}^2$ (en particular, no se anula). Por tanto, podemos aplicar el Teorema de la Función Implícita en cualquier punto $(t_0, x_0)$ tal que $F(t_0, x_0) = 0$,
            obteniendo así que la función implícita $x(t)$ es derivable. Aplicaremos este teorema a los puntos de la forma $(t,x_t)=(t,x(t))$. Calculamos su derivada mediante derivación implícita:
            \begin{equation*}
                \dfrac{\partial F}{\partial t}(t, x(t)) + \dfrac{\partial F}{\partial x}(t, x(t))\cdot x'(t) = 0
            \end{equation*}

            Despejando, tenemos que:
            \begin{equation*}
                x'(t) = -\dfrac{\dfrac{\partial F}{\partial t}(t, x(t))}{\dfrac{\partial F}{\partial x}(t, x(t))} = -\dfrac{1}{e^{x(t)} + 3(x(t))^2} < 0 \quad \forall t\in\bb{R}
            \end{equation*}

            Por tanto, hemos probado que $x(t)$ es decreciente.
        \end{description}
    \end{ejercicio}


\begin{ejercicio}
    Se considera la siguiente función:
    \Func{F}{]0, +\infty[}{\bb{R}}{t}{\displaystyle \int_0^{\sqrt{t}} e^{s^2} ~ds}

    ¿Es $F$ de clase $C^1$? En caso afirmativo, calcula la derivada.\\

    Definimos las siguientes funciones:
    \Func{\varphi}{\bb{R}^+}{\bb{R}^+}{t}{\sqrt{t}}
    \Func{\psi}{\bb{R}^+}{\bb{R}}{x}{\displaystyle \int_0^xe^{s^2} ~ds}

    Tenemos que $\varphi\in C^1(\bb{R}^+)$ de forma directa, y $\psi\in C^1(\bb{R}^+)$ por el Teoremema Fundamental del Cálculo. Sus respectivas derivadas son:
    \begin{align*}
        \varphi'(t) &= \dfrac{1}{2\sqrt{t}}\\
        \psi'(x) &= e^{x^2}
    \end{align*}
    
    
    Por tanto, como $F = \psi\circ\varphi$, tenemos que $F\in C^1(\bb{R}^+)$. Para calcular su derivada, aplicamos la regla de la cadena:
    \begin{equation*}
        F'(t) = \psi'(\varphi(t))\cdot\varphi'(t) = e^{(\sqrt{t})^2}\cdot\dfrac{1}{2\sqrt{t}} = \dfrac{e^t}{2\sqrt{t}} \quad \forall t\in\bb{R}^+
    \end{equation*}
\end{ejercicio}


\begin{ejercicio}
    Encuentra la solución del problema de valores iniciales siguiente:
    \begin{equation*}
        \dot{x} = \left(\dfrac{x}{t}\right)^3 + \dfrac{x}{t} - 1, \quad x(1) = 1
    \end{equation*}
    ¿En qué intervalo está definida?\\

    Tenemos que se trata de una ecuación homogénea definida en $D=\bb{R}^+\times \bb{R}$. Definimos el siguiente cambio de variable:
    \Func{\varphi=(\varphi_1, \varphi_2)}{\bb{R}^+\times \bb{R}}{D_1}{(t, x)}{(t,y)=\left(t, \dfrac{x}{t}\right)}

    Veamos el codomidio de $\varphi$:
    \begin{align*}
        D_1=\varphi(D) &= \left\{(t, y)\in\bb{R}^2 \mid (t,yt)\in D\right\}=D
    \end{align*}    

    Además, como podemos despejar cada componente de forma única, tenemos que $\varphi^{-1}$ es:
    \Func{\varphi^{-1}}{D_1}{D}{(t, y)}{(t,x)=\left(t, yt\right)}

    En primer lugar, tenemos que $\varphi,\varphi^{-1}$ son biyectivas. Además, ambas son de clase $C^1$, por lo que $\varphi$ es un difeomorfismo.
    Además, es admisible por no cambiar la primera variable. La ecuación transformada es:
    \begin{equation*}
        \dfrac{dy}{dt} = \dfrac{dy}{dx}=-\dfrac{x}{t^2} +\dfrac{x'}{t} = -\frac{y}{t} + \dfrac{y^3+y-1}{t} = \dfrac{y^3-1}{t} \text{ con dominio } D_1
    \end{equation*}

    Tenemos que se trata de una ecuación de variables separadas. Veamos en qué puntos se anula la función dependiente de $y$:
    \begin{equation*}
        y^3-1=0 \Longrightarrow y=1
    \end{equation*}

    Por tanto, tenemos que una solución de la ecuación diferencial dada es:
    \begin{equation*}
        y(t)=1\qquad \forall t\in \bb{R}^+
    \end{equation*}

    Deshaciedo el cambio de variable, una solución de la ecuación original es:
    \begin{equation*}
        x(t)=y(t)t = t \qquad \forall t\in \bb{R}^+
    \end{equation*}

    Tenemos que dicha solución satisfece $x(1)=1$, luego es la solución buscada. Está definida en $\bb{R}^+$, ya que así se tiene que $x\in C^1(\bb{R}^+)$ y $(t,x(t))\in D$ para todo $t\in \bb{R}^+$.
\end{ejercicio}


\begin{ejercicio}
    Demuestra que las fórmulas
    \begin{equation*}
        s = -e^t, \quad y = (t^2 + 1)x
    \end{equation*}
    definen un difeomorfismo que va de $D = \bb{R}^2$ a un dominio $\hat{D}$ que se especificará.
    Prueba que se trata de un cambio admisible para la ecuación $x' = x + t$ y encuentra la ecuación transformada.\\

    Definimos el siguiente cambio de variable:
    \Func{\varphi=(\varphi_1, \varphi_2)}{\bb{R}^2}{\wh{D}}{(t, x)}{(s, y)=\left(-e^t, (t^2+1)x\right)}

    Además, como podemos despejar cada componente de forma única, tenemos que $\varphi^{-1}$ es:
    \Func{\varphi^{-1}}{\wh{D}}{D}{(s, y)}{(t, x)=\left(\ln(-s), \dfrac{y}{t^2+1}\right)=\left(\ln(-s), \dfrac{y}{\ln^2(-s)+1}\right)}

    Veamos el codominio de $\varphi$:
    \begin{align*}
        \wh{D}=\varphi(D) &= \left\{(s, y)\in\bb{R}^2 \mid \left(\ln(-s), \dfrac{y}{\ln^2(-s)+1}\right)\in D\right\}
    \end{align*}

    En primer lugar, necesitamos que la inversa esté bien definida, luego $s<0$. Además, el denominador de la segunda componente de esta no se anula nunca. Como $D=\bb{R}^2$, tenemos que $\wh{D}=\bb{R}^- \times \bb{R}$.\\

    Una vez visto que $\varphi,\varphi^{-1}$ son biyectivas, falta por ver que son de clase $C^1$. La primera componente de ambas es una función elemental de clase $C^1$, y la segunda componente es un producto o cociente de funciones de clase $C^1$, que en definitiva es de clase $C^1$.
    Por tanto, como ambas componentes de $\varphi, \varphi^{-1}$ son de clase $C^1$, tenemos que $\varphi, \varphi^{-1}$ son de clase $C^1$, y por tanto $\varphi$ es un difeomorfismo.\\

    Veamos ahora que se trata de un cambio admisible para la ecuación $x' = x + t$. Tenemos que:
    \begin{equation*}
        \dfrac{\partial \varphi_1}{\partial t} + \dfrac{\partial \varphi_1}{\partial x} x'=-e^{-t}+0\cdot x'=-e^{-t}\neq 0 \qquad \forall (t,x)\in D
    \end{equation*}

    Por tanto, se trata de un cambio admisible. La ecuación transformada es:
    \begin{equation*}
        \dfrac{dy}{ds} = \dfrac{dy}{dt}\cdot \dfrac{dt}{ds} = \dfrac{2tx+(t^2+1)x'}{-e^t} = \dfrac{2tx+(t^2+1)(x+t)}{-e^t}
    \end{equation*}

    Aplicamos ahora $\varphi,\varphi^{-1}$ para que la ecuación esté en función de $y$ y $s$:
    \begin{equation*}
        y'= \dfrac{2tx+y+(t^2+1)t}{s} = \dfrac{2\ln(-s)\cdot \dfrac{y}{\ln^2(-s)+1}+y+(\ln^2(-s)+1)\ln(-s)}{s}
    \end{equation*}

    Por tanto, la ecuación transformada es:
    \begin{equation*}
        y' = \dfrac{2\ln(-s)\cdot \dfrac{y}{\ln^2(-s)+1}+y+(\ln^2(-s)+1)\ln(-s)}{s}\qquad \text{con dominio }\wh{D}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Se considera la transformación en el plano
    \begin{equation*}
        \psi(\theta, r) = (t, x), \quad t = r\cos \theta, \quad x = r\sen \theta, \quad (\theta, r) \in \wh{\Omega} = \left]\nicefrac{-\pi}{2}, \nicefrac{\pi}{2}\right[ \times \left]0, +\infty\right[
    \end{equation*}

    Determina $\Omega = \psi(\wh{\Omega})$ y prueba que $\psi$ es un difeomorfismo de $\wh{\Omega}$ a $\Omega$. Dada una ecuación $\dfrac{dx}{dt} = f(t, x)$ con $f : \Omega \to \bb{R}$, ¿bajo qué condiciones se puede asegurar que el difeomorfismo $\varphi = \psi^{-1}$ es admisible?\\

    Vemos directamente que $\psi$ es el cambio de coordenadas de polares a cartesianas en el semiplano $x>0$, es decir, primer y cuarto cuadrante.
    Busquemos en primer lugar la inversa de $\psi$. Buscamos despejar $\theta, r$ en función de $t, x$.
    \begin{itemize}
        \item Dividimos $x$ entre $t$, ya que el coseno no se anula en el dominio de defición dado. Tenemos que:
        \begin{equation*}
            \dfrac{x}{t} = \dfrac{r\sen \theta}{r\cos \theta} = \tan \theta
            \Longrightarrow \theta = \arctan \left(\dfrac{x}{t}\right)
        \end{equation*}
        donde en la última implicación hemos usado que $\theta\in\left]\nicefrac{-\pi}{2}, \nicefrac{\pi}{2}\right[$.
        Concluimos además que $t\neq 0$, y como $t=r\cos \theta$, tenemos que $t>0$.

        \item Despejamos ahora $r$. Sumando $x^2$ + $t^2$, tenemos:
        \begin{equation*}
            x^2+t^2 = r^2(\sen^2 \theta + \cos^2 \theta) = r^2 \Longrightarrow r = \sqrt{x^2+t^2}
        \end{equation*}
        donde hemos usado que $r>0$.
    \end{itemize}

    Por tanto, como hemos podido despejar cada componente de forma única, tenemos que $\psi^{-1}=\varphi$ es:
    \Func{\psi^{-1}=\varphi=(\varphi_1, \varphi_2)}{\Omega}{\wh{\Omega}}{(t, x)}{(\theta, r)=\left(\arctan \left(\dfrac{x}{t}\right), \sqrt{x^2+t^2}\right)}

    Estudiemos ahora el conjunto $\wh{\Omega}$. Tenemos que:
    \begin{align*}
        \Omega = \psi(\wh{\Omega}) &= \left\{(t, x)\in\bb{R}+\times \bb{R} \mid \left(\arctan \left(\dfrac{x}{t}\right), \sqrt{x^2+t^2}\right)\in \wh{\Omega}\right\}
        =\\&= \left\{(t, x)\in\bb{R}^+\times \bb{R} \mid \arctan \left(\dfrac{x}{t}\right)\in\left]\nicefrac{-\pi}{2}, \nicefrac{\pi}{2}\right[, \sqrt{x^2+t^2}>0\right\}
        =\\&= \bb{R}^+\times \bb{R}
    \end{align*}

    Ya sabemos que $\psi, \psi^{-1}$ son biyectivas. Además, $\psi,\psi^{-1} \in C^1$ de forma directa, puesto que son composición de funciones de clase $C^1$. Por tanto, $\psi,\psi^{-1}$ son difeomorfismos.\\

    Para que $\varphi$ sea admisible para dicha ecuación, necesitamos que se cumpla:
    \begin{align*}
        0&\neq \dfrac{\partial \varphi_1}{\partial t} + \dfrac{\partial \varphi_1}{\partial x} x'
        = \dfrac{1}{1+\left(\nicefrac{x}{t}\right)^2}\cdot \left(-\dfrac{x}{t^2}\right) + \dfrac{1}{1+\left(\nicefrac{x}{t}\right)^2}\cdot \dfrac{1}{t}\cdot f(t, x)
        =\\&= \dfrac{1}{1+\left(\nicefrac{x}{t}\right)^2}\left(-\dfrac{x}{t^2} + \dfrac{f(t, x)}{t}\right)
        \Longleftrightarrow
        \dfrac{-x}{t}+f(t, x)\neq 0
        \Longleftrightarrow
        f(t, x)\neq \dfrac{x}{t} \qquad \forall (t, x)\in \Omega
    \end{align*}

    Por tanto, la condición de admisibilidad equivale a:
    \begin{equation*}
        f(t, x)\neq \dfrac{x}{t} \qquad \forall (t, x)\in \bb{R}^+\times \bb{R}
    \end{equation*}
\end{ejercicio}

    
\end{document}