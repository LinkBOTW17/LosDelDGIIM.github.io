\newpage
\chapter{Cambio de Variables}
Dada una ecuación diferencial de primer orden en forman normal
\begin{equation*}
    \dfrac{dx}{dt} = x' = f(t,x)
\end{equation*}

mediante una función 
\Func{f}{D}{\mathbb{R}}{(t,x)}{f (t,x)}
continua definida en $D\subseteq \mathbb{R}^2$ un conjunto abierto y conexo, nuestro objetivo será, dado un cambio de variable por dos ecuaciones
\begin{equation*}
    \left\{\begin{array}{rl}
        s=\varphi_1(t,x) \\
        y = \varphi_2(t,x)
    \end{array}\right.
\end{equation*}

con 
\Func{\varphi_1,\varphi_2}{D}{\mathbb{R}}{(t,x)}{\varphi_1(t,x), \varphi_2(t,x)}
cambiar tanto la expresión de la ecuación diferencial como el dominio para facilitar la resolución del mismo, mediante una aplicación
\Func{\varphi= (\varphi_1,\varphi_2)}{D}{D_1}{(t,x)}{(s,y)}
con $D_1\subseteq \mathbb{R}^2$ abierto y conexo, que nos lleve a una ecuación diferencial
\begin{equation*}
    \dfrac{dy}{ds} = \hat{f} (s,y)
\end{equation*}

para cierta función
\Func{\hat{f}}{D_1}{\mathbb{R}}{(s,y)}{\hat{f} (s,y)}
Y será de nuestro interés buscar la expresión de dicha $\hat{f}$.\\

Nos preguntamos también por las condiciones que tenemos que exigirle a dicha $\varphi$ para que el cambio de variable sea bueno:
\begin{enumerate}
    \item Que $\varphi$ sea biyectiva, o equivalentemente, que tenga inversa $\psi = \varphi^{-1}$, para poder deshacer el cambio de variable.
    \item Que podamos hacer cálculo diferecial en ambos lados y que podamos transportarlo, es decir, que tanto $\varphi$ como $\psi$ sean de clase $C^1$.
    \item Además, también tendremos que buscar cómo poner $y$ en función de $s$, y exigir hipótesis para que podamos hacerlo.
\end{enumerate}

\begin{definicion}[difeomorfismo]
    Sea $r\in \mathbb{N}$, una aplicación $f:A\rightarrow B$ es un \newline$C^r$-difeomorfismo si $f$ es de clase $C^r(A)$, biyectiva y su inversa $f^{-1}$ es de clase $C^r(B)$.
\end{definicion}
De esta forma, nos interesará que $\varphi$ sea un $C^1$-difeomorfismo, para que se cumplan los dos primeros puntos de la enumeración anterior\footnote{Recordamos que una función de $\mathbb{R}^2$ sea de clase $C^1$ significa que podemos hacer sus derivadas parciales respecto a las dos variables y que ambas son continuas.}.\\

A continuación, realizaremos un razonamiento informal con la finalidad de comprobar qué pasará al realizar el cambio de variable, para luego formalizar el mismo.\\

Volviendo a la situación inicial, nos encontrábamos ante una ecuación de la forma
\begin{equation*}
    \dfrac{dx}{dt} = f(t,x)
\end{equation*}
y nos disponíamos a realizar un cambio de variable
\begin{equation*}
    \left\{\begin{array}{rl}
        s = \varphi_1(t,x) \\
        y = \varphi_2(t,x) 
    \end{array}\right.
\end{equation*}
De esta forma, suponiendo que $x=x(t)$ es solución de la ecuación, tenemos las variables $s$ y $y$ en función de $t$. 
\begin{equation*}
    \left\{\begin{array}{rl}
        s(t) = \varphi_1(t,x(t)) \\
        y(t) = \varphi_2(t,x(t)) 
    \end{array}\right.
\end{equation*}
Suponiendo ahora que podemos expresar $y$ en función de $s$: $y = y(s)$, buscamos calcular:
\begin{equation*}
    \dfrac{dy}{ds} = \dfrac{dy}{dt} \dfrac{dt}{ds}
\end{equation*}
Primero, calculamos:
\begin{equation*}
    \dfrac{dy}{dt} = \dfrac{\partial\varphi_2}{\partial t}(t,x) + \dfrac{\partial\varphi_2}{\partial x}(t,x)x'(t) \AstIg \dfrac{\partial\varphi_2}{\partial t}(t,x) + \dfrac{\partial\varphi_2}{\partial x}(t,x)f(t,x)
\end{equation*}
Donde en $(\ast)$ hemos usado que $x$ era solución de la ecuación diferencial. Posteriormente:
\begin{equation*}
    \dfrac{ds}{dt} = \dfrac{\partial\varphi_1}{\partial t}(t,x) + \dfrac{\partial\varphi_1}{\partial x}(t,x) f(t,x)
\end{equation*}
Así, llegamos a que:
\begin{equation*}
    \dfrac{dy}{ds} = \dfrac{dy}{dt}\dfrac{dt}{ds} = \dfrac{\dfrac{\partial\varphi_2}{\partial t}(t,x) + \dfrac{\partial\varphi_2}{\partial x}(t,x)f(t,x)}{\dfrac{\partial\varphi_1}{\partial t}(t,x) + \dfrac{\partial\varphi_1}{\partial x}(t,x) f(t,x)} 
\end{equation*}
Pero todavía no hemos terminado, ya que ahora tenemos la ecuación diferencial en función de las variables $s$, $y$, $t$ y $x$, por lo que tenemos que terminar de librarnos de las variables $t$ y $x$. Para ello, usamos la función $\psi$, ya que:
\begin{equation*}
    \varphi(t,x) = (s,y) \Longrightarrow \psi(s,y) = (t,x)
\end{equation*}

Sustituyendo:
\begin{equation*}
    \dfrac{dy}{ds} = \dfrac{\dfrac{\partial\varphi_2}{\partial t}(\psi(s,y)) + \dfrac{\partial\varphi_2}{\partial x}(\psi(s,y))f(\psi(s,y))}{\dfrac{\partial\varphi_1}{\partial t}(\psi(s,y)) + \dfrac{\partial\varphi_1}{\partial x}(\psi(s,y)) f(\psi(s,y))}
\end{equation*}
En caso de que el denominador sea distinto de 0, tendremos ya la nueva expresión de la ecuación diferencial, definiendo:
\begin{equation*}
    \hat{f}(s,y) = \dfrac{\dfrac{\partial\varphi_2}{\partial t}(\psi(s,y)) + \dfrac{\partial\varphi_2}{\partial x}(\psi(s,y))f(\psi(s,y))}{\dfrac{\partial\varphi_1}{\partial t}(\psi(s,y)) + \dfrac{\partial\varphi_1}{\partial x}(\psi(s,y)) f(\psi(s,y))}
\end{equation*}
llegamos a que
\begin{equation*}
    \dfrac{dy}{ds} = \hat{f}(s,y)
\end{equation*}

\begin{ejemplo}
    Dada la ecuación diferencial
    \begin{equation*}
        \dfrac{dx}{dt} = \dfrac{\sen(x+t-3)}{{(x-2t+1)}^{2}}
    \end{equation*}
    buscamos aplicarle un cambio de variable.

    La ecuación diferencial así no tiene sentido, pues nos falta darle un dominio de definición: Sea $f:D\subseteq \mathbb{R}^2\rightarrow\mathbb{R}$ una función dada por:
    \begin{equation*}
        f(t,x) = \dfrac{\sen(x+t-3)}{{(x-2t+1)}^{2}}
    \end{equation*}
    Buscamos un conjunto $D$ abierto y conexo que haga que $f$ sea continua.\\

    $f$ es continua en todos los puntos de $\mathbb{R}^2$ salvo en los que se anula su denominador, y esto sucede en la recta
    \begin{equation*}
        x-2t+1= 0
    \end{equation*}
    que divide el plano en dos componentes conexas. Para el dominio de la función $f$, hemos de quedarnos con un semiplano. Elegimos el de la izquierda\footnote{Sin ningún motivo, podría hacerse con el de la derecha.}, por lo que nos quedamos con
    \begin{equation*}
        D = \{(t,x)\in \mathbb{R}^2 \mid x -2t+1>0 \}
    \end{equation*}
    Vamos a aplicarle a esta ecuación diferencial un cambio de variable:
    \begin{equation*}
        \left\{\begin{array}{rll}
            y &= x+t-3 &= \varphi_2(t,x) \\
            s &= x-2t+1 &= \varphi_1(t,x)
        \end{array}\right.
    \end{equation*}
    Primero, veamos que $\varphi = (\varphi_1,\varphi_2)$ es un difeomorfismo de todo el plano en todo el plano:
    \begin{enumerate}
        \item $\varphi$ es biyectiva, ya que se puede despejar de manera única (es un sistema de ecuaciones lineal compatible determinado).
        \item $\varphi$ es de clase $C^1(\mathbb{R}^2)$, ya que sus dos componentes son polinomios.
        \item $\varphi^{-1}$ es de clase $C^1(\mathbb{R}^2)$: ya que al despejar para hallar la expresión de $\varphi^{-1}$, sale que es un polinomio también.
    \end{enumerate}
    Por tanto, $\varphi:\mathbb{R}^2\rightarrow\mathbb{R}^2$ es un $C^1$-difeomorfismo. Sin embargo, nos interesa verlo como un difeomorfismo de $D$. Buscamos su codominio $D_1$ para conseguirlo:\\

    Primero, buscamos qué imagen tiene la recta $x-2t+1=0$, y es la recta $s=0$, que nos divide del plano en dos semiplanos, uno a la izquierda y otro a la derecha. Ahora, la imagen de nuestro conjunto $D$ es el plano de la derecha, ya que tiene que cumplir que:
    \begin{equation*}
        x-2t+1 = s > 0
    \end{equation*}
    En definitiva:
    \begin{equation*}
        D_1 = \{(s,y)\in \mathbb{R}^2 \mid s>0\}
    \end{equation*}
    Además, sabemos que $D_1$ es abierto y conexo.\\

    Ahora, buscamos la fórmula para nuesetra aplicación $\hat{f}$. Podríamos usar la fórmula pero vamos a repetir los cálculos:

    \begin{equation*}
        \dfrac{dy}{ds} = \dfrac{dy}{dt}\dfrac{dt}{ds} = \dfrac{\nicefrac{dy}{dt}}{\nicefrac{ds}{dt}}
    \end{equation*}
    Pensando que tanto $y$ como $x$ dependen de $t$:
    \begin{equation*}
        \left.\begin{array}{rl}
            \dfrac{dy}{dt} = x' + 1 \\
            \dfrac{ds}{dt} = x' - 2 
        \end{array}\right\} \Longrightarrow \dfrac{dy}{ds} = \dfrac{x'+1}{x'-2}
    \end{equation*}
    Ahora, usamos que $x$ es solución de la ecuación diferencial, luego se cumplirá que $x'=f(t,x)$:
    \begin{equation*}
        \dfrac{dy}{ds} = \dfrac{x'+1}{x'-2} = \dfrac{\dfrac{\sen(x+t-3)}{{(x-2t+1)}^{2}}+1}{\dfrac{\sen(x+t-3)}{{(x-2t+1)}^{2}}-2}
    \end{equation*}
    A continuación, falta poner la ecuación en función de $(s,y)$. Para ello, componemos con la $\psi$:
    \begin{equation*}
        \dfrac{dy}{ds} = \dfrac{\dfrac{\sen y}{s^2}+1}{\dfrac{\sen y}{s^2}-2} = \dfrac{\sen y+s^2}{\sen y -2s^2} = \hat{f}(s,y)
    \end{equation*}
Finalmente, surge que tenemos que poner la $y$ en función de $s$. La ecuación diferencial no está definida en todo el semiplano: el denominador de la expresión no puede anularse.
Los puntos que cumplan:
\begin{equation*}
    \sen y -2s^2 = 0
\end{equation*}
no pueden entrar en el dominio de la ecuación diferencial.\\

Lo que sucede es que los difeomorfismos transladan curvas en curvas, pero no necesariamente curvas en explícitas a curvas en explícitas, luego puede que una curva que en $D$ se expresaba en explícitas no se pueda expresar en $D_1$ con ecuaciones explícitas, con lo que nos daría una singularidad (en este caso, se anularía dicho denominador). Próximamente, veremos la interpretación gráfica de que esto es lo que realmente sucede.
\end{ejemplo}

Ahora, precedemos a realizar una teoría formal que sustente todas las cuentas realizadas hasta el momento.

\begin{definicion}[Cambio de variable admisible]
    Dada una ecuación diferencial de primer orden en forma normal
    \begin{equation*}
        x'=f(t,x)
    \end{equation*}
    Con $f:D\subseteq \mathbb{R}^2\rightarrow\mathbb{R}$ una función continua con $D$ un conjunto abierto y conexo, un cambio de variable admisible es una transformación:
    \Func{\varphi= (\varphi_1,\varphi_2)}{D}{D_1}{(t,x)}{(s,y)}
    con $D$, $D_1\subseteq \mathbb{R}^2$ abiertos y conexos, $\varphi$ es $C^1$-difeomorfismo, y además\footnote{Esta última condición nos permite que podamos llevar curvas en explícitas $x=x(t)$ que son solución de la ecuación diferencial en $D$ a curvas en explícitas $y=y(s)$ que son solución de la ecuación diferencial en $D_1$.}:
    \begin{equation}\label{eq:condicion_cambio_admisible}
        \dfrac{\partial\varphi_1}{\partial t}(t,x) + \dfrac{\partial\varphi_1}{\partial x}(t,x)f(t,x) \neq 0 \qquad \forall (t,x) \in D
    \end{equation}
\end{definicion}

\begin{teo}[Cambio de variable para ecuaciones diferenciales]
    Dado una ecuación diferencial de primer orden en forma normal
    \begin{equation}\label{eq:dif_1er_orden_fn}
        x'=f(t,x)
    \end{equation}
    Con $f:D\subseteq \mathbb{R}^2\rightarrow\mathbb{R}$ una función continua con $D$ un conjunto abierto y conexo. Sea $\varphi:D\rightarrow D_1$ un cambio de variable admisible.

    Entonces, la ecuación~\ref{eq:dif_1er_orden_fn} es equivalente\footnote{Quiere decir, que siempre que tengamos una curva en $D$ que sea solución de la ecuación diferencial, podamos ir a $D_1$ aplicando $\varphi$ y tendremos una solución de la ecuación diferencial definida en $D_1$, así como este mismo procedimiento al revés.} a la ecuación
    \begin{equation}\label{eq:dif_1er_orden_fn_cambiada}
        \dfrac{dy}{ds} = \hat{f}(s,y)
    \end{equation}

    donde
    \begin{equation*}
        \hat{f}(s,y) = \dfrac{\dfrac{\partial\varphi_2}{\partial t}(\psi(s,y))+\dfrac{\partial\varphi_2}{\partial x}(\psi(s,y))f(\psi(s,y))}{\dfrac{\partial\varphi_1}{\partial t}(\psi(s,y)) + \dfrac{\partial\varphi_1}{\partial x}(\psi(s,y))f(\psi(s,y))} \qquad \forall (s,y)\in D_1
    \end{equation*}

\begin{proof}
    Supongamos que $x=x(t)$ es solución de la ecuación~\ref{eq:dif_1er_orden_fn} definida en un intervalo abierto $I\subseteq \mathbb{R}$, y queremos realizar el cambio
    \begin{equation*}
        \left\{\begin{array}{rl}
            s = \varphi_1(t,x(t)) \\
            y = \varphi_2(t,x(t))
        \end{array}\right.
    \end{equation*}
    Defino
    \Func{S}{I}{\mathbb{R}}{t}{\varphi_1 (t,x (t))}
    que es derivable por la regla de la cadena, con derivada distinta de 0:
    \begin{equation*}
        S'(t) = \dfrac{\partial\varphi_1}{\partial t}(t,x) + \dfrac{\partial\varphi_1}{\partial x}(t,x)x'(t) = \dfrac{\partial\varphi_1}{\partial t}(t,x) + \dfrac{\partial\varphi_1}{\partial x}(t,x)f(t,x) \neq 0 \qquad \forall t\in I
    \end{equation*}
    ya que el cambio era admisible. Defino $J=S(I)$ intervalo abierto, y podemos ahora aplicar el Teorema de la función inversa sobre $S$, obteniendo una función
    \Func{T}{J}{I}{t}{T (s)}
    de forma que cumpla
    \begin{gather*}
        T(S(t)) = t \quad \forall t\in I \\
        S(T(s)) = s \quad s\in J
    \end{gather*}
    Teníamos $s$ en función de $t$ y ahora hemos puesto $t$ en función de $s$ utilizando la primera ecuación del cambio de variable. Ahora, podemos definir (usando la segunda ecuación del cambio) la siguiente función, para expresar $y$ en función de $s$, gracias a que hemos expresado $t$ en función de $s$:
    \Func{y}{J}{\mathbb{R}}{s}{\varphi_2 (T (s), x (T (s)))}
    Nos falta derivar $y$ respecto a $s$ para comprobar que sea solución de la ecuación diferencial~\ref{eq:dif_1er_orden_fn_cambiada}:
    \begin{align*}
        y'(s) &= \dfrac{\partial\varphi_2}{\partial t}(T(s),x(T(s)))\cdot T'(s) + \dfrac{\partial \varphi_2}{\partial x}(T(s),x(T(s)))\cdot x'(T(s))\cdot T'(s) \\
              &= T'(s) \left(\dfrac{\partial\varphi_2}{\partial t}(T(s),x(T(s)))+ \dfrac{\partial \varphi_2}{\partial x}(T(s),x(T(s)))\cdot x'(T(s))\right) \\
              &= T'(s) \left(\dfrac{\partial\varphi_2}{\partial t}(T(s),x(T(s)))+ \dfrac{\partial \varphi_2}{\partial x}(T(s),x(T(s)))\cdot f(T(s),x(T(s)))\right) \\
    \end{align*}
    Ahora, usamos que $\varphi$ tiene de inversa a $\psi$, para así poder expresar
    \begin{equation*}
        \psi(s,y(s)) = (T(s), x(T(s)))
    \end{equation*}

    y eliminar $t$ y $x$ de la expresión, dejándolo todo en función de $s$ e $y$:
    \begin{equation*}
        y'(s) = T'(s) \left(\dfrac{\partial\varphi_2}{\partial t}(\psi(s,y(s)))+ \dfrac{\partial \varphi_2}{\partial x}(\psi(s,y(s)))\cdot f(\psi(s,y(s)))\right)
    \end{equation*}
    Falta ver que $T'(s)$ es el denominador de la expresión~\ref{eq:dif_1er_orden_fn_cambiada}. Para ello, aplicamos la regla de derivación de la función inversa:
    \begin{equation*}
        T'(s) = \dfrac{1}{S'(T(s))} =  \dfrac{1}{\dfrac{\partial\varphi_1}{\partial t}(T(s),x(T(s))) + \dfrac{\partial\varphi_1}{\partial x}(T(s),x(T(s)))f(T(s),x(T(s)))} 
    \end{equation*}
    Ahora, volvemos a usar que
    \begin{equation*}
        \psi(s,y(s)) = (T(s), x(T(s)))
    \end{equation*}

    para obtener
    \begin{equation*}
        T'(s) = \dfrac{1}{S'(T(s))} =  \dfrac{1}{\dfrac{\partial\varphi_1}{\partial t}(\psi(s,y(s))) + \dfrac{\partial\varphi_1}{\partial x}(\psi(s,y(s)))f(\psi(s,y(s)))} 
    \end{equation*}
    Finalmente, falta ver que si tenemos una solución en $D_1$, volvemos a tener una solución en $D$. Bastaría aplicar el mismo proceso pero al revés. Sin embargo, debemos comprobar que si $\varphi$ es admisible para la ecuación~\ref{eq:dif_1er_orden_fn}, entonces $\psi$ lo es para la ecuación~\ref{eq:dif_1er_orden_fn_cambiada}.

    Faltaría comprobar la expresión análoga a~\ref{eq:condicion_cambio_admisible} para $\psi$, esto es:
    % // TODO: Hacer:
    % Demostrar que si \varphi es admisible para x' entonces \psi es admisible para y', es decir, que la condición de \neq 0 se mantiene:
    \begin{equation*}
        \dfrac{\partial\psi_1}{\partial s}(s,y) + \dfrac{\partial\psi_1}{\partial y}(s,y)fgorro(s,y) \neq 0 \qquad \forall (s,y) \in  D_1
    \end{equation*}

    Usando que:
    \begin{equation*}
        \varphi'(\psi(s,y))\psi'(s,y) = Id
    \end{equation*}
    % Demostrado esto, veríamos que la condición es equivalente.
\end{proof}
\end{teo}

\section{Ecuaciones sencillas}
Nos falta ahora aprender estrategias para buscar el cambio de variable adecuado en cada caso. Para ello, aprenderemos primero a resolver las ecuaciones diferenciales más sencillas para así cuando se nos presente una más complicada, aplicar un cambio de variable para obtener una ecuación sencilla que sí sepamos resolver.

\subsection{Cálculo de primitivas}
Buscamos resolver ecuaciones diferenciales sencillas. Las ecuaciones diferenciales más sencillas que podemos encontrarnos son el cálculo de primitivas, es decir, cuando la derivada de $x$ sólo está en función de $t$.\\

Pensamos en la ecuación diferencial:
\begin{equation}\label{eq:dif_primitiva}
    x' = p(t)
\end{equation}
con $p:I\subseteq \mathbb{R}\rightarrow\mathbb{R}$ continua, el dominio de la ecuación diferencial es $D = I\times \mathbb{R}\subseteq \mathbb{R}^2$. Sabemos que dicha ecuación diferencial tiene solución, gracias al Teorema Fundamental del Cálculo:

\begin{teo}[Teorema Fundamental del Cálculo]
    Sea $p:I\rightarrow\mathbb{R}$ una funcion continua, fijado $t_0\in I$, entonces
    \begin{equation*}
        P(t) = \int_{t_0}^{t} p(s)~ds 
    \end{equation*}
    es una función de clase $C^1(I)$ que cumple $P'(t) = p(t)$.
\end{teo}
Por tanto, fijado $t_0 \in I$, las soluciones de la ecuación diferencial~\ref{eq:dif_primitiva} son de la forma:
\begin{equation*}
    x(t) = k + \int_{t_0}^{t} p(s)~ds  \qquad k\in \mathbb{R}
\end{equation*}

Tenemos una primera clase de ecuaciones diferenciales que sabemos resolver, al menos a nivel teórico, ya que hay integrales que no pueden calcularse.

\subsection{Ecuaciones de variables separadas}
% // TODO: Apuntes de 8 - 10

Son ecuaciones de la forma:
\begin{equation*}
    x' = p(t) q(x)
\end{equation*}
con funciones
\begin{gather*}
    p:I\rightarrow\mathbb{R} \\
    t\mapsto p(t) \\
    q:J\rightarrow\mathbb{R} \\
    x\mapsto q(x) 
\end{gather*}
Con $I,J\subseteq \mathbb{R}$ intervalos abiertos.

De esta forma, estamos manejando la ecuación 
\begin{equation*}
    x' = f(t,x)
\end{equation*}
con:
\Func{f}{D=I\timesJ}{\mathbb{R}}{(t,x)}{p (t) q (x)}

\begin{observacion}
Notemos que el cálculo de primitivas es caso particular de las ecuaciones de variables separadas, ya que tomando $q(x) = 1$ $\forall x\in \mathbb{R}$:
\begin{equation*}
    p(t)q(x) = p(t) \qquad \forall t\in I
\end{equation*}
\end{observacion}
Para su resolución, comenzaremos primero con unos cálculos informales que luego formalizaremos. Dada la ecuación:
\begin{equation*}
    \dfrac{dx}{dt} = p(t)q(x)
\end{equation*}
y tomamos un valor $a\in J$ que haga que $q(x) = 0$, entonces $x(t) = a$ con $t\in I$ es solución de la ecuación diferencial. Los ceros de la función $q$ producen las soluciones constantes de la ecuación diferencial. Típicamente, lo primero que haremos será buscar los ceros de la función $q$.\\

Ahora, haremos separación de variable, que precisamente busca las soluciones que no son constantes (aunque debería llamarse de variables separables). Hacemos la siguiente operación que no tiene ningún sentido:
\begin{equation*}
    \dfrac{dx}{q(x)} = p(t)~dt
\end{equation*}
Al dividir por $q$, las soluciones constantes no aparecen. Luego:
\begin{gather*}
    \int\dfrac{dx}{q(x)} = \int p(t)~dt \\
    \Phi(x) = P(t) + c
\end{gather*}
Siendo la primitiva de la primera la funcion $\Phi$ y la primitiva de la segunda la función $P$. Si ahora podemos calcular una inversaa $\Phi$, podemos deducir que:
\begin{equation*}
    x(t) = \Phi^{-1}(P(t)+c)
\end{equation*}

\begin{ejemplo}
    Buscamos resolver la ecuación
    \begin{equation*}
        x' = e^{t+x}
    \end{equation*}
    con dominio $D=\mathbb{R}^2$. Es una ecuación en variables separadas, ya que:
    \begin{equation*}
        x' = e^{t+x} = e^t e^x
    \end{equation*}
    En este caso, no encontramos soluciones constantes, ya que $e^x>0$ $\forall x\in \mathbb{R}$. Resolvámosla:

    \begin{gather*}
        \dfrac{dx}{dt} = e^t e^x \\
        e^{-x}~dx = e^t~dt \\
        \int e^{-x}~dx = \int e^t~dt \\
        -e^{-x} = e^t + c
    \end{gather*}
    Que nos da la función $x$ de manera implícita, buscamos la explícita:
    \begin{gather*}
        e^{-x} = -e^t - c
    \end{gather*}
    y tomamos logaritmos, pensando en que esto nos va a determinar luego el dominio de la solución (de forma implícita, suponemos que la cantidad de la derecha es positiva).
    \begin{gather*}
        -x(t) = \ln (-e^{t}-c) \\
        x(t) = -\ln (-e^{t}-c) \\
    \end{gather*}
    ¿Cuándo va a definir una función? Cuando $c$ toma valores positivos o cero, nunca, por lo que tenemos que suponer $c<0$. 

    Ahora, buscamos el intervalo para el que está definido esto. Buscamos que $t$ sea chico, para que sea menos negativo, luego las soluciones van a estar definidos en unos intervalos:
    \begin{gather*}
        -e^t -c > 0 \\
        -c > e^t
    \end{gather*}
    y como el logaritmo es estrictamente creciente:
    \begin{equation*}
        \ln(-c) > \ln (e^t) = t
    \end{equation*}
    \begin{equation*}
        t\in I_c = \left]-\infty, \ln(-c)\right[
    \end{equation*}
    A continuación:
    \begin{enumerate}
        \item Argumentamos que se puede hacer por el desarrollo teórico.
        \item Decimos que es solución, derivamos y comprobamos que, efectivamente, lo es.
    \end{enumerate}
\end{ejemplo}

% // TODO: Pasar a teorema
Supongamos que $q(x)\neq 0$ $\forall x\in J$.
En caso de anularse en algún punto, tomamos la solución constantes que nos da dicho cero. Vamos a intentar hacer un cambio de variable que transforme la ecuación
\begin{equation*}
    x' = p(t)q(x)
\end{equation*}
en un cálculo de primitivas.

En vez de dar el cambio, vamos a buscarlo, de forma que:
\begin{equation*}
    \left\{\begin{array}{rl}
            s &= t \\
            y &= \phi(x)
    \end{array}\right.
\end{equation*}
por lo que tendremos que buscar dicha función $\phi$. Si estas son las ecuaciones, tenemos un dominio $D = I\times J$. 
Para que $\varphi$ sea un difeomorfismo, es necesario que la función
\begin{gather*}
    \phi:J\rightarrow\mathbb{R}
\end{gather*}
sea de clase $C^1$, así como que $\phi'(x)\neq 0$ $\forall x\in J$. No es necesario exigir que sea biyectiva, ya que luego tomaremos como codominio:
\begin{equation*}
    \hat{J} = \phi(J)
\end{equation*}
intervalo abierto.\\
De esta forma, la eucación diferencial tras el cambio de variable tendrá como dominio $D_1=I\times \hat{J}$.\\

Ahora, buscamos que $\varphi$ sea admisible, es decir:
\begin{equation*}
    \dfrac{\partial\varphi_1}{\partial t} + \dfrac{\partial \varphi_1}{\partial x}f \neq 0
\end{equation*}
Lo cual es inmediato, ya que $\varphi_1(t,x)=t$, luego:
\begin{equation*}
    \dfrac{\partial\varphi_1}{\partial t} + \dfrac{\partial \varphi_1}{\partial x}f = 1 + 0 \neq 0
\end{equation*}
No cambiamos el tiempo. La interpretación geométrica es que si algo estaba en explícita, al hacer el cambio sigue estando en explícitas.\\



Aplicamos el cambio de variable:

\begin{equation*}
    \dfrac{dy}{ds} = \dfrac{dy}{dt} \dfrac{dt}{ds}= \phi'(x)x' = \phi'(x)p(t)q(x)
\end{equation*}

donde hemos usado que
\begin{equation*}
    \dfrac{dt}{ds} = 1
\end{equation*}
Todavía no tenemos la ecuación en $y$, ya que seguimos teniendo la ecuación en función de $x$. Basta con (siendo $\psi = \phi^{-1}$):
\begin{equation*}
    \dfrac{dy}{ds} = p(t)\phi'(\psi(y))q(\psi(y))
\end{equation*}

Sin embargo, queremos buscar un cambio de variable que nos lleve a:
\begin{equation*}
    \dfrac{dy}{ds} = p(t)
\end{equation*}
Por lo que tenemos que buscar que:
\begin{gather*}
    \phi'(x) q(x) = 1
\end{gather*}
Por tanto, defino
\begin{gather*}
    \phi:J\rightarrow\mathbb{R} \\
    \phi(x) = \int_{x_0}^{x} \dfrac{d\xi}{q(\xi)} \quad x_0 \in J
\end{gather*}
Para que:
\begin{equation*}
    \phi'(x) = \dfrac{1}{q(x)} \Longrightarrow \phi'(x)q(x) = 1
\end{equation*}
De esta forma, la fórmula:
\begin{equation*}
    \Phi(x(t)) = P(t) + c
\end{equation*}
Viene de la igualdad:
\begin{equation*}
    \int \dfrac{1}{q(x)}~dx  = \int p(t)~dt + c
\end{equation*}

Resumiendo, dada una ecuación:
\begin{equation*}
    \dfrac{dx}{dt} = p(t)q(x)
\end{equation*}
Si aplicamos el cambio:
\begin{equation*}
    \left\{\begin{array}{rl}
            s &= t  \\
            y &= \displaystyle\int_{x_0}^{x} \dfrac{d\xi}{q(\xi)}
    \end{array}\right.
\end{equation*}
Llegamos a una ecuación de la forma
\begin{equation*}
    \dfrac{dy}{ds} = g(t)
\end{equation*}
Que teóricamente sabemos resolver.

\begin{ejemplo}
    Volvemos a la ecuación con la que empezamos el curso:
    \begin{equation*}
        x' = \lm x
    \end{equation*}
    con dominio $D=\mathbb{R}^2$. Es de variables separadas. Las soluciones constantes de la ecuación son:
    \begin{equation*}
        x(t) = 0 \quad \forall t\in \mathbb{R}
    \end{equation*}
    Ahora, como $J$ debemos tomar tnato $\mathbb{R}^+$ como $\mathbb{R}^-$:

    En $\mathbb{R}^-$:
    \begin{gather*}
        \dfrac{dx}{dt} = \lm x \\
        \int \dfrac{dx}{x} = \int \lm~dt  \\
        \ln(-x) = \lm t + c
    \end{gather*}

    y despejamos $x$:
    \begin{gather*}
        -x(t) = e^{\lm t + c} \\
        x(t) = -e^{\lm t + c} = -e^c e^{\lm t}
    \end{gather*}
    En definitiva, las soluciones son:
    \begin{equation*}
        x(t) = k\cdot e^{\lm t} \quad k<0
    \end{equation*}
\end{ejemplo}
