\newpage
\chapter{Ecuaciones y sistemas}

\begin{definicion}[Ecuación Diferencial y solución]
    Una ecuación diferencial viene dada por una función
    \Func{\Phi}{D\subseteq\ \mathbb{R}^3}{\mathbb{R}}{(t,x,y)}{\Phi(t,x,y)}
    \textbf{continua} donde $D$ es un \textbf{abierto}\footnote{Por convenio, ya que las ecuaciones diferenciales no se comportan bien en los bordes.} \textbf{conexo}\footnote{Es lógico pensarlo, ya que estamos estudiando movimientos.} de $\mathbb{R}^3$.

\noindent
Una \textbf{solución} de dicha ecuación diferencial será una función $x:I\rightarrow\mathbb{R}$ con $I\subseteq \mathbb{R}^2$ \textbf{intervalo}\footnote{Es lógico, pues usualmente $t$ será el tiempo.} \textbf{abierto}\footnote{Pudiendo trabajar con funciones continuas en un cerrado y derivables en el abierto, evitando así por ejemplo tangentes verticales} tal que:
\begin{enumerate}[label= (\roman*)]
    \item $x$ sea derivable en $I$\footnote{Necesario para poder considerar $x'(t)$ en la propia ecuación.}.
    \item $(t,x(t),x'(t)) \in D \quad\forall t\in I$\footnote{En vistas de (III).}.
    \item $\Phi(t,x(t),x'(t))=0 \quad \forall t\in I$.
\end{enumerate}
\end{definicion}

\begin{ejemplo}
    Dada la ecuación diferencial:
    \begin{equation*}
        x'(t) = \dfrac{1}{x(t)}
    \end{equation*}
    y la expresión:
    \begin{equation*}
        x(t) = \sqrt{2t-38}
    \end{equation*}
    Probar que dicha expresión es solución de la ecuación diferencial.\\

    La ecuación diferencial viene dada por
    \Func{\Phi}{\mathbb{R}\times\mathbb{R}^+\times\ \mathbb{R}}{\mathbb{R}}{(t,x,y)}{y-\frac{1}{x}}
    \begin{itemize}
        \item Cogiendo $I = \left]19, +\infty\right[$, tenemos (I).
        \item Por ser la raíz una función continua y creciente, tenemos que ${x(I) = \left]0,+\infty\right[=\mathbb{R}^+}$, de donde se cumple (II).
        \item 
            \begin{equation*}
                x'(t) = \dfrac{1}{\sqrt{2t-38}} = \dfrac{1}{x(t)} \qquad \forall t\in I
            \end{equation*}
    \end{itemize}
\end{ejemplo}

\begin{notacion}
    La notación que hemos estado utilizando para las ecuaciones diferenciales no es la que usaremos a lo largo del curso:\\

    Lo que hasta ahora hemos notado y entendido por:
    \begin{equation*}
        \Phi(t,x(t),x'(t)) = 0
    \end{equation*}

    Como en el caso:
    \begin{equation*}
      x'(t) = 3x(t)  
    \end{equation*}
    Lo notaremos ahora por:
    \begin{gather*}
        \Phi(t,x,x') = 0\\
        x' = 3x
    \end{gather*}

    Que recordamos tiene por solución:
    \begin{equation*}
        x(t) = c \cdot e^{3t}, \quad c \in \mathbb{R}
    \end{equation*}
\end{notacion}

\begin{ejemplo}
    Para cierto $\lm \in \mathbb{R}$, resolver:
    \begin{enumerate}
        \item $x' = \lm x$
            \begin{equation*}
                x(t) = c \cdot e^{\lm t} \quad c \in \mathbb{R}
            \end{equation*}
        \item $x' = \lm t$
            \begin{equation*}
                x(t) = \frac{\lm}{2} t^2 + c \quad c \in \mathbb{R}
            \end{equation*}
    \end{enumerate}
\end{ejemplo}

\begin{definicion}[Ecuación Diferencial en forma normal]
    Una ecuación diferencial en forma normal viene dada por una expresión
    \begin{equation*}
        x' = f(t,x)
    \end{equation*}
    para cierta función
    \Func{f}{D\subseteq\mathbb{R}^2}{\mathbb{R}}{(t,x)}{f(t,x)}
    \textbf{continua} donde $D$ es un conjunto \textbf{abierto} y \textbf{conexo} de $\mathbb{R}^2$.\newline
    Una solución de dicha ecuación diferencial será una función $x:I\rightarrow\mathbb{R}$ con $I\subseteq\mathbb{R}^2$ un \textbf{intervalo abieto} tal que:
    \begin{enumerate}[label=(\roman*)]
        \item $x$ sea derivable en $I$.
        \item $(t,x(t))\in D$ $\forall t\in I$.
        \item $x'(t) = f(t,x(t))$ $\forall t\in I$.
    \end{enumerate}
\end{definicion}

\begin{observacion}
    Notemos que las ecuaciones diferenciales en forma normal son ecuaciones diferenciales, ya que dada una ecuación diferencial en forma normal mediante una función $f:C\subseteq\mathbb{R}^2\rightarrow\mathbb{R}$ continua con $D$ un conjunto abierto y conexo y una solución suya $x$ definida en un intervalo abierto $I$, entonces puedo definir la función
    \Func{\Phi}{D=C\times\mathbb{R}}{\mathbb{R}}{(t,x,y)}{y-f(t,x)}
    con $D\subseteq\mathbb{R}^3$ un conjunto abierto (por ser producto de abiertos) y conexo (por ser producto de conexos), $\Phi$ una función continua por ser diferencia de funciones continuas y:
    \begin{enumerate}[label=(\roman*)]
        \item $x$ es derivable en $I$.
        \item Como $D=C\times \mathbb{R}$ y como $(t,x(t))\in C$ $\forall t\in I$, entonces $(t,x(t),x'(t))\in D$ $\forall t\in I$.
        \item Como $x'(t) = f(t,x(t))$ $\forall t\in I$, entonces tendremos que:
            \begin{equation*}
                \Phi(t,x(t),x'(t)) = x'(t) - f(t,x(t)) = 0 \qquad \forall t\in I
            \end{equation*}
    \end{enumerate}
\end{observacion}

\section{Crecimiento proporcional}
En el capítulo anterior nos preguntábamos si todas las soluciones de la ecuación $x'=\lm x$ para cierto $\lm \in \mathbb{R}$ eran de la forma
\begin{equation*}
    x(t) = c \cdot e^{\lm t} \quad c\in \mathbb{R}
\end{equation*}
Ahora daremos respuesta a dicha cuestión, comentando además utilidades de la misma ecuación.

\begin{prop}
    Dada $x(t)$, solución de $x'=\lm x$ para cierto $\lm \in \mathbb{R}$, definida en un intervalo abierto $I$, existe $c\in \mathbb{R}$ tal que
    \begin{equation*}
        x(t) = c \cdot e^{\lm t} \quad t\in I
    \end{equation*}
\end{prop}
Antes de dar paso a la demostración, observemos que si suponemos cierta la tesis:
\begin{equation*}
    x(t) = c \cdot e^{\lm t} \Longleftrightarrow  e^{-\lm t} x(t) = c \Longrightarrow \dfrac{d}{dt}(e^{-\lm t}x(t)) = 0
\end{equation*}
\begin{proof}
    Definimos la función
    \Func{f}{I}{\mathbb{R}}{t}{e^{-\lm\ t}x (t)}
    que es derivable por ser producto de funciones derivables.
    \begin{align*}
        \dfrac{df(t)}{dt} = \dfrac{d}{dt}(e^{-\lm t}x(t)) &= -\lm e^{-\lm t} x(t) + e^{-\lm t} x'(t)\\
                          &= -\lm e^{-\lm t}x(t) + \lm e^{-\lm t}x(t) = 0 \quad \forall t\in I
    \end{align*}
    Por ser $f$ continua y definida en un intervalo, llegamos a que es constante, luego $\exists c\in \mathbb{R} \mid f(t) = e^{-\lm t}x(t) = c \quad \forall t\in I$, de donde deducimos que:
    \begin{equation*}
        x(t) = c \cdot e^{\lm t} \quad \forall t\in I
    \end{equation*}
\end{proof}

Nos centraremos ahora en la idea intuitiva de derivada como representación de la variación de una variable dependiente para dar lugar a los siguientes dos ejemplos que nos muestran cómo surge la ecuación diferencial $x' = \lm x$ para cierto $\lm \in \mathbb{R}$ de forma natural.

\begin{ejemplo}
    Si ingresamos un capital inicial $C(0) = 100$ en un banco que nos da el 2\% anual de interés, al cabo de un año tendremos en nuestra cuenta:
    \begin{equation*}
        C(1) = C(0) + \dfrac{2}{100}C(0) = 100 + \dfrac{2}{100}\cdot 100 = 102
    \end{equation*}
Sin embargo, si acudimos a otro banco que nos ofrece la misma tasa anual de interés pero que nos realiza pagos semestrales, al cabo de un año conseguiremos reunir:
\begin{align*}
    C(\nicefrac{1}{2}) &= C(0) + \dfrac{1}{2}\dfrac{2}{100}C(0) = 100 + \dfrac{1}{2}\dfrac{2}{100}\cdot 100 = 101 \\
    C(1) &= C(\nicefrac{1}{2}) + \dfrac{1}{2}\dfrac{2}{100}C(\nicefrac{1}{2}) = 101 + \dfrac{1}{2}\dfrac{2}{100}\cdot 101 = 102.01 > 102
\end{align*}
En general, si $\Delta t$ es la fracción del año en la que se nos hacen los pagos ($\Delta t = 1$ significa que es pago anual), la fórmula es:
\begin{equation*}
    C(t+\Delta t) = C(t) + \dfrac{2}{100}\Delta t C(t)
\end{equation*}

de donde:
\begin{equation*}
    \dfrac{C(t+\Delta t) - C(t)}{\Delta t} = \dfrac{2}{100} C(t)
\end{equation*}
Si ahora vamos a un banco que nos haga pagos continuos, dicha fracción de tiempo será mínima, por lo que podemos pensar que $\Delta t \rightarrow 0$ y hacer un paso al límite (no riguroso) para obtener que:
\begin{equation*}
    \lim_{\Delta t\to0} \dfrac{C(t+\Delta t) - C(t)}{\Delta t} = C'(t) = \dfrac{2}{100}C(t)
\end{equation*}
De donde tenemos
\begin{equation*}
    C' = \dfrac{2}{100} C
\end{equation*}

o de forma general, si notamos por $I\in \mathbb{R}$ a la tasa de interés:
\begin{equation*}
    C' = I C
\end{equation*}
Cuyas soluciones ya sabemos que se tratan de cualquier función de la familia:
\begin{equation*}
    C(t) = c \cdot e^{It} \quad c\in \mathbb{R}
\end{equation*}
Por tanto, el crecimiento del dinero en un banco que nos ofrezca un interés continuo es exponencial. En este ejemplo, vemos cómo el crecimiento del dinero en una cuenta bancaria es exponencial a la propia cantidad de dinero de la que disponemos en la misma.
\end{ejemplo}

\begin{ejemplo}
    La teoría física de la radioactividad nos dice que las sustancias radioactivas van perdiendo masa a una velocidad proporcional a la masa de la propia sustancia. Es decir, si representamos la masa de una sustancia radioactiva como variable dependiente del tiempo $m=m(t)$:
    \begin{equation*}
        m'(t) = -\lm m(t)
    \end{equation*}
    Para cierto parámetro $\lm \in \mathbb{R}^+$ relativo a la sustancia radioaciva que consideremos.

    Gracias al estudio anteriormente realizado de la ecuación diferencial $m' = -\lm m$, sabemos ya que soluciones de esta son cualesquiera funciones de la forma:
    \begin{equation*}
        m(t) = c\cdot e^{-\lm t}\quad c\in \mathbb{R}^+
    \end{equation*}
En este ejemplo, hemos vuelto a observar la interpretación de la derivada como cuantía de la variación de una determinada variable dependiente.
\end{ejemplo}

\section{Interpretación geométrica}
A continuación, trataremos de dar una interpretación geométrica de las ecuaciones diferenciales y de sus soluciones, basándonos en la interpretación geométrica de la derivada de una función en un punto como la pendiente de la recta tangente a la curva que describe la función en dicho punto.\\

Como ya mencionamos anteriormente, para dar una ecuación diferencial de orden 1 en forma normal nos es suficiente con dar una función
\Func{f}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{f (t,x)}
continua de tal forma que la ecuación diferencial a resolver es
\begin{equation*}
    x' = f(t,x)
\end{equation*}
cuya solución será una función $x = x(t)$.\\

Interpretaremos la función $f$ como un campo de direcciones, es decir, a cada punto del plano $(t,x)$ le asignamos un número $f(t,x)$ e interpretaremos dicho número como la pendiente de la recta que pasa por dicho punto.

A partir de dicha función podemos ir construyendo un ``campo de direcciones'', una regla que a cada punto del plano le asigna una recta que pasa por dicho punto.\\

Recordando la ecuación diferencial $x'=f(t,x)$ que nos da la igualdad ${x'(t) = f(t,x(t))}$, en el miembro derecho de esta última tenemos la pendiente asociada a la recta del campo de direcciones del punto $(t,x(t))$, mientras que a la izquierda tenemos la pendiente de la recta tangente a la curva $x=x(t)$ en el punto $(t,x(t))$.

De esta forma, podemos imaginarnos la ecuación diferencial como un campo de direcciones, mientras que las soluciones son curvas que ``peinan'' dicho campo.\\

A continución, ilustraremos gráficamente varios campos de direcciones dados por ecuaciones diferenciales y soluciones a dichas ecuaciones diferenciales, mediante varios ejemplos.

\begin{ejemplo}
    Consideremos la ecuación diferencial:
    \begin{equation*}
        x' = 0
    \end{equation*}
    Cuyas soluciones son todas las funciones constantes:
    \begin{equation*}
        x(t) = c \quad c\in \mathbb{R}, \quad t\in \mathbb{R}
    \end{equation*}
    En este caso, la función que nos da el campo de direcciones es
    \Func{f}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{0}
    por lo que a cada punto $(t,x)$ del plano le asociamos rectas de pendiente 0 que pasen por dicho punto, es decir, rectas horizontales.

\ifdefined\showimages
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\linewidth]{Imagenes/campo_direcciones_1.png}
        \caption{Campo de direcciones para $x'=0$ y algunas soluciones de la misma.}
    \end{figure}
\fi
\end{ejemplo}

\begin{ejemplo}
    Consideremos ahora:
    \begin{equation*}
        x' = 1
    \end{equation*}
    Cuyas soluciones son de la forma:
    \begin{equation*}
        x(t) = t + c \quad c\in \mathbb{R}, \quad t\in \mathbb{R}
    \end{equation*}
    En este caso, el campo de direcciones viene dado por
    \Func{f}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{1}
    por lo que a cada punto $(t,x)$ le asociamos una recta a 45º de inclinación.

\ifdefined\showimages
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\linewidth]{Imagenes/campo_direcciones_2.png}
        \caption{Campo de direcciones para $x'=1$ y algunas soluciones de la misma.}
    \end{figure}
\fi
\end{ejemplo}

\begin{ejemplo}
    Consideramos:
    \begin{equation*}
        x'=x
    \end{equation*}
    Cuyas soluciones sabemos que son:
    \begin{equation*}
        x(t) = c\cdot e^{t} \quad c\in \mathbb{R}, \quad t\in \mathbb{R}
    \end{equation*}
    Ahora, la función que nos da el campo de direcciones es
    \Func{f}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{x}
    Para pensar en el campo de direcciones, pensemos en ir dibujándolo por cada recta horizontal del plano:
    \begin{itemize}
        \item Para puntos $(t,x)$ de la recta $x=0$, tendremos $f(t,x) = 0$, luego para todos los puntos del eje de abscisas tenemos siempre rectas horizontales.
        \item Para los puntos de la recta $x=1$, tendremos rectas a 45º de inclinación.
        \item Para $x=-1$, tendremos rectas a -45º de inclinación.
        \item De igual forma, para la recta $x=2$, tendremos rectas más inclinadas que la de 45º.
        \item De forma análoga, para los puntos de la recta $x=-2$, tendremos rectas más inclinadas que la de -45º.
    \end{itemize}
    En definitiva, cuanto más nos alejamos del eje de abscisas, más pendientes se ponen las rectas del campo de direcciones.

\ifdefined\showimages
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\linewidth]{Imagenes/campo_direcciones_3.png}
        \caption{Campo de direcciones para $x'=x$ y algunas soluciones de la misma.}
    \end{figure}
\fi
\end{ejemplo}

\begin{ejemplo}
    Consideramos:
    \begin{equation*}
        x' = t^2 + x^2
    \end{equation*}
    Cuyas soluciones se ha demostrado\footnote{No se verá por exceder el conocimiento de la presente asignatura.} que no tienen fórmula que pueda escribirse con funciones elementales clásicas.

    Pese a ello, sabemos que la función que nos da su campo de direcciones es:
    \Func{f}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{t^2+x^2}
    Para visualizar el campo de direcciones, pensaremos en circunferencias centradas en el origen con distinto radio $r\in \mathbb{R}^+_0$:
    \begin{itemize}
        \item Para $r = 0$, tenemos la circunferencia formada por el punto $(0,0)$, con $f(0,0) = 0$, luego tenemos que la recta asociada a dicho punto es una recta horizontal.
        \item Para $r = 1$, tenemos que $t^2 + x^2 = r^2 = 1$ para cada punto $(t,x)$ de dicha circunferencia, luego tenemos una recta a 45º de inclinación en cada punto de dicha circunferencia.
        \item Para $r = 2$, tenemos que $t^2 + x^2 = r^2 = 4$ para cada punto de la circunferencia, luego tendríamos una recta de mayor inclinación en dichos puntos.
    \end{itemize}
    Podemos ya imaginarnos cuál será el campo de direcciones, el cual podemos graficar gracias a los ordenadores:
\ifdefined\showimages
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\linewidth]{Imagenes/campo_direcciones_4.png}
        \caption{Campo de direcciones para $x'=t^2+x^2$.}
    \end{figure}
\fi
    No conocemos soluciones para esta ecuación diferencial. Sin embargo, observando el campo de direcciones, observamos que las soluciones son funciones crecientes, con límite a $-\infty$ por la izquierda y a $+\infty$ por la derecha.
\end{ejemplo}

\section{Funciones implícitas}
Hasta ahora, hemos trabajado principalmente con funciones definidas en forma explícita $x=x(t)$. Sin embargo, en ecuaciones diferenciales es común trabajar con funciones definidas por una ecuación de la forma
\begin{equation*}
    F(t,x) = 0
\end{equation*}
por lo que tenemos que saber trabajar con ellas.\\

Cabe destacar que toda función explícita puede ponerse como implícita, pero no toda función implícita dada por una fórmula puede ponerse como función explícita. De esta forma, el estudio que realizaremos a continuación está enfocado a dichas funciones implícitas que no pueden ponerse de forma explícita.

Por lo tanto, si nos encontramos con una ecuación que nos da una función implícita de la cual podemos despejar $x$, podemos expresar la función de forma explícita y no será necesario aplicar lo aprendido en esta sección.

\begin{ejemplo}
    La fórmula
    \begin{equation*}
        x-t = 0
    \end{equation*}
    nos define una ecuación implícita $x=x(t)$, ya que dado un $t\in \mathbb{R}$, existe un único $x\in \mathbb{R}$ tal que se verifica la fórmula. Sin embargo, dicha función $x$ podemos expresarla de forma explícita, sacando su fórmula despejando $x$ de la fórmula anterior:
    \begin{equation*}
        x(t) = t \quad \forall t\in \mathbb{R}
    \end{equation*}
    Y podremos trabajar con ella como una función explícita, algo a lo que ya estamos acostumbrados.
\end{ejemplo}

\begin{ejemplo}
    Veamos que la fórmula
    \begin{equation}\label{eq:ejm1}
        x^7+3x+t^2 = 0
    \end{equation}
    nos define una función implícita $x(t)$, es decir, que dado un número $t\in \mathbb{R}$, existe un único valor $x\in \mathbb{R}$ que verifique la fórmula~(\ref{eq:ejm1}).\\

    Dado $t\in \mathbb{R}$, hemos de probar la existencia y unicidad de $x\in \mathbb{R}$ tal que verifique la fórmula~(\ref{eq:ejm1}). Cuando lo tengamos probado, notaremos $x(t) = x$ para dicho $t$ y tendremos probado que la fórmula~(\ref{eq:ejm1}) nos define una función implícita.
    \begin{proof} Demostremos por un lado la existencia y por otro la unicidad:
        \begin{description}
            \item [Existencia.]~\\
                Dado $t\in \mathbb{R}$, podemos definir el polinomio
                \begin{equation*}
                    p_t(x) = x^7+3x+t^2
                \end{equation*}
                Y por ser un polinomio de grado impar, conocemos que al menos tiene una raíz $x\in \mathbb{R}$ tal que se verifica la fórmula~(\ref{eq:ejm1})\footnote{Es contenido de Álgebra I, pero puede deducirse ya que tiene límite a $-\infty$ por la izquierda y a $+\infty$ por la derecha, y aplicamos el Teorema de Bolzano.}.\\
            \item [Unicidad.]~\\
                Derivamos ahora el polinomio $p_t$:
                \begin{equation*}
                    p_t'(x) = 7x^6+3 > 0 \quad \forall x\in \mathbb{R}
                \end{equation*}
                Luego es una función estrictamente creciente, por lo que a lo sumo tiene una raíz.
        \end{description}
    \end{proof}
\end{ejemplo}

Acabamos de ver un ejemplo de fórmula que nos define una única función implícita $x=x(t)$.  Nos preguntamos a continuación si cualquier fórmula nos provee de una función implícita. En caso de hacerlo, ¿obtenemos funciones derivables? Dicha pregunta nos servirá de paso para probar que la función implícita $x=x(t)$ del ejempmlo anterior es derivable.
\begin{enumerate}
    \item Como primera observación sencilla, mostramos que hay ecuaciones que no nos definen ninguna función implícita, como:
        \begin{equation*}
            x^2+t^2 = -1
        \end{equation*}
        Esto se debe a que, dado $t\in \mathbb{R}$, no podemos encontrar ningún $x\in \mathbb{R}$ tal que se verifique la ecuación.

    \item Además, hay ecuaciones que nos dan más de una función implícita, como el clásico ejemplo de la circunferencia:
        \begin{equation*}
            x^2 + t^2 = 1
        \end{equation*}
        Dicha ecuación nos fabrica dos funciones implícitas que además podemos expresar de forma explícita:
        \begin{align*}
            x_1(t) &= +\sqrt{1-t^2}, \quad t\in [-1,1] \\
            x_2(t) &= -\sqrt{1-t^2}, \quad t\in [-1,1] \\
        \end{align*}

    \item Finalmente, observamos que hay funciones implícitas que no se pueden derivar. Por ejemplo, la fórmula:
        \begin{equation*}
            x^3-t^2 = 0
        \end{equation*}
        nos da una función implícita que podemos poner como explícita:
        \begin{equation*}
            x(t) = t^{\nicefrac{2}{3}}, \quad t\in \mathbb{R}
        \end{equation*}
        Pero dicha función no es derivable en 0.
\end{enumerate}

En resumen, dada una fórmula que nos relacione dos variables:
\begin{equation*}
    F(t,x) = 0
\end{equation*}
no podemos asegurar que la función implícita que nos da (en caso de hacerlo) sea derivable, puede pasar cualquier cosa: a veces no define ecuación implícita, a veces define varias, puede definirnos sólo una que no sea derivable, o que sí lo sea, \ldots~No contamos por tanto con una teoría general de ecuaciones implícitas.\\

Sin embargo, contamos con un resultado bastante útil que ya conocimos en Análisis Matemático I, el Teorema de la Función Implícita\footnote{Aunque en Análisis Matemático I se dio el teorema en su forma más general, en esta asignatura nos interesará el caso de $\mathbb{R}^2$.}. Se trata de un teorema local que da condiciones para que exista la función implícita y sea única, dentro de un entorno suficientemente pequeño.

\begin{teo}[Función Implícita]
    Sea $G\subseteq \mathbb{R}^2$ un abierto y sea
    \Func{F}{G}{\mathbb{R}}{(t,x)}{F (t,x)}
    una función de clase $\mathcal{C}^1(G)$, es decir, que existan las parciales respecto a $t$ y respecto a $x$ y que ambas sean continuas.

    \noindent
    Sea $(t_0,x_0)\in G$ de forma que $F(t_0,x_0)=0$ y se cumpla que:
    \begin{equation*}
        \dfrac{\partial F}{\partial x}(t_0,x_0) \neq 0
    \end{equation*}
    Entonces, existe una función 
    \Func{x}{I}{\mathbb{R}}{t}{x (t)}
    con $I\subseteq \mathbb{R}$ un intervalo abierto de forma que $x\in \mathcal{C}^1(I)$ y se verifica:
    \begin{enumerate}
        \item $t_0 \in I$.
        \item $x(t_0) = x_0$.
        \item $(t,x(t))\in G$ $\forall t\in I$.
        \item $F(t,x(t))=0$ $\forall t\in I$.
    \end{enumerate}
\end{teo}~\\

Veremos ahora varios usos prácticos del teorema:
\begin{ejemplo}
    En el caso
    \begin{equation*}
        x^2+t^2 = 1
    \end{equation*}
    Tenemos la función 
    \Func{F}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{x^2 + t^2-1}
    que es de clase $C^1(\mathbb{R}^2)$:
    \begin{equation*}
        \dfrac{\partial F}{\partial t}(t,x) = 2t \qquad \dfrac{\partial F}{\partial x}(t,x) = 2x \qquad \forall (t,x)\in \mathbb{R}^2
    \end{equation*}
    Buscamos ahora un punto $(t_0,x_0)\in \mathbb{R}^2$ para aplicar el teorema:
    \begin{itemize}
        \item Ha de ser un punto de la circunferencia de radio 1, para que $F(t_0,x_0)=0$.
        \item Además, ha de ser $x_0 \neq 0$, para que:
            \begin{equation*}
                \dfrac{\partial F}{\partial x}(t_0,x_0) = 2x_0 \neq 0
            \end{equation*}
    \end{itemize}
    De esta forma, podemos elegir cualquier punto $(t_0,x_0)\in \mathbb{S}^1\setminus \{(-1,0),(1,0)\}$ para aplicar el teorema. Por tanto, dado cualquier punto $t_0\in \left]-1,1\right[$, el teorema nos dice que hay un intervalo abierto $I$ de forma que $t_0\in I \subseteq \left]-1,1\right[$ en el que la función (ya sea la anterior $x_1$ o $x_2$ de la última enumeración) es derivable.

    Es cierto que sabíamos ya de antemano la existencia de dichas funciones, pero en caso de no saberlo el Teorema nos garantiza dicha existencia. Este es el primer uso del teorema.
\end{ejemplo}

\begin{ejemplo}
    En el caso del ejemplo anterior, la fórmula
    \begin{equation*}
        x^7+3x+t^2 = 0
    \end{equation*}
    ya sabemos que existe la función implícita, pero no sabemos si dicha función es derivable o no. Usaremos el Teorema de la Función Implícita para probar que la función $x=x(t)$ que nos da la fórmula es derivable.

    \noindent
    Sea $G = \mathbb{R}^2$ y $F(t,x) = x^7+3x+t^2$ que es una función de clase $\mathcal{C}^1(\mathbb{R}^2)$:
    \begin{equation*}
        \dfrac{\partial F}{\partial t}(t,x) = 2t \qquad \dfrac{\partial F}{\partial x}(t,x) = 7x^6 + 3 \qquad \forall (t,x)\in \mathbb{R}^2
    \end{equation*}
    Notemos que:
    \begin{equation*}
        \dfrac{\partial F}{\partial x}(t,x) = 7x^6 + 3 > 0
    \end{equation*}
    Por lo que podemos elegir cualquier punto en el que $F(t,x) = 0$ para aplicar el teorema, obteniendo que la función $x$ es derivable.\\

    Este es el segundo uso práctico del teorema, probar de forma fácil que una función implícita que ya conocemos es derivable.
\end{ejemplo}

\begin{ejemplo}
    Anteriormente, vimos que la fórmula
    \begin{equation*}
        x^3-t^2 = 0
    \end{equation*}
    que define una función implícita:
    \begin{equation*}
        x(t) = t^{\nicefrac{2}{3}}, \quad t\in \mathbb{R}
    \end{equation*}
    no era derivable. Comprobamos qué hipótesis es la que falla del teorema:

    \noindent
    Tenemos
    \Func{F}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{x^3-t^2}
    con parciales:
    \begin{equation*}
        \dfrac{\partial F}{\partial t}(t,x) = 2t \qquad \dfrac{\partial F}{\partial x}(t,x) = 3x^2 \qquad \forall (t,x)\in \mathbb{R}^2
    \end{equation*}
    luego $F\in \mathcal{C}^1(\mathbb{R}^2)$. En el ejemplo anterior, fallaba la derivabilidad en $t_0 = 0$, luego comprobamos por qué la función no es derivable:

    \noindent
    En primer lugar, para tener que $x_0^3 - t_0^2 = 0$ con $t_0 = 0$ ha de ser $x_0 = 0$. Sin embargo:
    \begin{equation*}
        \dfrac{\partial F}{\partial x}(0,0) = 0
    \end{equation*}
    Luego no podemos aplicar el Teorema de la Función Implícita.
\end{ejemplo}

\subsection{Derivación implícita}
Hasta ahora, tenemos una forma de probar la existencia de funciones implícitas así como su derivabilidad, pero no sabemos cómo derivarlas, lo cual trataremos de resolver a continuación.\\

\noindent
Usualmente, tendremos una función
\Func{F}{G\subseteq\mathbb{R}^2}{\mathbb{R}}{(t,x)}{F (t,x)}
de clase $\mathcal{C}^1(\mathbb{R}^2)$ que verifique las hipótesis del Teorema de la Función Implícita, de forma que:
\begin{equation}\label{eq:formula_deriv_implicita}
    F(t,x(t)) = 0 \quad \forall t\in I
\end{equation}
para cierta función $x=x(t)$ e $I\subseteq \mathbb{R}$ intervalo abierto. Nuestro objetivo será derivar la expresión anterior.

\begin{prop}
    Dadas unas funciones $F$ como la definida anteriormente, $x$ y $t$ funciones reales de variable real de clase $\mathcal{C}^1(\mathbb{R})$ y una función como resultado de la composición de funciones:
    \begin{equation*}
        s \longmapsto (t(s), x(s)) \longmapsto F(t(s), x(s))
    \end{equation*}
    que es también una función real de variable real de clase $\mathcal{C}^1(\mathbb{R})$, tenemos que:
    \begin{equation*}
        \dfrac{d}{ds}[ F(t(s),x(s))] = \dfrac{\partial F}{\partial t}(t(s), x(s))\cdot t'(s) + \dfrac{\partial F}{\partial x}(t(s),x(s))\cdot x'(s) \quad \forall s\in \mathbb{R}
    \end{equation*}
\end{prop}

\noindent
Usando esta proposición sobre la fórmula~(\ref{eq:formula_deriv_implicita}), llegamos a la ecuación diferencial:
\begin{equation*}
    \dfrac{dF}{dt}(t,x(t)) = \dfrac{\partial F}{\partial t}(t,x(t)) + \dfrac{\partial F}{\partial x}(t,x(t))\cdot x'(t) = 0
\end{equation*}
Que no se encuentra en forma normal. Sin embargo, es usual haber aplicado el Teorema de la Función Implícita antes de este resultado, luego, suponiendo que estamos bajo dichas hipótesis, tendremos que 
\begin{equation*}
    \dfrac{\partial F}{\partial x}(t,x(t)) \neq 0
\end{equation*}
en un entorno de $t$, por lo que en dicho caso sí que podremos despejar la ecuación diferencial anterior, para expresarla en forma normal:
\begin{equation*}
    x'(t) = \dfrac{-\dfrac{\partial F}{\partial t}(t,x(t))}{\dfrac{\partial F}{\partial x}(t,x(t))}
\end{equation*}

\section{Ecuación diferencial a partir de una familia de funciones}\label{sec:1.4}
Al igual que sucede con los polinomios y sus raíces, es mucho más simple construir una ecuación diferencial a partir de una familia de soluciones a obtener la familia de funciones que resuelve una ecuación diferencial.\\

En esta sección, nos centraremos en cómo construir una ecuación diferencial de primer orden a partir de una familia uniparamétrica de funciones implícitas.

Para ello, nos darán una ecuación del tipo:
\begin{equation*}
    F(t,x,c) = 0
\end{equation*}

siendo $c$ el parámetro, y definiéndonos una familia de funciones implícitas, de donde obtenemos la función implícita $x=x(t)$, y llegamos a:

\begin{equation*}
    F(t,x(t),c) = 0
\end{equation*}

y lo que haremos para obtener la ecuación diferencial es derivar:
\begin{equation*}
    \dfrac{dF}{dt}(t,x(t),c) = \dfrac{\partial F}{\partial t}(t,x(t),c) + \dfrac{\partial F}{\partial x}(t,x(t),c)\cdot x'(t) = 0
\end{equation*}
Que no es una ecuación diferencial, sino una familia de ecuaciones diferenciales, ya que para cada $c\in \mathbb{R}$ tenemos una ecuación diferencial distinta.

El último paso, por tanto, es tratar de expresar $c$ en función de $x$ y de $t$, para sustituirlo y obtener finalmente la ecuación diferencial:

\begin{equation*}
    \left.\begin{array}{rr}
                F(t,x(t),c) &= 0 \\
                \dfrac{\partial F}{\partial t}(t,x(t),c) + \dfrac{\partial F}{\partial x}(t,x(t),c)\cdot x'(t) &= 0
        \end{array}\right\} \overset{\text{Despejar $c$}}{\longrightarrow } \Phi(t,x,x') = 0
\end{equation*}
No es necesario hacer este proceso de forma rigurosa, ya que lo único que nos pedirán es obtener una ecuación difrencial que tenga por soluciones la familia uniparamétrica de funciones dada. Por tanto, siempre y cuando consigamos este objetivo, podemos responder a la pregunta simplemente dando la ecuación diferencial y probando que, efectivamente, dicha familia es solución de la ecuación.

\begin{ejemplo}
    Hallar la ecuación diferencial que tiene por soluciones la familia uniparamétrica de funciones:
    \begin{equation}\label{eq:ejm1_ecuacion_familia}
        x^2+t^2 = c\qquad c\in \mathbb{R}^+
    \end{equation}
    En primer lugar, ya sabemos que dicha fórmula nos da una familia uniparamétrica de funciones:
    \begin{equation*}
        x(t) = \pm \sqrt{c-t^2}, \quad t\in \left]-\sqrt{c},\sqrt{c}\right[
    \end{equation*}
    Tratamos ahora de hallar la ecuación diferencial que nos solicitan, que lo haremos derivando en ambos miembros de la fórmula~(\ref{eq:ejm1_ecuacion_familia}):
    \begin{align*}
        {(x(t))}^{2}+t^2 &= c \\
        \dfrac{d}{dt}\left({(x(t))}^{2}+t^2 \right) &= \dfrac{d}{dt}(c) \\
        2xx' + 2t &= 0
    \end{align*}
    En este caso, no ha sido necesario despejar $c$ para sustituirlo al final del cálculo anterior, ya que directamente ha desaparecido de la ecuación diferencial. De esta forma, la ecuación diferencial buscada es:
    \begin{equation*}
        2xx' + 2t = 0
    \end{equation*}
    Que podemos expresar en forma normal como:
    \begin{equation*}
        x' = \dfrac{-t}{x}
    \end{equation*}
\end{ejemplo}

\begin{observacion}\label{obs:3a_ec_dif}
    Notemos que acabamos de aprender a resolver la ecuación diferencial
    \begin{equation*}
        x' = \dfrac{-t}{x}
    \end{equation*}
    Tiene por soluciones la familia uniparamétrica de funciones:
    \begin{equation*}
        x(t) = \pm \sqrt{c-t^2} \quad c\in \mathbb{R}^+, \quad t\in \left]-c,c\right[
    \end{equation*}
    Para el dominio de la función hemos elegido el intervalo abierto, ya que al ser una solución de una ecuación diferencial, tiene que estar definida en un abierto conexo, tal y como concretamos en la definición de una solución de una ecuación diferencial.
\end{observacion}


\begin{ejemplo}
    Buscar una ecuación diferencial que tenga como soluciones la familia uniparamétrica de funciones:
    \begin{equation}\label{eq:ejm2_ecuacion_familia}
        \dfrac{1}{c}e^{cx} - x^2 - \sen t = c
    \end{equation}
%     En primer lugar, comprobamos que, efectivamente, dicha fórmula nos da una familia uniparamétrica de funciones mediante el Teorema de la Función Implícita:\\
% 
%     Para cada $c\in \mathbb{R}^*$, definimos la función
%     \Func{F_c}{\mathbb{R}^2}{\mathbb{R}}{(t,x)}{\dfrac{1}{c} e^{cx}-x^2-\sen t -c}
% 
%     Con parciales:
%     \begin{equation*}
%         \dfrac{\partial F}{\partial t}(t,x) = -\cos t \qquad \dfrac{\partial F}{\partial x}(t,x) = e^{cx} -2x \qquad \forall (t,x) \in \mathbb{R}^2
%     \end{equation*}

    Tendríamos que $F(t,x,c) = \frac{1}{c}e^{cx} - x^2-\sen t - c$ y ahora derivaremos de forma implícita, pensando que la fórmula nos da una función $x=x(t)$:

    \begin{equation}\label{eq:ejm2_ecuacion_familia_2}
        \dfrac{d F}{d t}(t,x,c) = e^{cx}x' - 2x'x - \cos t = 0
    \end{equation}
    Ahora, nos disponemos a eliminar el parámetro $c$. Despejando en la fórmula~(\ref{eq:ejm2_ecuacion_familia_2}) llegamos a que:
    \begin{align*}
        e^{cx} &= \dfrac{2xx' + \cos t}{x'} \\
        cx &= \ln\left(\dfrac{2xx'+\cos t}{x'}\right) \\
        \dfrac{1}{c} &= \dfrac{x}{\ln \left(\dfrac{2xx' + \cos t}{x'}\right)}
    \end{align*}
    Y ahora sustituyendo $c$ y $\frac{1}{c}$ en~(\ref{eq:ejm2_ecuacion_familia}), tenemos que la ecuación diferencial buscada es:
    \begin{equation*}
       \dfrac{x}{\ln \left(\dfrac{2xx' + \cos t}{x'}\right)} \dfrac{2xx' + \cos t}{x'} - x^2-\sen t - \dfrac{1}{x}\ln \left(\dfrac{2xx' + \cos t}{x'}\right) = 0
    \end{equation*}
\end{ejemplo}

\section{Problemas geométricos}
Una aplicación de las ecuaciones diferenciales es hallar curvas exigiendo condiciones sobre sus tangentes o normales. Por ejemplo, podemos tratar de hallar la curva cuyas normales sean todas coincidentes en un mismo punto.

\begin{notacion}
    En esta sección haremos un cambio de notación, ya que las soluciones de las ecuaciones diferenciales ya no serán movimientos donde tratamos de expresar la posición $x$ de un móvil en función del tiempo $t$, $x = x(t)$; sino que las soluciones serán curvas geométricas, por lo que trataremos de, dada una abscisa $x$, hallar la coordenada en las ordenadas $y$ que nos diga un punto de la curva, $y = y(x)$.

    De esta forma, sustituiremos la notación que venimos usando de las ecuaciones diferenciales $F(t,x) = 0$ por la notación $F(x,y) = 0$.
\end{notacion}

Aunque toda curva en el plano puede expresarse con una ecuación implícita (esto no sucede con explícitas), supondremos siempre que las curvas las podremos poner en explícitas, con la finalidad de que nos aparezcan siempre ecuaciones de primer orden (usando ecuaciones paramétricas, por ejemplo, obtenemos sistemas de ecuaciones).

De esta forma, trabajaremos con curvas $y=y(x)$ con $x\in I$ intervalo abierto, siendo $y\in \mathcal{C}^1(I)$\footnote{Con vistas para derivar y aplicar el Teorema de la Función Implícita.}.

\subsubsection{Rectas tangentes a una curva}
Sabemos ya que, dada una curva $y = y(x)$, podemos encontrar en cada punto $(x,y(x))$ una recta tangete a dicha curva. A medida que movemos el punto por la curva, vamos obteniendo todo el haz de rectas que son tangentes a dicha curva.\\

Dado un punto $(x,y(x))$ de una curva $y=y(x)$, la ecuación de la recta tangente a la curva en dicho punto viene dada por:
\begin{equation*}
    v-y(x) = y'(x) (u-x)
\end{equation*}
siendo $u$ y $v$ las nuevas variables que hemos usado para expresar la ecuación\footnote{Notemos que no podemos usar $x$ e $y$ como variables por ser ya un punto que hemos fijado de la curva por el que queremos hacer pasar la recta tangente.}.\\

Dado $x\in \mathbb{R}$, el punto $(x,y(x))$ nos da una recta tangente a la curva por dicho punto. Si movemos la variable $u$, nos estaremos moviendo a lo largo de la recta tangete. Si ahora también movemos $x$, nos estaremos moviendo por todo el haz de rectas.

\subsubsection{Rectas normales a una curva}
Dada una curva $y=y(x)$, podemos encontrar también en cada punto $(x,y(x))$ una recta normal a dicha curva (esto es, que sea perpendicular a la recta tangente en dicho punto) que pase por el mismo punto.\\

Para hallar la ecuación de dicha recta, pensamos en que debe pasar por el punto $(x,y(x))$ y en que debe ser perpendicular a la recta tangente. De esta forma, si $m_1$ y $m_2$ son las pendientes de las rectas tangente y normal respectivamente, tenemos que:
\begin{equation*}
    m_1 \cdot m_2 = -1 \Longrightarrow m_2 = \dfrac{-1}{m_1}
\end{equation*}
Como la pendiente en la recta tangente es $m_1 = y'(x)$, tenemos ya la ecuación de la recta normal a una curva en el punto $(x,y(x))$, siempre y cuando $y'(x) \neq 0$:
\begin{equation}\label{eq:rectas_normales}
    v-y(x) = -\dfrac{1}{y'(x)}(u-x)
\end{equation}

siendo $u$ y $v$ las nuevas variables que hemos usado para expresar la ecuación.\\

Sin embargo, podemos expresar dicha ecuación como:
\begin{equation*}
    y'(x) (v-y(x)) = x-u
\end{equation*}

Y ya podremos considerarla también cuando $y'(x) = 0$.

\begin{ejemplo}
    Buscamos la curva para la que todas las rectas normales pasan por el origen\footnote{Notemos que si tenemos otro punto, podemos trasladar todo el problema al origen, trasladando de nuevo la solución a dicho punto.}.

    Para ello, buscamos expresar $y$ como función de $x$ para obtener la curva deseada: $y=y(x)$. Cuando vamos considerando todas las rectas normales, lo que hacemos es mover la ecuación de la recta normal por los puntos $(x,y(x))$ que cumplen la curva. 

    Debemos imponer que todas las rectas normales de ecuación~(\ref{eq:rectas_normales}) pasen por el origen, es decir, que la ecuación de las rectas normales se cumpla para el punto $(0,0)$ siempre. Esto sucede cuando $u=v=0$, para cada punto $(x,y(x))$ de la curva.

Luego se cumple que:
\begin{equation*}
    -y'(x)y(x) = x
\end{equation*}
Ecuación diferencial que no está en forma normal:
\begin{equation*}
    y'y+x=0
\end{equation*}
Pasaremos a resolverla con un truco que aprenderemos en el Capítulo 3:\\

Para ello, buscamos expresar la ecuación diferencial como la derivada de una expresión igualdada a 0, luego esta nueva expresión será constante, y obtendremos una ecuación que nos defina una función implícita:
\begin{align*}
    y'(x)y(x) + x &= 0 \\
    \dfrac{d}{dx}\left(\dfrac{1}{2}{(y(x))}^{2}+\dfrac{1}{2}x^2\right)&= 0 \\
    \dfrac{1}{2}{\left(y(x)\right)}^{2}+\dfrac{1}{2}x^2&=c \quad c\in \mathbb{R}^+\\
    {\left(y(x)\right)}^{2}+x^2 &= k
\end{align*}
Dicha curva es una circunferencia centrada en el origen de radio $k^2$. Estamos buscando la solución en explícitas, luego despejamos y obtenemos:
\begin{equation*}
    y(x) = \pm \sqrt{k-x^2} \qquad x\in \left]-\sqrt{k},\sqrt{k}\right[
\end{equation*}
(Hemos puesto el intervalo abierto por ser solución de una ecuación diferencial, luego debe estar definida en un abierto).
\end{ejemplo}

\subsection{Trayectorias ortogonales}
Dada una familia $\mathcal{F}$ de curvas uniparamétricas en la plano mediante una ecuación de la forma:
\begin{equation}\label{eq:tray_ort}
    F(x,y,c) = 0 \qquad c\in \mathbb{R}
\end{equation}
de forma que por cada punto del plano pase una curva de este tipo, buscamos otra familia $\mathcal{G}$ de curvas uniparamétricas de forma que corten ortogonalmente a las curvas de la familia $\mathcal{F}$. Llamaremos a las curvas de $\mathcal{G}$ trayectorias ortogonales a las curvas de $\mathcal{F}$.\\

El procedimiento a seguir será obtener la ecuación diferencial que nos define a la familia $\mathcal{F}$, de la cual obtendremos la ecuación diferencial que define a la familia $\mathcal{G}$, obligando a que el producto de las derivadas de las curvas sea $-1$. Finalmente, resolveremos esta segunda ecuación diferencial, para obtener la ecuación que nos defina la familia de curvas uniparamétricas del plano.\\

Por tanto, con vistas a obtener la ecuación diferencial que define a la familia $\mathcal{F}$, derivaremos la ecuación~(\ref{eq:tray_ort}):
\begin{equation}\label{eq:tray_ort_2}
    \dfrac{\partial F}{\partial x}(x,y,c) + \dfrac{\partial F}{\partial y}(x,y,c)y' = 0
\end{equation}
Ahora, juntaremos las expresiones~(\ref{eq:tray_ort}) y~(\ref{eq:tray_ort_2}) para eliminar el parámetro $c$, obteniendo la ecuación diferenecial de la familia $\mathcal{F}$, de la forma que aprendimos en la Sección~\ref{sec:1.4} y la pondremos en forma normal:
\begin{equation*}
    y' = f(x,y)
\end{equation*}
Suponiendo que podemos dividir, la ecuación de la familia de trayectorias ortogonales $\mathcal{G}$ será:
\begin{equation*}
    y' = -\dfrac{1}{f(x,y)}
\end{equation*}
Ahora, bastará resolver la ecuación diferenecial obtenida para obtener una ecuación implícita que nos define la familia uniparamétrica de funciones:
\begin{equation*}
    G(x,y,k) = 0 \qquad k\in \mathbb{R}
\end{equation*}

\begin{ejemplo}
    Demostrar que las trayectorias ortogonales a la familia:
    \begin{equation*}
        x^2 + y^2 = c \qquad c\in \mathbb{R}^+
    \end{equation*}
    son las rectas que pasan por el origen.\\

    Para ello, derivaremos dicha expresión entendiendo que $y$ está en función de $x$:
    \begin{equation*}
        2x + 2yy' = 0
    \end{equation*}

    Suponiendo que $y\neq 0$, llegamos a la ecuación diferencial en forma normal de la familia dada:
    \begin{equation*}
        y' = \dfrac{-x}{y}
    \end{equation*}

    Suponiendo ahora que $x\neq 0$, llegamos a la ecuación diferencial en forma normal de la familia de trayectorias ortogonales:
    \begin{equation*}
        y' = \dfrac{y}{x}
    \end{equation*}

    A poco que se piense\footnote{En futuros temas aprenderemos a resolver más tipos de ecuaciones diferenciales.}, llegamos a que tiene por soluciones la familia
    \begin{equation*}
        y(x) = k\cdot x \qquad k\in \mathbb{R}
    \end{equation*}
    
    Estas son las rectas que pasan por el origen.
\end{ejemplo}

\begin{ejemplo}
    Consideramos la siguiente ecuación que nos describe una familia uniparamétrica $\mathcal{F}$:
    \begin{equation*}
        y = cx^2 \qquad c\in \mathbb{R}
    \end{equation*}
    Buscamos la familia de trayectorias ortogonales.\\

    La familia $\mathcal{F}$ es la familia de parábolas con vértices en el origen:
    \ifdefined\showimages
    \begin{center}
    \begin{tikzpicture}
      \begin{axis}[
          axis lines = center,    % Dibujar los ejes
          xmin = -5, xmax = 5,    % Definir el rango en el eje x
          ymin = -10, ymax = 10,  % Definir el rango en el eje y
          domain = -5:5,          % Dominio de las funciones
          samples = 200,          % Número de muestras para las funciones
          major grid style = {lightgray},   % Estilo de la cuadrícula principal
          minor grid style = {dotted}       % Estilo de la cuadrícula secundaria
      ]

      \addplot[purple, thick] {0};
      \addplot[purple, thick] {x^2};
      \addplot[purple, thick] {2*x^2};
      \addplot[purple, thick] {0.5*x^2};
      \addplot[purple, thick] {-x^2};
      \addplot[purple, thick] {-2*x^2};
      \addplot[purple, thick] {-0.5*x^2};
      \end{axis}
    \end{tikzpicture}
    \end{center}
    \fi

    Con vistas a obtener la ecuación diferencial que nos describa a la familia, derivamos:
    \begin{align*}
        y &= cx^2 \\
        y' &= 2cx
    \end{align*}

    Despejando, obtenemos el valor de $c$:
    \begin{equation*}
        c = \dfrac{y}{x^2}
    \end{equation*}

    Ssustituimos este valor en la segunda expresión, obteniendo la ecuación diferencial en forma normal:
    \begin{equation*}
        y' = \dfrac{2y}{x}
    \end{equation*}
    Ahora, escribimos la ecución diferencial para la familia de trayectorias ortogonales:
    \begin{equation*}
        y' = \dfrac{-x}{2y}
    \end{equation*}
    Resolvemos esta ecuación diferencial a resolver, mediante el mismo truco que antes:
    \begin{align*}
        2yy' + x &= 0 \\
        \dfrac{d}{dx} \left(y^2 + \dfrac{x^2}{2}\right) &= 0 \\
        y^2 + \dfrac{x^2}{2} &= k \qquad k\in \mathbb{R}^+
    \end{align*}
    Estas son las elipses de eje mayor $\sqrt{2}$ (en el de abscisas) y eje menor 1 (cuando $k=1$):

    \ifdefined\showimages
    \begin{center}
    \begin{tikzpicture}
      \begin{axis}[
          axis lines = center,    % Dibujar los ejes
          xmin = -5, xmax = 5,    % Definir el rango en el eje x
          ymin = -5, ymax = 5,    % Definir el rango en el eje y
          domain = -5:5,          % Dominio de las funciones
          samples = 200,          % Número de muestras para las funciones
          major grid style = {lightgray},   % Estilo de la cuadrícula principal
          minor grid style = {dotted}       % Estilo de la cuadrícula secundaria
      ]

      % Dibujar las funciones cuadráticas
      \addplot[purple, thick] {0};
      \addplot[purple, thick] {x^2};
      \addplot[purple, thick] {2*x^2};
      \addplot[purple, thick] {0.5*x^2};
      \addplot[purple, thick] {-x^2};
      \addplot[purple, thick] {-2*x^2};
      \addplot[purple, thick] {-0.5*x^2};

      % Dibujar las elipses
      \addplot[green, thick, domain=0:360, samples=200] ({sqrt(2*0.5)*cos(x)}, {sqrt(0.5)*sin(x)});
      \addplot[green, thick, domain=0:360, samples=200] ({sqrt(2*1)*cos(x)}, {sqrt(1)*sin(x)});
      \addplot[green, thick, domain=0:360, samples=200] ({sqrt(2*2)*cos(x)}, {sqrt(2)*sin(x)});
      \addplot[green, thick, domain=0:360, samples=200] ({sqrt(2*4)*cos(x)}, {sqrt(4)*sin(x)});

      \end{axis}
    \end{tikzpicture}
    \end{center}
    \fi

\end{ejemplo}

\section{Sistemas de ecuaciones diferenciales}
Nos centramos ahora en el estudio de los sistemas de ecuaciones diferenciales. Un sistema de $d\in \mathbb{N}$ ecuaciones será de la forma:
\begin{equation*}
    x_i' = f_i(t,x_1,\ldots,x_d) \qquad i=1,\ldots, d
\end{equation*}
Y nuestras incógnitas serán:
\begin{equation*}
    x_1 = x_1(t),\ x_2 = x_2(t),\ \ldots,\ x_d = x_d(t)
\end{equation*}
Las familias de funciones que obtendremos ahora dependerán de $d$ parámetros.

\begin{ejemplo}
    Un ejemplo de sistema de ecuaciones diferenciales de dos ecuaciones y dos incógnitas es:
    \begin{equation*}
        \left\{\begin{array}{rl}
                x_1' &= x_2 \\
                x_2' &= -x_1
        \end{array}\right.
    \end{equation*}
    Una solución que podemos ver fácil es:
    \begin{align*}
        x_1(t) &= \sen t \\
        x_2(t) &= \cos t
    \end{align*}
    Otra es:
    \begin{equation*}
        x_1(t) = x_2(t) = 0 \quad t\in \mathbb{R}
    \end{equation*}
    Finalmente, llegamos a la familia de soluciones:
    \begin{align*}
        x_1(t) &= k \sen t \\
        x_2(t) &= k \cos t \\
               &k \in \mathbb{R}
    \end{align*}
    Que no son todas las soluciones, ya que sólo tenemos una familia uniparamétrica. Para hallar otro parámetro, podemos cambiar la fase de las funciones trigonométricas:
    \begin{align*}
        x_1(t) &= b \sen (t+a) \\
        x_2(t) &= b \cos (t+a) \\
               &a,b \in \mathbb{R}
    \end{align*}
    En el último Capítulo, aprenderemos a demostrar que esta familia nos da todas las soluciones. Dicha familia se puede escribir también como:
    \begin{align*}
        y_1(t) &= c_1 \sen t - c_2 \cos t \\
        y_2(t) &= c_1 \cos t + c_2 \sen t \\
               & c_1, c_2 \in \mathbb{R}
    \end{align*}
\end{ejemplo}

\begin{ejercicio*}
    Demostrar que ambas familias de funciones son las mismas:
    \begin{equation*}
        \left\{\begin{array}{rl}
                x_1(t) &= b \sen (t+a) \\
                x_2(t) &= b \cos (t+a)
        \end{array}\right. \qquad a,b \in \mathbb{R}
    \end{equation*}
    \begin{equation*}
        \left\{\begin{array}{rl}
                y_1(t) &= c_1 \sen t - c_2 \cos t \\
                y_2(t) &= c_1 \cos t + c_2 \sen t
        \end{array}\right. \qquad c_1, c_2 \in \mathbb{R}
    \end{equation*}
\end{ejercicio*}

\subsubsection{Curvas en paramétricas}
Volveremos a la notación $x$ e $y$ para las variables, y nos centraremos en las ecuaciones paramétricas. Esto es, dar $x$ e $y$ en función de una variable independiente $t$, por lo que ahora tendremos dos funciones:
Estas son:
\Func{x,y}{I}{\mathbb{R}}{t}{x (t),y (t)}
La diferencia entre implícitas y paramétricas es que ahora pensamos en una curva como un movimiento, no como un lugar geométrico que cumple una cierta propiedad: 
\begin{equation*}
    F(x,y) = 0
\end{equation*}
Dado un instante de tiempo $t$, el móvil que realiza el movimiento se encontrará en el punto $(x(t), y(t))$.
Podemos encontrar muchas parametrizaciones para una misma curva (ya que puede recorrerse de distintas formas).
\begin{ejemplo}
    Podemos dibujar $\frac{3}{4}$ de una circunferencia mediante la curva en paramétricas:
    \begin{align*}
        x(t) &= \cos t \\
        y(t) &= \sen t \\
             & t \in I=\left]0, \dfrac{3\pi}{2}\right[
    \end{align*}
\end{ejemplo}

\begin{definicion}[Órbita]
Dada una curva en paramétricas mediante dos funciones
\Func{x,y}{I}{\mathbb{R}}{t}{x (t),y (t)}
El lugar geométrico de todos los puntos del plano por el que pasa dicho movimiento es:
\begin{equation*}
    \{(x(t),y(t)) \mid t\in I\}
\end{equation*}
al que llamaremos órbita.
\end{definicion}

\subsection{Órbitas de un sistema autónomo en el plano}
Dado un sistema autónomo en el plano, es decir, un sistema de dos ecuaciones y dos incógnitas (para así obtener una curva plana) de forma que la variable independiente $t$ no aparezca en las ecuaciones del sistema (aunque $x$ e $y$ sean dependientes de $t$). Dicho sistema será de la forma:
\begin{equation*}
    \left\{\begin{array}{c}
            x' = f(x,y) \\
            y' = g(x,y)
    \end{array}\right.
\end{equation*}
Para ciertas funciones
\Func{f,g}{D\subseteq \mathbb{R}^2}{\mathbb{R}}{(x,y)}{f (x,y),g (x,y)}
Con $D$ un conjunto abierto y conexo, $f$ y $g$ funciones continuas.\\

Tratamos de buscar soluciones
\begin{equation*}
    x=x(t) \qquad y=y(t) \quad t\in \mathbb{R}
\end{equation*}
Buscar las soluciones de cualquier sistema de esta forma es demasiado difícil. Nos centraremos por ahora simplemente en calcular las órbias del sistema. Esto es, sabremos calcular el lugar geométrico de los puntos del plano por el que pasan las soluciones, pero no sabremos calcular cómo son los movimientos que describen las soluciones.\\

\noindent
De forma \textbf{NO RIGUROSA}, en física se da un sistema de la forma:
\begin{equation*}
    \left\{\begin{array}{c}
        \dfrac{dx}{dt} = f(x,y) \\
        \dfrac{dy}{dt} = g(x,y)
    \end{array}\right.
\end{equation*}
Y se saca la órbita poniendo $y$ en función de $x$ dividiendo:
\begin{equation*}
    \dfrac{\frac{dy}{\cancel{dt}}}{\frac{dx}{\cancel{dt}}} = \dfrac{g(x,y)}{f(x,y)} \Longrightarrow \dfrac{dy}{dx} = \dfrac{g(x,y)}{f(x,y)}
\end{equation*}
En lo sucesivo, trataremos de dar un fundamento teórico a esta cuenta, con el fin de aprender por qué podemos realizarla y dar condiciones para cuándo poder hacerlo.

\begin{ejemplo}
    Vamos a ver un ejemplo en el que la cuenta anterior funciona. Tomamos el sistema:
    \begin{equation*}
        \left\{\begin{array}{lr}
                x' &= y \\
                y' &= -x
        \end{array}\right.
    \end{equation*}
    Del que podemos coger como una solución las funciones:
    \begin{align*}
        x(t) &= 2\sen t \\
        y(t) &= -2\cos t \\
             & t\in \left]0,\pi\right[
    \end{align*}
    Suponiendo que podemos dividir:
    \begin{equation*}
        \dfrac{dx}{dt} = y,\qquad \dfrac{dy}{dt} = -x\Longrightarrow  \qquad \dfrac{dy}{dx} = \dfrac{-x}{y}
    \end{equation*}
    En la notación usual, esta es la ecuación:
    \begin{equation*}
        y' = -\dfrac{x}{y}
    \end{equation*}
    Sus soluciones veremos que son:
    \begin{equation*}
        y^2 + x^2 = c
    \end{equation*}
    La ecuación en implícitas de la órbita para dicha solución concreta es:
    \begin{equation*}
        y^2 + x^2 = 4
    \end{equation*}
    Por tanto, el cálculo parace que funciona.
\end{ejemplo}

\subsubsection{Función inversa}
Hagamos un breve repaso de lo que sabemos sobre funciones inversas. 
\begin{itemize}
    \item Podemos pensar en la noción conjuntista de función inversa: dada una función $f:I\rightarrow J$, si esta función es biyectiva, podemos encontrar una función ${f^{-1}:J\rightarrow I}$ tal que:
        \begin{gather*}
            f^{-1}\circ f = id_I \\
            f\circ f^{-1} = id_J
        \end{gather*}
    \item O también podemos pensar en la noción clásica de función inversa: si tenemos una variable $x$ dependiente de $t$: $x = f(t)$, bajo unas ciertas condiciones podemos encontrar una función $g$ de forma que hagamos $t$ depender de $x$: $t = g(x)$.
\end{itemize}

Para este apartado, dada una función:
\Func{f}{I}{\mathbb{R}}{x}{f (x)}
Con $I\subseteq \mathbb{R}$ un intervalo abierto, siempre que esta sea inyectiva, obtendremos una nueva función restringiendo el codominio de $f$ a $f(I)$, una función biyectiva que sí tendrá inversa, a la que notaremos por $f^{-1}$.

\begin{prop}
    Toda función continua e inyectiva es estrictamente monótona\footnote{El lector debe estar familizarizado con esta Proposición y el siguiente Teorema, al ser contenido de Cálculo II.}.
\end{prop}
A partir del resultado, al buscar funciones que puedan tener inversa, buscaremos funciones estrictamente monótonas.

\begin{teo}[Función inversa]\label{teo:funcion_inversa}
    Sea una función
    \Func{f}{I}{\mathbb{R}}{x}{f (x)}

    derivable en un intervalo abierto $I$ con $J=f(I)$ y
    \begin{equation*}
        f'(t) > 0 \qquad \forall t\in I
    \end{equation*}
    Entonces, dicha función tiene inversa, $g:J\rightarrow I$ y además es derivable en $J$, con:
    \begin{equation*}
        g'(x) = \dfrac{1}{f'(g(x))}
    \end{equation*}
\end{teo}

\begin{ejemplo}
    Dada la función:
    \begin{equation*}
        f:I=\left]-\dfrac{\pi}{2},\dfrac{\pi}{2}\right[ \rightarrow \mathbb{R} \qquad f(x) = \sen x \quad \forall x\in I
    \end{equation*}
    Sabemos que es una función derivable en $I$, con $J=f(I)=]-1,1[$ y con $f'(x) > 0$ $\forall x\in I$, por lo que podemos aplicar el teorema, luego existirá una función
    \begin{equation*}
        g:J\rightarrow R
    \end{equation*}
    Que será su función inversa y sabemos que dicha función es la función arcoseno, la cual es derivable (por el teorema), con:
    \begin{equation*}
        g'(x) = \dfrac{1}{\cos(\arcsen x)}
    \end{equation*}
    Tratamos ahora de simplificar dicha expresión:

    Si $\theta = \arcsen x$, entonces $\theta \in I$ y:
    \begin{equation*}
        \sen^2 \theta + \cos^2 \theta = 1 \Longrightarrow \cos \theta = \pm \sqrt{1-\sen^2 \theta}
    \end{equation*}

    Luego:
    \begin{equation*}
        \cos(\arcsen x) = \cos \theta = \pm \sqrt{1-\sen^2 \theta} = \pm \sqrt{1-x^2}
    \end{equation*}
    Por ser $\theta \in I$, sabemos que $\cos \theta > 0$, por lo que nos quedamos con el signo positivo de la raíz. Finalmente, llegamos a que:
    \begin{equation*}
        g'(x) = \arcsen'(x) = \dfrac{1}{\sqrt{1-x^2}}
    \end{equation*}
    Notemos que $\cos(\arcsen x) = \sqrt{1-x^2}$ siempre y cuando $x\in I$.
\end{ejemplo}~\\

Tenemos ya todas las herramientas necesarias para formalizar el cálculo de la ecuación diferencial de la órbita de un sistema autónomo plano.

\begin{teo}
    Dado un sistema de la forma:
    \begin{equation*}
        \left\{\begin{array}{c}
                x' = f(x,y) \\
                y' = g(x,y)
        \end{array}\right.
    \end{equation*}
    Para ciertas funciones
    \Func{f,g}{D\subseteq\mathbb{R}^2}{\mathbb{R}}{(x,y)}{f (x,y), g (x,y)}
    Con $D$ un conjunto abierto y conexo, $f$ y $g$ funciones continuas, de forma que el sistema tiene una solución:
    \begin{equation*}
        x = \varphi(t) \qquad y=\psi(t) \quad t\in I\subseteq \mathbb{R}
    \end{equation*}

    con $I$ un intervalo abierto.\\

    Si se verifica que:
    \begin{equation*}
        f(\varphi(t),\psi(t)) \neq 0 \qquad \forall t\in I
    \end{equation*}
    Entonces, la órbita $\{(\varphi(t),\psi(t))\mid t \in I\}$ puede escribirse como una curva en explícitas $y=y(x)$ de forma que venga dada por la ecuación diferencial:
    \begin{equation*}
        \dfrac{dy}{dx} = \dfrac{g(x,y)}{f(x,y)}
    \end{equation*}

    \begin{proof}
        Por ser $f(\varphi(t),\psi(t))\neq 0$ y ser $f$ continua, esta será siempre positiva o siempre negativa. Supongamos que es siempre positiva, y la demostración será análoga si esta es siempre negativa.

        Por tanto, tenemos que
        \begin{equation*}
            x' = \varphi'(t) = f(\varphi(t),\psi(t)) > 0 \quad \forall t\in I
        \end{equation*}
        Por lo que $\varphi$ cumple las hipótesis del Teorema~\ref{teo:funcion_inversa}. De esta forma, sea $J=\varphi(I)$, existirá una función $T:J\longrightarrow I$ derivable en $J$ y función inversa de $\varphi$ con:
        \begin{equation*}
            T'(x) = \dfrac{1}{\varphi'(T(x))} \qquad \forall x\in J
        \end{equation*}
        Como teníamos $x=\varphi (t)$, ahora tenemos $t = T(x)$.\\

        Definimos una función
        \Func{y}{J}{\mathbb{R}}{x}{\psi(T (x))}
        que es derivable por la regla de la cadena, con:
        \begin{align*}
            y'(x) &= \psi'(T(x))\cdot T'(x) \\
                  &= g(\varphi(T(x)), \psi(T(x)))\cdot T'(x) \\
                  &= g(x, y(x))\cdot T'(x)
        \end{align*}
        Y como:
        \begin{equation*}
            T'(x) = \dfrac{1}{\varphi'(T(x))} = \dfrac{1}{f(\varphi(T(x)), \psi(T(x)))} = \dfrac{1}{f(x,y(x))}
        \end{equation*}
        Juntando estas últimas dos expresiones, llegamos a que:
        \begin{equation*}
            y'(x) = \dfrac{dy}{dx}(x) = \dfrac{g(x,y(x))}{f(x,y(x))}
        \end{equation*}

        de donde obtenemos la ecuación diferencial
        \begin{equation*}
            \dfrac{dy}{dx} = \dfrac{g(x,y)}{f(x,y)}
        \end{equation*}
    \end{proof}
\end{teo}

\begin{ejemplo}
    Dado el sistema:
    \begin{equation*}
        \left\{\begin{array}{rl}
                x' &= y \\
                y' &= -x
        \end{array}\right.
    \end{equation*}
    Con funciones
    \Func{f,g}{\mathbb{R}^2}{\mathbb{R}}{(x,y)}{y, -x}
    Con una solución $x = \varphi(t)$ y $y=\psi(t)$
    \begin{align*}
        \varphi(t) &= 2\sen t \\
        \psi(t) &= 2\cos t \\
    \end{align*}
    Funciones definidas en un intervalo abierto $I$. Se pide hallar la órbita de dicha solución.\\
    Necesitamos ver que
    \begin{equation*}
        f(\varphi(t),\psi(t)) \neq 0 \qquad \forall t\in I
    \end{equation*}

    es decir:
    \begin{equation*}
        2\cos t \neq 0 \qquad \forall t\in I
    \end{equation*}
    Para ello, cogemos el intervalo $I = \left]-\frac{\pi}{2}, \frac{\pi}{2}\right[$, aunque se podría hacer con otros intervalos, pero complican el proceso.

    Tenemos:
    \begin{equation*}
        x=2\sen t \qquad J=\left]-2,2\right[
    \end{equation*}
    y buscamos poner $t$ en función de $x$:
    \begin{equation*}
        t = \arcsen \left(\dfrac{x}{2}\right)
    \end{equation*}
    Tenemos la función $T:J\rightarrow I$ con $T(x) = \arcsen \left(\frac{x}{2}\right)$

    Definimos ahora una función $y:J\rightarrow \mathbb{R}$ dada por:
    \begin{equation*}
        y(x) = \psi(T(x)) = 2\cos\left(\arcsen\left(\dfrac{x}{2}\right)\right)
    \end{equation*}
    Si llamamos $\theta = \arcsen\left(\frac{x}{2}\right)$, entonces $\theta \in I$ y sabemos que:
    \begin{gather*}
        \sen \theta = \dfrac{x}{2}\\
        \cos^2 \theta + \sen^2 \theta = 1 \Longrightarrow \cos \theta = \pm \sqrt{1-\sen^2 \theta} = \pm \sqrt{1-\dfrac{x^2}{4}}
    \end{gather*}
    Y por el intervalo en el que estamos, el coseno es positivo, luego cogemos la raíz positiva. Finalmente, llegamos a que:
    \begin{equation*}
        y(x) = 2\cos\left(\arcsen\left(\dfrac{x}{2}\right)\right) = 2\sqrt{1-\dfrac{x^2}{4}} = \sqrt{4-x^2}
    \end{equation*}
\end{ejemplo}

\begin{ejercicio}
    Repetir el ejemplo cogiendo otro intervalo $I$.
\end{ejercicio}
