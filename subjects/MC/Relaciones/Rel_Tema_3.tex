\newpage
\section{Propiedades de los Lenguajes Regulares}

\begin{comment}
\begin{table}[H]
        \centering
        \begin{tabular}{r c c c c c c c}
            \hhline{~*{1}{-}}
            $q_{11}q_{20}$ & \cell{~}\\ \hhline{~*{2}{-}}
            $q_{10}q_{21}$ & \cell{~} & \cell{~}\\ \hhline{~*{3}{-}}
            $E_1q_{20}$ & \cell{~} & \cell{~} & \cell{~}\\ \hhline{~*{4}{-}}
            $E_1q_{21}$ & \cell{~} & \cell{~} & \cell{~} & \cell{~}\\ \hhline{~*{5}{-}}
            $q_{10}E_2$ & \cell{~} & \cell{~} & \cell{~} & \cell{~} & \cell{~}\\ \hhline{~*{6}{-}}
            $q_{11}E_2$ & \cell{~} & \cell{~} & \cell{~} & \cell{~} & \cell{~} & \cell{~}\\ \hhline{~*{7}{-}}
            $E_1E_2$ & \cell{~} & \cell{~} & \cell{~} & \cell{~} & \cell{~} & \cell{~} &  \cell{~}\\ \hhline{~*{7}{-}}\\
            & $q_{10}q_{20}$ & $q_{11}q_{20}$ & $q_{10}q_{21}$ & $E_1q_{20}$ & $E_1q_{21}$ & $q_{10}E_2$ & $q_{11}E_2$\\
        \end{tabular}
        \caption{Minimización del AFD de la figura~\ref{fig:1.3.8-AFD-Interseccion}.}
        \label{tab:1.3.8-Minimizacion}
    \end{table}
\end{comment}

\begin{ejercicio}\label{ej:1.3.1}
    Determinar si los siguientes lenguajes son regulares o libres de contexto. Justificar las respuestas.
    \begin{enumerate}
        \item $L_1=\{0^i b^j \mid i = 2j \text{\ ó\ } 2i=j\}$
        
        Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^{2n}b^n\in L_1$ con $|z|=3n\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,b\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{2n-k-l}b^n \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+2n-k-l}b^n=0^{2n+l}b^n\notin L_1$, ya que, como $l\geq 1$:
        \begin{equation*}
            2n+l\neq 2n \quad \text{y} \quad 2(2n+l)\neq n
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular. Veamos ahora que sí es libre de contexto. Consideramos la gramática $G=(\{S,S_1,S_2\},\{0,b\},P,S)$ con $P$ definido por:
        \begin{align*}
            S &\rightarrow S_1 \mid S_2 \\
            S_1 &\rightarrow 00S_1b \mid \varepsilon \\
            S_2 &\rightarrow 0S_2bb \mid \varepsilon
        \end{align*}

        Tenemos que $G$ es una gramática libre de contexto tal que $\cc{L}(G)=L_1$, por lo que $L_1$ es libre de contexto.

        \item $L_2=\{uu^{-1} \mid u \in {\{0,1\}}^\ast, |u|\leq 1000\}$
        
        Consideramos el lenguaje auxiliar:
        \begin{equation*}
            L_2' = \{u\in \{0,1\}^\ast \mid |u|\leq 2\cdot 1000\}
        \end{equation*}

        Veamos que $L_2'$ es finito. Como el número de combinaciones de $n$ elementos de $\{0,1\}$ es $2^n$, entonces el número de palabras de longitud menor o igual a $2\cdot 1000$ es:
        \begin{equation*}
            |L_2'| = \sum_{i=0}^{2\cdot 1000} 2^i <\infty
        \end{equation*}

        Por tanto, como $L_2\subset L_2'$ finito, tenemos que $L_2$ es finito y por tanto regular.

        \item $L_3=\{uu^{-1} \mid u \in {\{0,1\}}^\ast, |u|\geq 1000\}$
        
        Sabemos que el siguiente lenguaje es independiente del contexto:
        \begin{equation*}
            L_3' = \{uu^{-1} \mid u \in {\{0,1\}}^\ast\}
        \end{equation*}

        Además, tenemos que $L_3'=L_2\cup L_3$. Supongamos que $L_3$ es regular. Entonces, como $L_2$ es regular, tendríamos que $L_3'$ es regular, lo cual es una contradicción. Por tanto, $L_3$ no es regular.
        Para ver que es libre de contexto, consideramos la gramática $G=(V,\{0,1\},P,S)$ con:
        \begin{equation*}
            V=\{S\}\cup \{A_i\mid i\in \{1,\dots,1000\}\}
        \end{equation*}

        Tenemos que $P$ está definido por:
        \begin{align*}
            S &\rightarrow 0A_10 \mid 1A_11, \\
            A_i &\rightarrow 0A_{i+1}0 \mid 1A_{i+1},\qquad i\in \{1,\dots,999\},\\
            A_{1000} &\rightarrow 0A_{1000}0 \mid 1A_{1000}1 \mid \varepsilon
        \end{align*}

        Notemos que, en $A_i$, ya hemos leído $i$ caracteres de $u$ (la palabra que forma la mitad del palíndromo).
        Una vez hemos llegado a $A_{1000}$, hemos leído $1000$ caracteres de $u$. Por tanto, podemos añadir los que queramos sin restricción, y podemos también terminar.
        Como $L_3=\cc{L}(G)$, tenemos que $L_3$ es independiente del contexto.
        
        \item $L_4=\{0^i 1^j 2^k \mid i = j \text{\ ó\ } j=k\}$
        
        Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^n1^n2^{2n}\in L_4$ con $|z|=3n\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1,2\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{n-k-l}1^n2^{2n} \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+n-k-l}1^n2^{2n}=0^{n+l}1^n2^{2n}\notin L_4$, ya que, como $l\geq 1$:
        \begin{equation*}
            n+l\neq n \quad \text{y} \quad n\neq 2n
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular. Veamos ahora que sí es libre de contexto. Consideramos la gramática $G=(V,\{0,1,2\},P,S)$ donde $V=\{S,S_1,S_2,A_0,A_2\}$ y $P$ está definido por:
        \begin{align*}
            S &\rightarrow S_1 A_2 \mid A_0 S_2 \\
            S_1 &\rightarrow 0S_1 1 \mid \varepsilon \\
            A_2 &\rightarrow 2 A_2 \mid \varepsilon \\
            S_2 &\rightarrow 1S_2 2 \mid \varepsilon \\
            A_0 &\rightarrow 0 A_0 \mid \varepsilon
        \end{align*}

        Tenemos que $G$ es una gramática libre de contexto tal que $\cc{L}(G)=L_4$, por lo que $L_4$ es libre de contexto.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.2}
    Determinar qué lenguajes son regulares o libres de contexto de los siguientes:
    \begin{enumerate}
        \item $\{u0u^{-1}\mid u \in {\{0,1\}}^\ast\}$
        
        Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^{n}10^n\in L$ con $|z|=2n+1\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{n-k-l}10^n \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+n-k-l}10^n=0^{n+l}10^n\notin L$, ya que, como $l\geq 1$:
        \begin{equation*}
            n+l\neq n
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular. Veamos ahora que sí es libre de contexto. Consideramos la gramática $G=(\{S\},\{0,1\},P,S)$, con $P$ definido por:
        \begin{align*}
            S &\rightarrow 0S0 1S1 \mid 0 \mid 1
        \end{align*}

        Tenemos que $G$ es una gramática libre de contexto tal que $\cc{L}(G)=L$, por lo que $L$ es libre de contexto.

        \item Números en binario que sean múltiplos de 4
        
        Tenemos que todos los números en binario que son múltiplos de 4 terminan en $00$, por lo que vienen dados por la siguiente expresión regular:
        \begin{equation*}
            0^* + (1+0)^{\ast}00
        \end{equation*}

        Notemos que hemos incluido $0^*$, porque el $0$ también es múltiplo de $4$. Por tanto, es regular.

        \item Palabras de ${\{0,1\}}^\ast$ que no contienen la subcadena $0110$.
        
        Notemos que podríamos dar un autómata que reconociese ese lenguaje, pero no es la opción más sencilla.
        Veamos en primer lugar que el lenguaje formado por las palabras que sí contienen la subcadena $0110$ es regular dando una expresión regular asociada a él:
        \begin{equation*}
            (0+1)^*\red{0110}(0+1)^*
        \end{equation*}

        Como el lenguaje descrito es su complementario y el complementario de un regular es regular, tenemos que el lenguaje dado es regular.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.3}
    Determinar qué lenguajes son regulares y qué lenguajes son libres de contexto entre los siguientes:
    \begin{enumerate}
        \item \label{ej:1.3.3.1}
        Conjunto de palabras sobre el alfabeto $\{0,1\}$ en las que cada 1 va precedido por un número par de ceros.
        
        Un reconocedor del lenguaje es el autómata de la figura \ref{fig:1.3.3-1},
        que tiene los siguientes estados:
        \begin{itemize}
            \item $q_0$: Llevo un número par de ceros consecutivos, puedo leer un $1$.
            \item $q_1$: Llevo un número impar de ceros consecutivos, no puedo leer un $1$.
            \item $q_2$: Acabo de leer un $1$.
        \end{itemize}
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, accepting, initial] (q0) {$q_0$};
                \node[state, accepting, right of=q0] (q1) {$q_1$};
                \node[state, accepting, below of=q0] (q2) {$q_2$};
                \node[state, below of=q1, error] (E) {$E$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q0) edge[left] node{1} (q2)
                        (q1) edge[above, bend right] node{0} (q0)
                        (q1) edge[right] node{1} (E)
                        (q2) edge[above] node{0} (q1)
                        (q2) edge[above] node{1} (E)
                        (E) edge[loop right] node{0,1} (E);
            \end{tikzpicture}
            \caption{Autómata que reconoce el lenguaje del ejercicio~\ref{ej:1.3.3}.\ref{ej:1.3.3.1}.}
            \label{fig:1.3.3-1}
        \end{figure}

        Por tanto, como hemos dado un autómata que reconoce el lenguaje, es regular.
        
        \item Conjunto $\{0^i 1^{2j}0^{i+j} \mid i,j\geq 0\}$
        
        Usaremos el Lema de Bombeo para demostrar que no es regular. Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^n1^{2n}0^{2n}$ con $|z|=5n\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{n-k-l}1^{2n}0^{2n} \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+n-k-l}1^{2n}0^{2n}=0^{n+l}1^{2n}0^{2n}\notin L$, ya que, como $l\geq 1$:
        \begin{equation*}
            2n\neq n+n+l
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular.
        Veamos ahora que es libre de contexto. Consideramos la gramática $G=(\{S,X\},\{0,1\},P,S)$, con $P$ definido por:
        \begin{align*}
            S &\rightarrow 11S0 \mid X,\\
            X &\rightarrow 0X0 \mid \veps.
        \end{align*}

        Tenemos que $G$ es una gramática libre de contexto tal que $\cc{L}(G)=L$, por lo que $L$ es libre de contexto.

        \item Conjunto $\{0^i 1^{j} 0^{i\ast j}\mid i,j\geq 0\}$
        
        Usaremos el Lema de Bombeo para demostrar que no es regular. Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^n1^{n}0^{n^2}$ con $|z|=n+n+n^2\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{n-k-l}1^{n}0^{n^2} \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+n-k-l}1^{n}0^{n^2}=0^{n+l}1^{n}0^{n^2}\notin L$, ya que, como $l\geq 1$:
        \begin{equation*}
            (n+l)\cdot n = n^2+nl \neq n^2
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular.
        Además, este lenguaje no es libre de contexto (algo que aún no podemos demostrar).
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.4}
    Determina si los siguientes lenguajes son regulares. Encuentra una gramática que los genere o un reconocedor que los acepte.
    \begin{enumerate}
        \item $L_1 = \{0^i 1^j \mid j < i\}$.
        
        Usaremos el Lema de Bombeo para demostrar que no es regular. Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^{n+1}1^{n}\in L_1$ con $|z|=2n+1\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{n+1-k-l}1^{n} \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=0$, tenemos que $uv^iw=0^{k+n+1-k-l}1^{n}=0^{n+1-l}1^{n}\notin L_1$, ya que:
        \begin{equation*}
            n < n+1-l \Longleftarrow l<1
        \end{equation*}
        Pero esto es una contradicción, ya que $l\geq 1$. Por tanto, por el recíproco del Lema de Bombeo, no es regular.
        Veamos ahora que es libre de contexto. Consideramos la gramática $G=(\{S\},\{0,1\},P,S)$, con $P$ definido por:
        \begin{align*}
            S &\rightarrow 0S \mid 0S'\\
            S' &\rightarrow 0S'1 \mid \veps
        \end{align*}

        Tenemos que $G$ es una gramática libre de contexto tal que $\cc{L}(G)=L_1$, por lo que $L_1$ es libre de contexto. Notemos que
        la producción $S\rightarrow 0S'$ fuerza a que haya al menos un $0$ más que $1$, y la producción $S\rightarrow 0S$ permite que la diferencia no sea de una sola unidad, sino que pueda ser mayor.

        \item $L_2 = \{001^i 0^j \mid i,j \geq 1\}$.
        
        Tenemos que un reconocedor de $L_2$ es:
        \begin{equation*}
            001^+0^+
        \end{equation*}

        Por tanto, tenemos que $L_2$ es regular.
        \item $L_3 = \{010u \mid u \in {\{0,1\}}^{\ast}, u \text{ no contiene la subcadena } 010\}$.
        
        Sea $L'=\{u\in \{0,1\}^\ast \mid u \text{ contiene la subcadena } 010\}$. Entonces sabemos que $L'$ es regular con reconocedor:
        \begin{equation*}
            (0+1)^*\red{010}(0+1)^*
        \end{equation*}

        Por tanto, $\ol{L'}$ es regular, por lo que está asociado a una expresión regular, sea esta $\wt{r}$. Entonces, $L_3$ es regular y está asociado a la expresión regular:
        \begin{equation*}
            010\wt{r}
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.5}
    Sea el alfabeto $A=\{0,1,+,=\}$, demostrar que el lenguaje
    \begin{equation*}
        \text{ADD} = \{x=y+z \mid x,y,z \text{ son números en binario, y } x \text{ es la suma de  } y \text{ y } z\}
    \end{equation*}
    no es regular.\\

    Usaremos el Lema de Bombeo para demostrar que no es regular. Para todo $n\in \mathbb{N}$, consideramos la palabra $w=[1^n = 0+1^n]$, donde hemos empleado los corchetes para facilitar la notación (ya que el $=$ lo estamos usando para igualdades entre cadenas y entre números en binario). Tenemos que $|w|=n+3+n\geq n$. Toda descomposición $w=uvw$, con $u,v,w\in \{0,1,+,=\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
    \begin{equation*}
        u=1^k \quad v=1^l \quad w=[1^{n-k-l} = 0+1^n] \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
    \end{equation*}

    Para $i=2$, tenemos que $uv^iw=[1^{k+2l+n-k-l} = 0+1^n]=[1^{n+l} = 0+1^n]\notin \text{ADD}$, ya que, como $l\geq 1$, en números binarios:
    \begin{equation*}
        1^{n+l} \neq 0+1^n=1^n
    \end{equation*}

    Por tanto, por el recíproco del Lema de Bombeo, no es regular.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.6}
    Determinar si los siguientes lenguajes son regulares o no:
    \begin{enumerate}
        \item $L=\{uvu^{-1} \mid u,v \in {\{0,1\}}^{\ast}\}$.\\
        
        Veamos en primer lugar que $L=\{0,1\}^*$ por doble inclusión:
        \begin{description}
            \item[$\subset$)] Se tiene trivialmente que $L\subset \{0,1\}^*$.
            \item[$\supset$)] Sea $w\in \{0,1\}^*$. Entonces, podemos tomar $u=\varepsilon$ y $v=w$ para obtener $w\in L$.
        \end{description}

        Por tanto, tenemos que $L$ es regular, con reconocedor:
        \begin{equation*}
            (0+1)^*
        \end{equation*}

        \item $L$ es el lenguaje sobre el alfabeto $\{0,1\}$ formado de las palabras de la forma $u0v$ donde $u^{-1}$ es un prefijo de $v$.
        
        Usaremos el Lema de Bombeo para demostrar que no es regular. Para todo $n\in \mathbb{N}$, consideramos la palabra $z=1^n01^n\in L$ con $|z|=2n+1\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=1^k \quad v=1^l \quad w=1^{n-k-l}01^n \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=1^{k+2l+n-k-l}01^n=1^{n+l}01^n\notin L$, ya que, como $l\geq 1$:
        \begin{equation*}
            n+l\neq n\Longrightarrow (1^{n+l})^{-1}=1^{n+l}\neq 1^n
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular.
        \item $L$ es el lenguaje sobre el alfebeto $\{0,1\}$ formado por las palabres en las que el tercer símbolo empezando por el final es un 1.
        
        Este lenguaje es regular, con reconocedor:
        \begin{equation*}
            (0+1)^*\red{1}(0+1)(0+1)
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.7}
    Obtener autómatas finitos determinísticos para los siguientes lenguajes sobre el alfabeto $\{0,1\}$.
    \begin{enumerate}
        \item \label{ej:1.3.7.1}
        Palabras en las que el número de 1 es múltiplo de 3 y el número de 0 es par.
        
        El estado $q_{ij}$ para $i=0,1,2$ y $j=0,1$ indica que:
        \begin{itemize}
            \item $n_1(u) \text{mod} 3=i$,
            \item $n_0(u) \text{mod} 2=j$.
        \end{itemize}

        Entonces, el autómata es el de la Figura~\ref{fig:1.3.7.1}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q00) {$q_{00}$};
                \node[state, right of=q00] (q01) {$q_{01}$};
                \node[state, right of=q01] (q02) {$q_{02}$};
                \node[state, below of=q00] (q10) {$q_{10}$};
                \node[state, right of=q10] (q11) {$q_{11}$};
                \node[state, right of=q11] (q12) {$q_{12}$};
    
                \draw   (q00) edge[above] node{1} (q01)
                        (q01) edge[above] node{1} (q02)
                        (q02) edge[above, bend right] node{1} (q00)
                        (q10) edge[above] node{1} (q11)
                        (q11) edge[above] node{1} (q12)
                        (q12) edge[below, bend left] node{1} (q10)
                        (q00) edge[left] node{0} (q10)
                        (q10) edge[right, bend right] node{0} (q00)
                        (q01) edge[left] node{0} (q11)
                        (q11) edge[right, bend right] node{0} (q01)
                        (q02) edge[left] node{0} (q12)
                        (q12) edge[right, bend right] node{0} (q02);
            \end{tikzpicture}
            \caption{Autómata que reconoce el lenguaje del ejercicio~\ref{ej:1.3.7}.\ref{ej:1.3.7.1}.}
            \label{fig:1.3.7.1}
        \end{figure}


        \item \label{ej:1.3.7.2}
        $\{{(01)}^{2i} \mid i \geq 0\}$
        
        El autómata es el de la Figura~\ref{fig:1.3.7.2}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, right of=q2] (q3) {$q_3$};
                \node[state, below of=q1, xshift=4em, error] (E) {$E$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[above] node{0} (q3)
                        (q3) edge[above, bend right] node{1} (q0);

                \draw[opacity=0.6]
                        (q0) edge[right] node{1} (E)
                        (q1) edge[right] node{0} (E)
                        (q2) edge[right] node{1} (E)
                        (q3) edge[right] node{0} (E)
                        (E) edge[loop right] node{0,1} (E);


            \end{tikzpicture}
            \caption{Autómata que reconoce el lenguaje del ejercicio~\ref{ej:1.3.7}.\ref{ej:1.3.7.2}.}
            \label{fig:1.3.7.2}
        \end{figure}
        \item $L_3=\{(0^{2i}1^{2i}) \mid i \geq 0\}$
        
        Veamos que este lenguaje no es regular con el Lema de Bombeo. Para todo $n\in \mathbb{N}$, consideramos la palabra $z=0^{2n}1^{2n}\in L_3$ con $|z|=4n\geq n$. Toda descomposición $z=uvw$, con $u,v,w\in \{0,1\}^\ast$, $|uv|\leq n$ y $|v|\geq 1$ debe cumplir que:
        \begin{equation*}
            u=0^k \quad v=0^l \quad w=0^{2n-k-l}1^{2n} \qquad \text{con } l,k\in \bb{N}\cup \{0\},~l\geq 1,~k+l\leq n
        \end{equation*}

        Para $i=2$, tenemos que $uv^iw=0^{k+2l+2n-k-l}1^{2n}=0^{2n+l}1^{2n}\notin L_3$, ya que, como $l\geq 1$:
        \begin{equation*}
            2n+l\neq 2n
        \end{equation*}

        Por tanto, por el recíproco del Lema de Bombeo, no es regular. Por tanto, no es posible construir un autómata finito determinístico que reconozca $L_3$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.8}
    Dar una expresión regular para la intersección de los lenguajes asociados a las expresiones regulares ${(01+1)}^{\ast}0$ y ${(10+0)}^{\ast}$. Se valorará que se construya el autómata que acepta la intersección de estos lenguajes, se minimice y, a partir del resultado, se construya la expresión regular.\\

    Sea $r_1=(01+1)^{\ast}0$ y $r_2=(10+0)^{\ast}$. Construimos los AFND asociados a $r_1$ y $r_2$, mostrados en las figuras \ref{fig:1.3.8-AFND1} y \ref{fig:1.3.8-AFND2}, respectivamente.
    \begin{figure}
        \centering
        \begin{subfigure}[c]{0.45\textwidth}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, accepting, below of=q0] (q2) {$q_2$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q0) edge[loop above] node{1} (q0)
                        (q1) edge[above, bend right] node{1} (q0)
                        (q0) edge[right] node{0} (q2);
            \end{tikzpicture}
            \caption{AFND asociado a $r_1$.}
            \label{fig:1.3.8-AFND1}
        \end{subfigure}
        \begin{subfigure}[c]{0.45\textwidth}
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};

                \draw   (q0) edge[above] node{1} (q1)
                        (q0) edge[loop above] node{0} (q0)
                        (q1) edge[above, bend right] node{0} (q0);
            \end{tikzpicture}
            \caption{AFND asociado a $r_2$.}
            \label{fig:1.3.8-AFND2}
        \end{subfigure}
        \caption{AFND asociados a las expresiones regulares $r_1$ y $r_2$.}
        \label{fig:1.3.8-AFND}
    \end{figure}

    Para poder aplicar el algoritmo de intersección de autómatas, antes hemos de convertir los autómatas en AFD. Los AFD asociados a $r_1$ y $r_2$ son los de las figuras \ref{fig:1.3.8-AFD1} y \ref{fig:1.3.8-AFD2}, respectivamente.
    \begin{figure}[H]
        \centering
        \begin{subfigure}[c]{0.45\textwidth}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q10) {$q_{10}$};
                \node[state, right of=q0, accepting] (q11) {$q_{11}$};
                \node[state, error, below of=q11] (E1) {$E_1$};

                \draw   (q10) edge[above] node{0} (q11)
                        (q10) edge[loop above] node{1} (q10)
                        (q11) edge[above, bend right] node{1} (q10)
                        (q11) edge[right] node{0} (E1)
                        (E1) edge[loop left] node{0,1} (E1);
            \end{tikzpicture}
            \caption{AFD asociado a $r_1$.}
            \label{fig:1.3.8-AFD1}
        \end{subfigure}
        \begin{subfigure}[c]{0.45\textwidth}
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q20) {$q_{20}$};
                \node[state, right of=q0] (q21) {$q_{21}$};
                \node[state, error, below of=q21] (E2) {$E_2$};

                \draw   (q0) edge[above] node{1} (q1)
                        (q0) edge[loop above] node{0} (q0)
                        (q1) edge[above, bend right] node{0} (q0)
                        (q1) edge[right] node{1} (E2)
                        (E2) edge[loop left] node{0,1} (E2);
            \end{tikzpicture}
            \caption{AFD asociado a $r_2$.}
            \label{fig:1.3.8-AFD2}
        \end{subfigure}
        \caption{AFD asociados a las expresiones regulares $r_1$ y $r_2$.}
        \label{fig:1.3.8-AFD}
    \end{figure}

    Por tanto, el AFD que acepta la intersección de los lenguajes asociados a $r_1$ y $r_2$ es el de la figura \ref{fig:1.3.8-AFD-Interseccion}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q10_20) {$q_{10}q_{20}$};
            \node[state, above right of=q10_20, accepting] (q11_20) {$q_{11}q_{20}$};
            \node[state, below right of=q10_20] (q10_21) {$q_{10}q_{21}$};
            \node[state, right of=q11_20] (qE1_20) {$E_1q_{20}$};
            \node[state, right of=qE1_20] (qE1_21) {$E_1q_{21}$};
            \node[state, below right of=qE1_21] (E1_E2) {$E_1E_2$};
            \node[state, right of=q10_21] (q10_E2) {$q_{10}E_2$};
            \node[state, right of=q10_E2] (q11_E2) {$q_{11}E_2$};

            \draw   (q10_20) edge[above] node{0} (q11_20)
                    (q10_20) edge[below] node{1} (q10_21)
                    (q11_20) edge[above] node{0} (qE1_20)
                    (q11_20) edge[right, bend right] node{1} (q10_21)
                    (q10_21) edge[above] node{1} (q10_E2)
                    (q10_21) edge[right, bend right] node{0} (q11_20)
                    (qE1_20) edge[above] node{1} (qE1_21)
                    (qE1_20) edge[loop below] node{0} (qE1_20)
                    (qE1_21) edge[above] node{1} (E1_E2)
                    (qE1_21) edge[bend left, below] node{0} (qE1_20)
                    (E1_E2) edge[loop right] node{0,1} (E1_E2)
                    (q10_E2) edge[above] node{0} (q11_E2)
                    (q10_E2) edge[loop above] node{1} (q10_E2)
                    (q11_E2) edge[above] node{0} (E1_E2)
                    (q11_E2) edge[bend right, above] node{1} (q10_E2);
        \end{tikzpicture}
        \caption{AFD que acepta la intersección de los lenguajes asociados a $r_1$ y $r_2$.}
        \label{fig:1.3.8-AFD-Interseccion}
    \end{figure}

    Para minimizarlo, consideramos en primer lugar que los siguientes estados son indistinguibles:
    \begin{equation*}
        q_E := \{E_{1}q_{20},E_{1}q_{21}, q_{10}E_{2},q_{11}E_{2}, E_{1}E_{2}\}
    \end{equation*}

    Estos son indistinguibles puesto que desde ninguno de ellos se puede llegar a un estado final. Por tanto, el AFD minimal es el de la figura \ref{fig:1.3.8-AFD-Interseccion-Minimal}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q10_20) {$q_{10}q_{20}$};
            \node[state, above right of=q10_20, accepting] (q11_20) {$q_{11}q_{20}$};
            \node[state, below right of=q10_20] (q10_21) {$q_{10}q_{21}$};
            \node[state, below right of=q11_20] (qE) {$q_{E}$};

            \draw   (q10_20) edge[above] node{0} (q11_20)
                    (q10_20) edge[below] node{1} (q10_21)
                    (q11_20) edge[bend right, right] node{1} (q10_21)
                    (q11_20) edge[above] node{0} (qE)
                    (q10_21) edge[below] node{1} (qE)
                    (q10_21) edge[bend right, left] node{0} (q11_20)
                    (qE) edge[loop right] node{0,1} (qE);
        \end{tikzpicture}
        \caption{AFD minimal que acepta la intersección de los lenguajes asociados a $r_1$ y $r_2$.}
        \label{fig:1.3.8-AFD-Interseccion-Minimal}
    \end{figure}

    Tenemos que es minimal, puesto que todos los estados son alcanzables y no hay estados distinguibles:
    \begin{itemize}
        \item $q_{11}q_{20}$ es distinguible del resto de estados por ser el único estado final.
        \item $q_{E}$ es distinguible de $q_{10}q_{20}$ y $q_{10}q_{21}$, ya que leyendo un $0$:
        \begin{equation*}
            \delta(q_{E},0)=q_{E}\notin F\qquad \delta(q_{10}q_{20},0)=\delta(q_{10}q_{21},0)=q_{11}q_{20}\in F
        \end{equation*}

        \item $q_{10}q_{20}$ y $q_{10}q_{21}$ son distinguibles, ya que leyendo $10$:
        \begin{equation*}
            \delta(q_{10}q_{20},1)=q_{11}q_{20}\in F\qquad \delta(q_{10}q_{21},1)=q_{E}\notin F
        \end{equation*}
    \end{itemize}

    Por tanto, el AFD minimal que acepta la intersección de los lenguajes asociados a $r_1$ y $r_2$ es el de la figura \ref{fig:1.3.8-AFD-Interseccion-Minimal}. Para obtener la expresión regular asociada, resolvemos el sistema de ecuaciones:
    \begin{align*}
        q_{10}q_{20} &= 0q_{11}q_{20}+1q_{10}q_{21}\\
        q_{11}q_{20} &= 0q_{E}+1q_{10}q_{21} + \veps\\
        q_{10}q_{21} &= 0q_{11}q_{20}+1q_{E}\\
        q_{E} &= 0q_{E}+1q_{E} = (0+1)q_{E}
    \end{align*}

    Por el Lema de Arden, como $q_E = (0+1)q_E + \emptyset$, tenemos que $q_E=(0+1)^*\emptyset = \emptyset$. Sustituyendo en las ecuaciones anteriores, obtenemos:
    \begin{align*}
        q_{10}q_{20} &= 0q_{11}q_{20}+1q_{10}q_{21}\\
        q_{11}q_{20} &= 1q_{10}q_{21} + \veps\\
        q_{10}q_{21} &= 0q_{11}q_{20}
    \end{align*}

    Sustituyendo $q_{10}q_{21}$ en la segunda ecuación, obtenemos:
    \begin{equation*}
        q_{11}q_{20} = 1q_{11}q_{20} + \veps \Longrightarrow q_{11}q_{20} = 10q_{11}q_{20}+ \veps = (10)^*\veps = (10)^*
    \end{equation*}

    Sustituyendo ambos en la primera ecuación, obtenemos:
    \begin{equation*}
        q_{10}q_{20} = 0(10)^* + 10q_{11}q_{20} = 0(10)^* + 10(10)^* = (0+10)(10)^*
    \end{equation*}

    Por tanto, la expresión regular asociada al AFD minimal de la figura \ref{fig:1.3.8-AFD-Interseccion-Minimal} es $$(0+10)(10)^*.$$    
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.9}
    Construir un Autómata Finito Determinista Minimal que acepte el lenguaje sobre el alfabeto $\{a,b,c\}$ de todas aquellas palabras que verifiquen simultáneamente las siguientes condiciones.
    \begin{enumerate}
        \item \label{ej:1.3.9.1}
        La palabra contiene un número par de a's.
        \item \label{ej:1.3.9.2}
        La longitud de la palabra es un múltiplo de 3.
        \item \label{ej:1.3.9.3}
        La palabra no contiene la subcadena $abc$.
    \end{enumerate}

    La condición \ref{ej:1.3.9.1} se puede cumplir con el autómata de la figura \ref{fig:1.3.9-AFD1}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, accepting, initial] (a0) {$a_0$};
            \node[state, right of=a0] (a1) {$a_1$};

            \draw   (a0) edge[loop above] node{$b,c$} (a0)
                    (a0) edge[above, bend left] node{$a$} (a1)
                    (a1) edge[loop above] node{$b,c$} (a1)
                    (a1) edge[below, bend left] node{$a$} (a0);
        \end{tikzpicture}
        \caption{AFD que acepta palabras con número par de $a$'s.}
        \label{fig:1.3.9-AFD1}
    \end{figure}

    La condición \ref{ej:1.3.9.2} se puede cumplir con el autómata de la figura \ref{fig:1.3.9-AFD2}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (b0) {$b_0$};
            \node[state, right of=b0] (b1) {$b_1$};
            \node[state, right of=b1] (b2) {$b_2$};

            \draw   (b0) edge[above] node{$a,b,c$} (b1)
                    (b1) edge[above] node{$a,b,c$} (b2)
                    (b2) edge[above, bend right] node{$a,b,c$} (b0);
        \end{tikzpicture}
        \caption{AFD que acepta palabras de longitud múltiplo de 3.}
        \label{fig:1.3.9-AFD2}
    \end{figure}

    La condición \ref{ej:1.3.9.3} se puede cumplir con el autómata de la figura \ref{fig:1.3.9-AFD3}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (c0) {$c_0$};
            \node[state, right of=c0] (c1) {$c_1$};
            \node[state, right of=c1] (c2) {$c_2$};
            \node[state, right of=c2] (c3) {$c_3$};

            \draw   (c0) edge[above] node{$a$} (c1)
                    (c0) edge[loop above] node{$b,c$} (c0)
                    (c1) edge[above] node{$b$} (c2)
                    (c1) edge[loop below] node{$a$} (c1)
                    (c1) edge[below, bend left] node{$c$} (c0)
                    (c2) edge[above] node{$c$} (c3)
                    (c2) edge[below, bend left] node{$a$} (c1)
                    (c2) edge[above, bend right] node{$b$} (c0)
                    (c3) edge[loop above] node{$a,b,c$} (c3);
        \end{tikzpicture}
        \caption{AFD que acepta palabras que no contienen la subcadena $abc$.}
        \label{fig:1.3.9-AFD3}
    \end{figure}

    El autómata producto tiene los siguientes estados:
    \begin{align*}
        Q&=\{a_ib_jc_k\mid i\in\{0,1\},j\in\{0,1,2\},k\in\{0,1,2,3\}\}\\
        F&=\{a_0b_0c_0\}
    \end{align*}

    El autómata producto es $M=(Q,\{a,b,c\},\delta,a_0b_0c_0,F)$, donde $\delta$ viene dado por la tabla~\ref{tab:1.3.9-AFD-Producto}.
    Además, todos sus estados son accesibles.
    \begin{table}[h!]
        \centering
        \resizebox{1.1\textwidth}{!}{
        \begin{tabular}{r|cccccccccccc}
            & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ & $11$ & $12$ \\
            $\delta$ & $a_0b_0c_0$ & $a_0b_0c_1$ & $a_0b_0c_2$ & $a_0b_0c_3$ & $a_0b_1c_0$ & $a_0b_1c_1$ & $a_0b_1c_2$ & $a_0b_1c_3$ & $a_0b_2c_0$ & $a_0b_2c_1$ & $a_0b_2c_2$ & $a_0b_2c_3$ \\\hline
            $a$ & $a_1b_1c_1$ & $a_1b_1c_1$ & $a_1b_1c_1$ & $a_1b_1c_3$ & $a_1b_2c_1$ & $a_1b_2c_1$ & $a_1b_2c_1$ & $a_1b_2c_3$ & $a_1b_0c_1$ & $a_1b_0c_1$ & $a_1b_0c_1$ & $a_1b_0c_3$ \\
            $b$ & $a_0b_1c_0$ & $a_0b_1c_2$ & $a_0b_1c_0$ & $a_0b_1c_3$ & $a_0b_2c_0$ & $a_0b_2c_2$ & $a_0b_2c_0$ & $a_0b_2c_3$ & $a_0b_0c_0$ & $a_0b_0c_2$ & $a_0b_0c_0$ & $a_0b_0c_3$ \\
            $c$ & $a_0b_1c_0$ & $a_0b_1c_0$ & $a_0b_1c_3$ & $a_0b_1c_3$ & $a_0b_2c_0$ & $a_0b_2c_0$ & $a_0b_2c_3$ & $a_0b_2c_3$ & $a_0b_0c_0$ & $a_0b_0c_0$ & $a_0b_0c_3$ & $a_0b_0c_3$ \\
            \hline \hline \\ \hline \hline 
            & $13$ & $14$ & $15$ & $16$ & $17$ & $18$ & $19$ & $20$ & $21$ & $22$ & $23$ & $24$ \\
            $\delta$ & $a_1b_0c_0$ & $a_1b_0c_1$ & $a_1b_0c_2$ & $a_1b_0c_3$ & $a_1b_1c_0$ & $a_1b_1c_1$ & $a_1b_1c_2$ & $a_1b_1c_3$ & $a_1b_2c_0$ & $a_1b_2c_1$ & $a_1b_2c_2$ & $a_1b_2c_3$ \\\hline
            $a$ & $a_0b_1c_1$ & $a_0b_1c_1$ & $a_0b_1c_1$ & $a_0b_1c_3$ & $a_0b_2c_1$ & $a_0b_2c_1$ & $a_0b_2c_1$ & $a_0b_2c_3$ & $a_0b_0c_1$ & $a_0b_0c_1$ & $a_0b_0c_1$ & $a_0b_0c_3$ \\
            $b$ & $a_1b_1c_0$ & $a_1b_1c_2$ & $a_1b_1c_0$ & $a_1b_1c_3$ & $a_1b_2c_0$ & $a_1b_2c_2$ & $a_1b_2c_0$ & $a_1b_2c_3$ & $a_1b_0c_0$ & $a_1b_0c_2$ & $a_1b_0c_0$ & $a_1b_0c_3$ \\
            $c$ & $a_1b_1c_0$ & $a_1b_1c_0$ & $a_1b_1c_3$ & $a_1b_1c_3$ & $a_1b_2c_0$ & $a_1b_2c_0$ & $a_1b_2c_3$ & $a_1b_2c_3$ & $a_1b_0c_0$ & $a_1b_0c_0$ & $a_1b_0c_3$ & $a_1b_0c_3$
        \end{tabular}}
        \caption{Transiciones del autómata producto para el ejercicio~\ref{ej:1.3.9}.}
        \label{tab:1.3.9-AFD-Producto}
    \end{table}

    \begin{comment}
    La minimización del autómata producto se muestra en la figura \ref{fig:1.3.9-AFD-Minimal}.
    \begin{table}[H]
        \centering
        \resizebox{1.1\textwidth}{!}{
        \begin{tabular}{r c c c c c c c c c c c c c c c c c c c c c c c c c c c cc c c c c c c c c c c c c c c c c c c c c c c c c c c c}
            \hhline{~*{1}{-}}
            $2$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $3$ & \cell{\times} & \cell{} \\ \hhline{~*{3}{-}}
            $4$ & \cell{\times} & \cell{} & \cell{} \\ \hhline{~*{4}{-}}
            $5$ & \cell{\times} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{5}{-}}
            $6$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{6}{-}}
            $7$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{7}{-}}
            $8$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{8}{-}}
            $9$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{9}{-}}
            $10$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{10}{-}}
            $11$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{11}{-}}
            $12$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{12}{-}}
            $13$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} \\ \hhline{~*{13}{-}}
            $14$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} \\ \hhline{~*{14}{-}}
            $15$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{15}{-}}
            $16$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{16}{-}}
            $17$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{17}{-}}
            $18$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{18}{-}}
            $19$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{19}{-}}
            $20$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{20}{-}}
            $21$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{21}{-}}
            $22$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{22}{-}}
            $23$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{23}{-}}
            $24$ & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{24}{-}}
            & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $10$ & $11$ & $12$ & $13$ & $14$ & $15$ & $16$ & $17$ & $18$ & $19$ & $20$ & $21$ & $22$ & $23$
        \end{tabular}
        }
        \caption{Tabla de minimización del autómata producto para el ejercicio~\ref{ej:1.3.9}.}
        \label{fig:1.3.9-AFD-Minimal}
    \end{table}
    \end{comment}
    
    % // TODO: Minimizar

\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.10}
    Encontrar un AFD minimal para el lenguaje
    \begin{equation*}
        {(a+b)}^{\ast}(aa+bb){(a+b)}^{\ast}
    \end{equation*}

    Para ello, primero construimos el AFND asociado a la expresión regular, mostrado en la figura \ref{fig:1.3.10-AFND}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0] (q1) {$q_1$};
            \node[state, below right of=q0] (q2) {$q_2$};
            \node[state, above right of=q2, accepting] (q3) {$q_3$};


            \draw   (q0) edge[loop above] node{$a,b$} (q0)
                    (q0) edge[above] node{$a$} (q1)
                    (q0) edge[below] node{$b$} (q2)
                    (q1) edge[above] node{$a$} (q3)
                    (q2) edge[below] node{$b$} (q3)
                    (q3) edge[loop above] node{$a,b$} (q3);
        \end{tikzpicture}
        \caption{AFND asociado a la expresión regular ${(a+b)}^{\ast}(aa+bb){(a+b)}^{\ast}$.}
        \label{fig:1.3.10-AFND}
    \end{figure}

    Convertimos el AFND en un AFD, mostrado en la figura \ref{fig:1.3.10-AFD}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0] (q0q1) {$q_0q_1$};
            \node[state, below right of=q0] (q0q2) {$q_0q_2$};
            \node[state, right of=q0q1, accepting] (q0q1q3) {$q_0q_1q_3$};
            \node[state, right of=q0q2, accepting] (q0q2q3) {$q_0q_2q_3$};

            \draw   (q0) edge[above] node{$a$} (q0q1)
                    (q0) edge[below] node{$b$} (q0q2)
                    (q0q1) edge[above] node{$a$} (q0q1q3)
                    (q0q1) edge[bend right, right] node{$b$} (q0q2)
                    (q0q2) edge[below] node{$b$} (q0q2q3)
                    (q0q2) edge[bend right, left] node{$a$} (q0q1)
                    (q0q1q3) edge[loop above] node{$a$} (q0q1q3)
                    (q0q1q3) edge[bend right, right] node{$b$} (q0q2q3)
                    (q0q2q3) edge[loop below] node{$b$} (q0q2q3)
                    (q0q2q3) edge[bend right, left] node{$a$} (q0q1q3);

        \end{tikzpicture}
        \caption{AFD asociado a la expresión regular ${(a+b)}^{\ast}(aa+bb){(a+b)}^{\ast}$.}
        \label{fig:1.3.10-AFD}
    \end{figure}

    No obstante, este no es minimal. En primer lugar, vemos que los estados $q_0q_1q_3$ y $q_0q_2q_3$ son indistinguibles, ya que para cualquier palabra $w\in \{a,b\}^*$:
    \begin{equation*}
        \delta(q_0q_1q_3,w)\in F\qquad \delta(q_0q_2q_3,w)\in F
    \end{equation*}

    Por tanto, notemos $q_F=\{q_0q_1q_3,q_0q_2q_3\}$. El AFD minimal es el de la figura \ref{fig:1.3.10-AFD-Minimal}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0] (q0q1) {$q_0q_1$};
            \node[state, below right of=q0] (q0q2) {$q_0q_2$};
            \node[state, above right of=q0q2, accepting] (qF) {$q_F$};

            \draw   (q0) edge[above] node{$a$} (q0q1)
                    (q0) edge[below] node{$b$} (q0q2)
                    (q0q1) edge[bend right, right] node{$b$} (q0q2)
                    (q0q2) edge[bend right, left] node{$a$} (q0q1)
                    (q0q1) edge[above] node{$a$} (qF)
                    (q0q2) edge[below] node{$b$} (qF)
                    (qF) edge[loop right] node{$a,b$} (qF);
        \end{tikzpicture}
        \caption{AFD minimal asociado a la expresión regular ${(a+b)}^{\ast}(aa+bb){(a+b)}^{\ast}$.}
        \label{fig:1.3.10-AFD-Minimal}
    \end{figure}
    \begin{itemize}
        \item $q_F$ es distinguible del resto de estados por ser el único estado final.
        \item $q_0q_1$ y $q_0q_2$ son distinguibles, ya que leyendo un $a$:
        \begin{equation*}
            \delta(q_0q_1,a)=q_F\in F\qquad \delta(q_0q_2,a)=q_0q_1\notin F
        \end{equation*}

        \item $q_0$ y $q_0q_1$ son distinguibles, ya que leyendo un $a$:
        \begin{equation*}
            \delta(q_0,a)=q_0q_1\notin F\qquad \delta(q_0q_1,a)=q_F\in F
        \end{equation*}

        \item $q_0$ y $q_0q_2$ son distinguibles, ya que leyendo un $b$:
        \begin{equation*}
            \delta(q_0,b)=q_0q_2\notin F\qquad \delta(q_0q_2,b)=q_F\in F
        \end{equation*}
    \end{itemize}

    Por tanto, el AFD minimal es el de la figura \ref{fig:1.3.10-AFD-Minimal}.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.11}
    Para cada uno de los siguientes lenguajes regulares, encontrar el autómata minimal asociado, y a partir de dicho autómata minimal, determinar la gramática regular que genera el lenguaje:
    \begin{enumerate}
        \item \label{ej:1.3.11-1}
        $a^+ b^+$
        
        En primer lugar, construimos el AFD asociado al lenguaje, mostrado en la figura \ref{fig:1.3.11-1-AFD}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, accepting, right of=q1] (q2) {$q_2$};
                \node[state, error, below of=q1] (E) {$E$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q0) edge[above] node{$b$} (E)
                        (q1) edge[above] node{$b$} (q2)
                        (q2) edge[loop above] node{$b$} (q2)
                        (q1) edge[loop above] node{$a$} (q1)
                        (q2) edge[above] node{$a$} (E)
                        (E) edge[loop right] node{$a,b$} (E);
            \end{tikzpicture}
            \caption{AFD asociado al lenguaje $a^+b^+$ del ejercicio \ref{ej:1.3.11}.\ref{ej:1.3.11-1}.}
            \label{fig:1.3.11-1-AFD}
        \end{figure}

        Veamos que este es minimal:
        \begin{itemize}
            \item $q_2$ es distinguible del resto de estados por ser el único estado final.
            \item $q_0$ y $q_1$ son distinguibles, ya que leyendo un $b$:
            \begin{equation*}
                \delta(q_0,b)=E\notin F\qquad \delta(q_1,b)=q_2\in F
            \end{equation*}

            \item $q_0$ y $E$ son distinguibles, ya que leyendo un $ab$:
            \begin{equation*}
                \delta^*(q_0,ab)=q_2\in F\qquad \delta^*(E,ab)=E\notin F
            \end{equation*}

            \item $q_1$ y $E$ son distinguibles, ya que leyendo un $b$:
            \begin{equation*}
                \delta(q_1,b)=q_2\in F\qquad \delta(E,b)=E\notin F
            \end{equation*}
        \end{itemize}

        Por tanto, el AFD minimal es el de la figura \ref{fig:1.3.11-1-AFD}. La gramática regular que genera el lenguaje es $G=(\{q_0,q_1,q_2\},\{a,b\},P,\{q_0\})$ con $P$:
        \begin{align*}
            q_0 &\longrightarrow aq_1\\
            q_1 &\longrightarrow aq_1\mid bq_2\\
            q_2 &\longrightarrow bq_2\mid \veps
        \end{align*}
        \item \label{ej:1.3.11-2}
        $a{(a+b)}^{\ast}b$
        
        En primer lugar, construimos el AFND asociado al lenguaje, mostrado en la figura \ref{fig:1.3.11-2-AFND}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, accepting, right of=q1] (q2) {$q_2$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q1) edge[loop above] node{$a,b$} (q1)
                        (q1) edge[above] node{$b$} (q2);
            \end{tikzpicture}
            \caption{AFND asociado al lenguaje $a{(a+b)}^{\ast}b$ del ejercicio \ref{ej:1.3.11}.\ref{ej:1.3.11-2}.}
            \label{fig:1.3.11-2-AFND}
        \end{figure}

        Convertimos el AFND en un AFD, mostrado en la figura \ref{fig:1.3.11-2-AFD}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, accepting, right of=q1] (q2) {$q_1q_2$};
                \node[state, error, below of=q1] (E) {$E$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q0) edge[above] node{$b$} (E)
                        (q1) edge[loop above] node{$a$} (q1)
                        (q1) edge[above] node{$b$} (q2)
                        (q2) edge[loop above] node{$b$} (q2)
                        (q2) edge[above, bend right] node{$a$} (q1)
                        (E) edge[loop right] node{$a,b$} (E);
            \end{tikzpicture}
            \caption{AFD asociado al lenguaje $a{(a+b)}^{\ast}b$ del ejercicio \ref{ej:1.3.11}.\ref{ej:1.3.11-2}.}
            \label{fig:1.3.11-2-AFD}
        \end{figure}

        Veamos que este es minimal:
        \begin{itemize}
            \item $q_1q_2$ es distinguible del resto de estados por ser el único estado final.
            \item $q_0$ y $q_1$ son distinguibles, ya que leyendo un $b$:
            \begin{equation*}
                \delta(q_0,b)=E\notin F\qquad \delta(q_1,b)=q_1q_2\in F
            \end{equation*}

            \item $q_0$ y $E$ son distinguibles, ya que leyendo un $ab$:
            \begin{equation*}
                \delta^*(q_0,ab)=q_1q_2\in F\qquad \delta^*(E,ab)=E\notin F
            \end{equation*}

            \item $q_1$ y $E$ son distinguibles, ya que leyendo un $b$:
            \begin{equation*}
                \delta(q_1,b)=q_1q_2\in F\qquad \delta(E,b)=E\notin F
            \end{equation*}
        \end{itemize}

        Por tanto, el AFD minimal es el de la figura \ref{fig:1.3.11-2-AFD}. La gramática regular que genera el lenguaje es $G=(\{q_0,q_1,q_2\},\{a,b\},P,\{q_0\})$ con $P$:
        \begin{align*}
            q_0 &\longrightarrow aq_1\\
            q_1 &\longrightarrow aq_1\mid bq_2\\
            q_2 &\longrightarrow bq_2\mid aq_1\mid \veps
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.12}
    Considera la gramática cuyas producciones se presentan a continuación y donde el símbolo inicial es $S$:
    \begin{align*}
        S &\rightarrow xN\mid  x \\
        N &\rightarrow yM\mid  y \\
        M &\rightarrow zN\mid  z
    \end{align*}
    \begin{enumerate}
        \item Escribe el diagrama de transiciones para el AFD que acepte el lenguaje $\cc{L}(G)$ generado por $G$.
        
        Las siguientes producciones generan el mismo lenguaje:
        \begin{align*}
            S &\rightarrow xN\\
            N &\rightarrow yM\mid \veps \\
            M &\rightarrow zN\mid \veps
        \end{align*}

        Por tanto, el AFD asociado al lenguaje $\cc{L}(G)$ es el de la figura \ref{fig:1.3.12-AFD}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (S) {$S$};
                \node[state, right of=S, accepting] (N) {$N$};
                \node[state, right of=N, accepting] (M) {$M$};
                \node[state, error, right of=M] (E) {$E$};

                \draw   (S) edge[above] node{$x$} (N)
                        (N) edge[above] node{$y$} (M)
                        (M) edge[bend left, below] node{$z$} (N)
                        (S) edge[below, bend right] node{$y,z$} (E)
                        (N) edge[above, bend left] node{$x,z$} (E)
                        (M) edge[above] node{$x,y$} (E)
                        (E) edge[loop right] node{$x,y,z$} (E);
            \end{tikzpicture}
            \caption{AFD asociado al lenguaje $\cc{L}(G)$ del ejercicio \ref{ej:1.3.12}.}
            \label{fig:1.3.12-AFD}
        \end{figure}
        \item Encuentra una gramática regular por la izquierda que genere ese mismo lenguaje $\cc{L}(G)$.
        
        La expresión regular asociada al lenguaje $\cc{L}(G)$ es:
        \begin{equation*}
            x(yz)^{\ast}(y+\veps)
        \end{equation*}
        
        Sea $G'=(\{S,N,M, F\},\{x,y,z\},P,F)$ con $P$:
        \begin{align*}
            F & \rightarrow N\mid M\\
            N & \rightarrow Sx \mid Mz\\
            M & \rightarrow Ny\\
            S & \rightarrow \veps
        \end{align*}

        Tenemos que $G'$ es una gramática regular por la izquierda, y $\cc{L}(G')=\cc{L}(G)$.

        \item Encuentra el AFD que acepte el complementario del lenguaje $\cc{L}(G)$.
        
        Intercambiando los estados finales por no finales y viceversa en el AFD de la figura \ref{fig:1.3.12-AFD}, obtenemos el AFD asociado al complementario del lenguaje $\cc{L}(G)$, mostrado en la figura \ref{fig:1.3.12-AFD-Complementario}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (S) {$S$};
                \node[state, right of=S] (N) {$N$};
                \node[state, right of=N] (M) {$M$};
                \node[state, error, right of=M, accepting] (E) {$E$};

                \draw   (S) edge[above] node{$x$} (N)
                        (N) edge[above] node{$y$} (M)
                        (M) edge[bend left, below] node{$z$} (N)
                        (S) edge[below, bend right] node{$y,z$} (E)
                        (N) edge[above, bend left] node{$x,z$} (E)
                        (M) edge[above] node{$x,y$} (E)
                        (E) edge[loop right] node{$x,y,z$} (E);
            \end{tikzpicture}
            \caption{AFD asociado al lenguaje $\ol{\cc{L}(G)}$ del ejercicio \ref{ej:1.3.12}.}
            \label{fig:1.3.12-AFD-Complementario}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.13}
    Determinar autómatas minimales para los lenguajes $L(M_1) \cup L(M_2)$ y $L(M_1)\cap \overline{L(M_2)}$ donde,
    \begin{itemize}
        \item $M_1 = (\{q_0, q_1, q_2, q_3\}, \{a,b,c\},\delta_1,q_0, \{q_2\})$ donde
            \begin{equation*}
                \begin{array}{c|cccc}
                    \delta_1 & q_0 & q_1 & q_2 & q_3 \\ 
                    \hline
                    a & q_1 & q_1 & q_3 & q_3 \\ 
                    b & q_2 & q_1 & q_1 & q_3 \\ 
                    c & q_3 & q_3 & q_0 & q_3 
                \end{array}
            \end{equation*}
        \item $M_2 = (\{q_0, q_1, q_2, q_3\}, \{a,b,c\},\delta_2,q_0, \{q_2\})$ donde
            \begin{equation*}
                \begin{array}{c|cccc}
                    \delta_2 & q_0 & q_1 & q_2 & q_3 \\ 
                    \hline
                    a & q_1 & q_1 & q_3 & q_3 \\ 
                    b & q_1 & q_2 & q_2 & q_3 \\ 
                    c & q_3 & q_3 & q_0 & q_3 
                \end{array}
            \end{equation*}
    \end{itemize}

    En primer lugar, minimizamos $M_1$ y $M_2$. La miminización de $M_1$ se muestra en la Tabla \ref{tab:1.3.13-M1-Minimal}.
    \begin{table}[H]
        \centering
        \begin{tabular}{r c c c}
            \hhline{~*{1}{-}}
            $q_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $q_2$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
            $q_3$ & \cell{\times} & \cell{(q_0,q_3)} & \cell{\times} \\ \hhline{~*{3}{-}}
            & $q_0$ & $q_1$ & $q_2$
        \end{tabular}
        \caption{Tabla de minimización de $M_1$.}
        \label{tab:1.3.13-M1-Minimal}
    \end{table}

    Por tanto, $\{q_1,q_3\}$ son indistinguibles, por lo que el AFD minimal asociado a $M_1$ es $M_1^m = (\{q_0,q_1,q_2\},\{a,b,c\},\delta_1^m,q_0,\{q_2\})$ donde:
    \begin{equation*}
        \begin{array}{c|ccc}
            \delta_1^m & q_0 & q_1 & q_2 \\ 
            \hline
            a & q_1 & q_1 & q_1 \\ 
            b & q_2 & q_1 & q_1 \\ 
            c & q_1 & q_1 & q_0 
        \end{array}
    \end{equation*}

    La miminización de $M_2$ se muestra en la Tabla \ref{tab:1.3.13-M2-Minimal}.
    \begin{table}[H]
        \centering
        \begin{tabular}{r c c c}
            \hhline{~*{1}{-}}
            $q_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $q_2$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
            $q_3$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
            & $q_0$ & $q_1$ & $q_2$
        \end{tabular}
        \caption{Tabla de minimización de $M_2$.}
        \label{tab:1.3.13-M2-Minimal}
    \end{table}

    Por tanto, el AFD minimal asociado a $M_2$ es $M_2^m=M_2$ minimal. A continuación, construimos los autómatas finitos deterministas asociados a $L(M_1) \cup L(M_2)$ y $L(M_1)\cap \overline{L(M_2)}$.
    \begin{enumerate}
        \item $L(M_1) \cup L(M_2)$
        
        En primer lugar, construimos el AFD asociado a $L(M_1) \cup L(M_2)$. Sea este $M=(Q,\{a,b,c\},\delta,(q_0,q_0'),F)$, donde:
        \begin{itemize}
            \item $Q=\{q_iq_j'\mid i=0,1,2\text{ y }j=0,1,2,3\}$.
            \item $F=\{(q_2,q_j')\mid j=0,1,2,3\} \cup \{(q_i,q_2')\mid i=0,1,2\}$.
            \item $\delta$ viene dada por la Tabla \ref{tab:transiciones}.            
            \begin{table}[h!]
                \centering
                \resizebox{1.1\textwidth}{!}{
                \begin{tabular}{r|cccccccccccc}
                    $\delta$ & $(q_0,q_0')$ & $(q_0,q_1')$ & $(q_0,q_2')$ & $(q_0,q_3')$ & $(q_1,q_0')$ & $(q_1,q_1')$ & $(q_1,q_2')$ & $(q_1,q_3')$ & $(q_2,q_0')$ & $(q_2,q_1')$ & $(q_2,q_2')$ & $(q_2,q_3')$ \\
                    \hline
                    $a$ & $q_1q_1'$ & $q_1q_1'$ & $q_1q_3'$ & $q_1q_3'$ & $q_1q_1'$ & $q_1q_1'$ & $q_1q_3'$ & $q_1q_3'$ & $q_1q_1'$ & $q_1q_1'$ & $q_1q_3'$ & $q_1q_3'$ \\
                    $b$ & $q_2q_1'$ & $q_2q_2'$ & $q_2q_2'$ & $q_2q_3'$ & $q_1q_1'$ & $q_1q_2'$ & $q_1q_2'$ & $q_1q_3'$ & $q_1q_1'$ & $q_1q_2'$ & $q_1q_2'$ & $q_1q_3'$ \\
                    $c$ & $q_1q_3'$ & $q_1q_3'$ & $q_1q_0'$ & $q_1q_3'$ & $q_1q_3'$ & $q_1q_3'$ & $q_1q_0'$ & $q_1q_3'$ & $q_0q_3'$ & $q_0q_3'$ & $q_0q_0'$ & $q_0q_3'$ \\
                \end{tabular}}
                \caption{Transiciones del autómata producto para $L(M_1),~L(M_2)$.}
                \label{tab:transiciones}
            \end{table}
        \end{itemize}

        Los estados accesibles son:
        \begin{equation*}
            \{q_0q_0',q_0q_3',q_1q_0',q_1q_1',q_1q_2',q_1q_3',q_2q_1',q_2q_3'\}
        \end{equation*}

        La minimización de $M$ se muestra en la Tabla \ref{tab:1.3.13-M-Union-Minimal}.
        \begin{table}[H]
            \centering
            \begin{tabular}{r c c c c c c c}
                \hhline{~*{1}{-}}
                $q_0q_3'$ & \cell{\times} \\ \hhline{~*{2}{-}}
                $q_1q_0'$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
                $q_1q_1'$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
                $q_1q_2'$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{5}{-}}
                $q_1q_3'$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
                $q_2q_1'$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                $q_2q_3'$ & \cell{\times} & \cell{\times}  & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                & $q_0q_0'$ & $q_0q_3'$ & $q_1q_0'$ & $q_1q_1'$ & $q_1q_2'$ & $q_1q_3'$ & $q_2q_1'$
            \end{tabular}
            \caption{Tabla de minimización de $M$ para $L(M_1) \cup L(M_2)$.}
            \label{tab:1.3.13-M-Union-Minimal}
        \end{table}

        Por tanto, el AFD minimal asociado a $L(M_1) \cup L(M_2)$ es $M^m=M$, el cual se puede ver en la Figura~\ref{fig:1.3.13-M-Union-Minimal}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0q0) {$q_0q_0'$};
                \node[state, above right of=q0q0] (q1q1) {$q_1q_1'$};
                \node[state, below right of=q0q0, accepting] (q2q1) {$q_2q_1'$};
                \node[state, right of=q1q1, accepting] (q1q2) {$q_1q_2'$};
                \node[state, right of=q1q2] (q1q0) {$q_1q_0'$};
                \node[state, right of=q2q1] (q0q3) {$q_0q_3'$};
                \node[state, right of=q0q3, accepting] (q2q3) {$q_2q_3'$};
                \node[state, below right of=q1q0, error] (E) {$E$};

                \draw   (q0q0) edge[above] node{$a$} (q1q1)
                        (q0q0) edge[above] node{$b$} (q2q1)
                        (q1q1) edge[loop above] node{$a$} (q1q1)
                        (q1q1) edge[above] node{$b$} (q1q2)
                        (q1q2) edge[loop below] node{$b$} (q1q2)
                        (q1q2) edge[above] node{$c$} (q1q0)
                        (q1q0) edge[above, bend right] node{$a,b$} (q1q1)
                        (q2q1) edge[right] node{$a$} (q1q1)
                        (q2q1) edge[above] node{$b$} (q1q2)
                        (q2q1) edge[above] node{$c$} (q0q3)
                        (q0q3) edge[above] node{$b$} (q2q3)
                        (q2q3) edge[below, bend left] node{$c$} (q0q3);
                \draw[opacity=0.7]
                        (q0q0) edge[below, bend right=90, looseness=1.1] node{$c$} (E)
                        (q1q1) edge[bend left=90, above] node{$c$} (E)
                        (q1q2) edge[above] node{$a$} (E)
                        (q1q0) edge[above] node{$c$} (E)
                        (q0q3) edge[above] node[pos=0.1]{$a,c$} (E)
                        (q2q3) edge[above] node[pos=0.1]{$a,b$} (E)
                        (E) edge[loop right] node{$a,b,c$} (E);
            \end{tikzpicture}
            \caption{AFD minimal asociado a $L(M_1) \cup L(M_2)$.}
            \label{fig:1.3.13-M-Union-Minimal}
        \end{figure}

        \item $L(M_1)\cap \overline{L(M_2)}$
        
        Ya tenemos del apartado anterior el AFD minimal asociado a $L(M_1)$. La minimización de $\ol{L(M_2)}$ se muestra en la Tabla \ref{tab:1.3.13-M2-Complement-Minimal}.
        \begin{table}[H]
            \centering
            \begin{tabular}{r c c c}
                \hhline{~*{1}{-}}
                $q_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
                $q_2$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
                $q_3$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
                & $q_0$ & $q_1$ & $q_2$
            \end{tabular}
            \caption{Tabla de minimización de $\ol{M_2}$.}
            \label{tab:1.3.13-M2-Complement-Minimal}
        \end{table}
        % Esto era necesario?

        Por tanto, el AFD minimal asociado a $\ol{L(M_2)}$ es ya minimal. A continuación, construimos el AFD asociado a $L(M_1)\cap \overline{L(M_2)}$. Sea este $M=(Q,\{a,b,c\},\delta,(q_0,q_0'),F)$, donde:
        \begin{itemize}
            \item $Q=\{q_iq_j'\mid i=0,1,2\text{ y }j=0,1,2,3\}$.
            \item $F=\{(q_2,q_j')\mid j=0,1,3\}$.
            \item $\delta$ viene dada por la Tabla \ref{tab:transiciones}.
        \end{itemize}

        Los estados accesibles son los mismos que antes:
        \begin{equation*}
            \{q_0q_0',q_0q_3',q_1q_0',q_1q_1',q_1q_2',q_1q_3',q_2q_1',q_2q_3'\}
        \end{equation*}

        La minimización de $M$ se muestra en la Tabla \ref{tab:1.3.13-M-Intersection-Minimal}.
        \begin{table}[H]
            \centering
            \begin{tabular}{r c c c c c c c}
                \hhline{~*{1}{-}}
                $q_0q_3'$ & \cell{} \\ \hhline{~*{2}{-}}
                $q_1q_0'$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
                $q_1q_1'$ & \cell{\times} & \cell{\times} & \cell{} \\ \hhline{~*{4}{-}}
                $q_1q_2'$ & \cell{\times} & \cell{\times} & \cell{} & \cell{{\begin{array}{c}(q_1q_2',q_1q_0')\\(q_qq_1',q_1q_0')\end{array}}} \\ \hhline{~*{5}{-}}
                $q_1q_3'$ & \cell{\times} & \cell{\times} & \cell{{\begin{array}{c}(q_1q_2',q_1q_3')\\(q_1q_2',q_1q_0')\\(q_1q_1',q_1q_2')\\(q0q_3',q_1q_0')\end{array}}} & \cell{{\begin{array}{c}(q_2q_3',q_2q_1')\\(q_1q_3',q_1q_0')\\(q_1q_1',q_1q_2')\end{array}}} & \cell{{\begin{array}{c}(q_2q_3',q_2q_1')\\(q_1q_1',q_1q_3')\end{array}}} \\ \hhline{~*{6}{-}}
                $q_2q_1'$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                $q_2q_3'$ & \cell{\times} & \cell{\times}  & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{(q_0q_3',q_0q_0')} \\ \hhline{~*{7}{-}}
                & $q_0q_0'$ & $q_0q_3'$ & $q_1q_0'$ & $q_1q_1'$ & $q_1q_2'$ & $q_1q_3'$ & $q_2q_1'$
            \end{tabular}
            \caption{Tabla de minimización de $M$ para $L(M_1) \cap \ol{L(M_2)}$.}
            \label{tab:1.3.13-M-Intersection-Minimal}
        \end{table}
        
        Por tanto, notando por $\equiv$ a la relación de indistinguibilidad, tenemos que:
        \begin{equation*}
            q_0q_3'\equiv q_0q_0':=q_0\qquad
            q_1q_1'\equiv q_1q_0'\equiv q_1q_2'\equiv q_1q_3':=q_1\qquad
            q_2q_1'\equiv q_2q_3' := q_2
        \end{equation*}

        Por tanto, el AFD minimal asociado a $L(M_1)\cap \overline{L(M_2)}$ es $M^m=(Q,\{a,b,c\},\delta^m,q_0,F)$ donde:
        \begin{itemize}
            \item $Q=\{q_0,q_0q_1',q_0q_2',q_1,q_2,q_2q_0',q_2q_2'\}$.
            \item $F=\{q_2, q_2q_0'\}$.
            \item Los estados accesibles son $\{q_0,q_1,q_2\}$.
            \item $\delta^m$ viene dada por la Tabla \ref{tab:transiciones-interseccion}, donde solo la definimos para los estados accesibles.
            \begin{table}[H]
                \centering
                \begin{tabular}{r|cccccccccccc}
                    $\delta^m$ & $q_0$ & $q_1$ & $q_2$ \\
                    \hline
                    $a$ & $q_1$ & $q_1$ & $q_1$ \\
                    $b$ & $q_2$ & $q_1$ & $q_1$ \\
                    $c$ & $q_1$ & $q_1$ & $q_0$
                \end{tabular}
                \caption{Transiciones del autómata minimal para $L(M_1),~\ol{L(M_2)}$.}
                \label{tab:transiciones-interseccion}
            \end{table}
        \end{itemize}

        El AFD minimal asociado a $L(M_1)\cap \overline{L(M_2)}$ es el de la Figura~\ref{fig:1.3.13-M-Intersection-Minimal}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, below right of=q0] (q1) {$q_1$};
                \node[state, accepting, above right of=q1] (q2) {$q_2$};

                \draw   (q0) edge[below left] node{$a,c$} (q1)
                        (q0) edge[above] node{$b$} (q2)
                        (q1) edge[loop right] node{$a,b,c$} (q1)
                        (q2) edge[below right] node{$a,b$} (q1)
                        (q2) edge[above, bend right] node{$c$} (q0);
            \end{tikzpicture}
            \caption{AFD minimal asociado a $L(M_1)\cap \ol{L(M_2)}$.}
            \label{fig:1.3.13-M-Intersection-Minimal}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.14}
    Dado el conjunto regular representado por la expresión regular $a^\ast b^\ast + b^\ast a^\ast$, construir un autómata finido determinístico minimal que lo acepte.\\

    El AFND con transiciones nulas asociado a la expresión regular dada es el de la Figura~\ref{fig:1.3.14-AFND}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0] (q1) {$q_1$};
            \node[state, below right of=q0] (q2) {$q_2$};
            \node[state, right of=q1, accepting] (q3) {$q_3$};
            \node[state, right of=q2, accepting] (q4) {$q_4$};

            \draw   (q0) edge[above] node{$\varepsilon$} (q1)
                    (q0) edge[below] node{$\varepsilon$} (q2)
                    (q1) edge[above] node{$\veps$} (q3)
                    (q1) edge[loop below] node{$a$} (q1)
                    (q3) edge[loop below] node{$b$} (q3)
                    (q2) edge[below] node{$\veps$} (q4)
                    (q2) edge[loop above] node{$b$} (q2)
                    (q4) edge[loop above] node{$a$} (q4);
        \end{tikzpicture}
        \caption{AFND con transiciones nulas asociado a la expresión regular $a^\ast b^\ast + b^\ast a^\ast$.}
        \label{fig:1.3.14-AFND}
    \end{figure}

    El AFD asociado a la expresión regular dada es el de la Figura~\ref{fig:1.3.14-AFD}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0q1q2q3q4q5) {$q_0q_1q_2q_3q_4q_5$};
            \node[state, above right of=q0q1q2q3q4q5, accepting] (q1q4) {$q_1q_4$};
            \node[state, below right of=q0q1q2q3q4q5, accepting] (q2q3) {$q_2q_3$};
            \node[state, right of=q1q4, accepting] (q3) {$q_3$};
            \node[state, right of=q2q3, accepting] (q4) {$q_4$};
            \node[state, error, above right of=q4] (E) {$E$};

            \draw   (q0q1q2q3q4q5) edge[above] node{$a$} (q1q4)
                    (q0q1q2q3q4q5) edge[below] node{$b$} (q2q3)
                    (q1q4) edge[above] node{$b$} (q3)
                    (q1q4) edge[loop below] node{$a$} (q1q4)
                    (q2q3) edge[below] node{$a$} (q4)
                    (q2q3) edge[loop above] node{$b$} (q2q3)
                    (q3) edge[loop below] node{$b$} (q3)
                    (q4) edge[loop above] node{$a$} (q4)
                    (q3) edge[above] node{$a$} (E)
                    (q4) edge[below] node{$b$} (E)
                    (E) edge[loop right] node{$a,b$} (E);
        \end{tikzpicture}
        \caption{AFD asociado a la expresión regular $a^\ast b^\ast + b^\ast a^\ast$.}
        \label{fig:1.3.14-AFD}
    \end{figure}

    Veamos ahora que el AFD de la Figura~\ref{fig:1.3.14-AFD} es minimal.
    \begin{itemize}
        \item El estado $E$ es distinguible de cualquier otro estado pues ser el único estado que no es final.
        \item Veamos que $q_3$ es distinguible del resto de estados finales. Leyendo $a$, tenemos que:
        \begin{equation*}
            \delta(q_3,a)=E\notin F,\qquad \left\{\begin{array}{l}
                \delta(q_1q_4,a)=q_1q_4\in F,\\
                \delta(q_2q_3,a)=q_4\in F,\\
                \delta(q_4,a)=q_4\in F,\\
                \delta(q_0q_1q_2q_3q_4q_5,a)=q_1q_4\in F.
            \end{array}
            \right.
        \end{equation*}
        \item De forma análoga leyendo $b$, tenemos que $q_4$ es distinguible del resto de estados finales.
        \item El estado $q_1q_4$ es distinguible de $q_2q_3$ y $q_0q_1q_2q_3q_4q_5$ leyendo $ba$.
        \item Finalmente, $q_0q_1q_2q_3q_4q_5$ es distinguible de $q_2q_3$ leyendo $ab$.
    \end{itemize}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.15}
    Sean los lenguajes:
    \begin{enumerate}
        \item $L_1={(01+1)}^{\ast}00$
        \item $L_2=01{(01+1)}^{\ast}$
    \end{enumerate}
    construir un autómata finito determinístico minimal que acepte el lenguaje $L_1 \setminus L_2$, a partir de autómatas que acepten $L_1$ y $L_2$.

    Veamos que $L_1\cap L_2=\emptyset$. Sea $z\in L_1$. Entonces, $z$ es admitida por la expresión regular $(01+1)^{\ast}00$, por lo que termina en $0$. Por tanto, $z\notin L_2$, ya que todas las palabras de $L_2$ terminan por $1$. Por tanto, $L_1\cap L_2=\emptyset$ y $L_1\setminus L_2=L_1$. Aun así, haremos el proceso algorítmico para obtener el AFD minimal asociado a $L_1\setminus L_2$.\\

    El AFD asociado a $L_1$ es el de la Figura~\ref{fig:1.3.15-L1}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1, accepting] (q2) {$q_2$};
            \node[state, error, right of=q2] (E) {$q_E$};

            \draw   (q0) edge[above] node{$0$} (q1)
                    (q0) edge[loop above] node{$1$} (q0)
                    (q1) edge[above, bend right] node{$1$} (q0)
                    (q1) edge[above] node{$0$} (q2)
                    (q2) edge[above] node{$0,1$} (E)
                    (E) edge[loop above] node{$0,1$} (E);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_1={(01+1)}^{\ast}00$.}
        \label{fig:1.3.15-L1}
    \end{figure}

    El AFD asociado a $L_2$ es el de la Figura~\ref{fig:1.3.15-L2}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$p_0$};
            \node[state, right of=q0] (q1) {$p_1$};
            \node[state, right of=q1, accepting] (q2) {$p_2$};
            \node[state, error, below of=q1] (E) {$p_E$};

            \draw   (q0) edge[above] node{$0$} (q1)
                    (q0) edge[below] node{$1$} (E)
                    (q1) edge[above] node{$1$} (q2)
                    (q1) edge[left] node{$0$} (E)
                    (q2) edge[loop above] node{$1$} (q2)
                    (q2) edge[above, bend right] node{$0$} (q1)
                    (E) edge[loop right] node{$0,1$} (E);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_2=01{(01+1)}^{\ast}$.}
        \label{fig:1.3.15-L2}
    \end{figure}

    El AFD asociado a $L_1\setminus L_2$ es el de la Figura~\ref{fig:1.3.15-L1-L2}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0q0) {$q_0p_0$};
            \node[state, above right of=q0q0] (q1p1) {$q_1p_1$};
            \node[state, below right of=q0q0] (q0pE) {$q_0p_E$};
            \node[state, above right of=q1q1, accepting, yshift=-2em] (q2pE) {$q_2p_E$};
            \node[state, below right of=q1q1, yshift=2em] (q0p2) {$q_0p_2$};
            \node[state, right of=q0pE] (q1pE) {$q_1p_E$};
            \node[state, right of=q2pE, error] (qEpE) {$q_Ep_E$};

            \draw   (q0q0) edge[above] node{$0$} (q1p1)
                    (q0q0) edge[below] node{$1$} (q0pE)
                    (q1p1) edge[above] node{$1$} (q0p2)
                    (q1p1) edge[above] node{$0$} (q2pE)
                    (q0pE) edge[above] node{$0$} (q1pE)
                    (q0pE) edge[loop above] node{$1$} (q0pE)
                    (q0p2) edge[below, bend left] node{$0$} (q1p1)
                    (q0p2) edge[loop above] node{$1$} (q0p2)
                    (q1pE) edge[below, bend left] node{$1$} (q0pE)
                    (q1pE) edge[right, bend right] node{$0$} (q2pE)
                    (q2pE) edge[above] node{$0,1$} (qEpE)
                    (qEpE) edge[loop below] node{$0,1$} (qEpE);
        \end{tikzpicture}
        \caption{AFD asociado a $L_1\setminus L_2$.}
        \label{fig:1.3.15-L1-L2}
    \end{figure}

    La minimización del AFD de la Figura~\ref{fig:1.3.15-L1-L2} se muestra en la Tabla~\ref{tab:1.3.15-L1-L2-Minimal}.
    \begin{table}[H]
        \centering
        \begin{tabular}{r c c c c c c c}
            \hhline{~*{1}{-}}
            $q_1p_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $q_2p_E$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
            $q_0p_2$ & \cell{} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
            $q_0p_E$ & \cell{} & \cell{\times} & \cell{\times} & \cell{{\begin{array}{c}(q_1p_E,~q_1p_1)\\(q_0p_0,q_0p_2)\end{array}}} \\ \hhline{~*{5}{-}}
            $q_1p_E$ & \cell{\times} & \cell{{\begin{array}{c}(q_0p_E,q_0p_0)\\(q_0p_E,q_0p_2)\end{array}}} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
            $q_Ep_E$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
            & $q_0p_0$ & $q_1p_1$ & $q_2p_E$ & $q_0p_2$ & $q_0p_E$ & $q_1p_E$
        \end{tabular}
        \caption{Tabla de minimización de $L_1\setminus L_2$.}
        \label{tab:1.3.15-L1-L2-Minimal}
    \end{table}

    Por tanto, notando por $\equiv$ a la relación de indistinguibilidad, tenemos que:
    \begin{equation*}
        q_0p_0\equiv q_0p_E\equiv q_0p_2
        \qquad q_1p_1\equiv q_1p_E
    \end{equation*}

    El AFD minimal asociado a $L_1\setminus L_2$ es el de la Figura~\ref{fig:1.3.15-L1-L2-Minimal}.
    Como vemos, este autómata es isomorfo al autómata de la Figura~\ref{fig:1.3.15-L1} que aceptaba $L_1$, como ya habíamos predicho.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0p_0,q_0p_E,q_0p_2$};
            \node[state, right of=q0, xshift=4em] (q1) {$q_1p_1,q_1p_E$};
            \node[state, right of=q1, accepting] (q2) {$q_2p_E$};
            \node[state, error, right of=q2] (E) {$q_Ep_E$};

            \draw   (q0) edge[above] node{$0$} (q1)
                    (q0) edge[loop above] node{$1$} (q0)
                    (q1) edge[above, bend right] node{$1$} (q0)
                    (q1) edge[above] node{$0$} (q2)
                    (q2) edge[above] node{$0,1$} (E)
                    (E) edge[loop above] node{$0,1$} (E);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_1\setminus L_2$.}
        \label{fig:1.3.15-L1-L2-Minimal}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.16}
    Dados los alfabetos $A=\{0,1,2,3\}$ y $B=\{0,1\}$ y el homomorfismo $f$ de $A^\ast$ en $B^\ast$ dado por:
    \begin{equation*}
        f(0)=00,\quad f(1)=01,\quad f(2)=10,\quad f(3)=11
    \end{equation*}
    Sea $L$ el conjunto de las palabras de $B^\ast$ en las que el número de símbolos 0 es par y el de símbolos 1 no es múltiplo de 3. Construir un autómata finito determinista que acepte el lenguaje $f^{-1}(L)$.\\

    El AFD que acepta a $L$ se desarrolló en el Ejercicio~\ref{ej:1.2.17}. Se muestra no obstante de nuevo en la Figura~\ref{fig:ej:1.3.16-L}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q00) {$q_{00}$};
            \node[state, right of=q00, accepting] (q01) {$q_{01}$};
            \node[state, right of=q01, accepting] (q02) {$q_{02}$};
            \node[state, below of=q00] (q10) {$q_{10}$};
            \node[state, right of=q10] (q11) {$q_{11}$};
            \node[state, right of=q11] (q12) {$q_{12}$};

            \draw   (q00) edge[above] node{1} (q01)
                    (q01) edge[above] node{1} (q02)
                    (q02) edge[above, bend right] node{1} (q00)
                    (q10) edge[above] node{1} (q11)
                    (q11) edge[above] node{1} (q12)
                    (q12) edge[below, bend left] node{1} (q10)
                    (q00) edge[left] node{0} (q10)
                    (q10) edge[right, bend right] node{0} (q00)
                    (q01) edge[left] node{0} (q11)
                    (q11) edge[right, bend right] node{0} (q01)
                    (q02) edge[left] node{0} (q12)
                    (q12) edge[right, bend right] node{0} (q02);
        \end{tikzpicture}
        \caption{AFD que acepta el lenguaje $L$ del Ejercicio~\ref{ej:1.3.16}.}
        \label{fig:ej:1.3.16-L}
    \end{figure}

    El AFD que acepta a $f^{-1}(L)$ es el de la Figura~\ref{fig:ej:1.3.16-f-1-L}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q00) {$q_{00}$};
            \node[state, right of=q00, accepting] (q01) {$q_{01}$};
            \node[state, right of=q01, accepting] (q02) {$q_{02}$};
            \node[state, below of=q02] (q10) {$q_{10}$};
            \node[state, below of=q00] (q11) {$q_{11}$};
            \node[state, below of=q01] (q12) {$q_{12}$};

            \draw   (q00) edge[above, loop above] node{0} (q00)
                    (q00) edge[left] node{1,2} (q11)
                    (q00) edge[above, bend left=60] node{3} (q02)
                    (q01) edge[above, loop above] node{0} (q01)
                    (q01) edge[left] node{1,2} (q12)
                    (q01) edge[above] node{3} (q00)
                    (q02) edge[above, loop above] node{0} (q02)
                    (q02) edge[left] node{1,2} (q10)
                    (q02) edge[above] node{3} (q01)
                    (q10) edge[below, loop below] node{0} (q10)
                    (q10) edge[above] node{1,2} (q01)
                    (q10) edge[above] node{3} (q12)
                    (q11) edge[below, loop below] node{0} (q11)
                    (q11) edge[below, bend right=90, looseness=2] node{1,2} (q02)
                    (q11) edge[below, bend right=60] node{3} (q10)
                    (q12) edge[below, loop below] node{0} (q12)
                    (q12) edge[above] node{1,2} (q00)
                    (q12) edge[above] node{3} (q11);
        \end{tikzpicture}
        \vspace{-2cm}
        \caption{AFD que acepta el lenguaje $L$ del Ejercicio~\ref{ej:1.3.16}.}
        \label{fig:ej:1.3.16-f-1-L}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.17}
    Determinar un autómata finito determinístico minimal para el lenguaje sobre el alfabeto $A=\{a,b,c\}$ dado por la expresión regular $b{(a+b)}^{\ast}+cb^\ast$.\\

    El AFD asociado a la expresión regular dada es el de la Figura~\ref{fig:1.3.17-AFD}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0, accepting] (q1) {$q_1$};
            \node[state, below right of=q0, accepting] (q2) {$q_2$};
            \node[state, below right of=q1, error] (E) {$E$};

            \draw   (q0) edge[above] node{$b$} (q1)
                    (q0) edge[below] node{$c$} (q2)
                    (q0) edge[above] node{$a$} (E)
                    (q1) edge[loop above] node{$a,b$} (q1)
                    (q1) edge[above] node{$c$} (E)
                    (q2) edge[loop below] node{$b$} (q2)
                    (q2) edge[below] node{$a,b$} (E)
                    (E) edge[loop right] node{$a,b,c$} (E);
        \end{tikzpicture}
        \caption{AFD asociado a la expresión regular $b{(a+b)}^{\ast}+cb^\ast$.}
        \label{fig:1.3.17-AFD}
    \end{figure}

    Veamos que es minimal:
    \begin{itemize}
        \item $E$ es distinguible de cualquier otro estado puesto que desde él no se puede llegar a un estado final.
        \item $q_0$ es distinguible de $q_1$ y $q_2$ puesto que no es final.
        \item $q_1$ es distinguible de $q_2$ leyendo $a$.
    \end{itemize}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.18}
    Determinar si las expresiones regulares siguientes representan el mismo lenguaje:
    \begin{enumerate}
        \item $L_1={(b+(c+a)a^\ast (b+c))}^{\ast} (c+a)a^\ast$
        \item $L_2=b^\ast (c+a) {((b+c)b^\ast (c+a))}^{\ast}a^\ast$
        \item $L_3=b^\ast (c+a){(a^\ast (b+c)b^\ast (c+a))}^{\ast}a^\ast$
    \end{enumerate}
    Justificar la respuesta.\\

    Veamos en primer lugar que $L_2\neq L_1,L_3$. Sea la palabra $u=caaccaaa$.
    Tenemos que $u\in L_1, L_3$ pero $u\notin L_2$. Por tanto, $L_2\neq L_1, L_3$.\\

    Veamos ahora que $L_1=L_3$ obteniendo el autómata finito minimal asociado a cada uno de ellos y viendo que es igual. Este se encuentra en la Figura~\ref{fig:1.3.18-L1-L3}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q1) {$q_1$};

            \draw   (q0) edge[loop above] node{$b$} (q0)
                    (q0) edge[above] node{$a,c$} (q1)
                    (q1) edge[loop above] node{$a$} (q1)
                    (q1) edge[below, bend left] node{$b,c$} (q0);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_1=L_3$ del Ejercicio~\ref{ej:1.3.18}.}
        \label{fig:1.3.18-L1-L3}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.19}
    Construir un autómata finito determinista minimal que acepte el conjunto de palabras sobre el alfabeto $A=\{0,1\}$ que representen números no divisibles por dos ni por tres (en binario).

    El AFD asociado a los múltiplos de $2$ se muestra en la Figura~\ref{fig:1.3.19-Multiplos-2}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, accepting, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};

            \draw   (q0) edge[loop above] node{$0$} (q0)
                    (q0) edge[above] node{$1$} (q1)
                    (q1) edge[loop above] node{$1$} (q1)
                    (q1) edge[above, bend right] node{$0$} (q0);
        \end{tikzpicture}
        \caption{AFD minimal asociado a los múltiplos de $2$ del Ejercicio~\ref{ej:1.3.19}.}
        \label{fig:1.3.19-Multiplos-2}
    \end{figure}

    El AFD asociado a los múltiplos de $3$ se muestra en la Figura~\ref{fig:1.3.19-Multiplos-3}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, accepting, initial] (p0) {$p_0$};
            \node[state, right of=p0] (p1) {$p_1$};
            \node[state, right of=p1] (p2) {$p_2$};

            \draw   (p0) edge[loop above] node{$0$} (p0)
                    (p0) edge[above] node{$1$} (p1)
                    (p1) edge[above] node{$0$} (p2)
                    (p1) edge[bend right, above] node{$1$} (p0)
                    (p2) edge[loop above] node{$1$} (p2)
                    (p2) edge[above, bend right] node{$0$} (p1);
        \end{tikzpicture}
        \caption{AFD minimal asociado a los múltiplos de $3$ del Ejercicio~\ref{ej:1.3.19}.}
        \label{fig:1.3.19-Multiplos-3}
    \end{figure}

    El autómata descrito en el enunciado es el autómata producto de los complementarios a los dos anteriores, mostrado en la Figura~\ref{fig:1.3.19-Producto}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0p0) {$q_0p_0$};
            \node[state, right of=q0p0, accepting] (q1p1) {$q_1p_1$};
            \node[state, above right of=q1p1] (q1p0) {$q_1p_0$};
            \node[state, right of=q1p0] (q0p1) {$q_0p_1$};
            \node[state, below right of=q1p1] (q0p2) {$q_0p_2$};
            \node[state, right of=q0p2, accepting] (q1p2) {$q_1p_2$};

            \draw   (q0p0) edge[loop above] node{$0$} (q0p0)
                    (q0p0) edge[above] node{$1$} (q1p1)
                    (q0p1) edge[above] node{$0$} (q0p2)
                    (q0p1) edge[above] node{$1$} (q1p0)
                    (q0p2) edge[left, bend left] node{$0$} (q0p1)
                    (q0p2) edge[above] node{$1$} (q1p2)
                    (q1p0) edge[above] node{$0$} (q0p0)
                    (q1p0) edge[right, bend left] node{$1$} (q1p1)
                    (q1p1) edge[above] node{$0$} (q0p2)
                    (q1p1) edge[above] node{$1$} (q1p0)
                    (q1p2) edge[right] node{$0$} (q0p1)
                    (q1p2) edge[loop right] node{$1$} (q1p2);
        \end{tikzpicture}
        \caption{AFD asociado al lenguaje del Ejercicio~\ref{ej:1.3.19}.}
        \label{fig:1.3.19-Producto}
    \end{figure}

    La minimización del autómata de la Figura~\ref{fig:1.3.19-Producto} se muestra en la Tabla~\ref{tab:1.3.19-Producto-Minimal}.
    \begin{table}[H]
        \centering
        \begin{tabular}{r c c c c c c c}
            \hhline{~*{1}{-}}
            $q_1p_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $q_1p_0$ & \cell{} & \cell{\times} \\ \hhline{~*{3}{-}}
            $q_0p_2$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
            $q_0p_1$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{5}{-}}
            $q_1p_2$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
            & $q_0p_0$ & $q_1p_1$ & $q_1p_0$ & $q_0p_2$ & $q_1p_1$
        \end{tabular}
        \caption{Tabla de minimización del autómata de la Figura~\ref{fig:1.3.19-Producto}.}
        \label{tab:1.3.19-Producto-Minimal}
    \end{table}

    Por tanto, notando por $\equiv$ a la relación de indistinguibilidad, tenemos que:
    \begin{equation*}
        q_0p_0\equiv q_1p_0\equiv: p_0
    \end{equation*}

    Por tanto, el autómata minimal asociado al lenguaje del enunciado es el de la Figura~\ref{fig:1.3.19-Producto-Minimal}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (p0) {$p_0$};
            \node[state, below of=p0, accepting] (q1p1) {$q_1p_1$};
            \node[state, right of=p0] (q0p1) {$q_0p_1$};
            \node[state, right of=q1p1] (q0p2) {$q_0p_2$};
            \node[state, right of=q0p2, accepting] (q1p2) {$q_1p_2$};

            \draw   (p0) edge[loop above] node{$0$} (p0)
                    (p0) edge[right] node{$1$} (q1p1)
                    (q0p1) edge[right] node{$0$} (q0p2)
                    (q0p1) edge[above] node{$1$} (p0)
                    (q0p2) edge[left, bend left] node{$0$} (q0p1)
                    (q0p2) edge[above] node{$1$} (q1p2)
                    (q1p1) edge[above] node{$0$} (q0p2)
                    (q1p1) edge[left, bend left] node{$1$} (p0)
                    (q1p2) edge[right] node{$0$} (q0p1)
                    (q1p2) edge[loop right] node{$1$} (q1p2);
        \end{tikzpicture}
        \caption{AFD Minimal asociado al lenguaje del Ejercicio~\ref{ej:1.3.19}.}
        \label{fig:1.3.19-Producto-Minimal}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.20}
    Determinar una expresión regular para los siguientes lenguajes sobre el alfabeto $\{0,1\}$:
    \begin{itemize}
        \item Palabras en las que el tercer símbolo es un 0.
        \item Palabras en las que el antepenúltimo símbolo es un 1.
    \end{itemize}
    Construir un autómata finito minimal que acepte la intersección de ambos lenguajes.\\

    Respecto al leguaje de las palabras en las que el tercer símbolo es un $0$ (llamémoslo $L_1$), su expresión regular es:
    \begin{equation*}
        (0+1)(0+1) \ \red{0}\  {(0+1)}^{\ast}
    \end{equation*}
    

    Respecto al leguaje de las palabras en las que el antepenúltimo símbolo es un $1$ (llamémoslo $L_2$), su expresión regular es:
    \begin{equation*}
        (0+1)^*\ \red{1}\ (0+1)(0+1)
    \end{equation*}

    \begin{description}
        \item[Opción 1:]  Autómata Producto.
        
        Obtendremos el AFD de $L_1$ de forma directa, mostrado en la Figura~\ref{fig:ej:1.3.20-1:AFD}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (p0) {$p_0$};
                \node[state, right of=p0] (p1) {$p_1$};
                \node[state, right of=p1] (p2) {$p_2$};
                \node[state, accepting, right of=p2] (p3) {$p_3$};
                \node[state, error, below of=p2] (E) {$E$};

                \draw   (p0) edge[above] node{$0,1$} (p1)
                        (p1) edge[above] node{$0,1$} (p2)
                        (p2) edge[above] node{$0$} (p3)
                        (p3) edge[loop above] node{$0,1$} (p3)
                        (p2) edge[right] node{$1$} (E)
                        (E) edge[loop below] node{$0,1$} (E);
            \end{tikzpicture}
            \caption{AFD minimal que acepta el lenguaje $L_1$ del ejercicio~\ref{ej:1.3.20}.}
            \label{fig:ej:1.3.20-1:AFD}
        \end{figure}

        Podríamos optar con construir el AFD de $L_2$ de forma directa, pero construiremos un AFND que acepte el lenguaje y luego lo convertiremos a AFD. El AFND se muestra en la Figura~\ref{fig:ej:1.3.20:AFND}, cuyos estados son:
        \begin{itemize}
            \item $q_0$: No estamos en la cadena final, por lo que podemos leer $0$'s y $1$'s.
            \item $q_1$: Acabo de empezar la cadena final. He leído un $1$.
            \item $q_2$: Estoy en la cadena final. El leído el $1$ y el segundo símbolo.
            \item $q_3$: Hemos terminado la cadena final.
        \end{itemize}
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, accepting, right of=q2] (q3) {$q_3$};

                \draw   (q0) edge[loop above] node{0,1} (q0)
                        (q0) edge[above] node{1} (q1)
                        (q1) edge[above] node{0,1} (q2)
                        (q2) edge[above] node{0,1} (q3);
            \end{tikzpicture}
            \caption{AFND que acepta el lenguaje $L_2$ del ejercicio~\ref{ej:1.3.20}.}
            \label{fig:ej:1.3.20:AFND}
        \end{figure}

        Convertimos ahora el AFND de la Figura \ref{fig:ej:1.3.20:AFND} en un AFD, representado en la Figura \ref{fig:ej:1.3.20:AFD}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q0q1) {$q_0q_1$};
                \node[state, above right of=q0q1, xshift=3em] (q0q1q2) {$q_0q_1q_2$};
                \node[state, below right of=q0q1, xshift=3em] (q0q2) {$q_0q_2$};
                \node[state, above right of=q0q1q2, accepting, xshift=3em] (q0q1q2q3) {$q_0q_1q_2q_3$};
                \node[state, below right of=q0q1q2, accepting, xshift=3em, yshift=3em] (q0q2q3) {$q_0q_2q_3$};
                \node[state, above right of=q0q2, accepting, xshift=3em, yshift=-3em] (q0q1q3) {$q_0q_1q_3$};
                \node[state, below right of=q0q2, accepting, xshift=3em] (q0q3) {$q_0q_3$};

                \draw   (q0) edge[loop above] node{0} (q0)
                        (q0) edge[above] node{1} (q0q1)
                        (q0q1) edge[above] node{0} (q0q2)
                        (q0q1) edge[above] node{1} (q0q1q2)
                        (q0q2) edge[above] node{0} (q0q3)
                        (q0q2) edge[above] node{1} (q0q1q3)
                        (q0q1q2) edge[above] node{0} (q0q2q3)
                        (q0q1q2) edge[above] node{1} (q0q1q2q3)
                        (q0q1q2q3) edge[right, bend left] node{0} (q0q2q3)
                        (q0q1q2q3) edge[loop above] node{1} (q0q1q2q3)
                        (q0q2q3) edge[right, bend left=45] node{0} (q0q3)
                        (q0q2q3) edge[right, bend left] node[pos=0.8]{1} (q0q1q3)
                        (q0q1q3) edge[below, bend left] node[pos=0.1]{0} (q0q2)
                        (q0q1q3) edge[right] node{1} (q0q1q2)
                        (q0q3) edge[below, bend left] node{1} (q0q1)
                        (q0q3) edge[below, bend left] node{0} (q0);
            \end{tikzpicture}
            \caption{AFD que acepta el lenguaje $L_2$ del ejercicio~\ref{ej:1.3.20}.}
            \label{fig:ej:1.3.20:AFD}
        \end{figure}

        El AFD de la Figura \ref{fig:ej:1.3.20:AFD} acepta el lenguaje $L_2$, y es idéntico al que podríamos haber razonado de forma directa. Veamos qué representa cada estado:
        \begin{itemize}
            \item $q_0$: No estamos en un candidado a ser cadena final. Si leemos un $1$, empezaremos la que puede ser la cadena final.
            \item $q_0q_1$: Hemos leído un $1$, por lo que hemos empezado la posible cadena final. Llevamos $1$.
            \item $q_0q_1q_2$: Hemos leído un $1$ y un $1$. Llevamos $11$ de cadena final.
            \item $q_0q_2$: Hemos leído un $1$ y un $0$. Llevamos $10$ de cadena final.
            \item $q_0q_1q_2q_3$: Hemos leído un $1$, un $1$ y un $1$. Llevamos $111$ de cadena final.
            \item $q_0q_2q_3$: Hemos leído un $1$, un $1$ y un $0$. Llevamos $110$ de cadena final.
            \item $q_0q_1q_3$: Hemos leído un $1$, un $0$ y un $1$. Llevamos $101$ de cadena final.
            \item $q_0q_3$: Hemos leído un $1$, un $0$ y un $0$. Llevamos $100$ de cadena final.
        \end{itemize}
        Lo complejo de hacerlo de forma directa sería ver las transiciones desde los estados finales. Razonando cuál es la cadena final leída, podríamos haberlo hecho de forma directa, pero el AFND nos ha ayudado a hacerlo de forma algorítmica.
        La minimización del autómata de la Figura~\ref{fig:ej:1.3.20:AFD} se muestra en la Tabla~\ref{tab:ej:1.3.20:AFD-Minimal}, donde vemos que este era minimal.
        \begin{table}
            \centering
            \begin{tabular}{r c c c c c c c c}
                \hhline{~*{1}{-}}
                $q_0q_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
                $q_0q_1q_2$ & \cell{\times} & \cell{\xcancel{(q_0q_3,q_0q_1q_3)}} \\ \hhline{~*{3}{-}}
                $q_0q_2$ & \cell{\xcancel{(q_0q_3,q_0q_1q_3)}} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
                $q_0q_1q_2q_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{5}{-}}
                $q_0q_2q_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
                $q_0q_1q_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                $q_0q_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                & $q_0$ & $q_0q_1$ & $q_0q_1q_2$ & $q_0q_2$ & $q_0q_1q_2q_3$ & $q_0q_2q_3$ & $q_0q_1q_3$
            \end{tabular}
            \caption{Tabla de minimización del autómata de la Figura~\ref{fig:ej:1.3.20:AFD}.}
            \label{tab:ej:1.3.20:AFD-Minimal}
        \end{table}

        Como vemos, obtener el autómata producto será complejo, puesto que tendrá $8\cdot 5=40$ estados. Por tanto, optamos por la segunda opción.

        \item[Opción 2:]  Expresión Regular.
        
        La expresión regular del lenguaje intersección ha de ser la siguiente:
        \begin{equation*}
            (0+1)(0+1) \ \red{0}\  {(0+1)}^{\ast} \ \red{1}\ (0+1)(0+1)
        \end{equation*}
        \begin{observacion}
            Notemos que esta expresión regular no contempla las palabras de longitud menor o igual a $5$. Estudiemos estas:
            \begin{itemize}
                \item Si $|z|=5$, es necesario que el tercer símbolo sea un $0$ y el antepenúltimo ($5-2=3$) un $1$. Por tanto, como el tercer símbolo no puede tomar ambos valores a la vez, no hay palabras de longitud $5$.
                \item Si $|z|=4$, es necesario que el tercer símbolo sea un $0$ y el antepenúltimo ($4-2=2$) un $1$. Por tanto, estas palabras son de la forma $(0+1) \ \red{10} \ (0+1)$.
                \item Si $|z|=3$, es necesario que el tercer símbolo sea un $0$ y el antepenúltimo ($3-2=1$) un $1$. Por tanto, estas palabras son de la forma $\red{1} \ (0+1) \ \red{0}$.
                \item Si $|z|<3$, no podemos considerar el tercer símbolo, por lo que no hay palabras de longitud menor que $3$.
            \end{itemize}

            Por tanto, la expresión regular correcta sería:
            \begin{equation*}
                (0+1)(0+1) \ \red{0}\  {(0+1)}^{\ast} \ \red{1}\ (0+1)(0+1)
                + (0+1) \ \red{10} \ (0+1)
                + \red{1} \ (0+1) \ \red{0}
            \end{equation*}
            No obstante, obtener el autómata finito minimal asociado a esta expresión regular sería muy complejo, por lo que no consideramos dichas palabras.
        \end{observacion}

        El AFND que acepta el lenguaje intersección se muestra en la Figura~\ref{fig:ej:1.3.20:AFND-Interseccion}.
        \begin{figure}
            \centering
            \begin{tikzpicture}[node distance=2.5cm]
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, right of=q2] (q3) {$q_3$};
                \node[state, right of=q3] (q4) {$q_4$};
                \node[state, right of=q4] (q5) {$q_5$};
                \node[state, accepting, right of=q5] (q6) {$q_6$};

                \draw   (q0) edge[above] node{$0,1$} (q1)
                        (q1) edge[above] node{$0,1$} (q2)
                        (q2) edge[above] node{$0$} (q3)
                        (q3) edge[loop above] node{$0,1$} (q3)
                        (q3) edge[above] node{$1$} (q4)
                        (q4) edge[above] node{$0,1$} (q5)
                        (q5) edge[above] node{$0,1$} (q6);
            \end{tikzpicture}
            \caption{AFND que acepta la intersección de los lenguajes del ejercicio~\ref{ej:1.3.20}.}
            \label{fig:ej:1.3.20:AFND-Interseccion}
        \end{figure}

        Convertimos ahora el AFND de la Figura \ref{fig:ej:1.3.20:AFND-Interseccion} en un AFD, representado en la Figura \ref{fig:ej:1.3.20:AFD-Interseccion}.
        \begin{figure}
            \centering
            \resizebox{1.15\textwidth}{!}{
            \begin{tikzpicture}[node distance=2.7cm]
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, right of=q2] (q3) {$q_3$};
                \node[state, right of=q3] (q3q4) {$q_3q_4$};
                \node[state, above right of=q3q4, xshift=3em] (q3q4q5) {$q_3q_4q_5$};
                \node[state, below right of=q3q4, xshift=3em] (q3q5) {$q_3q_5$};
                \node[state, above right of=q3q4q5, accepting, xshift=3em] (q3q4q5q6) {$q_3q_4q_5q_6$};
                \node[state, below right of=q3q4q5, accepting, xshift=3em, yshift=3em] (q3q5q6) {$q_3q_5q_6$};
                \node[state, above right of=q3q5, accepting, xshift=3em, yshift=-3em] (q3q4q6) {$q_3q_4q_6$};
                \node[state, below right of=q3q5, accepting, xshift=3em] (q3q6) {$q_3q_6$};
                \node[state, error, below of=q2] (E) {$E$};

                \draw   (q0) edge[above] node{$0,1$} (q1)
                        (q1) edge[above] node{$0,1$} (q2)
                        (q2) edge[above] node{$0$} (q3)
                        (q2) edge[right] node{$1$} (E)
                
                        (q3) edge[loop above] node{0} (q3)
                        (q3) edge[above] node{1} (q3q4)
                        (q3q4) edge[above] node{0} (q3q5)
                        (q3q4) edge[above] node{1} (q3q4q5)
                        (q3q5) edge[above] node{0} (q3q6)
                        (q3q5) edge[above] node{1} (q3q4q6)
                        (q3q4q5) edge[above] node{0} (q3q5q6)
                        (q3q4q5) edge[above] node{1} (q3q4q5q6)
                        (q3q4q5q6) edge[right, bend left] node{0} (q3q5q6)
                        (q3q4q5q6) edge[loop above] node{1} (q3q4q5q6)
                        (q3q5q6) edge[right, bend left=45] node{0} (q3q6)
                        (q3q5q6) edge[right, bend left] node[pos=0.8]{1} (q3q4q6)
                        (q3q4q6) edge[below, bend left] node[pos=0.1]{0} (q3q5)
                        (q3q4q6) edge[right] node{1} (q3q4q5)
                        (q3q6) edge[below, bend left] node{1} (q3q4)
                        (q3q6) edge[below, bend left] node{0} (q3);
            \end{tikzpicture}
            }
            \caption{AFD que acepta la intersección de los lenguajes del ejercicio~\ref{ej:1.3.20}.}
            \label{fig:ej:1.3.20:AFD-Interseccion}
        \end{figure}
    \end{description}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.21}
    Construir un autómata finito minimal para los siguientes lenguajes sobre el alfabeto $\{0,1\}$:
    \begin{enumerate}
        \item \label{ej:1.3.21-1}
        Palabras que contienen como subcadena una palabra del conjunto ${\{00,11\}}^{2}$.
        
        Han de contener una subcadena del conjunto $\{0000,0011,1100,1111\}$. Para ello, construimos el autómata de la Figura~\ref{fig:ej:1.3.21-1:AFD}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_{1}$};
                \node[state, below right of=q0] (q2) {$q_{2}$};
                \node[state, right of=q1] (q3) {$q_{3}$};
                \node[state, right of=q2] (q4) {$q_{4}$};
                \node[state, above right of=q3, yshift=-2em] (q5) {$q_{5}$};
                \node[state, below right of=q3, yshift=2em] (q6) {$q_{6}$};
                \node[state, above right of=q4, yshift=-2em] (q7) {$q_{7}$};
                \node[state, below right of=q4, yshift=2em] (q8) {$q_{8}$};
                \node[state, accepting, right of=q5] (q9) {$q_{9}$};
                \node[state, accepting, right of=q6] (q10) {$q_{10}$};
                \node[state, accepting, right of=q7] (q11) {$q_{11}$};
                \node[state, accepting, right of=q8] (q12) {$q_{12}$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{0} (q3)
                        (q3) edge[above] node{0} (q5)
                        (q5) edge[above] node{0} (q9)
                        (q3) edge[above] node{1} (q6)
                        (q6) edge[above] node{1} (q10)
                        (q0) edge[above] node{1} (q2)
                        (q2) edge[above] node{1} (q4)
                        (q4) edge[above] node{1} (q8)
                        (q8) edge[above] node{1} (q12)
                        (q4) edge[above] node{0} (q7)
                        (q7) edge[above] node{0} (q11);
                    
                \draw   (q1) edge[left, bend left] node{1} (q2)
                        (q2) edge[right, bend left] node{0} (q1)
                        (q5) edge[right] node{1} (q6)
                        (q6) edge[above, bend left] node{0} (q1)
                        (q8) edge[right] node{0} (q7)
                        (q7) edge[below, bend right] node{1} (q2);

                \draw   (q9) edge[loop right] node{0,1} (q9)
                        (q10) edge[loop right] node{0,1} (q10)
                        (q11) edge[loop right] node{0,1} (q11)
                        (q12) edge[loop right] node{0,1} (q12);
            \end{tikzpicture}
            \caption{AFD que acepta el lenguaje del ejercicio~\ref{ej:1.3.21}.\ref{ej:1.3.21-1}.}
            \label{fig:ej:1.3.21-1:AFD}
        \end{figure}

        La minimización del autómata de la Figura~\ref{fig:ej:1.3.21-1:AFD} se muestra en la Tabla~\ref{tab:ej:1.3.21-1:AFD-Minimal}.
        \begin{table}
            \centering
            \begin{tabular}{r cccccccccccccc}
                \hhline{~*{1}{-}}
                $q_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
                $q_2$ & \cell{\times} & \cell{\times} \\ \hhline{~*{3}{-}}
                $q_3$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
                $q_4$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{5}{-}}
                $q_5$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
                $q_6$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
                $q_7$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{8}{-}}
                $q_8$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{9}{-}}
                $q_9$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times}& \cell{\times} \\ \hhline{~*{10}{-}}
                $q_{10}$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times}& \cell{\times} & \cell{} \\ \hhline{~*{11}{-}}
                $q_{11}$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times}& \cell{\times} & \cell{} & \cell{} \\ \hhline{~*{12}{-}}
                $q_{12}$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times}& \cell{\times} & \cell{} & \cell{} & \cell{} \\ \hhline{~*{12}{-}}
                & $q_0$ & $q_1$ & $q_2$ & $q_3$ & $q_4$ & $q_5$ & $q_6$ & $q_7$ & $q_8$ & $q_9$ & $q_{10}$ & $q_{11}$
            \end{tabular}
            \caption{Tabla de minimización del autómata de la Figura~\ref{fig:ej:1.3.21-1:AFD}.}
            \label{tab:ej:1.3.21-1:AFD-Minimal}
        \end{table}

        Por tanto, tenemos que todos los estados finales eran indistinguibles. Notándolos por $q_F$, el autómata minimal es el de la Figura~\ref{fig:ej:1.3.21-1:AFD-Minimal}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_{1}$};
                \node[state, below right of=q0] (q2) {$q_{2}$};
                \node[state, right of=q1] (q3) {$q_{3}$};
                \node[state, right of=q2] (q4) {$q_{4}$};
                \node[state, above right of=q3, yshift=-2em] (q5) {$q_{5}$};
                \node[state, below right of=q3, yshift=2em] (q6) {$q_{6}$};
                \node[state, above right of=q4, yshift=-2em] (q7) {$q_{7}$};
                \node[state, below right of=q4, yshift=2em] (q8) {$q_{8}$};
                \node[state, accepting, right of=q7, yshift=2em] (qF) {$q_{F}$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{0} (q3)
                        (q3) edge[above] node{0} (q5)
                        (q5) edge[above, bend left] node{0} (qF)
                        (q3) edge[above] node{1} (q6)
                        (q6) edge[above] node{1} (qF)
                        (q0) edge[above] node{1} (q2)
                        (q2) edge[above] node{1} (q4)
                        (q4) edge[above] node{1} (q8)
                        (q8) edge[above, bend right] node{1} (qF)
                        (q4) edge[above] node{0} (q7)
                        (q7) edge[above] node{0} (qF);
                    
                \draw   (q1) edge[left, bend left] node{1} (q2)
                        (q2) edge[right, bend left] node{0} (q1)
                        (q5) edge[right] node{1} (q6)
                        (q6) edge[above, bend left] node{0} (q1)
                        (q8) edge[right] node{0} (q7)
                        (q7) edge[below, bend right] node{1} (q2);

                \draw   (qF) edge[loop right] node{0,1} (qF);
            \end{tikzpicture}
            \caption{AFD minimal que acepta el lenguaje del ejercicio~\ref{ej:1.3.21}.\ref{ej:1.3.21-1}.}
            \label{fig:ej:1.3.21-1:AFD-Minimal}
        \end{figure}
        \item \label{ej:1.3.21-2}
        Palabras que contienen como subcadena una palabra del conjunto $\{0011,1100\}$.

        El AFD minimal que acepta este lenguaje es el de la Figura~\ref{fig:ej:1.3.21-2:AFD}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_{1}$};
                \node[state, below right of=q0] (q2) {$q_{2}$};
                \node[state, right of=q1] (q3) {$q_{3}$};
                \node[state, right of=q2] (q4) {$q_{4}$};
                \node[state, right of=q3] (q6) {$q_{6}$};
                \node[state, right of=q4] (q7) {$q_{7}$};
                \node[state, accepting, above right of=q7] (qF) {$q_{F}$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{0} (q3)
                        (q3) edge[loop above] node{0} (q3)
                        (q3) edge[above] node{1} (q6)
                        (q6) edge[above] node{1} (qF)
                        (q0) edge[above] node{1} (q2)
                        (q2) edge[above] node{1} (q4)
                        (q4) edge[loop below] node{1} (q4)
                        (q4) edge[above] node{0} (q7)
                        (q7) edge[above] node{0} (qF);
                    
                \draw   (q1) edge[left, bend left] node{1} (q2)
                        (q2) edge[right, bend left] node{0} (q1)
                        (q6) edge[below, bend left] node{0} (q1)
                        (q7) edge[above, bend right] node{1} (q2);

                \draw   (qF) edge[loop right] node{0,1} (qF);
            \end{tikzpicture}
            \caption{AFD minimal que acepta el lenguaje del ejercicio~\ref{ej:1.3.21}.\ref{ej:1.3.21-2}.}
            \label{fig:ej:1.3.21-2:AFD}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.22}
    Responda a los siguientes apartados:
    \begin{enumerate}
        \item Construye una gramática regular que genere el siguiente lenguaje:
            \begin{equation*}
                L_1 = \{u\in {\{0,1\}}^{\ast} \mid \text{ el número de 1's y el número de 0's en } u \text{ es par }\}
            \end{equation*}

            Este es muy similar al Ejercicio~\ref{ej:1.2.15}. Tenemos los siguientes estados:
            \begin{itemize}
                \item \ul{$S$}: La cadena leída es correcta, ya que el número de $0$'s y de $1$'s es par.
                \item \ul{$E_0$}: Tenemos un error en $0$, ya que el número de $0$'s es impar. El número de $1$'s es par.
                \item \ul{$E_1$}: Tenemos un error en $1$, ya que el número de $1$'s es impar. El número de $0$'s es par.
                \item \ul{$E_{01}$}: Tenemos un error en $0$ y en $1$, ya que el número de $0$'s y de $1$'s es impar.
            \end{itemize}
        
            La gramática obtenida es $G=(\{E_{01},E_0,E_1,S\}, \{0, 1\}, P, S)$, donde $P$ es:
            \begin{align*}
                S &\to 0E_0 \mid 1E_1 \mid \veps, \\
                E_0 &\to 0S \mid 1E_{01}, \\
                E_1 &\to 0E_{01} \mid 1S, \\
                E_{01} &\to 0E_1 \mid 1E_0
            \end{align*}

            El autómata finito determinista minimal asociado a la gramática obtenida es el de la Figura~\ref{fig:1.3.22-L1}.
            \begin{figure}
                \centering
                \begin{tikzpicture}
                    \node[state, initial, accepting] (S) {$S$};
                    \node[state, right of=S] (E0) {$E_0$};
                    \node[state, below of=S] (E1) {$E_1$};
                    \node[state, below of=E0] (E01) {$E_{01}$};

                    \draw   (S) edge[above] node{0} (E0)
                            (S) edge[left] node{1} (E1)
                            (E0) edge[above, bend right] node{0} (S)
                            (E0) edge[right] node{1} (E01)
                            (E1) edge[above] node{0} (E01)
                            (E1) edge[left, bend left] node{1} (S)
                            (E01) edge[below, bend left] node{0} (E1)
                            (E01) edge[right, bend right] node{1} (E0);
                \end{tikzpicture}
                \caption{AFD minimal asociado a $L_1$ del Ejercicio~\ref{ej:1.3.22}.}
                \label{fig:1.3.22-L1}
            \end{figure}
        \item Construye un autómata que reconozca el siguiente lenguaje:
            \begin{equation*}
                L_2 = \{0^n 1^m \mid n\geq 1, m\geq 0, n \text{ múltiplo de 3, } m \text{ par }\}
            \end{equation*}

            Sean los siguientes estados:
            \begin{itemize}
                \item \ul{$q_0$}: $n,m=0$.
                \item \ul{$q_1$}: $n \mod 3=1$, $m=0$.
                \item \ul{$q_2$}: $n \mod 3=2$, $m=0$.
                \item \ul{$q_3$}: $n \mod 3=0$, $n>1$, $m=0$.
                \item \ul{$q_4$}: $n \mod 3=0$, $m\mod 2=1$.
                \item \ul{$q_5$}: $n \mod 3=0$, $m\mod 2=0$.
            \end{itemize}

            El autómata finito determinista asociado a $L_2$ es el de la Figura~\ref{fig:1.3.22-L2}.
            \begin{figure}
                \centering
                \begin{tikzpicture}[node distance=2.5cm]
                    \node[state, initial] (q0) {$q_0$};
                    \node[state, right of=q0] (q1) {$q_1$};
                    \node[state, right of=q1] (q2) {$q_2$};
                    \node[state, error, below right of=q2, yshift=-2em] (E) {$E$};
                    \node[state, above right of=E, accepting, yshift=2em] (q3) {$q_3$};
                    \node[state, right of=q3] (q4) {$q_4$};
                    \node[state, right of=q4, accepting] (q5) {$q_5$};

                    \draw   (q0) edge[above] node{0} (q1)
                            (q1) edge[above] node{0} (q2)
                            (q2) edge[above] node{0} (q3)
                            (q3) edge[above, bend right] node{0} (q1)
                            (q3) edge[above] node{1} (q4)
                            (q4) edge[above] node{1} (q5)
                            (q5) edge[above, bend right] node{1} (q4);
                    \draw[opacity=0.6]
                            (q0) edge[above] node{1} (E)
                            (q1) edge[above] node{1} (E)
                            (q2) edge[above] node{1} (E)
                            (q4) edge[above] node{0} (E)
                            (q5) edge[above] node{0} (E);
                \end{tikzpicture}
                \caption{AFD minimal asociado a $L_2$ del Ejercicio~\ref{ej:1.3.22}.}
                \label{fig:1.3.22-L2}
            \end{figure}


        \item Diseña el AFD mínimo que reconoce el lenguaje $(L_1 \cup L_2)$.
        % // TODO: Union de L1 y L2
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.23}
    Sobre el alfabeto $\{0,1\}$:
    \begin{enumerate}
        \item Construye una gramática regular que genere el lenguaje $L_1$ de las palabras $u$ tales que:
            \begin{itemize}
                \item Si $|u|< 5$ entonces el número de 1's es impar.
                \item Si $|u|\geq 5$ entonces el número de 1's es par.
                \item $u$ tiene al menos un símbolo 1.
            \end{itemize}
            % // TODO: Gramática regular para L1
        \item \label{ej:1.3.23-2}
        Construye un autómata que reconozca el lenguaje $L_2$ dado por:
            \begin{equation*}
                L_2 = \{0^n 1^m \mid n\geq 0, m\geq 1, m \text{\ es múltiplo de\ } 6\}
            \end{equation*}

            El autómata finito determinista asociado a $L_2$ es el de la Figura~\ref{fig:1.3.23-L2}.
            \begin{figure}
                \centering
                \begin{tikzpicture}[node distance=2.5cm]
                    \node[state, initial] (q0) {$q_0$};
                    \node[state, right of=q0] (q1) {$q_1$};
                    \node[state, right of=q1] (q2) {$q_2$};
                    \node[state, right of=q2] (q3) {$q_3$};
                    \node[state, right of=q3] (q4) {$q_4$};
                    \node[state, right of=q4] (q5) {$q_5$};
                    \node[state, accepting, right of=q5] (q6) {$q_6$};
                    \node[state, below of=q3, error] (E) {$E$};

                    \draw   (q0) edge[above] node{1} (q1)
                            (q1) edge[above] node{1} (q2)
                            (q2) edge[above] node{1} (q3)
                            (q3) edge[above] node{1} (q4)
                            (q4) edge[above] node{1} (q5)
                            (q5) edge[above] node{1} (q6)
                            (q6) edge[above, bend right] node{1} (q1)
                            (q0) edge[loop above] node{0} (q0)
                            (q1) edge[above] node{0} (E)
                            (q2) edge[above] node{0} (E)
                            (q3) edge[above right] node{0} (E)
                            (q4) edge[above] node{0} (E)
                            (q5) edge[above] node{0} (E)
                            (q6) edge[above] node{0} (E)
                            (E) edge[loop below] node{0,1} (E);
                \end{tikzpicture}
                \caption{AFD minimal asociado a $L_2$ del Ejercicio~\ref{ej:1.3.23}.\ref{ej:1.3.23-2}.}
                \label{fig:1.3.23-L2}
            \end{figure}

        \item Diseña el AFD mínimo que reconozca el lenguaje $(L_1 \cup L_2)$.
        
        % // TODO: Interseccion de L1 y L2
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.24}
    Encuentra para cada uno de los siguientes lenguajes una gramática de tipo 3 que lo genere o un autómata finito que lo reconozca:
    \begin{itemize}
        \item $L_1 = \{u\in {\{0,1\}}^{\ast} \mid u \text{\ no contiene la subcadena } \text{``}0101\text{''}\}$.
        \item $L_2 = \{0^i 1^j 0^k \mid i \geq 1, k\geq 0, i \text{\ impar\ }, k \text{\ múltiplo de\ } 3 \text{\ y\ } j\geq 2\}$ .
    \end{itemize}
    Diseña el AFD mínimo que reconoce el lenguaje $(L_1\cap L_2)$.\\

    El AFD minimal asociado a $L_1$ es el de la Figura~\ref{fig:1.3.24-L1}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q1) {$q_1$};
            \node[state, right of=q1, accepting] (q2) {$q_2$};
            \node[state, right of=q2, accepting] (q3) {$q_3$};
            \node[state, right of=q3] (q4) {$q_4$};

            \draw   (q0) edge[above] node{0} (q1)
                    (q0) edge[loop above] node{1} (q0)
                    (q1) edge[above] node{1} (q2)
                    (q1) edge[loop above] node{0} (q1)
                    (q2) edge[above] node{0} (q3)
                    (q2) edge[below, bend left] node{1} (q0)
                    (q3) edge[above] node{1} (q4)
                    (q3) edge[above, bend right] node{0} (q1)
                    (q4) edge[loop above] node{0,1} (q4);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_1$ del Ejercicio~\ref{ej:1.3.24}.}
        \label{fig:1.3.24-L1}
    \end{figure}

    El AFD minimal asociado a $L_2$ es el de la Figura~\ref{fig:1.3.24-L2}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (p0) {$p_0$};
            \node[state, right of=p0] (p1) {$p_1$};
            \node[state, right of=p1] (p2) {$p_2$};
            \node[state, right of=p2, accepting] (p3) {$p_3$};
            \node[state, right of=p3] (p4) {$p_4$};
            \node[state, right of=p4] (p5) {$p_5$};
            \node[state, error, below of=p2] (E) {$E$};

            \draw   (p0) edge[above] node{0} (p1)
                    (p1) edge[above, bend right] node{0} (p0)
                    (p1) edge[above] node{1} (p2)
                    (p2) edge[above] node{1} (p3)
                    (p3) edge[loop above] node{1} (p3)
                    (p3) edge[above] node{0} (p4)
                    (p4) edge[above] node{0} (p5)
                    (p5) edge[above, bend right] node{0} (p3)
                    (p0) edge[above] node{1} (E)
                    (p2) edge[above right] node{0} (E)
                    (p4) edge[above] node{1} (E)
                    (p5) edge[above] node{1} (E)
                    (E) edge[loop below] node{0,1} (E);


        \end{tikzpicture}
        \caption{AFD minimal asociado a $L_2$ del Ejercicio~\ref{ej:1.3.24}.}
        \label{fig:1.3.24-L2}
    \end{figure}

    El AFD asociado a $(L_1\cap L_2)$ es el de la Figura~\ref{fig:1.3.24-L1-L2}. Notemos que todos los estados de la forma $q_i,E$ se han agrupado en un único estado $E$, ya que todos ellos son indistingubles puesto que no se puede llegar desde ellos a ningún final.
    \begin{figure}
        \centering
        \resizebox{\textwidth}{!}{
        \begin{tikzpicture}[node distance=2.3cm]
            \node[state, initial] (q0p0) {$q_0p_0$};
            \node[state, right of=q0p0] (q1p1) {$q_1p_1$};
            \node[state, right of=q1p1] (q1p0) {$q_1p_0$};
            \node[state, below of=q1p1] (q2p2) {$q_2p_2$};
            \node[state, right of=q2p2, accepting] (q0p3) {$q_0p_3$};
            \node[state, right of=q0p3] (q1p4) {$q_1p_4$};
            \node[state, right of=q1p4] (q1p5) {$q_1p_5$};
            \node[state, right of=q1p5, accepting] (q1p3) {$q_1p_3$};
            \node[state, right of=q1p3, accepting] (q2p3) {$q_2p_3$};
            \node[state, right of=q2p3] (q3p4) {$q_3p_4$};
            \node[state, above of=q1p5, error] (E) {$E$};

            \draw   (q0p0) edge[above] node{0} (q1p1)
                    (q1p1) edge[below] node{0} (q1p0)
                    (q1p1) edge[left] node{1} (q2p2)
                    (q1p0) edge[above, bend right] node{0} (q1p1)
                    (q2p2) edge[below] node{1} (q0p3)
                    (q0p3) edge[above] node{0} (q1p4)
                    (q0p3) edge[loop below] node{1} (q0p3)
                    (q1p4) edge[above] node{0} (q1p5)
                    (q1p5) edge[above] node{0} (q1p3)
                    (q1p3) edge[below, bend left] node{0} (q1p4)
                    (q1p3) edge[above] node{1} (q2p3)
                    (q2p3) edge[above] node{0} (q3p4)
                    (q2p3) edge[below, bend left] node{1} (q0p3)
                    (q3p4) edge[above, bend right] node{0} (q1p5);

            \draw[opacity=0.6]
            (q0p0) edge[above, bend left] node{1} (E)
            (q1p0) edge[above] node{1} (E)
            (q2p2) edge[above] node{0} (E)
            (q1p4) edge[above] node{1} (E)
            (q1p5) edge[right] node{1} (E)
            (q3p4) edge[above, bend right] node{1} (E)
            (E) edge[loop above] node{0,1} (E);
        \end{tikzpicture}
        }
        \caption{AFD asociado a $(L_1\cap L_2)$ del Ejercicio~\ref{ej:1.3.24}.}
        \label{fig:1.3.24-L1-L2}
    \end{figure}

    La minimización de este autómata se muestra en la Tabla~\ref{tab:1.3.24-L1-L2}.
    \begin{table}[H]
        \centering
        \resizebox{1.1\textwidth}{!}{
        \begin{tabular}{r cccccccccc}
            \hhline{~*{1}{-}} 
            $q_1p_1$ & \cell{\times} \\ \hhline{~*{2}{-}}
            $q_1p_0$ & \cell{} & \cell{\times} \\ \hhline{~*{3}{-}}
            $q_2p_2$ & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{4}{-}}
            $q_0p_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{5}{-}}
            $q_1p_4$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{6}{-}}
            $q_1p_5$ & \cell{\times} & \cell{\xcancel{\begin{array}{c}(q_0p_0,q_3p_4)\\(q_1p_0,q_3p_4)\end{array}}} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{7}{-}}
            $q_1p_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{} & \cell{\times} & \cell{\times} \\ \hhline{~*{8}{-}}
            $q_2p_3$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{(q_1p_3,q_0p_3)} & \cell{\times} & \cell{\times} & \cell{(q_1p_3,q_2p_3)} \\ \hhline{~*{9}{-}}
            $q_3p_4$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\begin{array}{c}(q_0p_3,q_2p_3)\\(q_1p_3,q_2p_3)\end{array}} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{10}{-}}
            $E$ & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} & \cell{\times} \\ \hhline{~*{10}{-}}
            & $q_0p_0$ & $q_1p_1$ & $q_1p_0$ & $q_2p_2$ & $q_0p_3$ & $q_1p_4$ & $q_1p_5$ & $q_1p_3$ & $q_2p_3$ & $q_3p_4$
        \end{tabular}}
        \caption{Tabla de minimización del autómata de la Figura~\ref{fig:1.3.24-L1-L2}.}
        \label{tab:1.3.24-L1-L2}
    \end{table}

    % // TODO: COntinuar

\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.25}
    Dado el alfabeto $A=\{a,b,c\}$, encuentra:
    \begin{enumerate}
        \item Un AFD que reconozca las palabras en las que cada ``c'' va precedida de una ``a'' o una ``b''.
        \item Una expresión regular que represente el lenguaje compuesto por las palabras de longitud impar en las que el símbolo central es una ``c''.
        \item Una gramática regular que genere las palabras de longitud impar.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.26}
    Construir autómatas finitos para los siguientes lenguajes sobre el alfabeto $\{a,b,c\}$:
    \begin{enumerate}
        \item $L_1$: palabras del lenguaje ${(a+b)}^{\ast}{(b+c)}^{\ast}$.
        \item $L_2$: palabras en las que nunca hay una 'a' posterior a una 'c'.
        \item $(L_1 \setminus L_2)\cup (L_2 \setminus L_1)$
    \end{enumerate}
    ¿Qué podemos concluir sobre $L_1$ y $L_2$?
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.27}
    Si $f:{\{0,1\}}^{\ast}\rightarrow{\{a,b,c\}}^{\ast}$ es un homomorfismo dado por
    \begin{equation*}
        f(0) = aab \qquad f(1) = bbc
    \end{equation*}
    dar autómatas finitos deterministas minimales para los lenguajes $L$ y $f^{-1}(L)$ donde $L\subseteq {\{a,b,c\}}^{\ast}$ es el lenguaje en el que el número de símbolos $a$ no es múltiplo de 4.\\

    El autómata finito minimal asociado a $L$ es el de la Figura~\ref{fig:1.3.27-L}, donde $q_i$ representa el estado en el que $n_a \mod 4 = i$.
    Empleando un distino número de cadenas de $a$'s, vemos que los estados son distinguibles, por lo que es minimal.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q1) {$q_1$};
            \node[state, right of=q1, accepting] (q2) {$q_2$};
            \node[state, right of=q2, accepting] (q3) {$q_3$};

            \draw   (q0) edge[above] node{$a$} (q1)
                    (q0) edge[loop above] node{$b,c$} (q0)
                    (q1) edge[above] node{$a$} (q2)
                    (q1) edge[loop above] node{$b,c$} (q1)
                    (q2) edge[above] node{$a$} (q3)
                    (q2) edge[loop above] node{$b,c$} (q2)
                    (q3) edge[loop above] node{$b,c$} (q3)
                    (q3) edge[below, bend left] node{$a$} (q0);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $L$ del Ejercicio~\ref{ej:1.3.27}.}
        \label{fig:1.3.27-L}
    \end{figure}

    Empleando el algoritmo, el AFD asociado a $f^{-1}(L)$ es el de la Figura~\ref{fig:1.3.27-f-1-L}.
    No obstante, y debido a que hay estados inaccesibles, este no es minimal. El AFD minimal asociado a $f^{-1}(L)$ es el de la Figura~\ref{fig:1.3.27-f-1-L-minimal}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, below of=q0, accepting] (q1) {$q_1$};
            \node[state, right of=q0, accepting] (q2) {$q_2$};
            \node[state, right of=q1, accepting] (q3) {$q_3$};

            \draw   (q0) edge[above] node{$0$} (q2)
                    (q0) edge[loop above] node{$1$} (q0)
                    (q1) edge[above] node{$0$} (q3)
                    (q1) edge[loop above] node{$1$} (q1)
                    (q2) edge[below, bend left] node{$0$} (q0)
                    (q2) edge[loop above] node{$1$} (q2)
                    (q3) edge[loop above] node{$1$} (q3)
                    (q3) edge[below, bend left] node{$0$} (q1);
        \end{tikzpicture}
        \caption{AFD asociado a $f^{-1}(L)$ del Ejercicio~\ref{ej:1.3.27}.}
        \label{fig:1.3.27-f-1-L}
    \end{figure}
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q2) {$q_2$};

            \draw   (q0) edge[above] node{$0$} (q2)
                    (q0) edge[loop above] node{$1$} (q0)
                    (q2) edge[below, bend left] node{$0$} (q0)
                    (q2) edge[loop above] node{$1$} (q2);
        \end{tikzpicture}
        \caption{AFD minimal asociado a $f^{-1}(L)$ del Ejercicio~\ref{ej:1.3.27}.}
        \label{fig:1.3.27-f-1-L-minimal}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.28}
    Si $L_1$ es el lenguaje asociadoa a la expresión regular $01{(01+1)}^{\ast}$ y $L_2$ el lenguaje asociado a la expresión ${(1+10)}^{\ast}01$, encontrar un autómata minimal que acepte el lenguaje $L_1\setminus L_2$.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.29}
    Sean los alfabetos $A_1=\{a,b,c,d\}$ y $A_2=\{0,1\}$ y el lenguaje $L\subseteq A^\ast_2$ dado por la expresión regular ${(0+1)}^{\ast}0(0+1)$, calcular una expresión regular para el lenguaje $f^{-1}(L)$ donde $f$ es el homomorfismos entre $A^\ast_1$ y $A^\ast_2$ dado por
    \begin{equation*}
        f(a)=01 \qquad f(b) = 1 \qquad f(c)=0 \qquad f(d)=00
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.30}
    Obtener un autómata finito determinista para el lenguaje asociado a la expresión regular: ${(01)}^{+}+{(010)}^{\ast}$. Minimizarlo.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.31}
    Dado el lenguaje $L$ asociado a la expresión regular ${(01+011)}^{\ast}$ y el homomorfismo $f:{\{0,1\}}^{\ast}\rightarrow{\{0,1\}}^{\ast}$ dado por $f(0)=01$, $f(1)=1$, construir una expresión regular para el lenguaje $f^{-1}(L)$.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.32}
    Dar expresiones regulares para los siguientes lenguajes sobre el alfabeto $A_1=\{0,1,2\}$:
    \begin{enumerate}
        \item $L$ dado por el conjunto de palabras en las que cada 0 que no sea el último de la palabra va seguido por un 1 y cada 1 que no sea el último símbolo de la palabra va seguido por un 0.
        \item Considera el homomorfismo de $A_1$ en $A_2=\{0,1\}$  dado por $f(0)=001$, $f(1)=100$, $f(2)=0011$. Dar una expresión regular para $f(L)$.
        \item Dar una expresión regular para $LL^{-1}$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.33}
    Dados los lenguajes
    \begin{align*}
        L_1 &= \{0^i 1^j \mid i\geq 1, j\text{ es par y } j\geq 2\}\\
        L_2 &= \{1^j 0^k \mid k\geq 1, j\text{ es impar y } j\geq 1\}
    \end{align*}
    Encuentre:
    \begin{enumerate}
        \item Una gramática regular que genere el lenguaje $L_1$.
        \item Una expresión regular que represente al lenguaje $L_2$.
        \item Un automata finito determinista que acepte las cadenas de la concatenación de los lenguajes $L_1L_2$. Aplica el algoritmos para minimizar este autómata.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.34}
    Considerar los AFD $M_1=(\{A,B,C,D,E,F,G,H\}, \{0,1\}, \delta_1, A, \{C\})$ y $M_2=(\{A',B',C',D',G'\}, \{0,1\}, \delta_2, A', \{D'\})$ donde $\delta_1$ y $\delta_2$ están definidas por las Tablas~\ref{tab:1.3.34-M1} y~\ref{tab:1.3.34-M2} respectivamente.
    \begin{table}[h]
        \centering
        \begin{tabular}{r|cccccccc}
            $\delta_1$ & $A$ & $B$ & $C$ & $D$ & $E$ & $F$ & $G$ & $H$ \\
            \hline
            $0$ & $B$ & $G$ & $A$ & $C$ & $H$ & $C$ & $G$ & $G$ \\
            $1$ & $F$ & $C$ & $C$ & $G$ & $F$ & $G$ & $E$ & $C$
        \end{tabular}
        \caption{Transiciones del autómata $M_1$ del Ejercicio~\ref{ej:1.3.34}.}
        \label{tab:1.3.34-M1}
    \end{table}
    \begin{table}[h]
        \centering
        \begin{tabular}{r|ccccc}
            $\delta_2$ & $A'$ & $B'$ & $C'$ & $D'$ & $G'$ \\
            \hline
            $0$ & $G'$ & $B'$ & $D'$ & $A'$ & $B'$ \\
            $1$ & $C'$ & $A'$ & $B'$ & $D'$ & $D'$
        \end{tabular}
        \caption{Transiciones del autómata $M_2$ del Ejercicio~\ref{ej:1.3.34}.}
        \label{tab:1.3.34-M2}
    \end{table}
    Determinar si ambos autómatas finitos generan el mismo lenguaje.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.35}
    Comprobar si los autómatas de las Figuras~\ref{fig:1.3.35-M1} y~\ref{fig:1.3.35-M2} generan el mismo lenguaje.
    \begin{figure}
        \centering
        \begin{subfigure}[c]{0.45\textwidth}
            \hspace{-1cm}
            \begin{tikzpicture}[node distance=5.3em]
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_1$};
                \node[state, below right of=q0] (q2) {$q_2$};
                \node[state, above right of=q2] (q3) {$q_3$};
                \node[state, above right of=q3] (q4) {$q_4$};
                \node[state, below right of=q3] (q5) {$q_5$};
                \node[state, above right of=q5, accepting] (q6) {$q_6$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q0) edge[above] node{$b$} (q3)
                        (q1) edge[above] node{$b$} (q4)
                        (q1) edge[above] node{$a$} (q3)
                        (q4) edge[above] node{$a$} (q6)
                        (q4) edge[above] node{$b$} (q3)
                        (q6) edge[left] node{$a$} (q5)
                        (q6) edge[above] node{$b$} (q3)
                        (q5) edge[above] node{$b$} (q2)
                        (q5) edge[above] node{$a$} (q3)
                        (q2) edge[above] node{$a$} (q0)
                        (q2) edge[above] node{$b$} (q3);
            \end{tikzpicture}
            \caption{Autómata $M_1$ del Ejercicio~\ref{ej:1.3.35}.}
            \label{fig:1.3.35-M1}
        \end{subfigure}
        \begin{subfigure}[c]{0.45\textwidth}
            \hspace{1cm}
            \begin{tikzpicture}[node distance=5.3em]
                \node[state, initial, accepting] (q0) {$p_0$};
                \node[state, right of=q0] (q1) {$p_1$};
                \node[state, right of=q1] (q2) {$p_2$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q1) edge[above] node{$b$} (q2)
                        (q2) edge[below, bend left] node{$a$} (q0);
            \end{tikzpicture}
            \caption{Autómata $M_2$ del Ejercicio~\ref{ej:1.3.35}.}
            \label{fig:1.3.35-M2}
        \end{subfigure}
        \caption{Autómatas del Ejercicio~\ref{ej:1.3.35}.}
        \label{fig:1.3.35}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.36}
    Minimizar el autómata de la Figura~\ref{fig:1.3.36-M}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1] (q2) {$q_2$};
            \node[state, below right of=q2] (q7) {$q_7$};
            \node[state, above right of=q7] (q3) {$q_3$};
            \node[state, below left of=q7] (q5) {$q_5$};
            \node[state, below right of=q7] (q6) {$q_6$};
            \node[state, left of=q5] (q4) {$q_4$};

            \draw   (q0) edge[above] node{$a$} (q1)
                    (q0) edge[above] node{$b$} (q4)
                    (q1) edge[above] node[pos=0.25]{$a$} (q5)
                    (q1) edge[above] node{$b$} (q2)
                    (q2) edge[above, bend left=20] node{$a$} (q3)
                    (q2) edge[above] node{$b$} (q7)
                    (q3) edge[below, bend left=20] node{$a$} (q2)
                    (q3) edge[above] node{$b$} (q7)
                    (q4) edge[above] node{$a$} (q5)
                    (q4) edge[above, bend right=20] node[pos=0.15]{$b$} (q2)
                    (q5) edge[above, bend left=20] node{$a$} (q6)
                    (q5) edge[above] node{$b$} (q7)
                    (q6) edge[below, bend left=20] node{$a$} (q5)
                    (q6) edge[above] node{$b$} (q7)
                    (q7) edge[loop right, right] node{$a,b$} (q7);
        \end{tikzpicture}
        \caption{Autómata a minimizar del Ejercicio~\ref{ej:1.3.36}.}
        \label{fig:1.3.36-M}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.3.37}
    Si $L_1$ y $L_2$ son lenguajes sobre el alfabeto $A$, entonces \emph{la mezcla perfecta} de estos lenguajes se define como el lenguaje:
    \begin{equation*}
        \{w\mid w=a_1b_1\cdots a_kb_k \mid  a_1\ldots a_k\in L_1, b_1\ldots b_k\in L_2, a_i,b_i\in A\}
    \end{equation*}
    Demostrar que si $L_1$ y $L_2$ son regulares, entonces la mezcla perfecta de $L_1$ y $L_2$ es regular.
\end{ejercicio}

\begin{ejercicio}\label{ej:1.3.38}
    Si $L$ es un lenguaje, sea $L_{\nicefrac{1}{2}}$ el conjunto de palabras que son las mitades de palabras de $L$ y $L_{\nicefrac{-1}{3}}$ el conjunto de palabras que son las dos terceras partes de palabras de $L$. Es decir:
    \begin{align*}
        L_{\nicefrac{1}{2}} &= \{x\mid \exists y\in A^\ast, |x|=|y|, xy\in L\} \\
        L_{\nicefrac{-1}{3}} &= \{xz\mid \exists y\in A^\ast, |x|=|y|=|z|, xyz\in L\}
    \end{align*}
    Demostrar que si $L$ es regular, entonces $L_{\nicefrac{1}{2}}$ también lo es, pero que $L_{\nicefrac{-1}{3}}$ no es necesariamente regular.
\end{ejercicio}