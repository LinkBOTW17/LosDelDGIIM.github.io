\newpage
\section{Autómatas Finitos}

\begin{comment}
\begin{tikzpicture}
    \node[state, initial] (q1) {$q_1$};
    \node[state, accepting, right of=q1] (q2) {$q_2$};
    \node[state, right of=q2] (q3) {$q_3$};
    \draw (q1) edge[loop above] node{0} (q1)
    (q1) edge[above] node{1} (q2)
    (q2) edge[loop above] node{1} (q2)
    (q2) edge[bend left, above] node{0} (q3)
    (q3) edge[bend left, below] node{0, 1} (q2);
\end{tikzpicture}
\end{comment}

\begin{ejercicio} \label{ej:1.2.1}
    Considera el siguiente Autómata Finito Determinista (AFD) dado por $M = (Q, A, \delta, q_0, F)$, donde:
    \begin{itemize}
        \item $Q = \{q_0, q_1, q_2\}$
        \item $A = \{0, 1\}$
        \item La función de transición viene dada por:
        \begin{align*}
            \delta(q_0, 0) &= q_1, & \delta(q_0, 1) &= q_0 \\
            \delta(q_1, 0) &= q_2, & \delta(q_1, 1) &= q_0 \\
            \delta(q_2, 0) &= q_2, & \delta(q_2, 1) &= q_2
        \end{align*}
        \item $F = \{q_2\}$
    \end{itemize}
    Describe informalmente el lenguaje aceptado.\\

    Su representación gráfica está en la Figura \ref{fig:ej:1.2.1}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, accepting, right of=q1] (q2) {$q_2$};

            \draw   (q0) edge[loop above] node{1} (q0)
                    (q0) edge[above, bend left] node{0} (q1)
                    (q1) edge[below, bend left] node{1} (q0)
                    (q1) edge[above] node{0} (q2)
                    (q2) edge[loop above] node{0, 1} (q2);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.1}}
        \label{fig:ej:1.2.1}
    \end{figure}

    Tenemos que el lenguaje aceptado por el autómata es el conjunto de todas las palabras que contienen
    la cadena $00$ como subcadena. Es decir,
    \begin{align*}
        L = \{u_100u_2 \in \{0, 1\}^* \mid u_1, u_2 \in \{0, 1\}^*\}.
    \end{align*}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.2}
    Dado el AFD de la Figura \ref{fig:ej:1.2.2}, describir el lenguaje aceptado por dicho autómata.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, accepting, right of=q1] (q2) {$q_2$};

            \draw   (q0) edge[loop above] node{$b$} (q0)
                    (q0) edge[above] node{$a$} (q1)
                    (q1) edge[loop above] node{$b$} (q1)
                    (q1) edge[bend left, above] node{$a$} (q2)
                    (q2) edge[bend left, below] node{$a$} (q1)
                    (q2) edge[loop above] node{$b$} (q2);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.2}}
        \label{fig:ej:1.2.2}
    \end{figure}

    El lenguaje aceptado por el autómata es el conjunto de todas las palabras que contienen
    un número par de $a$'s. Es decir,
    \begin{align*}
        L = \{u \in \{a, b\}^* \mid n_a(u) \text{ es par},~n_a(u)>0\},
    \end{align*}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.3}
    Dibujar AFDs que acepten los siguientes lenguajes con alfabeto $\{0, 1\}$:
    \begin{enumerate}
        \item El lenguaje vacío,
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};

                \draw   (q0) edge[loop above] node{0, 1} (q0);
            \end{tikzpicture}
        \end{figure}
        \item El lenguaje formado por la palabra vacía, es decir, $\{\varepsilon\}$,
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0, error] (E) {$E$};

                \draw   (q0) edge[above] node{0, 1} (E);
                \draw   (E) edge[loop above] node{0, 1} (E);
            \end{tikzpicture}
        \end{figure}
        \item El lenguaje formado por la palabra $01$, es decir, $\{01\}$,
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, accepting, right of=q1] (q2) {$q_2$};
                \node[state, below of=q1, error] (E) {$E$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{1} (q2);
                \draw   (q0) edge[below] node{1} (E)
                        (q1) edge[left] node{0} (E)
                        (q2) edge[below right] node{0, 1} (E)
                        (E) edge[loop below] node{0, 1} (E);
            \end{tikzpicture}
        \end{figure}
        \item El lenguaje $\{11, 00\}$,
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_1$};
                \node[state, below right of=q0] (q2) {$q_2$};
                \node[state, accepting, right of=q0] (q3) {$q_3$};
                \node[state, right of=q3, error] (E) {$E$};

                \draw   (q0) edge[above] node{1} (q1)
                        (q0) edge[below] node{0} (q2)
                        (q1) edge[above] node{0} (E)
                        (q1) edge[left] node{1} (q3)
                        (q2) edge[left] node{0} (q3)
                        (q2) edge[below] node{1} (E);
                \draw   (E) edge[loop above] node{0, 1} (E);
                \draw   (q3) edge[above left] node{0, 1} (E);
            \end{tikzpicture}
        \end{figure}
        \item El lenguaje $\{(01)^i \mid i \geq 0\}$,
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, below right of=q0, error] (E) {$E$};
                \node[state, above right of=E] (q1) {$q_1$};


                \draw   (q0) edge[below] node{0} (q1)
                        (q0) edge[below] node{1} (q2)
                        (q1) edge[left] node{0} (q2)
                        (q1) edge[above, bend right] node{1} (q0)
                        (q2) edge[loop below] node{0, 1} (q2);
            \end{tikzpicture}
        \end{figure}
        \item El lenguaje formado por las cadenas con $0$'s y $1$'s donde el número de unos es divisible por $3$.
        
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};

                \draw   (q0) edge[loop above] node{0} (q0)
                        (q0) edge[above] node{1} (q1)
                        (q1) edge[loop above] node{0} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[loop above] node{0} (q2)
                        (q2) edge[below, bend left] node{1} (q0);
            \end{tikzpicture}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.4}
    Obtener a partir de la gramática regular $G = (\{S, B\}, \{1, 0\}, P, S)$, con
    \begin{align*}
        P = \left\{
            \begin{aligned}
                S &\to 110B \\
                B &\to 0B \mid 1B \mid \varepsilon
            \end{aligned}
        \right.
    \end{align*}
    un AFND que reconozca el lenguaje generado por esa gramática.

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.4}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1] (q2) {$q_2$};
            \node[state, accepting, right of=q2] (q3) {$q_3$};

            \draw   (q0) edge[above] node{1} (q1)
                    (q1) edge[above] node{1} (q2)
                    (q2) edge[above] node{0} (q3)
                    (q3) edge[loop above] node{0, 1} (q3);
        \end{tikzpicture}
        \caption{Autómata Finito No Determinista del Ejercicio \ref{ej:1.2.4}}
        \label{fig:ej:1.2.4}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.5}
    Dada la gramática regular $G = (\{S\}, \{1, 0\}, P, S)$, con
    \begin{align*}
        P = \{S &\to S10, S \to 0\},
    \end{align*}
    obtener un AFD que reconozca el lenguaje generado por esa gramática.\\

    El lenguaje es:
    \begin{equation*}
        L = \{0(10)^n \mid n\in \bb{N}\cup \{0\}\}.
    \end{equation*}

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.5}.
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, below right of=q0, error] (E) {$E$};
            \node[state, accepting, above right of=E] (q1) {$q_1$};

            \draw   (q0) edge[above, bend left] node{0} (q1)
                    (q0) edge[below] node{1} (E)
                    (q1) edge[above, bend left] node{1} (q0)
                    (q1) edge[below] node{0} (E)
                    (E) edge[loop below] node{0, 1} (E);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.5}}
        \label{fig:ej:1.2.5}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.6}
    Construir un AFND o AFD (dependiendo del caso) que acepte las cadenas $u \in \{0, 1\}^*$ que:
    \begin{enumerate}
        \item AFND. Contengan la subcadena $010$. \label{ej:1.2.6.1}
        
        El autómata obtenido es el de la Figura \ref{fig:ej:1.2.6.1}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, accepting, right of=q2] (q3) {$q_3$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[above] node{0} (q3)
                        (q3) edge[loop above] node{0, 1} (q3)
                        (q0) edge[loop above] node{0, 1} (q0);
            \end{tikzpicture}
            \caption{Autómata Finito No Determinista del Ejercicio \ref{ej:1.2.6} apartado \ref{ej:1.2.6.1}.}
            \label{fig:ej:1.2.6.1}
        \end{figure}
        \item AFND. Contengan la subcadena $110$. \label{ej:1.2.6.2}
        
        El autómata obtenido es el de la Figura \ref{fig:ej:1.2.6.2}.
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, accepting, right of=q2] (q3) {$q_3$};

                \draw   (q0) edge[above] node{1} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[above] node{0} (q3)
                        (q3) edge[loop above] node{0, 1} (q3)
                        (q0) edge[loop above] node{0, 1} (q0);
            \end{tikzpicture}
            \caption{Autómata Finito No Determinista del Ejercicio \ref{ej:1.2.6} apartado \ref{ej:1.2.6.2}.}
            \label{fig:ej:1.2.6.2}
        \end{figure}
        \item AFD. Contengan simultáneamente las subcadenas $010$ y $110$. \label{ej:1.2.6.3}
        
        El estado $q_0$ representa que no se ha empezado ninguna de las subcadenas, y el estado $q_F$ representa que se han encontrado ambas cadenas.
        Hay dos opciones:
        \begin{description}
            \item[Opción 1] Primero se lee $010$ y luego $110$. Son los siguientes estados:
            \begin{itemize}
                \item $q_0$: Estado inicial, no ha empezado la subcadena $010$.
                \item $q_1$: Se ha leído el $0$ de la subcadena $010$.
                \item $q_2$: Se ha leído la subcadena $01$ de la subcadena $010$.
                \item $q_3$: Se ha leído la subcadena $010$. No ha empezado la subcadena $110$.
                \item $q_4$: Se ha leído el $1$ de la subcadena $110$.
                \item $q_5$: Se ha leído la subcadena $11$ de la subcadena $110$.
                \item $q_F$: Se ha leído la subcadena $110$. Se han leído ambas subcadenas.
            \end{itemize}

            \item[Opción 2] Primero se lee $110$ y luego $010$. Son los siguientes estados:
            \begin{itemize}
                \item $q_0$: Estado inicial, no ha empezado la subcadena $110$.
                \item $q_1'$: Se ha leído el $1$ de la subcadena $110$.
                \item $q_2'$: Se ha leído la subcadena $11$ de la subcadena $110$.
                \item $q_3'$: Se ha leído la subcadena $110$. Se ha leído el $0$ de la subcadena $010$. Notemos que en este caso podemos agruparlo, puesto que el último carácter de la subcadena $110$ es el mismo que el primero de la subcadena $010$.
                \item $q_4'$: Se ha leído la subcadena $01$ de la subcadena $010$.
                \item $q_F$: Se ha leído la subcadena $010$. Se han leído ambas subcadenas.
            \end{itemize}
        \end{description}

        El autómata obtenido es el de la Figura \ref{fig:ej:1.2.6.3}.
        \begin{figure}
            \centering
            \begin{tikzpicture}[node distance=2.2cm]
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, right of=q2] (q3) {$q_3$};
                \node[state, right of=q3] (q4) {$q_4$};
                \node[state, right of=q4] (q5) {$q_5$};
                \node[state, accepting, below right of=q5] (qF) {$q_F$};

                \node[state, below right of=q0] (q1p) {$q_1'$};
                \node[state, right of=q1p] (q2p) {$q_2'$};
                \node[state, right of=q2p] (q3p) {$q_3'$};
                \node[state, right of=q3p, xshift=2.5em] (q4p) {$q_4'$};
                
                % Conexiones directas por arriba
                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[above] node{0} (q3)
                        (q3) edge[above] node{1} (q4)
                        (q4) edge[above] node{1} (q5)
                        (q5) edge[above] node{0} (qF)
                        (qF) edge[loop above] node{0, 1} (qF);
                
                % Conexiones directas por abajo
                \draw   (q0) edge[below] node{1} (q1p)
                        (q1p) edge[below] node{1} (q2p)
                        (q2p) edge[below] node{0} (q3p)
                        (q3p) edge[below] node{1} (q4p)
                        (q4p) edge[below] node{0} (qF);

                % Completamos los de arriba
                \draw   (q1) edge[loop above] node{0} (q1)
                        (q2) edge[left] node{1} (q2p)
                        (q3) edge[loop above] node{0} (q3)
                        (q4) edge[bend left, below] node{0} (q3)
                        (q5) edge[loop above] node{1} (q5);

                % Completamos los de abajo
                \draw   (q1p) edge[left] node{0} (q1)
                        (q2p) edge[loop below] node{1} (q2p)
                        (q3p) edge[loop below] node{0} (q3p)
                        (q4p) edge[bend right, above] node{1} (q2p);
                
            \end{tikzpicture}
            \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.6} apartado \ref{ej:1.2.6.3}.}
            \label{fig:ej:1.2.6.3}
        \end{figure}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.7}
    Construir un AFD que acepte el lenguaje generado por la siguiente gramática:
    \begin{align*}
        S &\to AB, & A &\to aA, & A &\to c, & B &\to bBb, & B &\to b.
    \end{align*}

    El lenguaje generado por la gramática es:
    \begin{align*}
        L = \{a^ncb^{2m+1} \mid n, m \in \bb{N}\cup \{0\}\}.
    \end{align*}

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.7}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1, accepting] (q2) {$q_2$};
            \node[state, below of=q1, error] (E) {$E$};

            \draw   (q0) edge[loop above] node{$a$} (q0)
                    (q0) edge[above] node{$c$} (q1)
                    (q0) edge[above] node{$b$} (E)
                    (q1) edge[left] node{$a,c$} (E)
                    (q1) edge[above, bend right] node{$b$} (q2)
                    (q2) edge[above, bend right] node{$b$} (q1)
                    (q2) edge[above] node{$a,c$} (E)
                    (E) edge[loop below] node{$a,b,c$} (E);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.7}}
        \label{fig:ej:1.2.7}
    \end{figure}

\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.8}
    Construir un AFD que acepte el lenguaje $L \subseteq \{a, b, c\}^*$ de todas las palabras con un número impar de ocurrencias de la subcadena $abc$.

    El autómata tiene los siguientes estados:
    \begin{itemize}
        \item $q_0$: Llevo un número par de ocurrencias de $abc$, y no he empezado la siguiente.
        \item $q_1$: Acabo de empezar una ocurrencia impar de $abc$, llevo solo una $a$.
        \item $q_2$: Estoy en una ocurrencia impar de $abc$, llevo $ab$.
        \item $q_3$: Llevo un número impar de ocurrencias de $abc$, y no he empezado la siguiente.
        \item $q_4$: Acabo de empezar una ocurrencia par de $abc$, llevo solo una $a$.
        \item $q_5$: Estoy en una ocurrencia par de $abc$, llevo $ab$.
    \end{itemize}

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.8}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1] (q2) {$q_2$};
            \node[state, below of=q2, accepting] (q3) {$q_3$};
            \node[state, left of=q3, accepting] (q4) {$q_4$};
            \node[state, left of=q4, accepting] (q5) {$q_5$};

            % Conexiones básicas
            \draw   (q0) edge[above] node{$a$} (q1)
                    (q1) edge[above] node{$b$} (q2)
                    (q2) edge[right] node{$c$} (q3)
                    (q3) edge[below] node{$a$} (q4)
                    (q4) edge[below] node{$b$} (q5)
                    (q5) edge[left] node{$c$} (q0);

            % Completamos
            \draw   (q0) edge[loop above] node{$b,c$} (q0)
                    (q1) edge[loop above] node{$a$} (q1)
                    (q1) edge[above, bend right] node{$c$} (q0)
                    (q2) edge[above, bend right] node{$a$} (q1)
                    (q2) edge[below, bend left] node{$b$} (q0)
                    (q3) edge[loop below] node{$b,c$} (q3)
                    (q4) edge[bend right, below] node{$c$} (q3)
                    (q4) edge[loop below] node{$a$} (q4)
                    (q5) edge[bend right, below] node{$a$} (q4)
                    (q5) edge[bend left, above] node{$b$} (q3);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.8}}
        \label{fig:ej:1.2.8}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.9}
    Sea $L$ el lenguaje de todas las palabras sobre el alfabeto $\{0, 1\}$ que no contienen dos $1$s que estén separados por un número impar de símbolos. Describir un AFD que acepte este lenguaje.

    Sea $u\in L$. Veamos que, a lo sumo, puede tener dos $1$'s. Supongamos por reducción al absurdo que tiene tres $1$'s. Entonces, entre la primera y la segunda hay un número impar de símbolos, y entre la segunda y la tercera hay un número impar de símbolos. Por lo tanto, entre el primer y el tercer $1$ hay:
    \begin{itemize}
        \item Un número par de símbolos antes del segundo $1$.
        \item El segundo $1$.
        \item Un número par de símbolos entre el segundo y el tercer $1$.
    \end{itemize}
    Por tanto, como el número de símbolos entre el primer y el tercer $1$ es impar, entonces $u\notin L$. Por lo tanto, $u$ tiene a lo sumo dos $1$'s.\\

    Por tanto, los estados son:
    \begin{itemize}
        \item $q_0$: No se ha introducido ningún $1$.
        \item $q_{p}$: Se ha introducido un $1$, después de él y antes del siguiente $1$ hay un número par de símbolos.
        \item $q_{i}$: Se ha introducido un $1$, después de él y antes del siguiente $1$ hay un número impar de símbolos.
        \item $q_{2}$: Se han introducido dos $1$'s, y no se ha introducido ningún otro.
        \item $E$: Estado de error.
    \end{itemize}

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.9}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (qp) {$q_p$};
            \node[state, right of=qp, accepting] (qi) {$q_i$};
            \node[state, below of=qp, accepting] (q2) {$q_2$};
            \node[state, below of=qi, error] (E) {$E$};

            \draw   (q0) edge[loop below] node{0} (q0)
                    (q0) edge[above] node{1} (qp)
                    (qp) edge[below, bend right] node{0} (qi)
                    (qp) edge[right] node{1} (q2)
                    (qi) edge[above, bend right] node{0} (qp)
                    (qi) edge[right] node{1} (E)
                    (q2) edge[loop left] node{0} (q2)
                    (q2) edge[above] node{1} (E)
                    (E) edge[loop right] node{0, 1} (E);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.9}.}
        \label{fig:ej:1.2.9}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.10}
    Dada la expresión regular $(a + \varepsilon)b^*$, encontrar un AFND asociado y, a partir de este, calcular un AFD que acepte el lenguaje.

    El AFND con transiciones nulas obtenido (siguiendo el algoritmo) es el de la Figura \ref{fig:ej:1.2.10}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, above right of=q0] (q1) {$q_1$};
            \node[state, below right of=q0] (q2) {$q_2$};
            \node[state, right of=q1] (q3) {$q_3$};
            \node[state, below right of=q3, accepting] (q4) {$q_4$};
            \node[state, right of=q4] (q5) {$q_5$};
            \node[state, right of=q5, accepting] (q6) {$q_6$};

            \draw   (q0) edge[above] node{$\varepsilon$} (q1)
                    (q0) edge[below] node{$\varepsilon$} (q2)
                    (q1) edge[above] node{$a$} (q3)
                    (q2) edge[above, bend right] node{$\veps$} (q4)
                    (q3) edge[above] node{$\varepsilon$} (q4)
                    (q4) edge[above] node{$\varepsilon$} (q5)
                    (q5) edge[above] node{$b$} (q6)
                    (q6) edge[below, bend left] node{$\veps$} (q5);
        \end{tikzpicture}
        \caption{Autómata Finito No Determinista algorítmico del Ejercicio \ref{ej:1.2.10}.}
        \label{fig:ej:1.2.10}
    \end{figure}

    Podemos simplificar este autómata para que así la transición al AFD sea más sencilla. El autómata simplificado es el de la Figura \ref{fig:ej:1.2.10.simplified}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q6) {$q_6$};

            \draw   (q0) edge[above] node{$a, \veps$} (q6)
                    (q6) edge[loop above] node{$b$} (q6);
        \end{tikzpicture}
        \caption{Autómata Finito No Determinista simplificado del Ejercicio \ref{ej:1.2.10}.}
        \label{fig:ej:1.2.10.simplified}
    \end{figure}

    A partir de este autómata simplificado, obtenemos el AFD de la Figura \ref{fig:ej:1.2.10.afd}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0q6) {$\{q_0, q_6\}$};
            \node[state, right of=q0q6, accepting] (q6) {$q_6$};
            \node[state, right of=q6, error] (E) {$E$};

            \draw   (q0q6) edge[above] node{$a,b$} (q6)
                    (q6) edge[loop above] node{$b$} (q6)
                    (q6) edge[above] node{$a$} (E)
                    (E) edge[loop above] node{$a,b$} (E);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.10}.}
        \label{fig:ej:1.2.10.afd}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.11}
    Obtener una expresión regular para el lenguaje complementario al aceptado por la gramática
    \begin{align*}
        S &\to abA \mid B \mid baB \mid \varepsilon, & A &\to bS \mid b, & B &\to aS.
    \end{align*}
    \begin{observacion}
        Construir un AFD asociado.
    \end{observacion}
    % // TODO: Hecho en clase. Comparar JJ

    Esta gramática es lineal por la derecha. Algorítmicamente, obtenemos el autómata de la Figura \ref{fig:ej:1.2.11_L} para el lenguaje generado por $S$, $\cc{L}(S)$.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            % Estados: abA, bA, A, B, baB, aB, B, veps, bS, S, b, aS, S
            \node[state, initial] (S) {$[S]$};
            \node[state, right of=S] (abA) {$[abA]$};
            \node[state, right of=abA] (bA) {$[bA]$};
            \node[state, right of=bA] (A) {$[A]$};
            \node[state, below of=abA] (B) {$[B]$};
            \node[state, below of=B] (baB) {$[baB]$};
            \node[state, right of=baB] (aB) {$[aB]$};
            \node[state, above of=S, accepting] (veps) {$[\varepsilon]$};
            \node[state, below of=A] (bS) {$[bS]$};
            \node[state, right of=A] (b) {$[b]$};
            \node[state, right of=B] (aS) {$[aS]$};

            \draw   (S) edge[above] node{$\veps$} (abA)
                    (abA) edge[above] node{$a$} (bA)
                    (bA) edge[above] node{$b$} (A)
                    (S) edge[above] node{$\veps$} (B)
                    (S) edge[below] node{$\veps$} (baB)
                    (baB) edge[above] node{$b$} (aB)
                    (aB) edge[above] node{$a$} (B)
                    (S) edge[left] node{$\veps$} (veps)
                    (A) edge[left] node{$\veps$} (bS)
                    (A) edge[below] node{$\veps$} (b)
                    (b) edge[above] node{$b$} (veps)
                    (bS) edge[above] node{$b$} (S)
                    (B) edge[above] node{$\veps$} (aS)
                    (aS) edge[below] node{$a$} (S);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del lenguaje $\cc{L}(S)$ del Ejercicio \ref{ej:1.2.11}.}
        \label{fig:ej:1.2.11_L}
    \end{figure}

    Ahora, tendríamos que eliminar las transiciones nulas para poder así aplicar el algoritmo para hallar la expresión regular. Esto no es sencillo, por lo que vamos a intentar obtener de forma directa el AFD. Para ello, la gramática dada genera el mismo lenguaje que las siguientes reglas de producción, donde hemos eliminado la variable $B$:
    \begin{align*}
        S &\to abA \mid aS \mid baaS \mid \varepsilon, & A &\to bS \mid b
    \end{align*}

    Eliminamos ahora la variable $A$:
    \begin{align*}
        S &\to abbS \mid abb \mid aS \mid baaS \mid \varepsilon
    \end{align*}

    Veamos ahora que la regla $S \to abb$ no es relevante, ya que podemos obtenerla a partir de $S \to abbS$ y $S \to \varepsilon$. Por tanto, la gramática dada inicialmente genera el mismo lenguaje que si estas fuesen las reglas de producción:
    \begin{align*}
        S &\to abbS \mid aS \mid baaS \mid \varepsilon
    \end{align*}

    Por tanto, vemos que:
    \begin{equation*}
        \cc{L}(G)=\{abb, a, baa\}^*.
    \end{equation*}

    En consecuencia, la expresión regular asociada a $\cc{L}(G)$ es:
    \begin{equation*}
        (abb + a + baa)^*
    \end{equation*}

    El AFD asociado a esta expresión regular es el de la Figura \ref{fig:ej:1.2.11_L_exp}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0) {$q_0$};
            \node[state, below right of=q0] (q2) {$q_{2}$};
            \node[state, above right of=q2] (q1) {$q_1$};
            \node[state, left of=q2, error] (E) {$E$};

            \draw   (q0) edge[loop above] node{$a$} (q0)
                    (q0) edge[above] node{$b$} (q1)
                    (q1) edge[above, bend right] node{$b$} (q0)
                    (q1) edge[below] node{$a$} (q2)
                    (q2) edge[below] node{$a$} (q0)
                    (q2) edge[above] node{$b$} (E)
                    (E) edge[loop left] node{$a,b$} (E);

        \end{tikzpicture}
        \caption{Autómata Finito Determinista del lenguaje $\cc{L}(G)$ del Ejercicio \ref{ej:1.2.11}.}
        \label{fig:ej:1.2.11_L_exp}
    \end{figure}

    Por tanto, el autómata finito determinista asociado al lenguaje complementario de $\cc{L}(G)$ es el de la Figura \ref{fig:ej:1.2.11_L_comp}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, below right of=q0, accepting] (q2) {$q_{2}$};
            \node[state, above right of=q2, accepting] (q1) {$q_1$};
            \node[state, left of=q2, error, accepting] (E) {$E$};

            \draw   (q0) edge[loop above] node{$a$} (q0)
                    (q0) edge[above] node{$b$} (q1)
                    (q1) edge[above, bend right] node{$b$} (q0)
                    (q1) edge[below] node{$a$} (q2)
                    (q2) edge[below] node{$a$} (q0)
                    (q2) edge[above] node{$b$} (E)
                    (E) edge[loop left] node{$a,b$} (E);

        \end{tikzpicture}
        \caption{Autómata Finito Determinista del lenguaje $\ol{\cc{L}(G)}$ del Ejercicio \ref{ej:1.2.11}.}
        \label{fig:ej:1.2.11_L_comp}
    \end{figure}

    Buscamos ahora una expresión para $\ol{\cc{L}(G)}$. Resolvemos el siguiente sistema:
    \begin{equation*}
        \begin{cases}
            q_0 &= aq_0 + bq_1\\
            q_1 &= bq_0 + aq_2 + \varepsilon\\
            q_2 &= aq_0 + bq_E + \varepsilon\\
            q_E &= aq_E + bq_E + \varepsilon
        \end{cases}
    \end{equation*}

    De la última ecuación, obtenemos que $q_E = (a+b)^*$. El sistema queda:
    \begin{equation*}
        \begin{cases}
            q_0 &= aq_0 + bq_1\\
            q_1 &= bq_0 + aq_2 + \varepsilon\\
            q_2 &= aq_0 + b(a+b)^* + \varepsilon\\
        \end{cases}
    \end{equation*}

    Sustituyendo $q_2$, obtenemos:
    \begin{equation*}
        \begin{cases}
            q_0 &= aq_0 + bq_1\\
            q_1 &= bq_0 + a(aq_0 + b(a+b)^* + \varepsilon) + \varepsilon\\
        \end{cases}
    \end{equation*}

    Tenemos que:
    \begin{equation*}
        q_1 = (b+aa)q_0 +ab(a+b)^* + a + \varepsilon
    \end{equation*}

    Sustituyendo, tenemos que:
    \begin{align*}
        q_0 &= aq_0 + b\left[(b+aa)q_0 +ab(a+b)^* + a + \varepsilon\right]
        =\\&= (a+b(b+aa))q_0 + bab(a+b)^* + ba + b
        \AstIg\\&\AstIg (a+b(b+aa))^*(bab(a+b)^* + ba + b)
    \end{align*}
    donde en $(\ast)$ hemos aplicado el Lema de Arden.
    Por tanto, la expresión regular asociada a $\ol{\cc{L}(G)}$ es:
    \begin{equation*}
        (a+b(b+aa))^*(bab(a+b)^* + ba + b)
    \end{equation*}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.12}
    Dar expresiones regulares para los lenguajes sobre el alfabeto $\{a, b\}$ dados por las siguientes condiciones:
    \begin{enumerate}
        \item Palabras que no contienen la subcadena $a$,
        \begin{equation*}
            b^*
        \end{equation*}
        \item Palabras que no contienen la subcadena $ab$.
        \begin{equation*}
            b^*a^*
        \end{equation*}
        \item \label{ej:1.2.12_3} % // TODO: Comprobar JJ
        Palabras que no contienen la subcadena $aba$.
        
        Este lenguaje viene descrito por el autómata de la Figura \ref{fig:ej:1.2.12_3}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0, accepting] (q1) {$q_1$};
                \node[state, right of=q1, accepting] (q2) {$q_2$};
                \node[state, right of=q2, error] (q3) {$E$};

                \draw   (q0) edge[above] node{$a$} (q1)
                        (q1) edge[above] node{$b$} (q2)
                        (q2) edge[above] node{$a$} (q3)
                        (q0) edge[loop above] node{$b$} (q0)
                        (q1) edge[loop above] node{$a$} (q1)
                        (q2) edge[below, bend left] node{$b$} (q0)
                        (q3) edge[loop above] node{$a,b$} (q3);
            \end{tikzpicture}
            \caption{AFD del lenguaje del Ejercicio \ref{ej:1.2.12} apartado \ref{ej:1.2.12_3}.}
            \label{fig:ej:1.2.12_3}
        \end{figure}

        Obtenemos la expresión regular asociada al lenguaje del autómata de la Figura \ref{fig:ej:1.2.12_3}.
        \begin{equation*}
            \begin{cases}
                q_0 &= bq_0 + aq_1 + \varepsilon\\
                q_1 &= aq_1 + bq_2 + \varepsilon\\
                q_2 &= bq_0 + aE + \varepsilon\\
                E &= aE + bE
            \end{cases}
        \end{equation*}

        Usando el Lema de Arden, obtenemos que $E=(a+b)^*$. Sustituyendo, obtenemos:
        \begin{equation*}
            \begin{cases}
                q_0 &= bq_0 + aq_1 + \varepsilon\\
                q_1 &= aq_1 + bq_2 + \varepsilon\\
                q_2 &= bq_0 + a(a+b)^* + \varepsilon\\
            \end{cases}
        \end{equation*}

        Sustituyendo $q_2$, obtenemos:
        \begin{equation*}
            \begin{cases}
                q_0 &= bq_0 + aq_1 + \varepsilon\\
                q_1 &= aq_1 + b(bq_0 + a(a+b)^* + \varepsilon) + \varepsilon\\
            \end{cases}
        \end{equation*}

        Usando el Lema de Arden, obtenemos que:
        \begin{equation*}
            q_1 = a^*[b(bq_0 + a(a+b)^* + \varepsilon) + \varepsilon]
        \end{equation*}

        Sustituyendo en la primera ecuación, tenemos que:
        \begin{align*}
            q_0 &= bq_0 +aa^*[b(bq_0 + a(a+b)^* + \varepsilon) + \varepsilon] + \veps=\\
            &= bq_0 + aa^*[bbq_0 + ba(a+b)^* + b + \varepsilon] + \veps =\\
            &= (b+aa^*bb)q_0 + aa^*[ba(a+b)^* + b + \varepsilon] + \veps \AstIg\\
            &\AstIg (b+aa^*bb)^*[aa^*(ba(a+b)^* + b + \varepsilon)+\varepsilon]
        \end{align*}
        donde en $(\ast)$ hemos aplicado el Lema de Arden.
        Por tanto, la expresión regular asociada al lenguaje del autómata de la Figura \ref{fig:ej:1.2.12_3} es:
        \begin{equation*}
            (b+aa^*bb)^*[aa^*(ba(a+b)^* + b + \varepsilon)+\varepsilon]
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Determinar si el lenguaje generado por la siguiente gramática es regular:
    \begin{align*}
        S &\to AabB, & A &\to aA \mid bA \mid \varepsilon, & B &\to Bab \mid Bb \mid ab \mid b.
    \end{align*}
    En caso de que lo sea, encontrar una expresión regular asociada.\\

    Es directo ver que el lenguaje generado por la gramática tiene como expresión regular asociada:
    \begin{align*}
        (a+b)^*ab(ab+b)^+.
    \end{align*}

    Por tanto, el lenguaje es regular.
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.14}
    Sobre el alfabeto $A = \{0, 1\}$ realizar las siguientes tareas:
    \begin{enumerate}
        \item \label{ej:1.2.14.1}
        Describir un autómata finito determinista que acepte todas las palabras que contengan a $011$ o a $010$ (o las dos) como subcadenas.
        
        Tenemos los siguientes estados:
        \begin{itemize}
            \item \ul{$q_0$}: No se ha empezado ninguna subcadena.
            \item \ul{$q_1$}: Se ha empezado una subcadena deseada. Tengo el carácter $0$.
            \item \ul{$q_2$}: Se continúa la subcadena deseada. Tengo los caracteres $01$.
            \item \ul{$q_3$}: Se ha encontrado la subcadena deseada. Tengo los caracteres $011$ o $010$.
        \end{itemize}

        El autómata obtenido es el de la Figura \ref{fig:ej:1.2.14.1}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};
                \node[state, right of=q1] (q2) {$q_2$};
                \node[state, accepting, right of=q2] (q3) {$q_3$};

                \draw   (q0) edge[above] node{0} (q1)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[above] node{0,1} (q3)
                        (q1) edge[loop above] node{0} (q1)
                        (q0) edge[loop above] node{1} (q0)
                        (q3) edge[loop above] node{0,1} (q3);
            \end{tikzpicture}
            \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.14} apartado \ref{ej:1.2.14.1}.}
            \label{fig:ej:1.2.14.1}
        \end{figure}
        
        \item \label{ej:1.2.14.2}
        Describir un autómata finito determinista que acepte todas las palabras que empiecen o terminen (o ambas cosas) por $01$.
        
        Tenemos los siguientes estados:
        \begin{itemize}
            \item \ul{$q_0$}: No hemos leído nada.
            \item \ul{$q_1$}: Hemos empezado con un $0$, por lo que puede comenzar por $01$ (o terminar por $01$).
            \item \ul{$q_2$}: Hemos empezado con $01$, por lo que ya no hay más restricciones.
            \item \ul{$q_3$}: No hemos empezado por $01$, por lo que ha de terminar por $01$.
            \item \ul{$q_4$}: Ha de terminar por $01$, y estamos en $0$, por lo que si introduce un $1$ puede terminar.
            \item \ul{$q_5$}: Ha de terminar por $01$, y acabamos de leer $01$, por lo que podemos terminar.
        \end{itemize}

        El autómata obtenido es el de la Figura \ref{fig:ej:1.2.14.2}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \node[state, initial] (q0) {$q_0$};
                \node[state, above right of=q0] (q1) {$q_1$};
                \node[state, right of=q1, accepting] (q2) {$q_2$};
                \node[state, below right of=q0] (q3) {$q_3$};
                \node[state, right  of=q3] (q4) {$q_4$};
                \node[state, accepting, right of=q4] (q5) {$q_5$};

                % Uniones directas
                \draw   (q0) edge[above] node{0} (q1)
                        (q0) edge[above] node{1} (q3)
                        (q1) edge[above] node{1} (q2)
                        (q2) edge[loop above] node{0,1} (q2)
                        (q3) edge[above] node{0} (q4)
                        (q4) edge[above] node{1} (q5);
                
                % Completamos autómata
                \draw   (q1) edge[left] node{0} (q4)
                        (q3) edge[loop below] node{1} (q3)
                        (q4) edge[loop above] node{0} (q4)
                        (q5) edge[above, bend right] node{0} (q4)
                        (q5) edge[below, bend left] node{1} (q3);
            \end{tikzpicture}
            \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.14} apartado \ref{ej:1.2.14.2}.}
            \label{fig:ej:1.2.14.2}
        \end{figure}

        \item Dar una expresión regular para el conjunto de las palabras en las que hay dos ceros separados por un número de símbolos que es múltiplo de $4$ (los símbolos que separan los ceros pueden ser ceros y puede haber otros símbolos delante o detrás de estos dos ceros).
        \begin{equation*}
            (0+1)^*\red{0}\left((0+1)(0+1)(0+1)(0+1)\right)^*\red{0}(0+1)^*
        \end{equation*}
        Notemos que los dos $0$'s en cuestión están marcados en rojo para facilitar la comprensión.
        \item Dar una expresión regular para las palabras en las que el número de ceros es divisible por $4$.
        
        En un primer momento, podríamos pensar en:
        \begin{equation*}
            (1^*01^*01^*01^*01^*)^*
        \end{equation*}
        No obstante, una palabra con $1$'s y sin $0$'s, que es aceptada por el lenguaje, no está contemplada en la expresión regular. La expresión regular correcta es:
        \begin{equation*}
            (1^*01^*01^*01^*0)^*1^*
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Construye una gramática regular que genere el siguiente lenguaje:
    \begin{align*}
        L_1 = \{u \in \{0, 1\}^* \mid \text{el número de $1$'s y de $0$'s es impar}\}.
    \end{align*}

    Tenemos los siguientes estados:
    \begin{itemize}
        \item \ul{$E_{01}$}: Tenemos un error en $0$ y $1$, ya que el número de $0$'s y de $1$'s es par.
        \item \ul{$E_0$}: Tenemos un error en $0$, ya que el número de $0$'s es par. El número de $1$'s es impar.
        \item \ul{$E_1$}: Tenemos un error en $1$, ya que el número de $1$'s es par. El número de $0$'s es impar.
        \item \ul{$X$}: No tenemos errores. El número de $0$'s y de $1$'s es impar.
    \end{itemize}

    La gramática obtenida es $G=(\{E_{01},E_0,E_1,X\}, \{0, 1\}, P, E_{01})$, donde $P$ es:
    \begin{align*}
        E_{01} &\to 0E_1 \mid 1E_0, \\
        E_0 &\to 0X \mid 1E_{01}, \\
        E_1 &\to 0E_{01} \mid 1X, \\
        X &\to 0E_0 \mid 1E_1 \mid \veps
    \end{align*}

\end{ejercicio}

\begin{ejercicio}
    Encuentra una expresión regular que represente el siguiente lenguaje:
    \begin{align*}
        L_2 = \{0^n1^m \mid n \geq 1, m \geq 0, n \text{ múltiplo de } 3 \text{ y } m \text{ es par}\}.
    \end{align*}

    La expresión regular es:
    \begin{align*}
        (000)^+(11)^*
    \end{align*}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.17}
    Diseña un autómata finito determinista que reconozca el siguiente lenguaje:
    \begin{align*}
        L_3 = \{u \in \{0, 1\}^* \mid \text{el número de $1$'s no es múltiplo de } 3 \text{ y el número de $0$'s es par}\}.
    \end{align*}

    Sean $n_0$ el número de $0$'s y $n_1$ el número de $1$'s.

    Tenemos la siguiente disposición de estados:
    \begin{itemize}
        \item Los estados de arriba representan $n_0 \text{ mod } 2 = 0$.
        \item Los estados de abajo representan $n_0 \text{ mod } 2 = 1$.
        \item Los estados de la primera columna representan $n_1 \text{ mod } 3 = 0$.
        \item Los estados de la segunda columna representan $n_1 \text{ mod } 3 = 1$.
        \item Los estados de la tercera columna representan $n_1 \text{ mod } 3 = 2$.
    \end{itemize}

    El estado $q_{ij}$ representa $n_0 \text{ mod } 2 = i$ y $n_1 \text{ mod } 3 = j$.
    
    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.17}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q00) {$q_{00}$};
            \node[state, right of=q00, accepting] (q01) {$q_{01}$};
            \node[state, right of=q01, accepting] (q02) {$q_{02}$};
            \node[state, below of=q00] (q10) {$q_{10}$};
            \node[state, right of=q10] (q11) {$q_{11}$};
            \node[state, right of=q11] (q12) {$q_{12}$};

            \draw   (q00) edge[above] node{1} (q01)
                    (q01) edge[above] node{1} (q02)
                    (q02) edge[above, bend right] node{1} (q00)
                    (q10) edge[above] node{1} (q11)
                    (q11) edge[above] node{1} (q12)
                    (q12) edge[below, bend left] node{1} (q10)
                    (q00) edge[left] node{0} (q10)
                    (q10) edge[right, bend right] node{0} (q00)
                    (q01) edge[left] node{0} (q11)
                    (q11) edge[right, bend right] node{0} (q01)
                    (q02) edge[left] node{0} (q12)
                    (q12) edge[right, bend right] node{0} (q02);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.17}}
        \label{fig:ej:1.2.17}
    \end{figure}
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.18}
    Dar una expresión regular para el lenguaje aceptado por el autómata de la Figura \ref{fig:ej:1.2.18}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0) {$q_0$};
            \node[state, accepting, below right of=q0] (q2) {$q_2$};
            \node[state, above right of=q2] (q1) {$q_1$};

            \draw   (q1) edge[loop above] node{$a$} (q1)
                    (q0) edge[above] node{$a,b$} (q1)
                    (q1) edge[below, bend left] node{$b$} (q2)
                    (q2) edge[below, bend left] node{$b$} (q1)
                    (q2) edge[above] node{$a$} (q0);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.18}}
        \label{fig:ej:1.2.18}
    \end{figure}

    Establecemos una ecuación por cada uno de los estados. El sistema inicial es:
    \begin{equation*}
        \begin{cases}
            q_0 = \veps + aq_1 + bq_1, \\
            q_1 = aq_1 + bq_2, \\
            q_2 = \veps + aq_0 + bq_1.
        \end{cases}
    \end{equation*}

    Buscamos obtener la expresión regular asociada a $q_1$:
    \begin{align*}
        q_1 &= aq_1 + b + baq_0 +bbq_1=\\
        &= baq_0 + b + (a+bb)q_1\AstIg\\
        &\AstIg (a+bb)^*(baq_0 + b)
    \end{align*}
    donde en $(\ast)$ hemos aplicado el Lema de Arden. Sustituyendo en la ecuación de $q_0$ obtenemos:
    \begin{align*}
        q_0 &= \veps + (a+b)q_1 =\\
        &= \veps + (a+b)(a+bb)^*(baq_0 + b) =\\
        &= \veps + (a+b)(a+bb)^*b + (a+b)(a+bb)^*baq_0 \AstIg\\
        &\AstIg ((a+b)(a+bb)^*ba)^*(\veps + (a+b)(a+bb)^*b)
    \end{align*}
    donde, de nuevo, en $(\ast)$ hemos aplicado el Lema de Arden. Por tanto, la expresión regular asociada al autómata es:
    \begin{align*}
        ((a+b)(a+bb)^*ba)^*(\veps + (a+b)(a+bb)^*b).
    \end{align*}
\end{ejercicio}


\begin{ejercicio} \label{ej:1.2.19}
    Dado el lenguaje
    \begin{align*}
        L = \{u110 \mid u \in \{1, 0\}^*\},
    \end{align*}
    encontrar la expresión regular, la gramática lineal por la derecha, la gramática lineal por la izquierda y el AFD asociado.

    La expresión regular es:
    \begin{align*}
        (0+1)^*110.
    \end{align*}

    La gramática lineal por la derecha es $G=(\{S,A\}, \{0, 1\}, P, S)$, donde $P$ es:
    \begin{align*}
        S &\to 0S \mid 1S \mid A\\
        A &\to 110.
    \end{align*}

    La gramática lineal por la izquierda es $G=(\{S,A\}, \{0, 1\}, P', S)$, donde $P'$ es:
    \begin{align*}
        S &\to X110\\
        X &\to X0 \mid X1 \mid \varepsilon.
    \end{align*}

    El AFD asociado es el de la Figura \ref{fig:ej:1.2.19}. Sus estados son:
    \begin{itemize}
        \item \ul{$q_0$}: No estoy en la cadena $110$ final.
        \item \ul{$q_1$}: He leído un $1$ de la cadena final.
        \item \ul{$q_2$}: He leído un $11$ de la cadena final.
        \item \ul{$q_3$}: He leído un $110$ de la cadena final.
    \end{itemize}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial] (q0) {$q_0$};
            \node[state, right of=q0] (q1) {$q_1$};
            \node[state, right of=q1] (q2) {$q_2$};
            \node[state, accepting, right of=q2] (q3) {$q_3$};

            \draw   (q0) edge[below] node{1} (q1)
                    (q1) edge[below] node{1} (q2)
                    (q2) edge[below] node{0} (q3)
                    (q0) edge[loop above] node{0} (q0)
                    (q1) edge[above, bend right] node{0} (q0)
                    (q2) edge[loop above] node{1} (q2)
                    (q3) edge[above, bend left] node{0,1} (q0);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.19}}
        \label{fig:ej:1.2.19}
    \end{figure}
\end{ejercicio}

\begin{ejercicio}
    Dado un AFD, determinar el proceso que habría que seguir para construir una gramática lineal por la izquierda capaz de generar el Lenguaje aceptado por dicho autómata.\\

    Sea $M=(Q, A, \delta, q_0, F)$ un AFD. Como $Q$ es finito, podemos enumerar los estados como $Q=\{q_1, q_2, \ldots, q_n\}$.    
    La Gramática Lineal por la Izquierda asociada es $G=(Q\cup \{S\}, A, P, S)$, donde hemos supuesto $S\notin Q$ debido a nuestra enumeración de los estados. Las reglas de producción son:
    \begin{equation*}
        P=\left\{
            \begin{array}{rcll}
                S &\to& q_i &\qquad \forall q_i\in F\\
                q_i &\to& q_j a &\qquad \forall q_i,q_j\in Q, a\in A \mid \delta(q_j, a)=q_i \\
                q_0 &\to& \veps.
            \end{array}
        \right.
    \end{equation*}
    Notemos que lo que hacemos es invertir el autómata, obtener la gramática lineal por la derecha, y después invertir las reglas de producción de esta última.
\end{ejercicio}

\begin{ejercicio} \label{ej:1.2.21}
    Construir un autómata finito determinista que acepte el lenguaje de todas las palabras sobre el alfabeto $\{0, 1\}$ que no contengan la subcadena $001$.
    Construir una gramática regular por la izquierda a partir de dicho autómata.\\

    Los estados son los siguientes:
    \begin{itemize}
        \item \ul{$q_0$}: No se ha empezado la subcadena $001$
        \item \ul{$q_1$}: Se ha leído un $0$ de la subcadena $001$.
        \item \ul{$q_2$}: Se ha leído un $00$ de la subcadena $001$.
        \item \ul{$E$}: Se ha leído la subcadena $001$, por lo que es el estado de error.
    \end{itemize}

    El autómata obtenido es el de la Figura \ref{fig:ej:1.2.21}.
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \node[state, initial, accepting] (q0) {$q_0$};
            \node[state, right of=q0, accepting] (q1) {$q_1$};
            \node[state, right of=q1, accepting] (q2) {$q_2$};
            \node[state, error, right of=q2] (E) {$E$};

            \draw   (q0) edge[below] node{0} (q1)
                    (q0) edge[loop above] node{1} (q0)
                    (q1) edge[below] node{0} (q2)
                    (q1) edge[above, bend right] node{1} (q0)
                    (q2) edge[loop above] node{0} (q0)
                    (q2) edge[below] node{1} (E)
                    (E) edge[loop above] node{0,1} (E);
        \end{tikzpicture}
        \caption{Autómata Finito Determinista del Ejercicio \ref{ej:1.2.21}}
        \label{fig:ej:1.2.21}
    \end{figure}
    
    Respecto a la gramática regular por la izquierda, usando el algoritmo descrito en el apartado anterior, tenemos que la gramática es $G=(Q\cup \{S\}, \{0, 1\}, P, S)$, donde $P$ es:
    \begin{align*}
        P=\left\{
            \begin{array}{rcll}
                S &\to& q_0 \mid q_1 \mid q_2,\\
                q_0 &\to& q_0 1 \mid q_1 1 \red{\mid \veps}\\
                q_1 &\to& q_0 0,\\
                q_2 &\to& q_1 0 \mid q_2 0,\\
                E &\to& E0 \mid E1 \mid q_2 1,
            \end{array}
        \right.
    \end{align*}

    % // TODO: Revisar JJ
\end{ejercicio}

\begin{ejercicio}
    Sea $B_n = \{a^k \mid k \text{ es múltiplo de } n\}$. Demostrar que $B_n$ es regular para todo $n$.\\

    Fijado $n\in \bb{N}$, la expresión regular correspondiente es:
    \begin{align*}
        (a\overbrace{\cdots }^{n \text{ veces}}a)^* = (a^n)^*
    \end{align*}

    Equivalentemente, usando la notación de las expresiones regulares de UNIX, la expresión regular sería:
    \begin{equation*}
        (a\{n\})^*
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Sea $A$ un alfabeto. Decimos que $u\in A^*$ es un prefijo de $v\in A^*$ si existe $w\in A^*$ tal que $uw = v$. Decimos que $u$ es un prefijo propio de $v$ si además $u \neq v$ y $u \neq \varepsilon$. Demostrar que si $L$ es regular, también lo son los lenguajes siguientes:
    \begin{enumerate}
        \item $\text{NOPREFIJO}(L) = \{u \in L \mid \text{ningún prefijo propio de } u \text{ pertenece a } L\}$,
        
        Como $L$ es regular, existe un AFD $M=(Q, A, \delta, q_0, F)$ tal que $L=\cc{L}(M)$. Construimos un AFD $M'=(Q\cup \{E\}, A, \delta', q_0, F)$,
        donde $E$ es un estado de error ($E\notin Q$) y $\delta'$ es:
        \begin{equation*}
            \begin{cases}
                \delta'(q, a) = \delta(q, a)&\qquad \forall q\in Q\setminus F, a\in A\\
                \delta'(q, a) = E&\qquad \forall q\in F, a\in A\\
                \delta'(E, a) = E&\qquad \forall a\in A
            \end{cases}
        \end{equation*}

        Demostramos mediante doble inclusión que $\text{NOPREFIJO}(L)=\cc{L}(M')$.
        \begin{description}
            \item[$\subseteq)$] Sea $u\in \text{NOPREFIJO}(L)$. Entonces, por definición de $\text{NOPREFIJO}(L)$, $u\in L$. Por tanto, $\exists q\in F$ tal que $\delta^{\ast}(q_0, u)=q$. Para ver que $u\in \cc{L}(M')$, basta ver que $(\delta')^{\ast}(q_0, u)\in F$.

            Como $u$ no tiene prefijos propios en $L$, entonces $\delta^{\ast}(q_0, u')\notin F$ para todo prefijo propio $u'$ de $u$; es decir, en los pasos de cálculo desde $q_0$ hasta $\delta^{\ast}(q_0, u)$ no se pasa por ningún estado final. Por tanto, como en esos casos $\delta'=\delta$, entonces $\delta^{\ast}(q_0, u)=q\in F$, por lo que $u\in \cc{L}(M')$.

            \item[$\supseteq)$] Sea $u\in \cc{L}(M')$. En primer lugar, tenemos que $(\delta')^{\ast}(q_0, u)\in F$. Veamos ahora que los pasos de cálculo desde $q_0$ hasta $(\delta')^{\ast}(q_0, u)$ leyendo $u$ no son ninguno finales.
            
            Si alguno de ellos fuese final (si $u$ tuviese algún prefijo propio $v\in L$), entonces desde él pasaríamos a $E$, y de este estado no final no saldríamos, llegando a contradicción. Por tanto, $u$ no tiene prefijos propios pertenecientes a $L$. Además, como en estos casos $\delta'=\delta$, tenemos que $\delta^{\ast}(q_0, u)\in F$, luego $u\in L$. De esta forma, $u\in \text{NOPREFIJO}(L)$.
        \end{description}
        
        \item $\text{NOEXTENSION}(L) = \{u \in L \mid u \text{ no es un prefijo propio de ninguna palabra de } L\}$.
        
        Como $L$ es regular, existe un AFD $M=(Q, A, \delta, q_0, F)$ tal que $L=\cc{L}(M)$. Construimos un AFD $M'=(Q, A, \delta, q_0, F')$, donde:
        \begin{equation*}
            F'=\{q\in F\mid \delta^{\ast}(q,u)\notin F,\forall u\in A^*\}
        \end{equation*}

        Demostramos mediante doble inclusión que $\text{NOEXTENSION}(L)=\cc{L}(M')$.
        \begin{description}
            \item[$\subseteq)$] Sea $u\in \text{NOEXTENSION}(L)$. Entonces, por definición de $\text{NOEXTENSION}(L)$, $u\in L$. Por tanto, $\exists q\in F$ tal que $\delta^{\ast}(q_0, u)=q$. Para ver que $u\in \cc{L}(M')$, basta ver que $q\in F'$. 
            
            Supongamos por reducción al absurdo $q\notin F'$. Entonces, $\exists v\in A^*$ tal que $\delta^{\ast}(q, v)\in F$. Pero entonces, $\delta^{\ast}(q_0, uv)=\delta^{\ast}(\delta^{\ast}(q_0, u), v)=\delta^{\ast}(q, v)\in F$, por lo que $uv\in L$ y, por tanto, $u$ es prefijo propio de $uv$, lo cual es una contradicción. Por tanto, $q\in F'$ y, por tanto, $u\in \cc{L}(M')$.

            \item[$\supseteq)$] Sea $u\in \cc{L}(M')$. En primer lugar, tenemos que $\delta^{\ast}(q_0, u)=q\in F'\subset F$, luego $u\in L$. Veamos ahora que $u$ no es prefijo propio de ninguna palabra de $L$.
            
            Supongamos por reducción al absurdo que $u$ es prefijo propio de alguna palabra de $L$. Entonces, $\exists v\in A^*\setminus \{\veps\}$ tal que $uv\in L$. Por tanto, $\delta^{\ast}(q_0, uv)\in F$. Pero entonces, $\delta^{\ast}(q_0, uv)=\delta^{\ast}(\delta^{\ast}(q_0, u), v)=\delta^{\ast}(q, v)\in F$.
            No obstante, hemos demostrado entonces que $q\notin F'$, lo cual es una contradicción. Por tanto, $u$ no es prefijo propio de ninguna palabra de $L$ y, por tanto, $u\in \text{NOEXTENSION}(L)$.
        \end{description}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Si $L \subseteq A^*$, define la relación $\equiv$ en $A^*$ como sigue: si $u, v \in A^*$, entonces $u \equiv v$ si y solo si para toda $z \in A^*$, tenemos que $(uz \in L \Leftrightarrow vz \in L)$.
    \begin{enumerate}
        \item Demostrar que $\equiv$ es una relación de equivalencia.
        
        Veamos las tres propiedades de las relaciones de equivalencia:
        \begin{itemize}
            \item \ul{Reflexiva}: Sea $u\in A^*$. Entonces, para todo $z\in A^*$, tenemos trivialmente que $(uz\in L\Leftrightarrow uz\in L)$. Por tanto, $u\equiv u$.
            \item \ul{Simétrica}: Sean $u,v\in A^*$ tales que $u\equiv v$. Entonces, para todo $z\in A^*$, tenemos que $(uz\in L\Leftrightarrow vz\in L)$. Por tanto, para todo $z\in A^*$, tenemos que $(vz\in L\Leftrightarrow uz\in L)$, lo cual implica que $v\equiv u$.
            \item \ul{Transitiva}: Sean $u,v,w\in A^*$ tales que $u\equiv v$ y $v\equiv w$. Entonces, para todo $z\in A^*$, tenemos que $(uz\in L\Leftrightarrow vz\in L)$ y $(vz\in L\Leftrightarrow wz\in L)$. Por tanto, para todo $z\in A^*$, tenemos que $(uz\in L\Leftrightarrow wz\in L)$, lo cual implica que $u\equiv w$.
        \end{itemize}
        Tenemos por tanto que $\equiv$ es una relación de equivalencia.

        \item Calcular las clases de equivalencia de $L = \{a^ib^i \mid i \geq 0\}$.
        
        En este caso, $A=\{a,b\}$.
        La primera clase de equivalencia que encontramos es las palabras que, le añadamos al final lo que le añadamos, no pertenecen al lenguaje. Es decir:
        \begin{equation*}
            [u\in A^* \mid \text{en $u$ hay una $a$ después de una $b$} \lor u=a^ib^j,\quad j>i]
        \end{equation*}

        Además, para cada $k\in \bb{N}\cup \{0\}$, tenemos:
        \begin{equation*}
            [a_k] = \{a^{k+i}b^i\mid i\in \bb{N}\cup \{0\}\}
        \end{equation*}

        \item Calcular las clases de equivalencia de $L = \{a^ib^j \mid i, j \geq 0\}$.
        
        \begin{comment}
        En este caso, $A=\{a,b\}$.
        La primera clase de equivalencia que encontramos es las palabras que, le añadamos lo que le añadamos, no pertenecen al lenguaje. Es decir:
        \begin{equation*}
            [u\in A^* \mid \text{en $u$ hay una $a$ después de una $b$}]
        \end{equation*}

        \begin{align*}
            [a] &= \{a^i\mid i\in \bb{N}\cup \{0\}\}\\
            [ab] &= \{a^ib^j\mid i\in \bb{N}\cup \{0\},j\in \bb{N}\}
        \end{align*}
        notemos que j\in N pq si no, estamos en la de arriba.
        \end{comment}

        % // TODO: Revisar
        \item Demostrar que $L$ es aceptado por un autómata finito determinista si y solo si el número de clases de equivalencia es finito.
        
        Demostramos mediante doble inclusión.
        \begin{description}
            \item[$\Longrightarrow)$] Supongamos que $L$ es aceptado por un autómata finito determinista. Sea $M=(Q, A, \delta, q_0, F)$ su AFD minimal que acepta $L$.
            Supongamos $u,v\in A^*$ tales que $u\equiv v$. Sean:
            \begin{align*}
                q_u &:= \delta^{\ast}(q_0, u),\\
                q_v &:= \delta^{\ast}(q_0, v).
            \end{align*}

            Veamos ahora que $q_u,q_v$ son indistingibles, es decir, $q_u=q_v$.
            \begin{itemize}
                \item Para todo $z\in A^*$, como $u\equiv v$, se tiene que:
                \begin{equation*}
                    uz\in L\Leftrightarrow vz\in L.
                \end{equation*}
    
                Equivalentemente, tenemos que:
                \begin{equation*}
                    \delta^{\ast}(\delta^{\ast}(q_0, u), z)\in F\Longleftrightarrow \delta^{\ast}(\delta^{\ast}(q_0, v), z)\in F
                \end{equation*}

                Es decir:
                \begin{equation*}
                    \delta^{\ast}(q_u, z)\in F\Longleftrightarrow \delta^{\ast}(q_v, z)\in F
                \end{equation*}

                Por tanto, $q_u$ y $q_v$ son indistinguibles; y como el autómata es minimal, $q_u=q_v$.
            \end{itemize}
            
            Por tanto, hay una clase de equivalencia por cada estado de $Q$. Como $Q$ es finito, el número de clases de equivalencia es finito.

            \item[$\Longleftarrow)$] Supongamos que el número de clases de equivalencia es finito. Sea el autómata $M=(Q, A, \delta, q_0, F)$, donde:
            \begin{itemize}
                \item $Q$ es el conjunto de clases de equivalencia de $L$,
                \item $q_0=[\varepsilon]$,
                \item $\delta([u], a)=[ua]$. Veamos que está bien definida.
                
                Sea $u,v\in A^*$ tales que $u\equiv v$, y veamos que, para todo $a\in A$, $ua\equiv va$.
                Como $u\equiv v$, para todo $z\in A^*$, tenemos que:
                \begin{equation*}
                    uz\in L\Leftrightarrow vz\in L.
                \end{equation*}

                Por tanto, tomando $z=az'$, con $z'\in L$, tenemos que:
                \begin{equation*}
                    uaz'\in L\Leftrightarrow vaz'\in L.
                \end{equation*}

                Es decir, $ua\equiv va$. Por tanto, $\delta$ está bien definida.
                \item $F=\{[u]\in Q\mid u\in L\}$.
                
                Para ver que $F$ está bien definida, veamos que, si $u\equiv v$, entonces $u\in L\Longleftrightarrow v\in L$.
                Esto es directo tomando $z=\veps$.
            \end{itemize}

            Veamos ahora que $L=\cc{L}(M)$.
            \begin{equation*}
                u\in \cc{L}(M)\Longleftrightarrow \delta^{\ast}(q_0, u)\in F\Longleftrightarrow \delta^{\ast}([\varepsilon], u)\in F\Longleftrightarrow \delta^{\ast}([u], \varepsilon)=[v],\text{con }v\in L
            \end{equation*}
            Como $\delta^{\ast}([u], \varepsilon)=[u]$, tenemos que:
            \begin{equation*}
                u\in \cc{L}(M)\Longleftrightarrow u\in L
            \end{equation*}
        \end{description}
        \item ¿Qué relación existe entre el número de clases de equivalencia y el autómata finito minimal que acepta $L$?
        
        % // TODO: Hacer
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Dada una palabra $u = a_1 \cdots a_n \in A^*$, se llama $\operatorname{Per}(u)$ al conjunto
    \begin{align*}
        \{a_{\sigma(1)}, \ldots, a_{\sigma(n)} \mid \sigma \text{ es una permutación de } \{1, \ldots, n\}\}.
    \end{align*}
    Dado un lenguaje $L$, se llama $\operatorname{Per}(L) = \bigcup\limits_{u \in L} \operatorname{Per}(u)$.
    Dar expresiones regulares y autómatas minimales para $\operatorname{Per}(L)$ en los siguientes casos:
    \begin{enumerate}% // TODO: Comprobar entero
        \item $L = (00 + 1)^*$,
        
        Tenemos que:
        \begin{align*}
            \operatorname{Per}(L) &= \{u\in A^*\mid \text{ $n_0(u)$ es par}\}
        \end{align*}

        Su autómata finito minimal es:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \node[state, initial, accepting] (q0) {$q_0$};
                \node[state, right of=q0] (q1) {$q_1$};

                \draw   (q0) edge[loop above] node{1} (q0)
                        (q0) edge[above, bend right] node{0} (q1)
                        (q1) edge[loop above] node{1} (q1)
                        (q1) edge[above, bend right] node{0} (q0);
            \end{tikzpicture}
        \end{figure}

        % Expr: 1^*(01^*01^*)^*
        \item $L = (0 + 1)^*0$,
        \item $L = (01)^*$.
    \end{enumerate}
    ¿Es posible que, siendo $L$ regular, $Per(L)$ no lo sea?
\end{ejercicio}