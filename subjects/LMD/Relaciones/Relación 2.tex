\section{Recurrencia}



\begin{ejercicio}
    Resuelva la relación de recurrencia dada por $u_{n+2} = 4u_{n+1} - 4u_n$, para todo $n\geq 0$.
    Particularice el resultado suponiendo que $n\geq 0$, $u_0=1$, $u_1=3$.\\

    El orden de la recurrencia es $k=2$. La ecuación característica es:
    \begin{equation*}
        x^2-4x+4 = {(x-2)}^2=0
    \end{equation*}

    Por tanto, tan solo hay una raíz $r=2$ de multiplicidad $m=2$. La solución general de la recurrencia por tanto es:
    \begin{equation*}
        x_n = (c_1+c_2n)2^n \qquad c_1,c_2\in \bb{C}
    \end{equation*}

    Y ahora buscar los valores de $c_1$ y $c_2$ usando las condiciones iniciales, para obtener la solución particular.
    Tenemos que $x_0=u_0=1$ y $x_1=u_1=3$, entonces:
    \begin{align*}
        1 &= (c_1+c_2\cdot 0) 2^0 = c_1\cdot 1 = c_1\\
        3 &= (c_1+c_2\cdot 1) 2^1 = (1+c_2) 2 = 2+2c_2 \Longrightarrow c_2 = \frac{3-2}{2} = \frac{1}{2}
    \end{align*}

    Por tanto, la solución particular es:
    \begin{equation*}
        x_n = \left(1+\frac{n}{2}\right)2^n = \left(\frac{2+n}{2}\right)2^n = (2+n)2^{n-1}
    \end{equation*}
    \begin{observacion}
        Notemos que distinguimos muy bien la reucrrencia en sí, notada por $u_n$, de la solución particular de la recurrencia, notada por $x_n$.
    \end{observacion}
\end{ejercicio}

\begin{ejercicio}\label{ej:recurrenciaFib}
    Resuelva la recurrencia:
    \begin{equation*}
        u_{n+2} = u_{n+1} + u_n\qquad n\geq 0
    \end{equation*}

    El orden $k$ de la recurrencia es 2 ($k = 2$). La ecución característica es:
    \begin{equation*}
        x^2 -x -1 = 0 
    \end{equation*}

    Las soluciones de la ecuación característica son:
    \begin{equation*}
        x = \dfrac{1\pm \sqrt{1+4}}{2}
    \end{equation*}

    Usando la notación del Teorema visto en Teoría, donde $r_i$ son las raíces de la ecuación característica y $m_i$ son las multiplicidades de las raíces, se tiene:
    \begin{gather*}
        r_1 = \dfrac{1+\sqrt{5}}{2} \qquad m_1 = 1 \\
        r_2 = \dfrac{1+\sqrt{5}}{2} \qquad m_2 = 1
    \end{gather*}

    En efecto, se tiene $m_1+m_2 = 1 +1 = 2 = k$, por lo que estamos en las condiciones del Teorema. Si $\{x_n\}$ es solución de la recurrencia, entonces sabemos que para todo $n\in \bb{N},~n \geq 0$ se tiene:
    \begin{align*}
        x_n &= c_1 r_1^n + c_2 r_2^n\\
            &= c_1{\left(\dfrac{1+\sqrt{5}}{2}\right)}^n + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^n
            \qquad c_1,c_2\in \bb{C}
    \end{align*}
    
    Los valores de $c_1$ y $c_2$ se obtendrán a partir de las condiciones iniciales, que no se nos han proporcionado.
\end{ejercicio}

\begin{ejercicio}
    Reuelva el problema lineal homogéneo:
    \begin{align*}
        u_0 &= 0\\    
        u_1 &= 1 \\
        u_{n+2} &= u_{n+1} + u_n \qquad n \geq 0
    \end{align*}

    Por el ejercicio~\ref{ej:recurrenciaFib}, sabemos que la solución a la relación de recurrencia del problema es:
    \begin{equation*}
        x_n = c_1{\left(\dfrac{1+\sqrt{5}}{2}\right)}^n + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^n
        \qquad c_1,c_2\in \bb{C}
    \end{equation*}

    Si $\{x_n\}$ es solución del problema entonces $x_0 = u_0 = 0$ y $x_1 = u_1 = 1$. Sabiendo esto,
    podemos calcular los valores de $c_1$ y $c_2$:
    \begin{align*}
        0 &= x_0 = c_1{\left(\dfrac{1+\sqrt{5}}{2}\right)}^0 + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^0\\
          &= c_1 + c_2 \Longrightarrow c_2 = -c_1\\\\
        1 &= x_1 = c_1 {\left(\dfrac{1+\sqrt{5}}{2}\right)}^1 + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^1 \\
          &= c_1 \left(\dfrac{1+\sqrt{5}}{2}\right) - c_1 \left(\dfrac{1-\sqrt{5}}{2}\right) 
          = c_1 \left(\dfrac{1+\sqrt{5}}{2} - \dfrac{1-\sqrt{5}}{2}\right) \\
          &= c_1 \left(\dfrac{1+\sqrt{5}-1+\sqrt{5}}{2}\right) 
          = c_1 \dfrac{2\sqrt{5}}{2} \\
          &= c_1 \sqrt{5} \Longrightarrow c_1 = \dfrac{1}{\sqrt{5}} \Longrightarrow c_2 = -\dfrac{1}{\sqrt{5}}
    \end{align*}

    La solución del problema por tanto es:
    \begin{equation*}
    x_n = \dfrac{1}{\sqrt{5}}\left({\left(\dfrac{1+\sqrt{5}}{2}\right)}^n - {\left(\dfrac{1-\sqrt{5}}{2}\right)}^n\right)
    \end{equation*}

    Notemos que esta es la conocida \emph{sucesión de Fibonacci}.
\end{ejercicio}

\begin{ejercicio}
    Calcular la solución del problema lineal homogéneo:
    \begin{align*}
        u_0 &= 2 \\
        u_1 &= 1 \\
        u_{n+2} &= u_{n+1} + u_n,\qquad n\geq 0
    \end{align*}

    Gracias a la solución del ejercicio~\ref{ej:recurrenciaFib}, sabemos que la solución a la relación de recurrencia del problema es:
    \begin{equation*}
        x_n = c_1{\left(\dfrac{1+\sqrt{5}}{2}\right)}^n + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^n
        \qquad c_1,c_2\in \bb{C}
    \end{equation*}

    Si $\{x_n\}$ es solución del problema, entonces $x_0 = u_0 = 2$ y $x_1 = u_1 = 1$. Sabiendo esto,
    podemos calcular los valores de $c_1$ y $c_2$:
    \begin{align*}
        2 &= x_0 \\
          &= c_1{\left(\dfrac{1+\sqrt{5}}{2}\right)}^0 + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^0\\
          &= c_1 + c_2 \Longrightarrow c_2 = 2-c_1\\ \\
        1 &= x_1 \\
          &= c_1 {\left(\dfrac{1+\sqrt{5}}{2}\right)}^1 + c_2 {\left(\dfrac{1-\sqrt{5}}{2}\right)}^1 \\
          &= c_1 \left(\dfrac{1+\sqrt{5}}{2}\right) + (2- c_1) \left(\dfrac{1-\sqrt{5}}{2}\right) \\
          &= c_1 \left(\dfrac{1+\sqrt{5}}{2}\right) + 2 \left(\dfrac{1-\sqrt{5}}{2}\right)-c_1\left(\dfrac{1-\sqrt{5}}{2}\right) \\
          &= c_1 \left(\dfrac{1+\sqrt{5}}{2}-\dfrac{1-\sqrt{5}}{2}\right) + \cancel{2}\left(\dfrac{1-\sqrt{5}}{\cancel{2}}\right) \\
          &= c_1 \sqrt{5} +1 - \sqrt{5} 
          \Longrightarrow 1 = c_1 \sqrt{5} + 1 -\sqrt{5}
          \Longrightarrow 0 = c_1\sqrt{5}-\sqrt{5} \\
          &\Longrightarrow c_1\sqrt{5} = \sqrt{5} \Longrightarrow c_1 = 1 \Longrightarrow c_2 = 1
    \end{align*}

    La solución por tanto es:
    \begin{equation*}
        x_n = {\left(\dfrac{1+\sqrt{5}}{2}\right)}^n + {\left(\dfrac{1-\sqrt{5}}{2}\right)}^n
    \end{equation*}

    Notemos que esta es la conocida \emph{sucesión de Lucas}.
\end{ejercicio}

\begin{ejercicio}
    Solucionar la recurrencia:
    \begin{equation*}
        u_{n+2} = 4u_{n+1} - 3u_n + 3^{n+1}+3 \qquad n\geq 0
    \end{equation*}

    Tenemos que el orden de la recurrencia es $k=2$. La ecuación característica es:
    \begin{equation*}
        0 = x^2 - 4x + 3 = (x-3)(x-1)
    \end{equation*}

    Por tanto, la solución general de la parte homogénea de la recurrencia es:
    \begin{equation*}
        x_n^{(h)} = c_0\cdot 1^n + c_1\cdot 3^n = c_0 + c_1 3^n
    \end{equation*}

    En lo que sigue, buscamos obtener una solución particular de la recurrencia. La función de ajuste es:
    \begin{equation*}
        f(n) = 3^{n+1} + 3 = 3\cdot 3^n + 3\cdot 1^n
    \end{equation*}

    Para adaptar la notación a lo visto en teoría, tenemos:
    \begin{equation*}
        3\cdot 3^n\Longrightarrow \left\{\begin{array}{l}
            s_3 = 3 \\
            m_3 = 1\\
            q_3(n) = 3 \\
            \deg(q_3(n)) = 0
        \end{array}\right\}
        \hspace{1cm}
        3\cdot 1^n\Longrightarrow \left\{\begin{array}{l}
            s_1 = 1 \\
            m_1 = 1\\
            q_1(n) = 3 \\
            \deg(q_1(n)) = 0
        \end{array}\right\}
    \end{equation*}

    Por lo visto en teoría, tenemos que una solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = c_2n\cdot 3^n + c_3n\cdot 1^n = c_2n\cdot 3^n + c_3n
    \end{equation*}

    Aun habiendo obtenido la forma general de la solución particular, necesitamos obtener los valores de $c_2$ y $c_3$.
    Para ello, como sabemos que $x_n^{(p)}$ es solución de la recurrencia, entonces:
    \begin{equation*}
        3^{n+1} + 3 = x_{n+2}^{(p)} - 4x_{n+1}^{(p)} + 3x_n^{(p)}
    \end{equation*}

    Calculemos dichos valores:
    \begin{align*}
        x_n^{(p)} &= c_2n\cdot 3^n + c_3n = n(c_2\cdot 3^n + c_3)\\
        x_{n+1}^{(p)} &= c_2(n+1)\cdot 3^{n+1} + c_3(n+1)
        = (n+1)(3c_2\cdot 3^{n} + c_3)\\
        x_{n+2}^{(p)} &= c_2(n+2)\cdot 3^{n+2} + c_3(n+2)
        = (n+2)(3^2c_2\cdot 3^{n} + c_3)
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        3^{n+1} + 3 &= x_{n+2}^{(p)} - 4x_{n+1}^{(p)} + 3x_n^{(p)} =\\
        &= (n+2)(3^2c_2\cdot 3^{n} + c_3) - 4(n+1)(3c_2\cdot 3^{n} + c_3) + 3n(c_2\cdot 3^n + c_3) =\\
        &= c_2 3^n[3^2(n+2) - 4\cdot 3(n+1) + 3n] + c_3[(n+2) - 4(n+1) + 3n] =\\
        &= c_2 3^n[9n + 18 - 12n - 12 + 3n] + c_3[n+2 - 4n - 4 + 3n] =\\
        &= 6c_2 3^n -2c_3
    \end{align*}

    Por tanto, deducimos que:
    \begin{equation*}
        3^{n+1} + 3 = 3\cdot 3^n + 3 = 6c_2 3^n -2c_3
    \end{equation*}

    Igualando los coeficientes, obtenemos las siguientes ecuaciones:
    \begin{align*}
        6c_2 &= 3 \Longrightarrow c_2 = \nicefrac{1}{2} \\
        -2c_3 &= 3 \Longrightarrow c_3 = \nicefrac{-3}{2}
    \end{align*}

    Por tanto, la solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = \frac{1}{2}n\cdot 3^n - \frac{3}{2}n
        = \frac{n}{2}\left(3^n - 3\right)
    \end{equation*}

    Como sabemos que la solución general de la recurrencia $\{x_n\}$ es la suma de la solución homogénea y la solución particular, entonces
    $\{x_n\} = \left\{x_n^{(h)} + x_n^{(p)}\right\}$ y entonces:
    \begin{align*}
        x_n &= c_0 + c_1 3^n + \frac{n}{2}\left(3^n - 3\right) 
        = \left(\frac{n}{2} + c_1\right)3^n + c_0 - \frac{3n}{2}
    \end{align*}
\end{ejercicio}

\begin{ejercicio}\label{ej:recurrenciaComplejos}
    Resuelva la recurrencia:
    \begin{equation*}
        u_{n+2} + 4u_n = 0 \qquad n\geq 0
    \end{equation*}

    El orden de la recurrencia es $k=2$. La ecuación característica es:
    \begin{equation*}
        x^2 + 4 = 0 \Longleftrightarrow x^2 = -4
    \end{equation*}

    Por tanto, tenemos que las soluciones de la ecuación característica son:
    \begin{equation*}
        z_1 = 2i \qquad z_2 = -2i
    \end{equation*}

    Por lo tanto, la solución general de la recurrencia es:
    \begin{equation*}
        x_n = c_1\cdot (2i)^n + c_2\cdot (-2i)^n
    \end{equation*}

    Buscamos ahora expresar la solución general de la recurrencia en términos de senos y cosenos. Para ello, tenemos que:
    \begin{equation*}
        |z_1| = |z_2| = 2 \hspace{1cm} \theta_{z_1} = \frac{\pi}{2} \hspace{1cm} \theta_{z_2} = -\frac{\pi}{2}
    \end{equation*}

    Por tanto, la expresión de $z_1$ y $z_2$ en términos de senos y cosenos es:
    \begin{align*}
        z_1 &= 2\cdot \left[\cos\left(\frac{\pi}{2}\right) + i\sen\left(\frac{\pi}{2}\right)\right]\\
        z_2 &= 2\cdot \left[\cos\left(-\frac{\pi}{2}\right) + i\sen\left(-\frac{\pi}{2}\right)\right]
    \end{align*}

    Usando que $\cos(-\theta) = \cos(\theta)$ y $\sen(-\theta) = -\sen(\theta)$, tenemos que:
    \begin{align*}
        z_1 &= 2\cdot \left[\cos\left(\frac{\pi}{2}\right) + i\sen\left(\frac{\pi}{2}\right)\right]\\
        z_2 &= 2\cdot \left[\cos\left(\frac{\pi}{2}\right) - i\sen\left(\frac{\pi}{2}\right)\right]
    \end{align*}

    Elevando a $n$, por el Teorema de Moivre, tenemos que:
    \begin{align*}
        (z_1)^n &= 2^n\cdot \left[\cos\left(\frac{n\pi}{2}\right) + i\sen\left(\frac{n\pi}{2}\right)\right]\\
        (z_2)^n &= 2^n\cdot \left[\cos\left(\frac{n\pi}{2}\right) - i\sen\left(\frac{n\pi}{2}\right)\right]
    \end{align*}

    Por tanto, la solución general de la recurrencia en términos de senos y cosenos es:
    \begin{align*}
        x_n &= c_1\cdot 2^n\cdot \left[\cos\left(\frac{n\pi}{2}\right) + i\sen\left(\frac{n\pi}{2}\right)\right] + c_2\cdot 2^n\cdot \left[\cos\left(\frac{n\pi}{2}\right) - i\sen\left(\frac{n\pi}{2}\right)\right] =\\
        &= 2^n\left[(c_1+c_2)\cos\left(\frac{n\pi}{2}\right) + i(c_1-c_2)\sen\left(\frac{n\pi}{2}\right)\right] =\\
        &= 2^n\left[d_1\cos\left(\frac{n\pi}{2}\right) + d_2\sen\left(\frac{n\pi}{2}\right)\right]
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    Resuelva la recurrencia:
    \begin{equation*}
        u_{n+2} + 4u_n = 6\cos\left(\frac{n\pi}{2}\right) + 3\sen\left(\frac{n\pi}{2}\right) \qquad n\geq 0
    \end{equation*}

    \begin{comment}
    Por el ejercicio~\ref{ej:recurrenciaComplejos}, tenemos que:
    \begin{equation*}
        x_n^{(h)} = 2^n\left[d_1\cos\left(\frac{n\pi}{2}\right) + d_2\sen\left(\frac{n\pi}{2}\right)\right]
    \end{equation*}
    \end{comment}
\end{ejercicio}

\begin{ejercicio}
    Calcular el número de pasos mínimo para completar una instancia del puzzle conocido como ``Torres de Hanoi'', en función del número de discos $n$ con los que cuente.\\

    Para $n\geq 0$ sea $u_n$ el número de movimientos necesarios para pasar los $n$ discos
    del poste $A$ al poste $C$. Si el puzzle tuviese $n+1$ discos entonces hacemos lo siguiente:
    \begin{itemize}
        \item Pasamos los $n$ discos superiores del poste $A$ al poste $B$. Esto nos cuesta $u_n$ movimientos.
        \item Pasamos el disco base del poste $A$ al poste $C$. Esto nos cuesta 1 movimiento.
        \item Pasamos los $n$ discos superiores del poste $B$ al poste $C$. Esto nos cuesta $u_n$ movimientos.
    \end{itemize}

    Por tanto, lo dicho sugiere la siguiente recurrencia:
    \begin{equation*}
        u_{n+1} = 2u_n + 1
    \end{equation*}

    Tenemos que el orden de la recurrencia es $k=1$. La ecuación característica es:
    \begin{equation*}
        x-2 = 0
    \end{equation*}

    Por tanto, la solución general de la recurrencia es:
    \begin{equation*}
        x_n = c_1\cdot 2^n  \qquad c_1\in \bb{C}
    \end{equation*}

    En lo que sigue, buscamos obtener una solución particular de la recurrencia. La función de ajuste es:
    \begin{equation*}
        f(n) = 1 = 1\cdot 1^n
    \end{equation*}

    Para adaptar la notación a lo visto en teoría, tenemos:
    \begin{equation*}
        1\cdot 1^n\Longrightarrow \left\{\begin{array}{l}
            s_1 = 1 \\
            m_1 = 0\\
            q_1(n) = 1 \\
            \deg(q_1(n)) = 0
        \end{array}\right\}
    \end{equation*}
    
    Por lo visto en teoría, tenemos que una solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = c_2\cdot 1^n = c_2   \qquad c_2\in \bb{C}
    \end{equation*}

    Aun habiendo obtenido la forma general de la solución particular, necesitamos obtener
    el valor de $c_2$. Para ello, como sabemos que $x_n^{(p)}$ es solución de la recurrencia, entonces:
    \begin{equation*}
        1 = x_{n+1}^{(p)} - 2x_n^{(p)} = c_2 - 2c_2 = -c_2  \Longrightarrow c_2 = -1
    \end{equation*}

    Por tanto, la solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = -1
    \end{equation*}

    Como sabemos que la solución general de la recurrencia $\{x_n\}$ es la suma de la solución homogénea y la solución particular, entonces
    $\{x_n\} = \left\{x_n^{(h)} + x_n^{(p)}\right\}$ y entonces:
    \begin{align*}
        x_n &= c_1\cdot 2^n - 1
    \end{align*}

    Como sabemos que $x_0 = u_0 = 0$ ya que no se requiere ningún movimiento para pasar 0 discos, entonces:
    \begin{align*}
        0 &= c_1\cdot 2^0 - 1 = c_1 - 1 \Longrightarrow c_1 = 1
    \end{align*}

    Por tanto, la solución de la recurrencia es:
    \begin{equation*}
        x_n = 2^n - 1
    \end{equation*}

    Notemos que esta es la solución al problema de las Torres de Hanoi. Veamos como ilustración los primeros valores de la sucesión:
    \begin{align*}
        x_0 &= 2^0 - 1 = 0 \\
        x_1 &= 2^1 - 1 = 1 \\
        x_2 &= 2^2 - 1 = 3 \\
        x_3 &= 2^3 - 1 = 7 \\
        x_4 &= 2^4 - 1 = 15
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    Sea la sucesión $\{u_n\}$ definida por:
    \begin{equation*}
        u_n = \sum_{k = 0}^n k 2^k
    \end{equation*}
    \begin{enumerate}
        \item Encuentre una expresión recurrente para $u_n$.
        
        Para todo $n\in \bb{N}$, $n\geq 1$ se tiene:
        \begin{align*}
            u_n &= \sum_{k = 0}^n k 2^k = \sum_{k = 0}^{n-1} k 2^k + n2^n = u_{n-1} + n2^n
        \end{align*}

        Además, para $n=0$ se tiene que:
        \begin{equation*}
            u_0 = \sum_{k = 0}^0 k 2^k = 0\cdot 2^0 = 0
        \end{equation*}

        Por tanto, la expresión recurrente para $u_n$ es:
        \begin{equation*}
            \left\{\begin{array}{l}
                u_0 = 0 \\
                u_n = u_{n-1} + n2^n    \qquad n\geq 1
            \end{array}\right.
        \end{equation*}

        \item Encuentre una fórmula explícita para calcular $u_n$.
        
        Encontrar una fórmula explícita para $u_n$ es equivalente a resolver la recurrencia. Para ello, su polinomio característico es:
        \begin{equation*}
            x-1 = 0
        \end{equation*}

        Por tanto, la solución a la parte homogénea de la recurrencia es:
        \begin{equation*}
            u_n^{(h)} = c_0 \qquad c_0\in \bb{C}
        \end{equation*}

        La función de ajuste es:
        \begin{equation*}
            f(n) = n2^n
        \end{equation*}

        Para adaptar la notación a lo visto en teoría, tenemos:
        \begin{equation*}
            n2^n\Longrightarrow \left\{\begin{array}{l}
                s = 2 \\
                m = 0\\
                q(n) = n \\
                \deg(q(n)) = 1
            \end{array}\right.
        \end{equation*}

        Por lo visto en teoría, tenemos que una solución particular de la recurrencia es:
        \begin{equation*}
            u_n^{(p)} = (c_1 + c_2n)2^n
        \end{equation*}

        Aun habiendo obtenido la forma general de la solución particular, necesitamos obtener los valores de $c_1$ y $c_2$.
        Para ello, como sabemos que $u_n^{(p)}$ es solución de la recurrencia, entonces:
        \begin{align*}
            n2^n &= u_{n}^{(p)} - u_{n-1}^{(p)} = (c_1 + c_2n)2^{n} - (c_1 + c_2(n-1))2^{n-1} =\\
            &= 2(c_1+c_2n)2^{n-1} - (c_1+c_2(n-1))2^{n-1} =\\
            &= 2^{n-1}[2c_1 + 2c_2n - c_1 - c_2n + c_2]
            = 2^{n-1}[c_1 + c_2 +c_2n]
        \end{align*}

        Por tanto, deducimos que:
        \begin{equation*}
            n2^n = 2^{n-1}\cdot 2n =
            2^{n-1}[c_1 + c_2 +c_2n] \Longrightarrow
            \left\{
                \begin{array}{l}
                    0 = c_1 + c_2 \\
                    2 = c_2
                \end{array}
            \right\} \Longrightarrow
            \left\{
                \begin{array}{l}
                    c_1 = -2 \\
                    c_2 = 2
                \end{array}
            \right.
        \end{equation*}

        Por tanto, la solución particular de la recurrencia es:
        \begin{equation*}
            u_n^{(p)} = (-2 + 2n)2^n = (n-1)2^{n+1}
        \end{equation*}

        Como sabemos que la solución general de la recurrencia $\{u_n\}$ es la suma de la solución homogénea y la solución particular, entonces
        $\{u_n\} = \left\{u_n^{(h)} + u_n^{(p)}\right\}$ y entonces:
        \begin{align*}
            u_n &= c_0 + (n-1)2^{n+1}
        \end{align*}

        Como sabemos que $u_0 = 0$ ya que no se requiere ningún movimiento para pasar 0 discos, entonces:
        \begin{align*}
            0 &= c_0 + (0-1)2^{0+1} = c_0 - 2 \Longrightarrow c_0 = 2
        \end{align*}

        Por tanto, la solución de la recurrencia es:
        \begin{equation*}
            u_n = 2 + (n-1)2^{n+1}
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Un ciudadano pide un préstamo por cantidad $S$ de dinero a pagar en $T$ plazos. Si $I$ es el interés del préstamos por plazo en tanto por uno, ¿qué pago constante $P$ debe hacer al final de cada plazo?\\

   Sea $u_n$ es la cantidad de pŕestamo que todavía debe el ciudadano al final del $n-$ésimo plazo,
   es decir, a continuación del $n-$ésimo pago. 
   Entonces, para todo $0 \leq n \leq T-1$ tenemos:
    \begin{align*}
        u_{n+1} &= u_n + I \cdot u_n - P \\
                &= (1+I) u_n - P
    \end{align*}
    
    El problema entonces se reduce a resolver la recurrencia:
    \begin{equation*}
        \left\{
            \begin{array}{rl}
                u_0 &= S \\
                u_T &= 0 \\
                u_{n+1} &= (1+I)u_n - P \qquad 0 \leq n \leq T - 1
            \end{array}
        \right.
    \end{equation*}

    El orden de la recurrencia es $k=1$. La ecuación característica es:
    \begin{equation*}
        x - (1+I) = 0
    \end{equation*}

    Por tanto, la solución a la parte homogénea de la recurrencia es:
    \begin{equation*}
        x_n^{(h)} = c_0(1+I)^n \qquad c_0\in \bb{C}
    \end{equation*}

    La función de ajuste es $f(n) = -P = -Pn^0\cdot 1^n$. Para adaptar la notación a lo visto en teoría, tenemos:
    \begin{equation*}
        -P\Longrightarrow \left\{\begin{array}{l}
            s = -P \\
            q(n) = 1 \\
            \deg(q(n)) = 0
        \end{array}\right.
    \end{equation*}

    Para obtener la multiplicidad del $1$ como raíz del polinomio característico, depende del valor de $I$.
    Como la única raíz del polinomio característico es $1+I$, realizamos la siguiente distinción de casos:
    \begin{itemize}
        \item \ul{$I = 0$}: En este caso, la raíz del polinomio característico es $1$ y por tanto, $m=1$.
        Por tanto, tenemos:
        \begin{align*}
            x_n^{(h)} &= c_0(1+I)^n = c_0(1)^n = c_0
            x_n^{(p)} &= c_1 n\cdot 1^n = c_1n
        \end{align*}

        Como $x_n^{(p)}$ es solución de la recurrencia, entonces:
        \begin{align*}
            -P &= x_{n+1}^{(p)} - (1+I)x_n^{(p)} = c_1(n+1) - (1+I)c_1n
            =\\&= c_1[n+1 - n(1+I)] = c_1(1-I) = c_1
        \end{align*}

        Por tanto, la solución de la recurrencia es:
        \begin{align*}
            x_n &= c_0 -Pn
        \end{align*}

        Para hallar $c_0$ y $P$, usamos las condiciones iniciales:
        \begin{align*}
            S &= x_0 = c_0 - P\cdot 0 = c_0 \Longrightarrow c_0 = S \\
            0 &= x_T = c_0 - P\cdot T = S - PT \Longrightarrow P = \dfrac{S}{T}
        \end{align*}

        Por tanto, la solución de la recurrencia es:
        \begin{align*}
            x_n &= S - \dfrac{S}{T}n = S\left(1-\dfrac{n}{T}\right)
        \end{align*}

        La cantidad constante que debe pagar el ciudadano al final de cada plazo es:
        \begin{equation*}
            P = \dfrac{S}{T}
        \end{equation*}

        \item \ul{$I \neq 0$}: En este caso, la raíz del polinomio característico es $1+I$ y por tanto, $m=0$.
        Por tanto, tenemos:
        \begin{align*}
            x_n^{(h)} &= c_0(1+I)^n
            x_n^{(p)} &= c_1 n^0\cdot 1^n = c_1
        \end{align*}

        Como $x_n^{(p)}$ es solución de la recurrencia, entonces:
        \begin{align*}
            -P &= x_{n+1}^{(p)} - (1+I)x_n^{(p)} = c_1 - (1+I)c_1 = -Ic_1
            \Longrightarrow c_1 = \dfrac{P}{I}
        \end{align*}

        Por tanto, la solución de la recurrencia es:
        \begin{align*}
            x_n &= c_0(1+I)^n + \dfrac{P}{I}
        \end{align*}

        Para hallar $c_0$ y $P$, usamos las condiciones iniciales:
        \begin{align*}
            S &= x_0 = c_0(1+I)^0 + \dfrac{P}{I} = c_0 + \dfrac{P}{I} \Longrightarrow c_0 = S - \dfrac{P}{I} \\
            0 &= x_T = c_0(1+I)^T + \dfrac{P}{I}
        \end{align*}

        Por tanto, para hallar la cantidad constante que debe pagar el ciudadano al final de cada plazo, necesitamos despejar $P$ de la ecuación anterior:
        \begin{align*}
            0 &= \left(S - \dfrac{P}{I}\right)(1+I)^T + \dfrac{P}{I}
            \Longrightarrow\\&\Longrightarrow P = (P-SI)(1+I)^T = P(1+I)^T - SI(1+I)^T
            \Longrightarrow\\&\Longrightarrow P = \dfrac{SI(1+I)^T}{(1+I)^T - I}
        \end{align*}

        La solución de la recurrencia es:
        \begin{align*}
            x_n &= \left(S - \dfrac{P}{I}\right)(1+I)^n + \dfrac{P}{I}
        \end{align*}
    \end{itemize}

\end{ejercicio}

\begin{ejercicio}
    Encuentre la solución la solución general para la siguiente recurrencia:
    \begin{equation*}
        u_n = u_{n-2} + 2^n + (-1)^n \qquad n\geq 2
    \end{equation*}
    y luego soluciona el problema que surge de ella junto a los valores iniciales: $$u_0 = u_1 = 2.$$

    El orden de la recurrencia es $k=2$. La ecuación característica es:
    \begin{equation*}
        x^2 - 1 = 0 \Longrightarrow (x+1)(x-1) = 0
    \end{equation*}

    Por tanto, la solución de la parte homogénea de la recurrencia es:
    \begin{equation*}
        x_n^{(h)} = c_1(-1)^n + c_2
    \end{equation*}

    La función de ajuste es $f(n) = 2^n + (-1)^n$. Por lo visto en teoría, tenemos que
    una solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = c_3 2^n + c_4n(-1)^n
    \end{equation*}

    Para el cálculo de $c_3$ y $c_4$ no intervienen los valores iniciales.
    Como $x_n^{(p)}$ es solución de la recurrencia, entonces:
    \begin{align*}
        2^n + (-1)^n &= x_{n}^{(p)} - x_{n-2}^{(p)}
        = c_3 2^n + c_4n(-1)^n - c_3 2^{n-2} - c_4(n-2)(-1)^{n-2} =\\
        &= 2^{n-2}(2^2c_3-c_3) + (-1)^{n}(c_4n - c_4(n-2)) =\\
        &= 2^{n-2}\cdot 3c_3 + 2(-1)^n c_4
    \end{align*}

    Por tanto, deducimos que:
    \begin{equation*}
        \left\{\begin{array}{l}
            3c_3 = 4 \Longrightarrow c_3 = \nicefrac{4}{3} \\
            2c_4 = 1 \Longrightarrow c_4 = \nicefrac{1}{2}
        \end{array}\right.
    \end{equation*}

    Por tanto, la solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = \frac{2^{n+2}}{3} + \frac{n}{2}\cdot (-1)^n
    \end{equation*}

    La solución general de la recurrencia es:
    \begin{equation*}
        x_n = c_1(-1)^n + c_2 + \frac{2^{n+2}}{3} + \frac{n}{2}\cdot (-1)^n
    \end{equation*}

    Usando los valores iniciales, tenemos:
    \begin{align*}
        2 &= x_0 = c_1 + c_2 + \frac{4}{3} + 0 \Longrightarrow c_1 + c_2 = \frac{2}{3} \\
        2 &= x_1 = -c_1 + c_2 + \frac{8}{3} - \frac{1}{2} \Longrightarrow -c_1 + c_2 = -\frac{1}{6}
    \end{align*}

    Tenemos por tanto el siguiente sistema de ecuaciones:
    \begin{equation*}
        \left\{\begin{array}{l}
            c_1 + c_2 = \nicefrac{2}{3} \\
            c_1 - c_2 = \nicefrac{1}{6}
        \end{array}\right\}
        \Longrightarrow
        \left\{\begin{array}{l}
            c_1 = \nicefrac{5}{12} \\
            c_2 = \nicefrac{1}{4}
        \end{array}\right.
    \end{equation*}

    Por tanto, la solución de la recurrencia para los valores iniciales dados es:
    \begin{align*}
        x_n &= \frac{5}{12}(-1)^n + \frac{1}{4} + \frac{2^{n+2}}{3} + \frac{n}{2}\cdot (-1)^n =\\
        &= \frac{2^{n+2}}{3} + (-1)^n\left(\frac{5}{12} + \frac{n}{2}\right) + \frac{1}{4}
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    Resuelva la recurrencia
    \begin{equation*}
        u_{n+2} + 4u_{n+1} + 16u_n = 4^{n+2} \cos \left(\dfrac{n\pi}{2} \right) -4^{n+3} \sen \left(\dfrac{n\pi}{2} \right) 
    \end{equation*}

    El orden de la recurrencia es $k=2$. La ecuación característica es:
    \begin{equation*}
        x^2 + 4x + 16 = 0
    \end{equation*}

    Por tanto, las soluciones de la ecuación característica son:
    \begin{equation*}
        x = \dfrac{-4\pm \sqrt{16 - 4\cdot 16}}{2}
        = -2\pm \sqrt{-3\cdot 2^2}
        = -2\pm 2\sqrt{3}i
        \Longrightarrow
        \left\{\begin{array}{l}
            r_1 = -2 + 2\sqrt{3}i \\
            r_2 = -2 - 2\sqrt{3}i
        \end{array}\right.
    \end{equation*}

    Por tanto, la solución a la parte homogénea de la recurrencia es:
    \begin{equation*}
        x_n^{(h)} = c_1(-2+2\sqrt{3}i)^n + c_2(-2-2\sqrt{3}i)^n
    \end{equation*}

    Para expresar la solución en términos de senos y cosenos, calculamos el módulo y el argumento de las raíces.
    El módulo de las raíces es:
    \begin{equation*}
        |r_1| = |r_2| = \sqrt{2^2 + 2^2\cdot 3} = \sqrt{2^4}=4
    \end{equation*}

    Respecto al argumento de las raíces, tenemos:
    \begin{align*}
        \tg(\theta_1) &= \frac{\Im(r_1)}{\Re(r_1)} = \frac{2\sqrt{3}}{-2} = -\sqrt{3} \Longrightarrow \theta_1 = -\frac{\pi}{3} + \pi = \frac{2\pi}{3}\\
        \tg(\theta_2) &= \frac{\Im(r_2)}{\Re(r_2)} = \frac{-2\sqrt{3}}{-2} = \sqrt{3} \Longrightarrow \theta_2 = \frac{\pi}{3} + \pi = \frac{4\pi}{3} = -\frac{2\pi}{3}
    \end{align*}

    Por tanto, la solución a la parte homogénea de la recurrencia en términos de senos y cosenos, usando la fórmula de Moivre, es:
    \begin{equation*}
        x_n^{(h)} = 4^n\left(c_1\cos\left(\frac{2\pi n}{3}\right) + c_2\sen\left(\frac{2\pi n}{3}\right)\right)
        + 4^n\left(c_3\cos\left(\frac{4\pi n}{3}\right) + c_4\sen\left(\frac{4\pi n}{3}\right)\right)
    \end{equation*}

    Usando que $\sen(-x) = -\sen(x)$ y $\cos(-x) = \cos(x)$, podemos reescribir la solución anterior como:
    \begin{align*}
        x_n^{(h)} &= 4^n\left(c_1\cos\left(\frac{2\pi n}{3}\right) + c_2\sen\left(\frac{2\pi n}{3}\right)\right)
        + 4^n\left(c_3\cos\left(\frac{2\pi n}{3}\right) - c_4\sen\left(\frac{2\pi n}{3}\right)\right) =\\
        &= 4^n\left((c_1+c_3)\cos\left(\frac{2\pi n}{3}\right) + (c_2-c_4)\sen\left(\frac{2\pi n}{3}\right)\right) =\\
        &= 4^n\left(d_1\cos\left(\frac{2\pi n}{3}\right) + d_2\sen\left(\frac{2\pi n}{3}\right)\right)
    \end{align*}

    Como solución particular de la recurrencia, partimos de:
    \begin{equation*}
        x_n^{(p)} = 4^n\left[c_5\cos\left(\frac{n\pi}{2}\right) + c_6\sen\left(\frac{n\pi}{2}\right)\right]
    \end{equation*}

    Calculamos $x_{n+2}^{(p)}$ y $x_{n+1}^{(p)}$:
    \begin{align*}
        x_{n+2}^{(p)} &= 4^{n+2}\left[c_5\cos\left(\frac{(n+2)\pi}{2}\right) + c_6\sen\left(\frac{(n+2)\pi}{2}\right)\right] =\\
        &= 4^{n+2}\left[c_5\cos\left(\frac{n\pi}{2} + \pi\right) + c_6\sen\left(\frac{n\pi}{2} + \pi\right)\right] =\\
        &= 4^{n+2}\left[c_5\left(\cos\left(\frac{n\pi}{2}\right)\cos\pi-\sen\left(\frac{n\pi}{2}\right)\sen\pi\right)
        + c_6\sen\left(\frac{n\pi}{2}\right)\cos\pi + c_6\cos\left(\frac{n\pi}{2}\right)\sen\pi\right] =\\
        &= 4^{n+2}\left[-c_5\cos\left(\frac{n\pi}{2}\right) - c_6\sen\left(\frac{n\pi}{2}\right)\right] =\\
        &= 4^n\left[-16c_5\cos\left(\frac{n\pi}{2}\right) - 16c_6\sen\left(\frac{n\pi}{2}\right)\right]
        \\ &\\
        x_{n+1}^{(p)} &= 4^{n+1}\left[c_5\cos\left(\frac{(n+1)\pi}{2}\right) + c_6\sen\left(\frac{(n+1)\pi}{2}\right)\right] =\\
        &= 4^{n+1}\left[c_5\cos\left(\frac{n\pi}{2} + \frac{\pi}{2}\right) + c_6\sen\left(\frac{n\pi}{2} + \frac{\pi}{2}\right)\right] =\\
        &= 4^{n+1}\left[c_5\left(\cos\left(\frac{n\pi}{2}\right)\cos\frac{\pi}{2}-\sen\left(\frac{n\pi}{2}\right)\sen\frac{\pi}{2}\right)
        + c_6\sen\left(\frac{n\pi}{2}\right)\cos\frac{\pi}{2} + c_6\cos\left(\frac{n\pi}{2}\right)\sen\frac{\pi}{2}\right] =\\
        &= 4^{n+1}\left[-c_5\sen\left(\frac{n\pi}{2}\right) + c_6\cos\left(\frac{n\pi}{2}\right)\right] =\\
        &= 4^n\left[-4c_5\sen\left(\frac{n\pi}{2}\right) + 4c_6\cos\left(\frac{n\pi}{2}\right)\right]
    \end{align*}

    Sustituyendo en la recurrencia, tenemos:
    \begin{align*}
        4^n & \left[16\cos\left(\frac{\pi n}{2}\right) - 64\sen\left(\frac{\pi n}{2}\right)\right] =\\
        &= 4^{n+2} \cos\left(\frac{n\pi}{2}\right) - 4^{n+3} \sen\left(\frac{n\pi}{2}\right) =\\
        &= x_{n+2}^{(p)} + 4x_{n+1}^{(p)} + 16x_n^{(p)} =\\
        &= 4^n\left[
            -16c_5\cos\left(\frac{n\pi}{2}\right) - 16c_6\sen\left(\frac{n\pi}{2}\right)    
        \right] +\\
        &\qquad + 4^n\left[
            -16c_5\sen\left(\frac{n\pi}{2}\right) + 16c_6\cos\left(\frac{n\pi}{2}\right)
        \right] +\\
        &\qquad + 4^n\left[
            16c_5\cos\left(\frac{n\pi}{2}\right) + 16c_6\sen\left(\frac{n\pi}{2}\right)
        \right] =\\
        &= 4^n\left[
            16c_6\cos\left(\frac{n\pi}{2}\right) - 16c_5\sen\left(\frac{n\pi}{2}\right)
        \right]
    \end{align*}

    Igualando coeficientes, tenemos:
    \begin{align*}
        16c_6 = 16 &\Longrightarrow c_6 = 1 \\
        -16c_5 = -64 &\Longrightarrow c_5 = 4
    \end{align*}

    Por tanto, la solución general de la recurrencia es:
    \begin{align*}
        x_n &= x_n^{(h)} + x_n^{(p)} =\\
        &= 4^n\left(d_1\cos\left(\frac{2\pi n}{3}\right) + d_2\sen\left(\frac{2\pi n}{3}\right)\right) + 4^n\left[4\cos\left(\frac{n\pi}{2}\right) + \sen\left(\frac{n\pi}{2}\right)\right] =\\
        &= 4^n\left(d_1\cos\left(\frac{2\pi n}{3}\right) + d_2\sen\left(\frac{2\pi n}{3}\right) + 4\cos\left(\frac{n\pi}{2}\right) + \sen\left(\frac{n\pi}{2}\right)\right)
    \end{align*}
\end{ejercicio}

\begin{ejercicio}[Función Gamma]
    Calcule el valor de la integral:
    \begin{equation*}
        \Gamma(n+1) = \int_0^{\infty} t^{n} e^{-t} dt
    \end{equation*}

    Aplicamos el método de integración por partes:
    \begin{equation*}
        \MetInt{u = t^n \qquad du=nt^{n-1}}{dv = e^{-t} \qquad v = -e^{-t}}
    \end{equation*}

    Por tanto, tenemos:
    \begin{equation*}
        \Gamma(n+1) = \int_0^\infty t^n e^{-t} dt = \left[-t^n e^{-t}\right]_0^\infty + n\int_0^\infty t^{n-1} e^{-t} dt \AstIg n\Gamma(n)
    \end{equation*}
    donde en $(\ast)$ hemos usado la Regla de Barrow, junto a:
    \begin{equation*}
        \lim_{t\to\infty} t^n e^{-t} = \lim_{t\to\infty} \dfrac{t^n}{e^t} = 0 \hspace{2cm}
        \lim_{t\to 0} t^n e^{-t} = 0^n\cdot e^0 = 0
    \end{equation*}

    Por tanto, mediante una fácil inducción, tenemos que:
    \begin{equation*}
        \Gamma(n+1) = n\Gamma(n) = n!\cdot \Gamma(1) \qquad \forall n\in \bb{N}
    \end{equation*}

    Veamos el valor de $\Gamma(1)$:
    \begin{equation*}
        \Gamma(1) = \int_0^\infty e^{-t} dt = \left[-e^{-t}\right]_0^\infty = 0 - (-1) = 1
    \end{equation*}

    Por tanto, tenemos que:
    \begin{equation*}
        \Gamma(n+1) = n! \qquad \forall n\in \bb{N}
    \end{equation*}
\end{ejercicio}


\begin{ejercicio}
    Considere el problema de recurrencia no homogéneo:
    \begin{equation*}
        \left\{\begin{array}{ll}
            u_n = 3u_{n-1} +3^n-2 & n\geq 1 \\
            u_0 = 2
        \end{array}\right.
    \end{equation*}
    y redúzcalo a un problema de recurrencia homogénea.\\

    Por variación de índices, tenemos que:
    \begin{equation*}
        u_{n-1} = 3u_{n-2} + 3^{n-1}-2
    \end{equation*}

    Por tanto, multiplicando por $3$ llegamos a la segunda ecuación:
    \begin{equation*}
        \begin{array}{rcl}
            u_n &=& 3u_{n-1} + 3^n - 2 \\
            3u_{n-1} &=& 9u_{n-2} + 3^n - 6 \\ \hline
            u_n - 3u_{n-1} &=& 3u_{n-1} - 9u_{n-2} + 4
        \end{array}
    \end{equation*}
    donde hemos restado ambas ecuaciones. Por tanto, tenemos que:
    \begin{equation*}
        u_n = 6u_{n-1} - 9u_{n-2} + 4
    \end{equation*}

    Repitiendo el proceso, tenemos que:
    \begin{equation*}
        \begin{array}{rcl}
            u_n - 6u_{n-1} + 9u_{n-2} &=& 4 \\
            u_{n-1} - 6u_{n-2} + 9u_{n-3} &=& 4 \\ \hline
            u_n - 7u_{n-1} + 15u_{n-2} - 9u_{n-3} &=& 0
        \end{array}
    \end{equation*}
    donde de nuevo hemos restado ambas ecuaciones. Por tanto, tenemos que la recurrencia homogénea equivalente es:
    \begin{equation*}
        u_n = 7u_{n-1} - 15u_{n-2} + 9u_{n-3}
    \end{equation*}

    Resolvamos ahora dicha recurrencia homogénea. El orden de la recurrencia es $k=3$. La ecuación característica es:
    \begin{equation*}
        x^3 - 7x^2 + 15x - 9 = 0
    \end{equation*}

    Veamos mediante Ruffini que $x=1$ es raíz de la ecuación característica:
    \begin{figure}[H]
        \centering
        \polyhornerscheme[x=1]{x^3 - 7x^2 + 15x - 9}
    \end{figure}

    Por tanto, tenemos que:
    \begin{equation*}
        x^3 - 7x^2 + 15x - 9 = (x-1)(x^2 - 6x + 9) = (x-1)(x-3)^2
    \end{equation*}

    Por tanto, la solución general de la recurrencia homogénea es:
    \begin{equation*}
        x_n = c_1 + c_2\cdot 3^n + c_3n\cdot 3^n
    \end{equation*}

    Las condiciones iniciales de contorno que debemos imponer son:
    \begin{align*}
        x_0=u_0&= 2\\
        x_1=u_1&= 6 + 3 - 2 = 7\\
        x_2=u_2&= 21 + 9 - 2 = 28
    \end{align*}

    Por tanto, tenemos el siguiente sistema de ecuaciones:
    \begin{equation*}
        \left\{\begin{array}{l}
            c_1 + c_2 = 2 \\
            c_1 + 3c_2 + 3c_3 = 7 \\
            c_1 + 9c_2 + 18c_3 = 28
        \end{array}\right\} \Longrightarrow c_0=c_1=c_2=1
    \end{equation*}

    Por tanto, la solución de la recurrencia dada es:
    \begin{equation*}
        x_n = 1 + 3^n + n\cdot 3^n = 1 + (n+1)3^n
    \end{equation*}

    \begin{observacion}
        Notemos que este ``método'' tiene varios inconvenientes:
        oculta que algunos de los coeficientes son independientes de los valores de contorno,
        no evita encontrar las raíces de un un polinomio mientras que eleva el grado del polinomio a estudiar,
        no es algorítmico,
        el cálculo de los coeficientes indeterminados es efectuado mediante un sitema de mayor orden, etc.;
        no obstante el método es algebraicamente bello.
    \end{observacion}
\end{ejercicio}


\begin{ejercicio}
    Considere las siguientes recurrencias:
    \begin{equation*}
        \left\{
            \begin{array}{ll}
                s_n  = 2s_{n-1} + s_{n-2} + 4t_{n-1} & n\geq 2 \\
                t_n = s_{n-1} + t_{n-1} & n\geq 2
            \end{array}
        \right.
    \end{equation*}
    Solucione y resuelva la primera recurrencia.\\

    Mediante una simple variación de índices, tenemos que:
    \begin{equation*}
        s_{n-1} = 2s_{n-2} + s_{n-3} + 4t_{n-2}
    \end{equation*}

    Por tanto, tenemos que:
    \begin{align*}
        s_n - s_{n-1} &= 2s_{n-1} + s_{n-2} + 4t_{n-1} - 2s_{n-2} - s_{n-3} - 4t_{n-2} =\\
        &= 2s_{n-1} - s_{n-2} - s_{n-3} + 4t_{n-1} - 4t_{n-2}
    \end{align*}

    Luego:
    \begin{equation*}
        s_n = 3s_{n-1} - s_{n-2} - s_{n-3} + 4(t_{n-1} - t_{n-2})
    \end{equation*}

    Haciendo uso de que $t_n - t_{n-1} = s_{n-1}$, tenemos que:
    \begin{equation*}
        s_n = 3s_{n-1} - s_{n-2} - s_{n-3} + 4s_{n-2} = 3s_{n-1} + 3s_{n-2} - s_{n-3}
    \end{equation*}

    La ecuación característica de la recurrencia homogénea obtenida es:
    \begin{equation*}
        x^3 - 3x^2 - 3x + 1 = 0
    \end{equation*}

    Veamos que $x=-1$ es raíz de la ecuación característica:
    \begin{figure}[H]
        \centering
        \polyhornerscheme[x=-1]{x^3 - 3x^2 - 3x + 1}
    \end{figure}

    Por tanto, tenemos que:
    \begin{equation*}
        x^3 - 3x^2 - 3x + 1 = (x+1)(x^2 - 4x + 1) = 0 \Longleftrightarrow
        \left\{\begin{array}{l}
            x = -1 \\
            x = 2\pm \sqrt{3}
        \end{array}\right.
    \end{equation*}

    Por tanto, la solución general de la recurrencia homogénea es:
    \begin{equation*}
        x_n = c_1(-1)^n + c_2(2+\sqrt{3})^n + c_3(2-\sqrt{3})^n
    \end{equation*}
\end{ejercicio}



\begin{ejercicio}
    Encuentre una fracción que represente al número real:
    \begin{equation*}
        \sum_{k=0}^{\infty} \dfrac{k}{10^{3(k+1)}}
    \end{equation*}

    De forma general, sea $\alpha\in \bb{R},~\alpha\neq 1$, y consideramos la recurrencia dada por:
    \begin{equation*}
        \left\{\begin{array}{l}
            s_0 = 0 \\
            s_n = s_{n-1} + n\alpha^{n+1}
        \end{array}\right.
    \end{equation*}

    El orden de la recurrencia es $k=1$. La ecuación característica es:
    \begin{equation*}
        x - 1 = 0 \Longrightarrow x = 1
    \end{equation*}

    Por tanto, la solución de la parte homogénea de la recurrencia es:
    \begin{equation*}
        x_n^{(h)} = c_1
    \end{equation*}

    La función de ajuste es $f(n) = n\alpha^{n+1}$. Por lo visto en teoría, tenemos que
    una solución particular de la recurrencia es:
    \begin{equation*}
        x_n^{(p)} = (c_2 + c_3n)\alpha^n
    \end{equation*}

    Como $x_n^{(p)}$ es solución de la recurrencia, entonces:
    \begin{align*}
        \alpha^2 n\alpha^{n-1} &=n\alpha^{n+1} = x_n^{(p)} - x_{n-1}^{(p)} = (c_2 + c_3n)\alpha^n - (c_2 + c_3(n-1))\alpha^{n-1} =\\
        &= c_2\alpha^n + c_3n\alpha^n - c_2\alpha^{n-1} - c_3n\alpha^{n-1} + c_3\alpha^{n-1} =\\
        &= c_2\alpha^{n-1}(\alpha-1) + c_3\alpha^{n-1} +c_3n\alpha^{n-1}(\alpha-1)
    \end{align*}

    Por tanto, tenemos el siguiente sistema de ecuaciones:
    \begin{equation*}
        \left\{\begin{array}{l}
            c_3(\alpha-1) = \alpha^2 \Longrightarrow c_3 = \dfrac{\alpha^2}{\alpha-1}\\
            c_2(\alpha-1) + c_3 = 0 \Longrightarrow c_2 = \dfrac{-c_3}{\alpha-1} = \dfrac{-\alpha^2}{(\alpha-1)^2}
        \end{array}\right.
    \end{equation*}

    Por tanto, la solución particular de la recurrencia es:
    \begin{align*}
        x_n^{(p)} &= \left(\dfrac{-\alpha^2}{(\alpha-1)^2} + \dfrac{n\alpha^2}{\alpha-1}\right)\alpha^n =\\
        &= \left(\dfrac{-\alpha^2+n\alpha^2(\alpha-1)}{(\alpha-1)^2}\right)\alpha^n =\\
        &= \left(\dfrac{n\alpha^3-n\alpha^2-\alpha^2}{(\alpha-1)^2}\right)\alpha^n =\\
    \end{align*}

    Por tanto, tenemos que una solución general de la recurrencia es:
    \begin{align*}
        x_n &= x_n^{(h)} + x_n^{(p)} =\\
        &= c_1 + \left(\dfrac{n\alpha^3-n\alpha^2-\alpha^2}{(\alpha-1)^2}\right)\alpha^n
    \end{align*}

    Para hallar el valor de $c_1$, como sabemos que $x_0=s_0=0$, tenemos que:
    \begin{equation*}
        0 = x_0 = c_1 + \dfrac{-\alpha^2}{(\alpha-1)^2} \Longrightarrow c_2=\dfrac{\alpha^2}{(\alpha-1)^2}
    \end{equation*}

    Por tanto, la solución a la recurrencia dada es:
    \begin{align*}
        x_n &= \dfrac{\alpha^2}{(\alpha-1)^2}+ \left(\dfrac{n\alpha^3-n\alpha^2-\alpha^2}{(\alpha-1)^2}\right)\alpha^n =\\
        &= \dfrac{\alpha^2}{(\alpha-1)^2}+ \dfrac{n\alpha^{n+3}-n\alpha^{n+2}-\alpha^{n+2}}{(\alpha-1)^2} =\\
        &= \dfrac{\alpha^2 -\alpha^{n+2} + n\alpha^{n+3}-n\alpha^{n+2}}{(\alpha-1)^2}
    \end{align*}

    Tomando límite con $n\to \infty$, suponiendo $\alpha\in [0,1[$, se tiene que:
    \begin{align*}
        \lim_{n\to \infty} x_n &= \lim_{n\to \infty} \dfrac{\alpha^2 -\alpha^{n+2} + n\alpha^{n+3}-n\alpha^{n+2}}{(\alpha-1)^2}=\\
        &= \dfrac{\alpha^2}{(\alpha-1)^2}=\left(\dfrac{\alpha}{\alpha-1}\right)^2
        = \left(\dfrac{\alpha}{1-\alpha}\right)^2
    \end{align*}

    Resolvamos ahora por tanto el ejercicio. Tomando $\alpha=10^{-3}$, se tiene que:
    \begin{equation*}
        s_n = x_n = \sum_{k=0}^{n} \dfrac{k}{10^{3(k+1)}}
    \end{equation*}

    Tomando límite por tanto con $n\to \infty$, como $\alpha\in [0,1[$, se tiene:
    \begin{equation*}
        \sum_{k=0}^{\infty} \dfrac{k}{10^{3(k+1)}} = \lim_{n\to \infty} x_n
        = \left(\dfrac{10^{-3}}{1-10^{-3}}\right)^2
        = \left({1}{10^3-1}\right)^2
        = \dfrac{1}{999^2} = \dfrac{1}{998001}
    \end{equation*}
\end{ejercicio}



\begin{ejercicio}
    Demuestre mediante la teoría de recurrencias que $0.\ol{9}=1$.
    \begin{observacion}
        Observe que, sin mucho rigor, se podría tener lo siguiente:
        \begin{equation*}
            0.\ol{9} = 3\cdot 0.\ol{3} = 3\cdot \dfrac{1}{3} = 1
        \end{equation*}
    \end{observacion}
\end{ejercicio}

