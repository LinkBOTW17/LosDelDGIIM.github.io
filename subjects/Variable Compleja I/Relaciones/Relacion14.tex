\section{Residuos}

\begin{ejercicio}
    Probar que, para $a \in \left]0,1\right[$, se tiene:
    \begin{equation*}
        \int_0^{2\pi} \frac{\cos^2(3t)}{1 + a^2 - 2a \cos(2t)} \, dt = \pi\cdot \frac{a^2 - a + 1}{1 - a}.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Probar que, para $n \in \bb{N}$, se tiene:
    \begin{equation*}
        \int_0^{2\pi} \frac{(1 + 2\cos t)^n \cos(nt)}{3 + 2\cos t} \, dt = \dfrac{2\pi}{\sqrt{5}} \left(3 - \sqrt{5}\right)^n.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Probar que, para $n \in \bb{N}$, se tiene:
    \begin{equation*}
        \int_0^{2\pi} e^{\cos t} \cos\left(n t - \sen t\right) \, dt = \frac{2\pi}{n!}.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:14.4}
    Probar que, para cualesquiera $a, b \in \bb{R}^+$, se tiene:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{dx}{(x^2 + a^2)(x^2 + b^2)^2} = \pi\cdot \frac{(a + 2b)}{2ab^3(a + b)^2}.
    \end{equation*}

    Calculamos las raíces del denominador:
    \begin{align*}
        x^2 + a^2 &= 0 \implies x\in \{ai, -ai\}, \\
        (x^2 + b^2)^2 &= 0 \implies x^2 + b^2 = 0 \implies x\in \{bi, -bi\}.
    \end{align*}

    Por tanto, definimos $A=\{ai, -ai, bi, -bi\}$, y sea la siguiente función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{1}{(z^2 + a^2)(z^2 + b^2)^2}}
    
    Tenemos que $A'=\emptyset$, y $f\in \cc{H}(\bb{C}\setminus A)$, por lo que podemos aplicar el teorema de los residuos. Como $\bb{C}$ es homológicamente conexo puesto que $\bb{C}\setminus \bb{C}=\emptyset$, podemos aplicar el Teormea de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$. 
    
    Para cada $r>\max\{a,b\}$, consideramos el ciclo $\Sigma_r = \gamma_r + \sigma_r$, representado en la Figura~\ref{fig:ej:14.4}, donde:
    \Func{\gamma_r}{[-r, r]}{\bb{C}}{t}{t}
    \Func{\sigma_r}{[0, \pi]}{\bb{C}}{t}{re^{it}}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-3.5, xmax=3.5,
                ymin=-2, ymax=2,
                axis equal,
            ]
                \def\R{2}
                \def\A{1.5}
                \def\B{0.5}

                % Polos
                \draw[fill=red] (0, \A) circle (2pt) node[right] {$ai$};
                \draw[fill=red] (0, -\A) circle (2pt) node[right] {$-ai$};
                \draw[fill=teal] (0, \B) circle (2pt) node[right] {$bi$};
                \draw[fill=teal] (0, -\B) circle (2pt) node[right] {$-bi$};

                
                % sigma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) arc[start angle=0, end angle=180, radius=\R]
                    node[midway, below left, yshift=-1em, xshift=-1em] {$\sigma_r$};

                % gamma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (-\R, 0) -- (\R, 0)
                    node[pos=0.25, below] {$\gamma_r$};

                % Puntos de unión
                \draw[fill=blue] (-\R, 0) circle (2pt);
                \draw[fill=blue] (\R, 0) circle (2pt);

            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_r$ del Ejercicio~\ref{ej:14.4}.}
        \label{fig:ej:14.4}
    \end{figure}

    De esta forma, tenemos que:
    \begin{align*}
        \int_{\Sigma_r} f(z) \, dz &= \int_{\gamma_r} f(z) \, dz + \int_{\sigma_r} f(z) \, dz \\
        &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_r}(z_0)
    \end{align*}

    Calculemos las dos integrales que nos han resultado:
    \begin{align*}
        \int_{\gamma_r} f(z) \, dz &= \int_{-r}^{r} \frac{1}{(t^2 + a^2)(t^2 + b^2)^2} \, dt, \\
        \int_{\sigma_r} f(z) \, dz &= \int_0^{\pi} \frac{1}{(r^2 e^{2it} + a^2)(r^2 e^{2it} + b^2)^2} i r e^{it} \, dt.
    \end{align*}

    Notemos que la primera integral es la integral pedida, por lo que buscamos que la integral resultante de la segunda integral sea cero.
    \begin{align*}
        \left| \int_0^{\pi} \frac{1}{(r^2 e^{2it} + a^2)(r^2 e^{2it} + b^2)^2} i r e^{it} \, dt \right|
        \leq \pi\cdot \frac{r}{(r^2 - a^2)(r^2 - b^2)^2}
    \end{align*}
    donde hemos usado que $|e^{it}|=1$ y que, como $r>\max\{a,b\}>0$, tenemos que $r^2>\max\{a^2,b^2\}$, por lo que:
    \begin{align*}
        \left| r^2 e^{2it} + a^2 \right| &\geq \left||r^2 e^{2it}| - |a^2|\right| = \left| r^2 - a^2 \right| = r^2 - a^2
    \end{align*}

    Como la expresión anterior es válida para cualquier $r > \max\{a,b\}$, podemos hacer $r \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{r\to+\infty} \int_{\gamma_r} f(z) \, dz &= \int_{-\infty}^{+\infty} \frac{1}{(x^2 + a^2)(x^2 + b^2)^2} \, dx, \\
        \lim_{r\to+\infty} \int_{\sigma_r} f(z) \, dz &= 0.
    \end{align*}

    Calculamos en primer lugar los índices. Por la forma en la que se ha definido el ciclo $\Sigma_r$, para todo $r>\max\{a,b\}$, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_r}(ai) &= \Ind_{\Sigma_r}(bi) = 1\\
        \Ind_{\Sigma_r}(-ai) &= \Ind_{\Sigma_r}(-bi) = 0.
    \end{align*}

    Por tanto, tan solo hemos de calcular los residuos en los polos $ai$ y $bi$. Comenzamos por calcular el residuo en $ai$:
    \begin{align*}
        \lim_{z\to ai} (z - ai)f(z) &= \lim_{z\to ai} \frac{z - ai}{(z^2 + a^2)(z^2 + b^2)^2} \\
        &= \lim_{z\to ai} \dfrac{1}{(z + ai)(z^2 + b^2)^2} \\
        &= \dfrac{1}{(2ai)(-a^2 + b^2)^2} = \dfrac{1}{2ai(b^2 - a^2)^2}.
    \end{align*}

    Por tanto, deducimos que el orden del polo $ai$ es $1$, y que el residuo es:
    \begin{align*}
        \Res(f, ai) &= \dfrac{1}{2ai(b^2 - a^2)^2}
    \end{align*}

    Ahora, calculamos el residuo en $bi$:
    \begin{align*}
        \lim_{z\to bi} (z - bi)f(z) &= \lim_{z\to bi} \frac{z - bi}{(z^2 + a^2)(z^2 + b^2)^2} \\
        &= \lim_{z\to bi} \dfrac{1}{(z^2 + a^2)(z+bi)^2(z - bi)} = +\infty \\
        \lim_{z\to bi} (z-bi)^2 f(z) &= \lim_{z\to bi} \frac{1}{(z^2 + a^2)(z+bi)^2}\in \bb{C}^*
    \end{align*}
    Por tanto, deducimos que el orden del polo $bi$ es $2$. El residuo se calcula como:
    \begin{align*}
        \Res(f, bi) &= \dfrac{1}{1!} \lim_{z\to bi} \frac{d}{dz}\left((z - bi)^2 f(z)\right)
        = \lim_{z\to bi} \frac{d}{dz}\left(\frac{1}{(z^2 + a^2)(z+bi)^2}\right)
        =\\&= \lim_{z\to bi} -\frac{2z(z+bi)^2+2(z^2+a^2)(z+bi)}{(z^2 + a^2)^2(z+bi)^4}
        =\\&= \lim_{z\to bi} -\frac{2z(z+bi)+2(z^2+a^2)}{(z^2 + a^2)^2(z+bi)^3}
        = -\dfrac{2bi(2bi) + (a^2-b^2)}{(a^2-b^2)^2(2bi)^3}
        =\\&= -\dfrac{-4b^2 + 2(a^2-b^2)}{(a^2-b^2)^2\cdot 8bi(-b^2)}
        = \dfrac{-2b^2 + a^2-b^2}{(a^2-b^2)^2\cdot 4b^3i}
        = \dfrac{a^2-3b^2}{(b^2-a^2)^2\cdot 4b^3i}
    \end{align*}

    Por tanto, deducimos que el residuo en $bi$ es:
    \begin{align*}
        \Res(f, bi) &= \dfrac{a^2-3b^2}{(b^2-a^2)^2\cdot 4b^3i}
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \lim_{r\to+\infty} \int_{\Sigma_r} f(z) \, dz &= \int_{-\infty}^{+\infty} \frac{1}{(x^2 + a^2)(x^2 + b^2)^2} \, dx
        = 2\pi i\left(\Res(f, ai) + \Res(f, bi)\right)
        =\\&= 2\pi i\left(\dfrac{1}{2ai(b^2 - a^2)^2} + \dfrac{a^2-3b^2}{(b^2-a^2)^2\cdot 4b^3i}\right)
        =\\&= \dfrac{\pi}{a(b^2 - a^2)^2} + \dfrac{\pi(a^2-3b^2)}{(b^2-a^2)^2\cdot 2b^3}
        = \dfrac{\pi(2b^3 + a^3-3b^2a)}{2ab^3(b^2-a^2)^2}
        =\\&= \dfrac{\pi(b-a)^2(a+2b)}{2ab^3(b+a)^2(b-a)^2}
        = \dfrac{\pi(a+2b)}{2ab^3(b+a)^2}
    \end{align*}
    como queríamos demostrar.
\end{ejercicio}

\begin{ejercicio}\label{ej:14.5}
    Probar que, para $a \in \bb{R}^+$, se tiene:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{x^6}{(x^4 + a^4)^2} \, dx = \dfrac{3\pi\sqrt{2}}{8a}.
    \end{equation*}

    Calculamos las raíces del denominador:
    \begin{align*}
        (x^4 + a^4)^2 &= 0 \implies x^4 + a^4 = 0 \implies x\in A:=\left[\sqrt[4]{-1}\right]\cdot a = a\cdot \left\{e^{i\frac{\pi}{4}}, e^{i\frac{3\pi}{4}}, e^{i\frac{5\pi}{4}}, e^{i\frac{7\pi}{4}}\right\}
    \end{align*}

    En este tipo de ejercicios, buscamos que los polos del integrando tengan el menor orden posible, para que así a la hora de calcular los residuos, estos sean más sencillos. Por ello, en este caso no vamos a realizar el cálculo directamente, sino que antes vamos a aplicar esta idea. Es por ello que vamos a aplicar el método de Integración por Partes:
    \begin{equation*}
        \MetInt{u(x)=x^3\qquad u'(x)=3x^2}{v'(x)=\dfrac{x^3}{(x^4 + a^4)^2}\qquad v(x)=-\dfrac{1}{4}\cdot \dfrac{1}{x^4 + a^4}}
    \end{equation*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} \frac{x^6}{(x^4 + a^4)^2} \, dx &= -\frac{1}{4}\left[\dfrac{x^3}{x^4 + a^4}\right]_{-\infty}^{+\infty} + \frac{3}{4}\int_{-\infty}^{+\infty} \frac{x^2}{x^4 + a^4} \, dx
        = \frac{3}{4}\int_{-\infty}^{+\infty} \frac{x^2}{x^4 + a^4} \, dx.
    \end{align*}

    Por tanto, hemos reducido el orden de los polos del integrando. Ahora sí, definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{z^2}{z^4 + a^4}}
    donde $A$ es el conjunto de los cuatro polos que hemos calculado anteriormente. Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$.

    Para cada $r>a$, consideramos el ciclo $\Sigma_r = \gamma_r + \sigma_r$, representado en la Figura~\ref{fig:ej:14.5}, donde:
    \Func{\gamma_r}{[-r, r]}{\bb{C}}{t}{t}
    \Func{\sigma_r}{[0,\pi]}{\bb{C}}{t}{re^{it}}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-3.5, xmax=3.5,
                ymin=-1, ymax=1,
                axis equal,
            ]
                \def\R{2}
                \def\A{1}

                % Polos
                \draw[fill=red] (45:\A) circle (2pt) node[right] {$a e^{i\frac{\pi}{4}}$};
                \draw[fill=red] (135:\A) circle (2pt) node[left] {$a e^{i\frac{3\pi}{4}}$};
                \draw[fill=red] (225:\A) circle (2pt) node[below] {$a e^{i\frac{5\pi}{4}}$};
                \draw[fill=red] (315:\A) circle (2pt) node[below] {$a e^{i\frac{7\pi}{4}}$};


                % sigma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) arc[start angle=0, end angle=180, radius=\R]
                    node[midway, below left, yshift=-1em, xshift=-1em] {$\sigma_r$};

                % gamma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (-\R, 0) -- (\R, 0)
                    node[pos=0.25, below] {$\gamma_r$};

                % Puntos de unión
                \draw[fill=blue] (-\R, 0) circle (2pt);
                \draw[fill=blue] (\R, 0) circle (2pt);

            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_r$ del Ejercicio~\ref{ej:14.5}.}
        \label{fig:ej:14.5}
    \end{figure}

    De esta forma, tenemos que:
    \begin{align*}
        \int_{\Sigma_r} f(z) \, dz &= \int_{\gamma_r} f(z) \, dz + \int_{\sigma_r} f(z) \, dz \\
        &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_r}(z_0)
    \end{align*}

    Calculemos la primera integral que nos ha resultado:
    \begin{align*}
        \int_{\gamma_r} f(z) \, dz &= \int_{-r}^{r} \frac{t^2}{t^4 + a^4} \, dt
    \end{align*}

    Notemos que es la integral pedida, por lo que buscamos que la integral resultante de la segunda integral sea cero.
    \begin{align*}
        \left| \int_{\sigma_r} f(z) \, dz \right|
        &\leq \pi r\cdot \sup\left\{\left|\dfrac{z^2}{z^4 + a^4}\right| : z\in \sigma_r^*\right\}
        \leq \pi r\cdot \frac{r^2}{r^4 - a^4}
        = \pi \cdot \frac{r^3}{r^4 - a^4}
    \end{align*}
    donde hemos usado que, si $z\in \sigma_r^*$, entonces $|z|=r$ y, como $r>a>0$, tenemos que $r^4>a^4$, por lo que:
    \begin{align*}
        |z^4 + a^4| &\geq \left||z^4| - |a^4|\right| = \left|r^4 - a^4\right| = r^4 - a^4.
    \end{align*}

    Como la expresión anterior es válida para cualquier $r > a$, podemos hacer $r \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{r\to+\infty} \int_{\gamma_r} f(z) \, dz &= \int_{-\infty}^{+\infty} \frac{x^2}{x^4 + a^4} \, dx, \\
        \lim_{r\to+\infty} \int_{\sigma_r} f(z) \, dz &= 0.
    \end{align*}

    Calculamos en primer lugar los índices. Por la forma en la que se ha definido el ciclo $\Sigma_r$, para todo $r>a$, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_r}(a e^{i\frac{\pi}{4}}) &= \Ind_{\Sigma_r}(a e^{i\frac{3\pi}{4}}) = 1\\
        \Ind_{\Sigma_r}(a e^{i\frac{5\pi}{4}}) &= \Ind_{\Sigma_r}(a e^{i\frac{7\pi}{4}}) = 0.
    \end{align*}

    Por tanto, tan solo hemos de calcular los residuos en los polos $a e^{i\frac{\pi}{4}}$ y $a e^{i\frac{3\pi}{4}}$. Comenzamos por calcular el residuo en $a e^{i\frac{\pi}{4}}$:
    \begin{align*}
        \lim_{z\to a e^{i\frac{\pi}{4}}} (z - a e^{i\frac{\pi}{4}})f(z) &= \lim_{z\to a e^{i\frac{\pi}{4}}} \frac{z^2}{(z-a e^{i\frac{3\pi}{4}})(z-a e^{i\frac{5\pi}{4}})(z-a e^{i\frac{7\pi}{4}})}
        =\\&= \dfrac{a^2e^{i\frac{\pi}{2}}}{(a e^{i\frac{\pi}{4}} - a e^{i\frac{3\pi}{4}})(a e^{i\frac{\pi}{4}} - a e^{i\frac{5\pi}{4}})(a e^{i\frac{\pi}{4}} - a e^{i\frac{7\pi}{4}})}
        =\\&= \dfrac{i}{a\left(e^{i\frac{\pi}{4}} - e^{i\frac{3\pi}{4}}\right)\left(e^{i\frac{\pi}{4}} - e^{i\frac{5\pi}{4}}\right)\left(e^{i\frac{\pi}{4}} - e^{i\frac{7\pi}{4}}\right)}
        =\\&= \dfrac{i}{a\left(\sqrt{2}\right)\left(\sqrt{2} + \sqrt{2}i\right)\left(\sqrt{2}i\right)}
        = \dfrac{1}{2\sqrt{2}a\left(1 + i\right)}\in \bb{C}^*
    \end{align*}

    Por tanto, deducimos que el orden del polo $a e^{i\frac{\pi}{4}}$ es $1$, y que el residuo es:
    \begin{align*}
        \Res(f, a e^{i\frac{\pi}{4}}) &= \dfrac{1}{2\sqrt{2}a(1 + i)}
        = \dfrac{1-i}{4\sqrt{2}a}
    \end{align*}

    Ahora, calculamos el residuo en $a e^{i\frac{3\pi}{4}}$:
    \begin{align*}
        \lim_{z\to a e^{i\frac{3\pi}{4}}} (z - a e^{i\frac{3\pi}{4}})f(z) &= \lim_{z\to a e^{i\frac{3\pi}{4}}} \frac{z^2}{(z-a e^{i\frac{\pi}{4}})(z-a e^{i\frac{5\pi}{4}})(z-a e^{i\frac{7\pi}{4}})}
        =\\&= \dfrac{a^2e^{i\frac{3\pi}{2}}}{(a e^{i\frac{3\pi}{4}} - a e^{i\frac{\pi}{4}})(a e^{i\frac{3\pi}{4}} - a e^{i\frac{5\pi}{4}})(a e^{i\frac{3\pi}{4}} - a e^{i\frac{7\pi}{4}})}
        =\\&= \dfrac{-ia^2}{a^3\left(e^{i\frac{3\pi}{4}} - e^{i\frac{\pi}{4}}\right)\left(e^{i\frac{3\pi}{4}} - e^{i\frac{5\pi}{4}}\right)\left(e^{i\frac{3\pi}{4}} - e^{i\frac{7\pi}{4}}\right)}
        =\\&= \dfrac{-i}{a\left(-\sqrt{2}\right)\left(\sqrt{2}i\right)\left(-\sqrt{2} + \sqrt{2}i\right)}
        = \dfrac{1}{2\sqrt{2}a\left(-1 + i\right)}\in \bb{C}^*
    \end{align*}

    Por tanto, deducimos que el orden del polo $a e^{i\frac{3\pi}{4}}$ es $1$, y que el residuo es:
    \begin{align*}
        \Res(f, a e^{i\frac{3\pi}{4}}) &= \dfrac{1}{2\sqrt{2}a(-1 + i)}
        = -\dfrac{1+i}{4\sqrt{2}a}
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \lim_{r\to+\infty} \int_{\Sigma_r} f(z) \, dz &= \int_{-\infty}^{+\infty} \frac{x^2}{x^4 + a^4} \, dx
        = 2\pi i\left(\Res(f, a e^{i\frac{\pi}{4}}) + \Res(f, a e^{i\frac{3\pi}{4}})\right)
        =\\&= 2\pi i\left(\dfrac{1-i}{4\sqrt{2}a} - \dfrac{1+i}{4\sqrt{2}a}\right)
        = 2\pi i\left(\dfrac{-2i}{4\sqrt{2}a}\right)
        = \dfrac{\pi}{\sqrt{2}a} = \dfrac{\pi\sqrt{2}}{2a}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} \frac{x^6}{(x^4 + a^4)^2} \, dx &= \frac{3}{4}\int_{-\infty}^{+\infty} \frac{x^2}{x^4 + a^4} \, dx
        = \frac{3}{4}\cdot \dfrac{\pi\sqrt{2}}{2a}
        = \dfrac{3\pi\sqrt{2}}{8a},
    \end{align*}
    como queríamos demostrar.
\end{ejercicio}

\begin{ejercicio}\label{ej:14.6}
    Sea $n \in \bb{N}$ con $n > 2$, integrar una conveniente función sobre un camino cerrado que recorra la frontera del siguiente sector circular $$D(0,R) \cap \{z \in \bb{C}^* : 0 < \arg z < \nicefrac{2\pi}{n}\}$$
    con $R \in \bb{R}^+$, para probar que:
    \begin{equation*}
        \int_0^{+\infty} \frac{dx}{1 + x^n} = \frac{\pi}{n}\csc\left(\frac{\pi}{n}\right).
    \end{equation*}

    Calculamos las raíces del denominador:
    \begin{align*}
        1 + x^n &= 0 \implies x^n = -1 \implies x\in A:=\left\{e^{i\frac{\pi + 2k\pi}{n}} : k=0, 1, \ldots, n-1\right\}.
    \end{align*}

    Por simplicidad, notaremos por $x_i = e^{i\frac{\pi + 2i\pi}{n}}$ los polos, para $i=0, 1, \ldots, n-1$. De esta forma, tenemos que:
    \begin{equation*}
        A=\left\{x_0, x_1, \ldots, x_{n-1}\right\}
    \end{equation*}

    Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{1}{1 + z^n}}

    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$.

    Para todo $R > 1$, consideramos el siguiente ciclo $\Sigma_R = \gamma_R + \sigma_R + (- \tau_R)$, representado en la Figura~\ref{fig:ej:14.6}, donde:
    \Func{\gamma_R}{[0, R]}{\bb{C}}{t}{t}
    \Func{\sigma_R}{[0, \nicefrac{2\pi}{n}]}{\bb{C}}{t}{Re^{it}}
    \Func{\tau_R}{[0,R]}{\bb{C}}{t}{te^{i\nicefrac{2\pi}{n}}}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-3.5, xmax=3.5,
                ymin=-1, ymax=1,
                axis equal,
            ]
                \def\R{2.4}
                \def\n{6}
                \def\x{0}
                \def\y{0}

                % Polos
                % Representamos los polos en bucle
                \foreach \k in {0,...,\numexpr\n-1\relax} {
                    \pgfmathsetmacro{\angle}{180*(1+2*\k)/\n}
                    \pgfmathsetmacro{\x}{cos(\angle)}
                    \pgfmathsetmacro{\y}{sin(\angle)}
                    \pgfmathsetmacro{\labelx}{\x + 0.5*cos(\angle)} % Offset for label
                    \pgfmathsetmacro{\labely}{\y + 0.5*sin(\angle)} % Offset for label
                    \edef\temp{\noexpand\node[font=\noexpand\footnotesize] at (axis cs:\labelx,\labely) {$e^{i\frac{\pi + 2 \cdot \k \cdot \pi}{\n}}$};}
                    \edef\temp2{\noexpand\node[font=\noexpand\footnotesize] at (axis cs:\labelx,\labely) {$x_{\k}$};}
                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=red},
                    ] coordinates {(\x, \y)};
                    %\temp
                    \temp2
                }

                \draw[dashed] (1, 0) arc[start angle=0, end angle=360, radius=1]
                    node[font=\footnotesize, pos=0.3, yshift=-0.8em] {$C(0,1)$};
                \draw[dashed] (\R, 0) arc[start angle=0, end angle=360, radius=\R]
                    node[pos=0.28, below left, yshift=-10em, xshift=-1em] {$C(0,R)$};
                
                
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) arc[start angle=0, end angle={360/\n}, radius=\R]
                    node[midway, below left, yshift=-1em, xshift=-1em] {$\sigma_r$};

                % gamma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (0, 0) -- (\R, 0)
                    node[pos=0.25, below] {$\gamma_r$};


                % tau_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] ({\R*cos(360/\n)}, {\R*sin(360/\n)}) -- (0, 0) node[pos=0.25, below, yshift=-0.2em, xshift=0.3em] {$-\tau_r$};

                % Puntos de unión
                \draw[fill=blue] (0, 0) circle (2pt);
                \draw[fill=blue] (\R, 0) circle (2pt);
                \draw[fill=blue] ({\R*cos(360/\n)}, {\R*sin(360/\n)}) circle (2pt);

            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_R$ del Ejercicio~\ref{ej:14.6}.}
        \label{fig:ej:14.6}
    \end{figure}

    De esta forma, tenemos que:
    \begin{align*}
        \int_{\Sigma_R} f(z) \, dz &= \int_{\gamma_R} f(z) \, dz + \int_{\sigma_R} f(z) \, dz + \int_{-\tau_R} f(z) \, dz \\
        &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_R}(z_0)
    \end{align*}

    Calculemos la primera integral que nos ha resultado:
    \begin{align*}
        \int_{\gamma_R} f(z) \, dz &= \int_{0}^{R} \frac{1}{1 + t^n} \, dt
    \end{align*}
    Notemos que es la integral pedida, por lo que buscamos que las integrales resultantes de las otras dos integrales sean cero.
    \begin{align*}
        \left| \int_{\sigma_R} f(z) \, dz \right|
        &\leq \frac{2\pi R}{n}\cdot \sup\left\{\left|\dfrac{1}{1 + z^n}\right| : z\in \sigma_R^*\right\}
        = \frac{2\pi R}{n}\cdot \frac{1}{R^n - 1}
        = \frac{2\pi}{n(R^{n-1} - \nicefrac{1}{R})}
    \end{align*}
    donde hemos usado que, si $z\in \sigma_R^*$, entonces $|z|=R$ y, como $R>1$, tenemos que $R^n>1$, por lo que:
    \begin{align*}
        |1 + z^n| &\geq \left|1- |z|^n\right| = \left|1 - R^n\right| = R^n - 1.
    \end{align*}
    Como la expresión anterior es válida para cualquier $R > 1$, podemos hacer $R \to +\infty$ y tenemos que (usando que $n > 2$):
    \begin{align*}
        \lim_{R\to+\infty} \int_{\sigma_R} f(z) \, dz &= 0.
    \end{align*}

    Calculamos ahora la tercera integral:
    \begin{align*}
        \int_{-\tau_R} f(z) \, dz &= -\int_{\tau_R} f(z) \, dz
        = -\int_{0}^{R} \frac{e^{i\frac{2\pi}{n}}}{1 + (e^{i\frac{2\pi}{n}}t)^n} \, dt
        = -e^{i\frac{2\pi}{n}}\int_{0}^{R} \frac{1}{1 + t^n} \, dt
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{\Sigma_R} f(z) \, dz &= \int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt + - e^{i\frac{2\pi}{n}}\int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt
        = \left(1 - e^{i\frac{2\pi}{n}}\right)\int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt.
    \end{align*}

    Calculamos ahora los índices. Por la forma en la que se ha definido el ciclo $\Sigma_R$, para todo $R > 1$, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_R}(x_0) &= 1\\
        \Ind_{\Sigma_R}(x_i) &= 0 \quad \text{para } i=1, \ldots, n-1.
    \end{align*}

    Por tanto, tan solo hemos de calcular el residuo en el polo $x_0 = e^{i\frac{\pi}{n}}$. Como $1+x_0^n = 0$, por la Regla de L'Hôpital, tenemos que:
    \begin{align*}
        \lim_{z\to x_0} (z - x_0)f(z) &= \lim_{z\to x_0} \frac{z - x_0}{1 + z^n}
        = \lim_{z\to x_0} \frac{1}{n z^{n-1}} = \frac{1}{n x_0^{n-1}}.
    \end{align*}
    Por tanto, deducimos que el orden del polo $x_0$ es $1$, y que el residuo es:
    \begin{align*}
        \Res(f, x_0) &= \frac{1}{n x_0^{n-1}} = \frac{1}{n e^{i\frac{(n-1)\pi}{n}}} = \frac{e^{-i\frac{(n-1)\pi}{n}}}{n}
        = -\frac{e^{i\frac{\pi}{n}}}{n}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{\Sigma_R} f(z) \, dz &= \left(1 - e^{i\frac{2\pi}{n}}\right)\int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt
        = 2\pi i\left(\Res(f, x_0)\right)\Ind_{\Sigma_R}(x_0)
        = 2\pi i\left(-\frac{e^{i\frac{\pi}{n}}}{n}\right).
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt &= -\frac{2\pi i e^{i\frac{\pi}{n}}}{n\left(1 - e^{i\frac{2\pi}{n}}\right)}
        = -\frac{2\pi i}{n} \cdot \frac{1}{e^{-i\frac{\pi}{n}} - e^{i\frac{\pi}{n}}}
    \end{align*}

    Veamos qué valor toma el denominador, puesto que buscamos que sea la cosecante:
    \begin{align*}
        e^{-i\frac{\pi}{n}} - e^{i\frac{\pi}{n}} &= \cos\left(-\frac{\pi}{n}\right) + i\sen\left(-\frac{\pi}{n}\right) - \left(\cos\left(\frac{\pi}{n}\right) + i\sen\left(\frac{\pi}{n}\right)\right)
    \end{align*}
    donde hemos usado que $\cos(-x) = \cos(x)$ y $\sen(-x) = -\sen(x)$. Por tanto, tenemos que:
    \begin{align*}
        e^{-i\frac{\pi}{n}} - e^{i\frac{\pi}{n}} &= -2i\sen\left(\frac{\pi}{n}\right).
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{0}^{+\infty} \frac{1}{1 + t^n} \, dt &= -\frac{2\pi i}{n} \cdot \frac{1}{-2i\sen\left(\frac{\pi}{n}\right)}
        = \frac{\pi}{n}\csc\left(\frac{\pi}{n}\right),
    \end{align*}
    como queríamos demostrar.
\end{ejercicio}

\begin{ejercicio}\label{ej:14.7}
    Probar que, para $a, t \in \bb{R}^+$, se tiene:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{\cos(tx)}{(x^2 + a^2)^2} \, dx = \frac{\pi}{2a^3}(1 + a t)e^{-a t}.
    \end{equation*}

    Calculamos las raíces del denominador:
    \begin{align*}
        x^2 + a^2 &= 0 \implies x^2 = -a^2 \implies x\in A:=\left\{-ai, ai\right\}.
    \end{align*}

    Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{e^{i t z}}{(z^2 + a^2)^2}}
    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$.

    Para todo $R > a$, consideramos el siguiente ciclo $\Sigma_R = \gamma_R + \sigma_R$, representado en la Figura~\ref{fig:ej:14.7}, donde:
    \Func{\gamma_R}{[-R, R]}{\bb{C}}{t}{t}
    \Func{\sigma_R}{[0, \pi]}{\bb{C}}{t}{Re^{it}}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-3.5, xmax=3.5,
                ymin=-1, ymax=1,
                axis equal,
            ]
                \def\R{2.4}
                \def\a{1}

                % Polos
                \draw[fill=red] (0, -\a) circle (2pt) node[right] {$-ai$};
                \draw[fill=red] (0, \a) circle (2pt) node[right] {$ai$};

                % sigma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) arc[start angle=0, end angle=180, radius=\R]
                    node[midway, below left, yshift=-1em, xshift=-1em] {$\sigma_r$};

                % gamma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (-\R, 0) -- (\R, 0)
                    node[pos=0.25, below] {$\gamma_r$};

                % Puntos de unión
                \draw[fill=blue] (-\R, 0) circle (2pt);
                \draw[fill=blue] (\R, 0) circle (2pt);

            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_R$ del Ejercicio~\ref{ej:14.7}.}
        \label{fig:ej:14.7}
    \end{figure}

    De esta forma, tenemos que:
    \begin{align*}
        \int_{\Sigma_R} f(z) \, dz &= \int_{\gamma_R} f(z) \, dz + \int_{\sigma_R} f(z) \, dz
        = 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_R}(z_0)
    \end{align*}

    Calculemos la primera integral que nos ha resultado:
    \begin{align*}
        \int_{\gamma_R} f(z) \, dz &= \int_{-R}^{R} \frac{e^{i t z}}{(z^2 + a^2)^2} \, dz
        = \int_{-R}^{R} \frac{\cos(t z)}{(z^2 + a^2)^2} \, dz
        + i\int_{-R}^{R} \frac{\sen(t z)}{(z^2 + a^2)^2} \, dz
    \end{align*}

    Notemos que la integral pedida es la parte real de la integral. Veamos la siguiente integral:
    \begin{align*}
        \int_{\sigma_R} f(z) \, dz &\leq \pi R\cdot \sup\left\{\left|\dfrac{e^{i t z}}{(z^2 + a^2)^2}\right| : z\in \sigma_R^*\right\}
        \leq \frac{\pi R}{(R^2 - a^2)^2}
    \end{align*}
    donde hemos usado que, si $z\in \sigma_R^*$, entonces $|z|=R$ y, como $R>a>0$, tenemos que $R^2>a^2$, por lo que:
    \begin{align*}
        |z^2 + a^2| &\geq \left||z^2| - |a^2|\right| = \left|R^2 - a^2\right| = R^2 - a^2\\
        |e^{i t z}| &=e^{-t\Im(z)}\leq e^0 = 1.
    \end{align*}
    Por tanto, como la expresión anterior es válida para cualquier $R > a$, podemos hacer $R \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{\sigma_R} f(z) \, dz &= 0.
    \end{align*}

    Calculamos ahora los índices. Por la forma en la que se ha definido el ciclo $\Sigma_R$, para todo $R > a$, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_R}(-ai) &= 0\\
        \Ind_{\Sigma_R}(ai) &= 1.
    \end{align*}

    Por tanto, tan solo hemos de calcular el residuo en el polo $ai$.
    \begin{align*}
        \lim_{z\to ai} (z - ai)f(z) &= \lim_{z\to ai} (z - ai)\cdot \frac{e^{i t z}}{[(z - ai)(z + ai)]^2}
        = \lim_{z\to ai} \frac{e^{i t z}}{(z + ai)^2(z - ai)} = +\infty.\\
        \lim_{z\to ai} (z - ai)^2f(z) &= \lim_{z\to ai} \frac{e^{i t z}}{(z + ai)^2}
        = \frac{e^{i t ai}}{(2ai)^2} = \frac{e^{-at}}{-4a^2} = -\frac{e^{-at}}{4a^2}\in \bb{C}^*
    \end{align*}

    Por tanto, deducimos que el orden del polo $ai$ es $2$, y que el residuo es:
    \begin{align*}
        \Res(f, ai) &= \lim_{z\to ai} \dfrac{d}{dz}\left((z - ai)^2f(z)\right)
        = \lim_{z\to ai} \dfrac{d}{dz}\left(\frac{e^{i t z}}{(z + ai)^2}\right)
        =\\&= \lim_{z\to ai} \frac{i t e^{i t z}(z + ai)^2 - e^{i t z}\cdot 2(z + ai)}{(z + ai)^4}
        = \lim_{z\to ai} \frac{i t e^{i t z}(z + ai) - 2e^{i t z}}{(z + ai)^3}
        =\\&=  \lim_{z\to ai} e^{i t z} \frac{i t (z + ai) - 2}{(z + ai)^3}
        = e^{-at}\cdot \dfrac{i t (2ai) - 2}{(2ai)^3}
        = e^{-at}\cdot \dfrac{-at -1}{-4a^3i}
        = e^{-at}\cdot \dfrac{at+1}{4a^3i}
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{\Sigma_R} f(z) \, dz &= 2\pi i\left(e^{-at}\cdot \frac{at + 1}{4a^3i} \cdot 1\right)
        = \frac{\pi\cdot e^{-at}(at + 1)}{2a^3}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-R}^{R} \frac{\cos(t z)}{(z^2 + a^2)^2} \, dz + i\int_{-R}^{R} \frac{\sen(t z)}{(z^2 + a^2)^2} \, dz + \int_{\sigma_R} f(z) \, dz &= \frac{\pi\cdot e^{-at}(at + 1)}{2a^3}.
    \end{align*}

    Como esta expresión es válida para cualquier $R > a$, podemos hacer $R \to +\infty$ y tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} \frac{\cos(t z)}{(z^2 + a^2)^2} \, dz + i\int_{-\infty}^{+\infty} \frac{\sen(t z)}{(z^2 + a^2)^2} \, dz &= \frac{\pi\cdot e^{-at}(at + 1)}{2a^3}.
    \end{align*}

    Igualando las partes reales, tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} \frac{\cos(t z)}{(z^2 + a^2)^2} \, dz &= \frac{\pi\cdot e^{-at}(at + 1)}{2a^3}.
    \end{align*}
    como queríamos demostrar.
\end{ejercicio}

\begin{ejercicio}\label{ej:14.8}
    Probar que:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{x\sen(\pi x)}{x^2-5x+6} \, dx = -5\pi.
    \end{equation*}
    \begin{observacion}
        Para resolver este ejercicio, se puede integrar la función $\frac{ze^{i\pi z}}{z^2-5z+6}$ en un semicírculo retocado (que rodee los polos de la función).
    \end{observacion}

    Calculamos las raíces del denominador:
    \begin{align*}
        x^2 - 5x + 6 &= 0 \implies x \in \frac{5\pm\sqrt{25 - 24}}{2} = \frac{5\pm 1}{2} = \left\{3, 2\right\}.
    \end{align*}

    Sea por tanto $A = \{2, 3\}$. Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{z e^{i \pi z}}{z^2 - 5z + 6}}

    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$.

    Para todo $R > 3$, y $\veps\in \bb{R}^+$ suficientemente pequeño para que:
    \begin{equation*}
        [2-\veps, 2+\veps] \cap [3-\veps, 3+\veps] = \emptyset,
        \qquad R > 3 + \veps,
    \end{equation*}
    consideramos el siguiente ciclo $\Sigma_{R,\veps}$ representado en la Figura~\ref{fig:ej:14.8}, donde:
    \begin{align*}
        \Sigma_{R,\veps} &= [-R, 2-\veps] + \sigma_{2} + [2+\veps, 3-\veps] + \sigma_{3} + [3+\veps, R] + [R, R+iR] - [-R+iR, R+iR] - [-R, -R + iR]
    \end{align*}
    \Func{[-R, 2-\veps]}{[-R, 2-\veps]}{\bb{C}}{t}{t}
    \Func{\sigma_{2}}{[0, \pi]}{\bb{C}}{t}{2 + \veps e^{it}}
    \Func{[2+\veps, 3-\veps]}{[2+\veps, 3-\veps]}{\bb{C}}{t}{t}
    \Func{\sigma_{3}}{[0, \pi]}{\bb{C}}{t}{3 + \veps e^{it}}
    \Func{[3+\veps, R]}{[3+\veps, R]}{\bb{C}}{t}{t}
    \Func{[R, R+iR]}{[0, R]}{\bb{C}}{t}{R + it}
    \Func{[-R+iR, R+iR]}{[-R, R]}{\bb{C}}{t}{t + iR}
    \Func{[-R, -R+iR]}{[,R]}{\bb{C}}{t}{-R + it}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-3.5, xmax=3.5,
                ymin=-1, ymax=3.5,
                axis equal,
                clip=false,
            ]
                \def\R{3}
                \def\e{0.6}
                \def\A{0.5}
                \def\B{2}

                % Polos
                \draw[fill=red] (\A, 0) circle (2pt) node[below] {$2$};
                \draw[fill=red] (\B, 0) circle (2pt) node[below] {$3$};

                % [-R, 2-\veps]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (-\R, 0) -- (\A - \e, 0)
                    node[pos=0.5, below] {$[-R, 2-\veps]$};

                % sigma_2
                \draw[thick, blue, arrow at 2/3] (\A - \e, 0) arc[start angle=180, end angle=0, radius=\e];

                % [2+\veps, 3-\veps]
                \draw[thick, blue] (\A + \e, 0) -- (\B - \e, 0);
                
                % sigma_3
                \draw[thick, blue, arrow at 2/3] (\B - \e, 0) arc[start angle=180, end angle=0, radius=\e];

                % [3+\veps, R]
                \draw[thick, blue] (\B + \e, 0) -- (\R, 0);

                % [R, R+iR]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) -- (\R, \R)
                    node[pos=0.5, right] {$[R, R+iR]$};
                % [-R+iR, R+iR]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, \R) -- (-\R, \R)
                    node[pos=0.5, above] {$-[-R+iR, R+iR]$};
                % [-R, -R+iR]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3]  (-\R, \R) -- (-\R, 0)
                    node[pos=0.5, left] {$-[-R, -R+iR]$};

                % Puntos de unión
                \draw[fill=blue] (-\R, 0) circle (2pt);
                \draw[fill=blue] (\A - \e, 0) circle (2pt);
                \draw[fill=blue] (\A + \e, 0) circle (2pt);
                \draw[fill=blue] (\B - \e, 0) circle (2pt);
                \draw[fill=blue] (\B + \e, 0) circle (2pt);
                \draw[fill=blue] (\R, 0) circle (2pt);


                % Marca del veps
                \draw[thick, dashed, -Stealth, teal] (\A, 0) -- (\A, \e)
                    node[above, pos=1] {$\varepsilon$};
                \draw[thick, dashed, -Stealth, teal] (\B, 0) -- (\B, \e)
                    node[above, pos=1] {$\varepsilon$};
            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_R$ del Ejercicio~\ref{ej:14.8}.}
        \label{fig:ej:14.8}
    \end{figure}

    Calculemos en primer lugar los índices de los polos. Puesto que, debido a la forma en la que se ha definido el ciclo $\Sigma_R$, para todo $R > 3$ y todo $\veps > 0$ suficientemente pequeño, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_R}(2) = \Ind_{\Sigma_R}(3) = 0
    \end{align*}

    Por tanto, por el Teorema de los Residuos, tenemos que:
    \begin{align*}
        \int_{\Sigma_R} f(z) \, dz &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_R}(z_0) = 0.
    \end{align*}

    Para calcular la integral sobre los retoques, aplicamos la siguiente proposición:
    \begin{prop}
        Sea $f\in \cc{H}(\bb{C}\setminus \{a\}$, y $a\in \bb{C}$ un polo de orden $1$ de $f$. Fijados $\alpha,\beta\in \bb{R}$, con $\alpha < \beta$, para cada $\veps\in \bb{R}^+$ definimos:
        \Func{\gamma_\veps}{[\alpha, \beta]}{\bb{C}}{t}{a + \veps e^{it}}

        Notemos que $\gamma_\veps$ es el sector circular de radio $\veps$ centrado en $a$ y que une los puntos $a + \veps e^{i\alpha}$ y $a + \veps e^{i\beta}$.

        Entonces:
        \begin{equation*}
            \lim_{\veps\to 0} \int_{\gamma_\veps} f(z) \, dz = i(\beta-\alpha)\Res(f,a).
        \end{equation*}
        \begin{proof}
            Como $f$ tiene un polo de orden $1$ en $a$, $\exists \Psi\in \cc{H}(\bb{C})$, con $\Psi(a) \neq 0$, tal que:
            \begin{equation*}
                f(z) = \frac{\Psi(z)}{z-a}, \quad z\in \Omega\setminus \{a\}.
            \end{equation*}

            Entonces:
            \begin{align*}
                \int_{\gamma_\veps} f(z) \, dz &= \int_{\alpha}^{\beta} \frac{\Psi(a + \veps e^{it})}{a+\veps e^{it} - a} \cdot \veps i e^{it} \, dt
                = i\int_{\alpha}^{\beta} \Psi(a + \veps e^{it}) e^{it} \, dt
            \end{align*}

            Tomando el límite cuando $\veps\to 0$, tenemos que:
            \begin{align*}
                \lim_{\veps\to 0} \int_{\gamma_\veps} f(z) \, dz &= i\lim_{\veps\to 0} \int_{\alpha}^{\beta} \Psi(a + \veps e^{it}) e^{it} \, dt
                = i\int_{\alpha}^{\beta} \Psi(a) = i(\beta - \alpha)\Psi(a)
            \end{align*}

            Calculamos ahora el residuo:
            \begin{align*}
                \Res(f,a) &= \lim_{z\to a} (z-a)f(z) = \lim_{z\to a} (z-a)\cdot \frac{\Psi(z)}{z-a} = \Psi(a).
            \end{align*}

            Por tanto, tenemos que:
            \begin{align*}
                \lim_{\veps\to 0} \int_{\gamma_\veps} f(z) \, dz &= i(\beta - \alpha)\Res(f,a).
            \end{align*}
        \end{proof}
    \end{prop}

    Por tanto, usando la proposición anterior, tenemos que:
    \begin{align*}
        \lim_{\veps\to 0} \int_{\sigma_{2}} f(z) \, dz &= i\pi\Res(f,2)\\
        \lim_{\veps\to 0} \int_{\sigma_{3}} f(z) \, dz &= i\pi\Res(f,3).
    \end{align*}

    Calculamos ahora qué ocurre en el segmento $[-R,R]$:
    \begin{align*}
        \lim_{\veps\to 0} \int_{[-R, 2-\veps]} f(z) \, dz + \int_{[2+\veps, 3-\veps]} f(z) \, dz + \int_{[3+\veps, R]} f(z) \, dz &= \int_{-R}^{R} f(z) \, dz
    \end{align*}

    Faltaría comprobar (compruébese) que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{[R, R+iR]} f(z) \, dz - \int_{[-R+iR, R+iR]} f(z) \, dz - \int_{[-R, -R+iR]} f(z) \, dz &= 0.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        0 &= \int_{-\infty}^{+\infty} f(z) \, dz + i\pi\Res(f,2) + i\pi\Res(f,3)
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    Integrando la función $z \mapsto \frac{1-e^{2i z}}{z^2}$ sobre un camino cerrado que recorra la frontera de la mitad superior del anillo $A(0; \varepsilon, R)$, probar que:
    \begin{equation*}
        \int_0^{+\infty} \frac{\sen^2(x)}{x^2} \, dx = \frac{\pi}{2}.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:14.10}
    Dado $a \in \bb{R}$ con $a > 1$, integrar la función $z \mapsto \frac{z}{a - e^{-i z}}$ sobre la poligonal $\left[-\pi, \pi, \pi + i n, -\pi + i n, -\pi\right]$, con $n \in \bb{N}$, para probar que:
    \begin{equation*}
        \int_{-\pi}^{\pi} \frac{x\sen(x)}{1 + a^2 - 2a\cos(x)} \, dx = \frac{2\pi}{a}\log\left(\frac{1 + a}{a}\right).
    \end{equation*}

    En primer lugar, veamos en qué puntos se anula el denominador de mi función a integrar:
    \begin{align*}
        a - e^{-i z} &= 0 \implies e^{-i z} = a \implies -iz\in \Log(a)=\ln a + 2\pi i \bb{Z}
        \implies z \in -2\pi \bb{Z} + i\ln a.
    \end{align*}

    Sea por tanto $A = -2\pi \bb{Z} + i\ln a$. Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{z}{a - e^{-i z}}}

    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$.
    
    Para todo $n \in \bb{N},~n>\ln a$, consideramos la poligonal siguiente:
    \begin{align*}
        \Sigma_n &= [-\pi, \pi] + [\pi, \pi + i n] + [\pi + i n, -\pi + i n] + [-\pi + i n, -\pi]
        =\\&= [-\pi, \pi] + [\pi, \pi + i n] - [-\pi + i n, \pi + i n] - [-\pi, -\pi + i n]
    \end{align*}
    representada en la Figura~\ref{fig:ej:14.10}, donde:
    \Func{[-\pi, \pi]}{[-\pi, \pi]}{\bb{C}}{t}{t}
    \Func{[\pi, \pi + i n]}{[0, n]}{\bb{C}}{t}{\pi + i t}
    \Func{[-\pi + i n, \pi + i n]}{[-\pi, \pi]}{\bb{C}}{t}{t + i n}
    \Func{[-\pi, -\pi + i n]}{[0, n]}{\bb{C}}{t}{- \pi + i t}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-4, xmax=4,
                ymin=-1, ymax=3.5,
                axis equal image,
                clip=false,
            ]
                \def\B{pi}
                \def\A{-\B}
                \def\n{2}
                \def\a{3}

                
                % Calculamos ln a
                \pgfmathsetmacro{\lnA}{ln(\a)}

                
                %-2*\k*\B, \lnA

                % Polos
                \foreach \k in {0} {
                    \addplot[only marks, mark=*, mark options={fill=red}, samples=1] coordinates {(-2*\k*\B, \lnA)} 
                        node[right, font=\footnotesize] {$i \ln a$};
                }

                % [-\pi, \pi]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\A, 0) -- (\B, 0)
                    node[pos=0.8, below, font=\footnotesize] {$[-\pi, \pi]$};

                % [\pi, \pi + i n]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\B, 0) -- (\B, \n)
                    node[pos=0.5, right, font=\footnotesize] {$[\pi, \pi + i n]$};

                % [-\pi + i n, \pi + i n]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\B, \n) -- (\A, \n)
                    node[pos=1, above, font=\footnotesize] {$-[-\pi + i n, \pi + i n]$};

                % [-\pi, -\pi + i n]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\A, \n) -- (\A, 0)
                    node[pos=0.5, left, xshift=0em, font=\footnotesize] {$-[-\pi, -\pi + i n] $};

            \end{axis}
        \end{tikzpicture}
        \caption{Poligonal de integración $\Sigma_n$ del Ejercicio~\ref{ej:14.10}.}
        \label{fig:ej:14.10}
    \end{figure}

    Por el Teorema de los Residuos, tenemos que:
    \begin{align*}
        \int_{\Sigma_n} f(z) \, dz &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Sigma_n}(z_0).
    \end{align*}

    Calculemos ahora los índices de los polos. Para cada $k\in \bb{Z}^*$, tenemos que:
    \begin{equation*}
        \left|\Re\left(-2k\pi + i\ln a\right)\right| = 2|k|\pi > \pi
    \end{equation*}

    Por tanto, para todo $n\in \bb{N}$, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_n}\left(-2k\pi + i\ln a\right) &= 0 \quad \text{para todo } k\in \bb{Z}^*\\
        \Ind_{\Sigma_n}\left(i\ln a\right) &= 1.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{\Sigma_n} f(z) \, dz &= 2\pi i\Res(f, i\ln a)
    \end{align*}

    Antes de calcular el residuo o las integrales, veamos la relación entre la integral que nos piden y la función que hemos de integrar. Notemos que, para cada $x\in \bb{R}$, tenemos que:
    \begin{align*}
        1+a^2 - 2a\cos(x) &= |e^{-ix}|^2 + |a|^2 - 2a\Re\left(e^{-ix}\right)
        = |e^{-ix} - a|^2 = |a - e^{-ix}|^2 =\\&= (a - e^{-ix})(a - e^{ix})
    \end{align*}

    Ahora sí, calculemos las integrales que nos han resultado. En primer lugar, calculemos la integral sobre el segmento $[-\pi, \pi]$:
    \begin{align*}
        \int_{-\pi}^{\pi} f(z) \, dz &= \int_{-\pi}^{\pi} \frac{z}{a - e^{-i z}}
        = \int_{-\pi}^{\pi} \frac{z (a - e^{i z})}{(a - e^{-i z})(a - e^{i z})} \, dz
        = \int_{-\pi}^{\pi} \frac{z (a - e^{i z})}{1 + a^2 - 2a\cos(z)} \, dz
        =\\&= \int_{-\pi}^{\pi} \frac{z (a - \cos(z) - i\sen(z))}{1 + a^2 - 2a\cos(z)} \, dz
        =\\&= \int_{-\pi}^{\pi} \frac{z (a - \cos(z))}{1 + a^2 - 2a\cos(z)} \, dz
        - i\int_{-\pi}^{\pi} \frac{z \sen(z)}{1 + a^2 - 2a\cos(z)} \, dz.
    \end{align*}

    Calculemos en primer lugar la integral sobre el segmento $[-\pi + i n, \pi + i n]$:
    \begin{align*}
        \left|\int_{[-\pi + i n, \pi + i n]} f(z) \, dz\right| &\leq 2\pi\cdot \sup\left\{\left|\dfrac{z}{a - e^{-i z}}\right| : z\in [-\pi + i n, \pi + i n]\right\}
        = 2\pi\cdot \frac{\sqrt{\pi^2 + n^2}}{e^{n} - a}.
    \end{align*}
    donde hemos usado que, para todo $z\in [-\pi + i n, \pi + i n]$, tenemos que:
    \begin{align*}
        |z| &\leq |\pi + i n| = \sqrt{\pi^2 + n^2}\\
        |a - e^{-i z}| &\geq \left||a| - |e^{-i z}|\right| = \left|a - e^{\Im z}\right| = \left|a - e^{n}\right| = e^{n} - a
    \end{align*}
    Como esta expresión es válida para cualquier $n > \ln a$, podemos hacer $n \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{n\to+\infty} \int_{[-\pi + i n, \pi + i n]} f(z) \, dz &= 0.
    \end{align*}

    Faltan ahora por calcular las integrales sobre los segmentos $[\pi, \pi + i n]$ y sobre $[-\pi, -\pi + i n]$. Para el segmento $[\pi, \pi + i n]$, tenemos que:
    \begin{align*}
        \hspace{-1cm}\int_{[\pi, \pi + i n]} f(z) \, dz &= \int_0^n f(\pi + i t)\cdot i \, dt
        = i\int_0^n \frac{\pi + i t}{a - e^{-i(\pi + i t)}} \, dt
        = i\int_0^n \frac{\pi + i t}{a -e^{-i\pi}e^{t}} \, dt
        = i\int_0^n \frac{\pi + i t}{a + e^{t}} \, dt
    \end{align*}

    Por otro lado, para el segmento $[-\pi, -\pi + i n]$, tenemos que:
    \begin{align*}
        \hspace{-1cm}\int_{[-\pi, -\pi + i n]} f(z) \, dz &= \int_0^n f(-\pi + i t)\cdot i \, dt
        = i\int_0^n \frac{-\pi + i t}{a - e^{-i(-\pi + i t)}} \, dt
        = i\int_0^n \frac{-\pi + i t}{a -e^{i\pi}e^{t}} \, dt
        = i\int_0^n \frac{-\pi + i t}{a + e^{t}} \, dt
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{[\pi, \pi + i n]} f(z) \, dz -& \int_{[-\pi, -\pi + i n]} f(z) \, dz = i\int_0^n \frac{2\pi}{a + e^{t}} \, dt
        = \dfrac{2\pi i}{a}\int_0^n \frac{a}{a + e^{t}} \, dt
        =\\&= \dfrac{2\pi i}{a}\int_0^n \left(1 - \frac{e^{t}}{a + e^{t}}\right) \, dt
        = \dfrac{2\pi i}{a}\left[t - \ln(a + e^{t})\right]_0^n
        =\\&= \dfrac{2\pi i}{a}\left(n - \ln(a + e^{n}) + \ln(a + 1)\right)
        = \dfrac{2\pi i}{a}\left(\ln\left(\frac{e^{n}}{a + e^{n}}\right) + \ln(a + 1)\right)
    \end{align*}

    Como esta expresión es válida para cualquier $n > \ln a$, podemos hacer $n \to +\infty$ y por la continuidad del logaritmo, tenemos que:
    \begin{align*}
        \lim_{n\to+\infty} \left(\int_{[\pi, \pi + i n]} f(z) \, dz - \int_{[-\pi, -\pi + i n]} f(z) \, dz\right) &= \dfrac{2\pi i}{a}\ln\left(1+a\right).
    \end{align*}

    Por otro lado, calculemos el residuo en el punto $i\ln a$:
    \begin{align*}
        \lim_{z\to i\ln a} (z - i\ln a)f(z) &= \lim_{z\to i\ln a} (z - i\ln a)\cdot \frac{z}{a - e^{-i z}}
        \Hop i\ln a\cdot \lim_{z\to i\ln a} \frac{1}{e^{-i z}i}
        = i\ln a\cdot \frac{1}{ai} = \frac{\ln a}{a}
    \end{align*}

    Por tanto, sabemos que $f$ tiene un polo simple en $i\ln a$, y que:
    \begin{align*}
        \Res(f, i\ln a) &= \frac{\ln a}{a}.
    \end{align*}

    Por tanto, para todo $n > \ln a$, tenemos que:
    \begin{align*}
        \int_{\Sigma_n} f(z) \, dz &= 2\pi i\Res(f, i\ln a) = 2\pi i\cdot \frac{\ln a}{a}.
    \end{align*}

    Uniendo todas las integrales que hemos calculado, tenemos que:
    \begin{align*}
        2\pi i \cdot \frac{\ln a}{a} &= \int_{-\pi}^{\pi} f(z) \, dz - \int_{[-\pi + i n, \pi + i n]} f(z) \, dz + \dfrac{2\pi i}{a}\left[\ln\left(\frac{e^{n}}{a + e^{n}}\right) + \ln(a + 1)\right]
    \end{align*}

    Como esta expresión es válida para cualquier $n > \ln a$, podemos hacer $n \to +\infty$ y tenemos que:
    \begin{align*}
        2\pi i \cdot \frac{\ln a}{a} &= \int_{-\pi}^{\pi} f(z) \, dz + \dfrac{2\pi i}{a}\ln(a + 1)
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-\pi}^{\pi} f(z) \, dz &= 2\pi i \cdot \frac{\ln a}{a} - \dfrac{2\pi i}{a}\ln(a + 1)
        = \dfrac{2\pi i}{a}\left(\ln a - \ln(a + 1)\right)
        = \dfrac{2\pi i}{a}\ln\left(\frac{a}{a + 1}\right).
    \end{align*}

    Igualando las partes imaginarias, tenemos que:
    \begin{align*}
        -\int_{-\pi}^{\pi} \frac{x\sen(x)}{1 + a^2 - 2a\cos(x)} \, dx
        &= \dfrac{2\pi}{a}\ln\left(\frac{a}{a + 1}\right)
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-\pi}^{\pi} \frac{x\sen(x)}{1 + a^2 - 2a\cos(x)} \, dx
        &= \dfrac{2\pi}{a}\ln\left(\frac{1 + a}{a}\right).
    \end{align*}
    como queríamos demostrar.
\end{ejercicio}

\begin{ejercicio}
    Integrando una conveniente función compleja a lo largo de la frontera de la mitad superior del anillo $A(0; \varepsilon, R)$, probar que, para $\alpha \in \left]-1, 3\right[$, se tiene:
    \begin{equation*}
        \int_0^{+\infty} \frac{x^\alpha}{(1 + x^2)^2} \, dx = \frac{\pi}{4}(1 - \alpha)\sec\left(\frac{\pi \alpha}{2}\right).
    \end{equation*}
    \begin{observacion}
        Para resolver este ejercicio, se puede hacer el cambio de variable $x = e^t$ y luego integrar $\frac{e^{t(\alpha + 1)}}{(1 + e^{2t})^2}$ en un rectángulo.
    \end{observacion}
\end{ejercicio}

\begin{ejercicio}
    Probar que, para $\alpha \in \left]0, 2\right[$, se tiene:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{e^{\alpha x}}{1 + e^x + e^{2x}} \, dx = \int_0^{+\infty} \frac{t^{\alpha - 1}}{1 + t + t^2} \, dt = \dfrac{2\pi}{\sqrt{3}}\cdot \dfrac{\sen\left(\frac{\pi(1 - \alpha)}{3}\right)}{\sen\left(\pi \alpha\right)}.
    \end{equation*}
    \begin{observacion}
        Para resolver este ejercicio, se puede integrar $\frac{e^x \alpha}{1 + e^x + e^{2x}}$ en un rectángulo.
    \end{observacion}
\end{ejercicio}

\begin{ejercicio}
    Integrando la función $z \mapsto \frac{\log(z + i)}{1 + z^2}$ sobre un camino cerrado que recorra la frontera del conjunto $\{z \in \bb{C} : |z| < R, \Im z > 0\}$, con $R \in \bb{R}$ y $R > 1$, calcular la integral:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{\log(1 + x^2)}{1 + x^2} \, dx.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}\label{ej:14.14}
    Integrando una conveniente función sobre la poligonal $\Gamma_R$ dada por
    $$[-R, R, R + \pi i, -R + \pi i, -R]$$
    con $R \in \bb{R}^+$, calcular la integral:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{\cos(x)}{e^x + e^{-x}} \, dx.
    \end{equation*}

    Veamos en primer lugar en qué puntos se anula el denominador de mi función a integrar:
    \begin{align*}
        e^z + e^{-z} &= 0 \implies e^{2z} = -1 \implies 2z \in \Log(-1) = i\Arg(-1)=i\left(\pi + 2\pi \bb{Z}\right)
        \implies z \in i\pi \left(\nicefrac{1}{2} + \bb{Z}\right).
    \end{align*}

    Sea por tanto $A= i\pi \left(\nicefrac{1}{2} + \bb{Z}\right)$. Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{e^{iz}}{e^z + e^{-z}}}

    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$. Para todo $R\in \bb{R}^+$, consideramos la poligonal siguiente:
    \begin{align*}
        \Gamma_R &= [-R, R] + [R, R + \pi i] - [-R + \pi i, R + \pi i] - [-R, -R + \pi i]
    \end{align*}
    representada en la Figura~\ref{fig:ej:14.14}, donde:
    \Func{[-R, R]}{[-R, R]}{\bb{C}}{t}{t}
    \Func{[R, R + \pi i]}{[0, \pi]}{\bb{C}}{t}{R + i t}
    \Func{[-R + \pi i, R + \pi i]}{[-R, R]}{\bb{C}}{t}{t + i\pi}
    \Func{[-R, -R + \pi i]}{[0, \pi]}{\bb{C}}{t}{-R + i t}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-4, xmax=4,
                ymin=-1, ymax=4,
                axis equal image,
                clip=false,
            ]
                \def\B{pi}
                \def\A{-\B}
                \def\R{3}

                % Polos
                \foreach \k in {0} {
                    \addplot[only marks, mark=*, mark options={fill=red}, samples=1] coordinates {(0, \k*\B + \B*0.5)} 
                        node[right, font=\footnotesize] {$i\left(\nicefrac{1}{2} + 0\right)\pi$};
                }

                % [-R, R]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\A, 0) -- (\B, 0)
                    node[pos=0.7, below] {$[-R, R]$};

                % [R, R + pi i]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\B, 0) -- (\B, \B)
                    node[pos=0.5, right] {$[R, R + \pi i]$};

                % [-R + pi i, R + pi i]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\B, \B) -- (\A, \B)
                    node[pos=1.0, above] {$-[-R + \pi i, R + \pi i]$};

                % [-R, -R + pi i]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\A, \B) -- (\A, 0)
                    node[pos=0.5, left] {$-[-R,-R+\pi i]$};

                % Puntos de unión. Coordenadas:
                \addplot[only marks, mark=*, mark options={fill=blue}, samples=1] coordinates {(\B, 0) (\B, \B) (\A, \B) (\A, 0)};
            \end{axis}
        \end{tikzpicture}
        \caption{Poligonal de integración $\Gamma_R$ del Ejercicio~\ref{ej:14.14}.}
        \label{fig:ej:14.14}
    \end{figure}

    Por el Teorema de los Residuos, tenemos que:
    \begin{align*}
        \int_{\Gamma_R} f(z) \, dz &= 2\pi i\sum_{z_0\in A}\Res(f,z_0)\Ind_{\Gamma_R}(z_0).
    \end{align*}

    Calculemos ahora los índices de los polos. Para cada $k\in \bb{Z}^*$, tenemos que:
    \begin{align*}
        \left|\Im\left(i\left(\nicefrac{1}{2} + k\right)\pi\right)\right| = \left|\left(\nicefrac{1}{2} + k\right)\pi\right| > \pi
    \end{align*}
    Por tanto, para todo $R\in \bb{R}^+$, tenemos que:
    \begin{align*}
        \Ind_{\Gamma_R}\left(i\left(\nicefrac{1}{2} + k\right)\pi\right) &= 0 \quad \text{para todo } k\in \bb{Z}^*\\
        \Ind_{\Gamma_R}\left(i\left(\nicefrac{1}{2}\right)\pi\right) &= 1.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{\Gamma_R} f(z) \, dz &= 2\pi i\Res(f, i\left(\nicefrac{1}{2}\right)\pi).
    \end{align*}

    Antes de calcular el residuo, calculemos las integrales resultantes. Tenemos que:
    \begin{align*}
        \int_{[-R, R]} f(z) \, dz &= \int_{-R}^{R} \frac{e^{iz}}{e^z + e^{-z}} \, dz
    \end{align*}
    Tomando límite con $R\to +\infty$, la parte que nos interesa es la parte real. Por tanto, vamos por buen camino. Calculamos el resto de las integrales:
    \begin{align*}
        \left|\int_{[R, R + \pi i]} f(z) \, dz\right| &\leq \pi\cdot \sup\left\{\left|\dfrac{e^{iz}}{e^z + e^{-z}}\right| : z\in [R, R + \pi i]\right\}
    \end{align*}
    donde, para todo $z\in [R, R + \pi i]^*$, tenemos que:
    \begin{align*}
        |e^{iz}| &= e^{-\Im z}\leq e^0=1\\
        |e^z + e^{-z}| &\geq \left||e^z| - |e^{-z}|\right| = \left|e^{\Re z} - e^{-\Re z}\right| = \left|e^{R} - e^{-R}\right| = e^{R} - e^{-R}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \left|\int_{[R, R + \pi i]} f(z) \, dz\right| &\leq \pi\cdot \frac{1}{e^{R} - e^{-R}}.
    \end{align*}
    Como esta expresión es válida para cualquier $R > 0$, podemos hacer $R \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{[R, R + \pi i]} f(z) \, dz &= 0.
    \end{align*}

    Veamos ahora qué ocurre con la integral sobre el segmento $[-R, -R + \pi i]$:
    \begin{align*}
        \left|\int_{[-R, -R + \pi i]} f(z) \, dz\right| &\leq \pi\cdot \sup\left\{\left|\dfrac{e^{iz}}{e^z + e^{-z}}\right| : z\in [-R, -R + \pi i]\right\}
    \end{align*}
    donde, para todo $z\in [-R, -R + \pi i]^*$, tenemos que:
    \begin{align*}
        |e^{iz}| &= e^{-\Im z}\leq e^0=1\\
        |e^z + e^{-z}| &\geq \left||e^z| - |e^{-z}|\right| = \left|e^{\Re z} - e^{-\Re z}\right| = \left|e^{-R} - e^{R}\right| = e^{R} - e^{-R}.
    \end{align*}
    Por tanto, tenemos que:
    \begin{align*}
        \left|\int_{[-R, -R + \pi i]} f(z) \, dz\right| &\leq \pi\cdot \frac{1}{e^{R} - e^{-R}}.
    \end{align*}
    Como esta expresión es válida para cualquier $R > 0$, podemos hacer $R \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{[-R, -R + \pi i]} f(z) \, dz &= 0.
    \end{align*}




    Veamos ahora qué ocurre con la integral sobre el segmento $[-R + \pi i, R + \pi i]$:
    \begin{align*}
        \int_{[-R + \pi i, R + \pi i]} f(z) \, dz &= \int_{-R}^{R} f(t + i\pi) \, dt
        = \int_{-R}^{R} \frac{e^{i(t + i\pi)}}{e^{t + i\pi} + e^{-(t + i\pi)}} \, dt
        = \int_{-R}^{R} \frac{e^{it}e^{-\pi}}{e^{t}e^{i\pi} + e^{-t}e^{-i\pi}} \, dt
        =\\&= e^{-\pi}\int_{-R}^{R} \frac{e^{it}}{- e^t - e^{-t}} \, dt
        = -e^{-\pi}\int_{-R}^{R} \frac{e^{it}}{e^t + e^{-t}} \, dt
        = -e^{-\pi}\int_{-R}^{R} f(t) \, dt.
    \end{align*}

    Por tanto, uniendo todas las integrales que hemos calculado, y tomando el límite con $R\to +\infty$, tenemos que:
    \begin{align*}
        2\pi i\Res(f, i\left(\nicefrac{1}{2}\right)\pi) &= \left(1+e^{-\pi}\right)\int_{-\infty}^{+\infty} f(z) \, dz
    \end{align*}

    Ahora calculemos el residuo en el punto $i\left(\nicefrac{1}{2}\right)\pi$:
    \begin{align*}
        \lim_{z\to i\cdot \frac{\pi}{2}} \left(z - i\cdot \frac{\pi}{2}\right)f(z) &= \lim_{z\to i\cdot \frac{\pi}{2}} \left(z - i\cdot \frac{\pi}{2}\right)\cdot \frac{e^{iz}}{e^z + e^{-z}}
    \end{align*}

    Por el Teorema de la Regla de L'Hôpital, tenemos que:
    \begin{align*}
        \lim_{z\to i\cdot \frac{\pi}{2}} \left(z - i\cdot \frac{\pi}{2}\right)f(z) &= e^{-\frac{\pi}{2}}\cdot \lim_{z\to i\cdot \frac{\pi}{2}} \frac{1}{e^z - e^{-z}}
        = e^{-\frac{\pi}{2}}\cdot \dfrac{1}{e^{i\cdot \frac{\pi}{2}} - e^{-i\cdot \frac{\pi}{2}}}
        = e^{-\frac{\pi}{2}}\cdot \dfrac{1}{i - (-i)} = e^{-\frac{\pi}{2}}\cdot \dfrac{1}{2i}
    \end{align*}

    Por tanto, sabemos que $f$ tiene un polo simple en $i\cdot \frac{\pi}{2}$, y que:
    \begin{align*}
        \Res\left(f, i\cdot \frac{\pi}{2}\right) &= e^{-\frac{\pi}{2}}\cdot \dfrac{1}{2i}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} f(z) \, dz &= \dfrac{2\pi i\Res\left(f, i\cdot \frac{\pi}{2}\right)}{1 + e^{-\pi}}
        = \dfrac{\pi e^{-\frac{\pi}{2}}}{1 + e^{-\pi}}.
    \end{align*}

    Por tanto, como buscamos la parte real de la integral anterior, tenemos que:
    \begin{align*}
        \int_{-\infty}^{+\infty} \frac{\cos(x)}{e^x + e^{-x}} \, dx &= \Re\left(\int_{-\infty}^{+\infty} f(z) \, dz\right) = \Re\left(\dfrac{\pi e^{-\frac{\pi}{2}}}{1 + e^{-\pi}}\right)
        = \dfrac{\pi e^{-\frac{\pi}{2}}}{1 + e^{-\pi}}
    \end{align*}
\end{ejercicio}

\begin{ejercicio}\label{ej:14.15}
    Integrando una conveniente función sobre un camino cerrado que recorra la frontera del conjunto $\{z \in \bb{C} : \varepsilon < |z| < R, 0 < \arg z < \nicefrac{\pi}{2}\}$, con $0 < \varepsilon < 1 < R$, calcular la integral:
    \begin{equation*}
        \int_0^{+\infty} \frac{\log(x)}{1 + x^4} \, dx.
    \end{equation*}

    Calculamos primero los puntos donde se anula el denominador de la función a integrar:
    \begin{align*}
        1 + z^4 &= 0 \implies z^4 = -1 \implies z\in \left\{e^{i\left(\frac{\pi}{4} + k\frac{\pi}{2}\right)} : k\in \{0, 1, 2, 3\}\right\}
        = \left\{e^{i\frac{\pi}{4}}, e^{i\frac{3\pi}{4}}, e^{i\frac{5\pi}{4}}, e^{i\frac{7\pi}{4}}\right\}.
    \end{align*}

    Para cada $k\in \{0, 1, 2, 3\}$, definimos por simplicidad:
    \begin{align*}
        z_k &= e^{i\left(\frac{\pi}{4} + k\frac{\pi}{2}\right)}
    \end{align*}

    Sea por tanto $A = \{z_k : k\in \{0, 1, 2, 3\}\}$. Definimos la función:
    \Func{f}{\bb{C}\setminus A}{\bb{C}}{z}{\frac{\log(z)}{1 + z^4}}

    Notemos que $f\in \cc{H}(\bb{C}\setminus A)$, y que $A'=\emptyset$, por lo que podemos aplicar el Teorema de los Residuos. Como $\bb{C}$ es homológicamente conexo, podemos aplicar el Teorema de los Residuos para cualquier ciclo $\Sigma$ en $\bb{C}\setminus A$. Para todo $R>1$ y $\veps\in \left]0, 1\right[$, consideramos el siguiente ciclo:
    \begin{align*}
        \Sigma_{\veps, R} &= -\gamma_{\veps} + [\veps, R] + \sigma_R - [i\veps, iR]
    \end{align*}
    representada en la Figura~\ref{fig:ej:14.15}, donde:
    \Func{\gamma_{\veps}}{[0, \nicefrac{\pi}{2}]}{\bb{C}}{t}{\veps e^{it}}
    \Func{[\veps, R]}{[\veps, R]}{\bb{C}}{t}{t}
    \Func{\sigma_R}{[0, \nicefrac{\pi}{2}]}{\bb{C}}{t}{Re^{it}}
    \Func{[i\veps, iR]}{[\veps, R]}{\bb{C}}{t}{i t}
    \begin{figure}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={$x$},
                ylabel={$y$},
                xtick=\empty,
                ytick=\empty,
                xmin=-2, xmax=2,
                ymin=-1.5, ymax=2.5,
                axis equal image,
                clip=false,
            ]
                \def\R{1.5}
                \def\eps{0.5}
                \def\n{4}

                \def\x{0}
                \def\y{0}

                % Polos
                % Representamos los polos en bucle
                \foreach \k in {0,...,\numexpr\n-1\relax} {
                    \pgfmathsetmacro{\angle}{180*(1+2*\k)/\n}
                    \pgfmathsetmacro{\x}{cos(\angle)}
                    \pgfmathsetmacro{\y}{sin(\angle)}
                    \pgfmathsetmacro{\labelx}{\x + 0.2*cos(\angle)} % Offset for label
                    \pgfmathsetmacro{\labely}{\y + 0.2*sin(\angle)} % Offset for label
                    \edef\temp{\noexpand\node[font=\noexpand\footnotesize] at (axis cs:\labelx,\labely) {$e^{i\frac{\pi + 2 \cdot \k \cdot \pi}{\n}}$};}
                    \edef\temp2{\noexpand\node[font=\noexpand\footnotesize] at (axis cs:\labelx,\labely) {$z_{\k}$};}
                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=red},
                    ] coordinates {(\x, \y)};
                    %\temp
                    \temp2
                }



                % [-eps, R]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\eps, 0) -- (\R, 0)
                    node[pos=0.7, below] {$[\varepsilon, R]$};

                % sigma_r
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (\R, 0) arc[start angle=0, end angle=90, radius=\R]
                    node[midway, below left, yshift=-1em, xshift=-1em] {$\sigma_R$};

                % [iR, i eps]
                \draw[thick, blue, arrow at 1/3, arrow at 2/3] (0, \R) -- (0,\eps)
                    node[pos=0, left] {$-[i \veps, i R]$};

                % gamma_eps
                \draw[thick, blue, arrow at 2/3] (0, \eps) arc[start angle=90, end angle=0, radius=\eps];

                % Marca los puntos de unión
                \addplot[only marks, mark=*, mark options={fill=blue}, samples=1] coordinates {(\eps, 0) (\R, 0) (0, \R) (0, \eps)};

                % Radio veps
                \draw[-Stealth, teal, dashed] (0, 0) -- (\eps*0.7071, \eps*0.7071)
                    node[pos=1, above right] {$\varepsilon$};
            \end{axis}
        \end{tikzpicture}
        \caption{Ciclo de integración $\Sigma_{\veps, R}$ del Ejercicio~\ref{ej:14.15}.}
        \label{fig:ej:14.15}
    \end{figure}

    Por el Teorema de los Residuos, tenemos que:
    \begin{align*}
        \int_{\Sigma_{\veps, R}} f(z) \, dz &= 2\pi i\sum_{w_0\in A}\Res(f,w_0)\Ind_{\Sigma_{\veps, R}}(w_0).
    \end{align*}
    Calculemos ahora los índices de los polos. Por cómo hemos definido el ciclo, tenemos que:
    \begin{align*}
        \Ind_{\Sigma_{\veps, R}}(z_0) &= 1\\
        \Ind_{\Sigma_{\veps, R}}(z_k) &= 0 \quad \text{para todo } k\in \{1, 2, 3\}.
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \int_{\Sigma_{\veps, R}} f(z) \, dz &= 2\pi i\Res(f, z_0).
    \end{align*}

    Antes de calcular el residuo, calculemos las integrales resultantes. Tenemos que:
    \begin{align*}
        \int_{[\veps, R]} f(z) \, dz &= \int_{\veps}^{R} \frac{\log(z)}{1 + z^4} \, dz
    \end{align*}
    Tomando límite con $\veps\to 0^+$, y $R\to +\infty$, tenemos lo buscado.\\

    Veamos ahora qué ocurre con la integral sobre el segmento $[i\veps, iR]$:
    \begin{align*}
        \int_{[i\veps, iR]} f(z) \, dz &= i\int_{\veps}^{R} f(it) \, dt
        = i\int_{\veps}^{R} \frac{\log(it)}{1 + (it)^4} \, dt
        = i\int_{\veps}^{R} \frac{\ln t + i\arg(it)}{1 + t^4} \, dt
        =\\&= i\int_{\veps}^{R} \frac{\ln t + i\cdot \nicefrac{\pi}{2}}{1 + t^4} \, dt
        = -\frac{\pi}{2}\cdot \int_{\veps}^{R} \frac{1}{1 + t^4} \, dt + i\int_{\veps}^{R} \frac{\ln t}{1 + t^4} \, dt.
    \end{align*}

    Veamos ahora qué ocurre con la integral sobre la curva $\gamma_{\veps}$:
    \begin{align*}
        \left|\int_{\gamma_{\veps}} f(z) \, dz\right| &\leq \frac{\pi}{2}\cdot \veps \cdot \sup\left\{\left|\dfrac{\log(z)}{1 + z^4}\right| : z\in \gamma_{\veps}^*\right\}
    \end{align*}
    Para todo $z\in \gamma_{\veps}$, tenemos que:
    \begin{align*}
        |1+z^4| &\geq \left||1| - |z^4|\right| = \left|1 - \veps^4\right| = 1 - \veps^4\\
        |\log(z)| &= |\ln|z| + |\arg(z)|\leq \ln\veps + \frac{\pi}{2}
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        \left|\int_{\gamma_{\veps}} f(z) \, dz\right| &\leq \frac{\pi}{2}\cdot \veps \cdot \frac{\ln\veps + \frac{\pi}{2}}{1 - \veps^4}.
    \end{align*}

    Como esta expresión es válida para cualquier $\veps\in \left]0, 1\right[$, podemos hacer $\veps \to 0^+$ y tenemos que:
    \begin{align*}
        \lim_{\veps\to 0^+} \int_{\gamma_{\veps}} f(z) \, dz &= 0.
    \end{align*}

    Veamos ahora qué ocurre con la integral sobre $\sigma_R$:
    \begin{align*}
        \left|\int_{\sigma_R} f(z) \, dz\right| &\leq \frac{\pi}{2}\cdot R \cdot \sup\left\{\left|\dfrac{\log(z)}{1 + z^4}\right| : z\in \sigma_R^*\right\}
    \end{align*}
    Para todo $z\in \sigma_R$, tenemos que:
    \begin{align*}
        |1+z^4| &\geq \left||1| - |z^4|\right| = \left|1 - R^4\right| = R^4 - 1\\
        |\log(z)| &= |\ln|z| + |\arg(z)|\leq \ln R + \frac{\pi}{2}
    \end{align*}
    Por tanto, tenemos que:
    \begin{align*}
        \left|\int_{\sigma_R} f(z) \, dz\right| &\leq \frac{\pi}{2}\cdot R \cdot \frac{\ln R + \frac{\pi}{2}}{R^4 - 1}.
    \end{align*}
    Como esta expresión es válida para cualquier $R > 1$, podemos hacer $R \to +\infty$ y tenemos que:
    \begin{align*}
        \lim_{R\to+\infty} \int_{\sigma_R} f(z) \, dz &= 0.
    \end{align*}

    Uniendo todas las integrales que hemos calculado, tenemos que:
    \begin{align*}
        2\pi i\Res(f, z_0) &= \int_0^R \frac{\log(t)}{1 + t^4} \, dt + \frac{\pi}{2}\cdot \int_{0}^R \frac{1}{1 + t^4} \, dt - i\int_0^R \frac{\log(t)}{1 + t^4} \, dt
    \end{align*}
    
\end{ejercicio}

\begin{ejercicio}
    Integrando una conveniente función sobre la poligonal $[-R, R, R + 2\pi i, -R + 2\pi i, -R]$, con $R \in \bb{R}^+$, calcular la integral:
    \begin{equation*}
        \int_{-\infty}^{+\infty} \frac{e^{\nicefrac{x}{2}}}{e^x + 1} \, dx.
    \end{equation*}
\end{ejercicio}