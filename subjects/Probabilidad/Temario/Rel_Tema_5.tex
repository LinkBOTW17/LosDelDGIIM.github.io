\section{Algunos Modelos Multivariantes}

\begin{ejercicio}
    El 60\% de los clientes de un almacén paga con dinero, el 30\% con tarjeta y el 10\% con cheques. Calcular la probabilidad de que de 10 clientes, 5 paguen con dinero, 2 con tarjeta y 3 con cheques.\\

    Dado $i\in \{\text{dinero},\text{tarjeta},\text{cheques}\}$, definimos $X_i$ como la variable aleatoria que cuenta el número de clientes que pagan con el método $i$. Entonces, $(X_{\text{dinero}},X_{\text{tarjeta}},X_{\text{cheques}})$ sigue una distribución multinomial con parámetros $n = 10$ y probabilidades $(p_{\text{dinero}},p_{\text{tarjeta}},p_{\text{cheques}})$, donde:
    \begin{gather*}
        p_{\text{dinero}} = 0.6,\qquad 
        p_{\text{tarjeta}} = 0.3,\qquad
        p_{\text{cheques}} = 0.1.
    \end{gather*}

    Tenemos entonces que:
    \begin{align*}
        P[X_{\text{dinero}} &= 5,X_{\text{tarjeta}} = 2,X_{\text{cheques}} = 3] = \dfrac{10!}{5!2!3!}\cdot p_{\text{dinero}}^5 \cdot p_{\text{tarjeta}}^2 \cdot p_{\text{cheques}}^3
        =\\&= \dfrac{10!}{5!2!3!} \cdot 0.6^5 \cdot 0.3^2 \cdot 0.1^3
        \approx 0.0176
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    En un hotel hay tres salas de televisión. En un determinado instante, cada televisor puede sintonizar uno entre 6 canales distintos, A, B, C, D, E y F. Cada canal tiene probabilidad $\nicefrac{1}{36}, \nicefrac{3}{36}, \nicefrac{5}{36}, \nicefrac{7}{36}, \nicefrac{9}{36}$ y $\nicefrac{11}{36}$, respectivamente, de ser sintonizado, con independencia unas televisiones de otras. Calcular:
    \begin{enumerate}
        \item Probabilidad de que en un instante dado se sintonicen los canales B, D y E.
        
        Dado $i\in \{A,B,C,D,E,F\}$, definimos $X_i$ como la variable aleatoria que cuenta el número de televisores sintonizando el canal $i$. Entonces, $(X_A,X_B,X_C,X_D,X_E)$ sigue una distribución multinomial con parámetros $n = 3$ y probabilidades $(p_A,p_B,p_C,p_D,p_E)$, donde
        \begin{gather*}
            p_A = \dfrac{1}{36},\qquad 
            p_B = \dfrac{3}{36},\\
            p_C = \dfrac{5}{36},\qquad 
            p_D = \dfrac{7}{36},\qquad 
            p_E = \dfrac{9}{36}.
        \end{gather*}

        Consideramos ahora el vector aleatorio $(X_B,X_D,X_E)$, que sabemos que:
        \begin{equation*}
            (X_B,X_D,X_E) \sim M_3\left(3,p_B,p_D,p_E\right).
        \end{equation*}

        Tenemos que:
        \begin{equation*}
            P[X_B = 1,X_D = 1,X_E = 1] = \dfrac{3!}{1!1!1!0!}\cdot p_B \cdot p_D \cdot p_E = 6\cdot \dfrac{3}{36}\cdot \dfrac{7}{36}\cdot \dfrac{9}{36} = \dfrac{7}{288} \approx 0.0243
        \end{equation*}

        \item Probabilidad de que en un instante dado haya un televisor sintonizando el canal B y otro el E.
        
        Consideramos ahora el vector aleatorio $(X_B,X_E)$, que sabemos que:
        \begin{equation*}
            (X_B,X_E) \sim M_2\left(3,p_B,p_E\right).
        \end{equation*}

        Tenemos que:
        \begin{equation*}
            P[X_B = 1,X_E = 1] = \dfrac{3!}{1!1!1!}\cdot p_B \cdot p_E \cdot \left(1-p_B-p_E\right) = 6\cdot \dfrac{3}{36}\cdot \dfrac{9}{36}\cdot \dfrac{24}{36} = \dfrac{1}{12} \approx 0.0833
        \end{equation*}
        \item Probabilidad de que en un instante dado los tres televisores sintonicen el canal F.
        
        Consideramos ahora el vector aleatorio $(X_F)$, que sabemos que:
        \begin{equation*}
            (X_F) \sim M_1\left(3,p_F\right).
        \end{equation*}

        Tenemos que:
        \begin{equation*}
            P[X_F = 3] = \dfrac{3!}{3!0!}\cdot p_F^3 = 6\cdot \left(\dfrac{11}{36}\right)^3 = \dfrac{1331}{7776} \approx 0.1711
        \end{equation*}

        \item Probabilidad de que en un instante dado no estén sintonizados A, B, C, D.
        
        Consideramos ahora el vector aleatorio $(X_A,X_B,X_C,X_D)$, que sabemos que:
        \begin{equation*}
            (X_A,X_B,X_C,X_D) \sim M_4\left(3,p_A,p_B,p_C,p_D\right).
        \end{equation*}

        Tenemos que:
        \begin{align*}
            P[X_A = 0,&X_B = 0,X_C = 0,X_D = 0] = \dfrac{3!}{0!0!0!0!3!}\cdot \left(1-p_A-p_B-p_C-p_D\right)^3 =\\&= 1\cdot \left(1-\dfrac{1}{36}-\dfrac{3}{36}-\dfrac{5}{36}-\dfrac{7}{36}\right)^3 = \left(\dfrac{5}{9}\right)^3 = \dfrac{125}{729} \approx 0.1715
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Un ordenador genera números aleatorios del 0 al 9 con independencia e igual probabilidad para cada dígito. Si se generan 12 números aleatorios, calcular:
    \begin{enumerate}
        \item La probabilidad de que aparezca 6 veces el dígito 0, 4 veces el 1 y 2 veces el 2.
        
        Dado $i\in \{0,1,2,\ldots,8\}$, definimos $X_i$ como la variable aleatoria que cuenta el número de veces que aparece el dígito $i$. Entonces, $(X_0,X_1,X_2,\ldots,X_8)$ sigue una distribución multinomial con parámetros $n = 12$ y probabilidades $(p_0,p_1,p_2,\ldots,p_8)$, donde:
        \begin{gather*}
            p := p_0 = p_1 = p_2 = \ldots = p_8 = \dfrac{1}{10}.
        \end{gather*}

        Consideramos ahora el vector aleatorio $(X_0,X_1,X_2)$, que sabemos que:
        \begin{equation*}
            (X_0,X_1,X_2) \sim M_3\left(12,p_0,p_1,p_2\right).
        \end{equation*}

        Tenemos que:
        \begin{equation*}
            P[X_0 = 6,X_1 = 4,X_2 = 2] = \dfrac{12!}{6!4!2!0!}\cdot p_0^6 \cdot p_1^4 \cdot p_2^2
            = \dfrac{12!}{6!4!2!0!} p^{12}
            \approx 13.86\cdot 10^{-9}
        \end{equation*}
        \item El número esperado de veces que aparece el 0.
        
        Temeos que $X_0 \sim N_1\left(12,p_0\right)$, por lo que:
        \begin{equation*}
            E[X_0] = n\cdot p_0 = 12\cdot \dfrac{1}{10} = \frac{6}{5} = 1.2
        \end{equation*}
        \item La probabilidad de que aparezca 4 veces el 1 y 3 veces el 6.
        
        Consideramos ahora el vector aleatorio $(X_1,X_6)$, que sabemos que:
        \begin{equation*}
            (X_1,X_6) \sim M_2\left(12,p_1,p_6\right).
        \end{equation*}

        Tenemos que:
        \begin{equation*}
            P[X_1 = 4,X_6 = 3] = \dfrac{12!}{4!3!5!}\cdot p_1^4 \cdot p_6^3 \cdot (1-p_1-p_6)^5
            = \dfrac{12!}{4!3!5!} p^7 (1-2p)^5
            \approx 9.08\cdot 10^{-4}
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Sea $F : \mathbb{R} \to \mathbb{R}$ una función de distribución continua, y sean $\alpha_1$ y $\alpha_2$ números reales tales que $F(\alpha_1) = 0.3$ y $F(\alpha_2) = 0.8$. Si se seleccionan al azar 25 observaciones independientes de la distribución cuya función de distribución es $F$. Calcular la probabilidad de que seis de los valores
    observados sean menores que $\alpha_1$, diez de los valores observados estén entre $\alpha_1$ y $\alpha_2$ y 9 sean mayores que $\alpha_2$.\\

    Como $F$ es una función de distribución, es creciente. Como $F(\alpha_1) = 0.3$ y $F(\alpha_2) = 0.8$, tenemos que $\alpha_1\leq \alpha_2$. Definimos las siguientes variables aleatorias:
    \begin{align*}
        X_1 &:= \text{Número de observaciones menores que }\alpha_1,\\
        X_2 &:= \text{Número de observaciones entre }\alpha_1\text{ y }\alpha_2,\\
        X_3 &:= \text{Número de observaciones mayores que }\alpha_2.
    \end{align*}
    
    Tenemos las siguientes probabilidades:
    \begin{align*}
        p_1 &= \text{Prob. de que una observación sea menor que }\alpha_1 = F(\alpha_1) = 0.3,\\
        p_2 &= \text{Prob. de que una observación esté entre }\alpha_1\text{ y }\alpha_2 = F(\alpha_2) - F(\alpha_1) = 0.8 - 0.3 = 0.5,\\
        p_3 &= \text{Prob. de que una observación sea mayor que }\alpha_2 = 1 - F(\alpha_2) = 0.2 = 1 - p_1 - p_2.
    \end{align*}

    Tenemos que:
    \begin{equation*}
        (X_1,X_2) \sim M_2\left(25,p_1,p_2\right).
    \end{equation*}

    Por lo que la probabilidad pedida es:
    \begin{equation*}
        P[X_1 = 6,X_2 = 10] = \dfrac{25!}{6!10!9!}\cdot p_1^6 \cdot p_2^{10} \cdot p_3^9
        = \dfrac{25!}{6!10!9!} \cdot 0.3^6 \cdot 0.5^{10} \cdot 0.2^9
        \approx 0.0059
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Si se lanzan 5 dados equilibrados de forma independiente, calcular la probabilidad de que los números 1 y 4 aparezcan el mismo número de veces.\\

    Dado $i\in \{1,2,3,4,5,6\}$, definimos $X_i$ como la variable aleatoria que cuenta el número de veces que aparece el número $i$. Entonces, $(X_1,X_2,X_3,X_4,X_5)$ sigue una distribución multinomial con parámetros $n = 5$ y probabilidades $(p_1,p_2,p_3,p_4,p_5)$, donde:
    \begin{gather*}
        p := p_1 = p_2 = p_3 = p_4 = p_5 = \dfrac{1}{6}.
    \end{gather*}

    Consideramos ahora el vector aleatorio $(X_1,X_4)$, que sabemos que:
    \begin{equation*}
        (X_1,X_4) \sim M_2\left(5,p_1,p_4\right).
    \end{equation*}

    Tenemos que la probabilidad pedida es:
    \begin{equation*}
        P[X_1=X_2]=\sum_{i=0}^2 P[X_1 = i,X_4 = i]
    \end{equation*}

    Calculamos cada uno de los sumandos:
    \begin{align*}
        P[X_1 = 0,X_4 = 0] &= \dfrac{5!}{0!0!5!}\cdot p_1^0 \cdot p_4^0 \cdot (1-p_1-p_4)^5 = \dfrac{5!}{5!} \cdot \left(\dfrac{4}{6}\right)^5 = \dfrac{32}{243},\\
        P[X_1 = 1,X_4 = 1] &= \dfrac{5!}{1!1!3!}\cdot p_1^1 \cdot p_4^1 \cdot (1-p_1-p_4)^3 = 5\cdot 4\cdot \left(\dfrac{1}{6}\right)\cdot \left(\dfrac{1}{6}\right)\cdot \left(\dfrac{4}{6}\right)^3 = \dfrac{40}{243},\\
        P[X_1 = 2,X_4 = 2] &= \dfrac{5!}{2!2!1!}\cdot p_1^2 \cdot p_4^2 \cdot (1-p_1-p_4)^1 = \frac{5!}{2!2!} \cdot \left(\dfrac{1}{6}\right)^2 \cdot \left(\dfrac{1}{6}\right)^2 \cdot \dfrac{4}{6} = \dfrac{5}{324}.
    \end{align*}

    Por lo que la probabilidad pedida es:
    \begin{equation*}
        P[X_1=X_2]=\dfrac{32}{243} + \dfrac{40}{243} + \dfrac{5}{324} = \dfrac{101}{324} \approx 0.312
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    En un determinado juego de azar existen tres posibles resultados A, B y C, que se dan con probabilidad $0.8$,$0.15$ y $0.05$, respectivamente. Una persona realiza 5 veces el juego de forma independiente, calcular la probabilidad de que no obtenga ninguna vez el resultado C ni más de una vez el resultado B.\\

    Dado $i\in \{A,B,C\}$, sea $p_i$ la probabilidad de obtener el resultado $i$. Definimos la variable aleatoria $X_i$ como el número de veces que se obtiene el resultado $i$. Se pide:
    \begin{equation*}
        P[X_B \leq 1,X_C = 0] = P[X_B = 0,X_C = 0] + P[X_B = 1,X_C = 0]
    \end{equation*}

    Para calcular cada una de las probabilidades, consideramos el vector aleatorio $(X_B,X_C)$, que sabemos que:
    \begin{equation*}
        (X_B,X_C) \sim M_2\left(5,p_B,p_C\right).
    \end{equation*}

    Tenemos que:
    \begin{align*}
        P[X_B = 0,X_C = 0] &= \dfrac{5!}{0!0!5!}\cdot p_B^0 \cdot p_C^0 \cdot (1-p_B-p_C)^5 = \dfrac{5!}{5!} \cdot 0.8^5 = \frac{1024}{3125},\\
        P[X_B = 1,X_C = 0] &= \dfrac{5!}{1!0!4!}\cdot p_B^1 \cdot p_C^0 \cdot (1-p_B-p_C)^4 = 5 \cdot 0.15 \cdot 0.8^4= \frac{192}{625}.
    \end{align*}

    Por lo que la probabilidad pedida es:
    \begin{equation*}
        P[X_B \leq 1,X_C = 0] = \frac{1024}{3125} + \frac{192}{625} = \frac{1984}{3125} \approx 0.63488
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Sea $(X,Y)$ un vector aleatorio con distribución normal con parámetros $\mu_1 = 5$, $\mu_2 = 8$, $\sigma_1^2 = 16$, $\sigma_2^2 = 9$, $\rho = 0.6$. Calcular
    \[
        P[5 < Y < 11 \mid X = 2].
    \]

    Calculemos en primer lugar la distribución condicional de $Y$ dado $X = 2$. Sabemos que:
    \begin{equation*}
        Y \mid X = 2 \sim \cc{N}\left(\mu_2 + \rho\dfrac{\sigma_2}{\sigma_1}(2-\mu_1),\sigma_2^2(1-\rho^2)\right)
        = \cc{N}\left(6.65, 5.76\right).
    \end{equation*}

    Por tanto, y notando por $Z$ a la tipificada de $Y\mid X=2$, tenemos que:
    \begin{align*}
        P[5 < Y < 11 \mid X = 2] &= P[-0.6875 < Z < 1.8125] = P[Z < 1.8125] - P[Z > -0.6875] =\\
        &= P[Z < 1.8125] - P[Z < 0.6875] \approx 0.96485-0.75490 = 0.20995.
    \end{align*}

    % // TODO: Hecho en clase, comparar
\end{ejercicio}

\begin{ejercicio}
    Calcular la distribución de probabilidad de la suma $X + Y$ para $(X,Y) \sim \cc{N}((\mu_1,\mu_2),\Sigma)$, siendo
    \[
        \Sigma = \begin{pmatrix}
            \sigma_1^2 & \sigma_1\sigma_2\rho \\
            \sigma_1\sigma_2\rho & \sigma_2^2
        \end{pmatrix}.
    \]
\end{ejercicio}

\begin{ejercicio}
    Si $(X,Y)$ es un vector aleatorio con distribución normal, encontrar una condición necesaria y suficiente para que $X + Y$ y $X - Y$ sean independientes.
\end{ejercicio}

\begin{ejercicio}
    Para cada una de las siguientes densidades normales bidimensionales, hallar $\mu_1,\mu_2,\sigma_1^2,\sigma_2^2$ y $\rho$:
    \begin{enumerate}
        \item $f_{(X,Y)}(x, y) = \dfrac{1}{2\pi}\exp\left(-\dfrac{1}{2}((x-1)^2 + (y-2)^2)\right)$
        \item $f_{(X,Y)}(x, y) = \dfrac{1}{2\pi}\exp\left(-\dfrac{1}{2}(x^2 +y^2 +4x-6y+13)\right)$
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Sea $(X,Y)$ un vector aleatorio con función de densidad en $\mathbb{R}^2$ dada por:
    \begin{align*}
        f_{(X,Y)}(x, y) &= f_1(x, y) + f_2(x, y),\\
        f_1(x, y) &= \dfrac{1}{4\pi}\sqrt{1-\rho^2}\exp\left(-\dfrac{1}{2}(1-\rho^2)(x^2 +y^2 -2\rho xy)\right),\quad |\rho| < 1,\\
        f_2(x, y) &= \dfrac{1}{4\pi}\sqrt{1-\tau^2}\exp\left(-\dfrac{1}{2}(1-\tau^2)(x^2 +y^2 -2\tau xy)\right),\quad |\tau| < 1.
    \end{align*}
    
    \begin{enumerate}
        \item Demostrar que las distribuciones marginales son normales de media cero y varianza uno.
        \item Obtener la covarianza de $X$ e $Y$.
        \item ¿Son $X$ e $Y$ independientes? ¿Son $X$ e $Y$ incorreladas?
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Sea $(X,Y)$ un vector aleatorio con distribución normal con parámetros $\mu_1,\mu_2,\sigma_1^2,\sigma_2^2$ y $\rho$. Demostrar que $X$ e $Y$ son independientes $\Leftrightarrow \rho = 0$.
\end{ejercicio}